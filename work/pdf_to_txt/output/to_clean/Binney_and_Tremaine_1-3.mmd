## 1 Introduction

A **stellar system** is a gravitationally bound assembly of stars or other point masses. Stellar systems vary over more than fourteen orders of magnitude in size and mass, from binary stars, to star clusters containing \(10^{2}\) to \(10^{6}\) stars, through galaxies containing \(10^{5}\) to \(10^{12}\) stars, to vast clusters containing thousands of galaxies.

The behavior of these systems is determined by Newton's laws of motion and Newton's law of gravity,1 and the study of this behavior is the branch of theoretical physics called **stellar dynamics**. Stellar dynamics is directly related to at least three other areas of theoretical physics. Superficially, it is closest to celestial mechanics, the theory of planetary motions--both involve the study of orbits in a gravitational field--however, much of the formalism of celestial mechanics is of little use in stellar dynamics, since it is based on perturbation expansions that do not converge when applied to most stellar systems. The most fundamental connections of stellar dynamics are with classical statistical mechanics, since the number of stars in a star cluster or galaxy is often so large that a statistical treatment of the dynamics is necessary. Finally, many of the mathematical tools that have been developed to study stellar systems are borrowed from plasma physics, which also involves the study of large numbers of particles interacting via long-range forces.

Footnote 1: As yet, there is no direct evidence for stellar systems in which relativistic effects are important, although such systems are likely to be present at the centers of galaxies.

For an initial orientation, it is useful to summarize a few orders of magnitude for a typical stellar system, the one to which we belong. Our Sun is located in a stellar system called the **Milky Way** or simply **the Galaxy**. The Galaxy contains four principal constituents:

1. There are about \(10^{11}\) stars, having a total mass \(\simeq 5\times 10^{10}\) solar masses (written \(5\times 10^{10}\,{\cal M}_{\odot}\); \(1\,{\cal M}_{\odot}=1.99\times 10^{30}\,{\rm kg}\)).2 Most of the stars in the Galaxy travel on nearly circular orbits in a thin disk whose radius is roughly \(10^{4}\) parsecs (\(1\) parsec \(\equiv 1\,{\rm pc}\equiv 3.086\times 10^{16}\,{\rm m}\)), or \(10\) kiloparsecs (kpc). The thickness of the disk is roughly \(0.5\,{\rm kpc}\) and the Sun is located near its midplane, about \(8\,{\rm kpc}\) from the center. Footnote 2: See Appendix A for a tabulation of physical and astronomical constants, and Tables 1.1, 1.2 and 2.3 for more precise descriptions of the properties of the Galaxy.
2. The disk also contains gas, mostly atomic and molecular hydrogen, concentrated into clouds with a wide range of masses and sizes, as well as small solid particles ("dust"), which render interstellar gas opaque at visible wavelengths over distances of several kpc. Most of the atomic hydrogen is neutral rather than ionized, and so is denoted **HI**. Together, the gas and dust are called the **interstellar medium** (ism). The total ism mass is only about \(10\%\) of the mass in stars, so the ism has little direct influence on the dynamics of the Galaxy. However, it plays a central role in the chemistry of galaxies, since dense gas clouds are the sites of star formation, while dying stars eject chemically enriched material back into the interstellar gas. The nuclei of the atoms in our bodies were assembled in stars that were widely distributed through the Galaxy.
3. At the center of the disk is a black hole, of mass \(\simeq 4\times 10^{6}\,{\cal M}_{\odot}\). The black hole is sometimes called Sagittarius A* or Sgr A*, after the radio source that is believed to mark its position, which in turn is named after the constellation in which it is found.
4. By far the largest component, both in size and mass, is the **dark halo**, which has a radius of about \(200\,{\rm kpc}\) and a mass of about \(10^{12}\,{\cal M}_{\odot}\) (both these values are quite uncertain). The dark halo is probably composed of some weakly interacting elementary particle that has yet to be detected in the laboratory. For most purposes, the halo interacts with the other components of the Galaxy only through the gravitational force that it exerts, and hence stellar dynamics is one of the few tools we have to study this mysterious yet crucial constituent of the universe.

The typical speed of a star on a circular orbit in the disk is about \(200\,{\rm km\,s^{-1}}\). It is worth remembering that \(1\,{\rm km\,s^{-1}}\) is almost exactly \(1\,{\rm pc}\) (actually \(1.023\)) in \(1\) megayear (\(1\) megayear \(\equiv 1\,{\rm Myr}=10^{6}\) years). Thus the time required to complete one orbit at the solar radius of \(8\,{\rm kpc}\) is \(250\,{\rm Myr}\). Since the age of the Galaxy is about \(10\) gigayears (\(1\) gigayear \(\equiv 1\,{\rm Gyr}=10^{9}\,{\rm yr}\)), most disk stars have completed over forty revolutions, and it is reasonable to assume that the Galaxy is now in an approximately steady state. The steady-stateapproximation allows us to decouple the questions of the present-day _equilibrium_ and _structure_ of the Galaxy, to which most of this book is devoted, from the thornier issue of the _formation_ of the Galaxy, which we discuss only in the last chapter of this book.

Since the orbital period of stars near the Sun is several million times longer than the history of accurate astronomical observations, we are forced to base our investigation of Galactic structure on what amounts to an instantaneous snapshot of the system. To a limited extent, the snapshot can be supplemented by measurements of the angular velocities (or **proper motions**) of stars that are so close that their position on the sky has changed noticeably over the last few years; and by **line-of-sight velocities** of stars, measured from Doppler shifts in their spectra. Thus the _positions_ and _velocities_ of some stars can be determined, but their _accelerations_ are almost always undetectable with current observational techniques.

Using the rough values for the dimensions of the Galaxy given above, we can estimate the mean free path of a star between collisions with another star. For an assembly of particles moving on straight-line orbits, the mean free path is \(\lambda=1/(n\sigma)\), where \(n\) is the number density and \(\sigma\) is the cross-section. Let us make the crude assumption that all stars are like the Sun so the cross-section for collision is \(\sigma=\pi(2\,R_{\odot})^{2}\), where \(\,R_{\odot}=6.96\times 10^{8}\,{\rm m}=2.26\times 10^{-8}\,{\rm pc}\) is the solar radius.3 If we spread \(10^{11}\) stars uniformly over a disk of radius \(10\,{\rm kpc}\) and thickness \(0.5\,{\rm kpc}\), then the number density of stars in the disk is \(0.6\,{\rm pc}^{-3}\) and the mean free path is \(\lambda\simeq 2\times 10^{14}\,{\rm pc}\). The interval between collisions is approximately \(\lambda/v\), where \(v\) is the random velocity of stars at a given location. Near the Sun, the random velocities of stars are typically about \(50\,{\rm km\,s^{-1}}\). With this velocity, the collision interval is about \(5\times 10^{18}\,{\rm yr}\), over \(10^{8}\) times longer than the age of the Galaxy. Evidently, near the Sun collisions between stars are so rare that they are irrelevant--which is fortunate, since the passage of a star within even \(10^{3}\) solar radii would have disastrous consequences for life on Earth. For similar reasons, hydrodynamic interactions between the stars and the interstellar gas have a negligible effect on stellar orbits.

Footnote 3: This calculation neglects the enhancement in collision cross-section due to the mutual gravitational attraction of the passing stars, but this increases the collision rate by a factor of less than 100, and hence does not affect our conclusion. See equation (7.195).

Thus, each star's motion is determined solely by the gravitational attraction of the mass in the galaxy--other stars, gas, and dark matter. Since the motions of weakly interacting dark-matter particles are also determined by gravitational forces alone, the tools that we develop in this book are equally applicable to both stars and dark matter, despite the difference of 70 or more orders of magnitude in mass.

We show in SS1.2 that a useful first approximation for the gravitational field in a galaxy is obtained by imagining that the mass is continuously distributed, rather than concentrated into discrete mass points (the starsand dark-matter particles) and clouds (the gas). Thus we begin Chapter 2 with a description of Newtonian potential theory, developing methods to describe the smoothed gravitational fields of stellar systems having a variety of shapes. In Chapter 3 we develop both quantitative and qualitative tools to describe the behavior of particle orbits in gravitational fields. In Chapter 4 we study the statistical mechanics of large numbers of orbiting particles to find equilibrium distributions of stars in phase space that match the observed properties of galaxies, and learn how to use observations of galaxies to infer the properties of the underlying gravitational field.

The models constructed in Chapter 4 are **stationary**, that is, the density at each point is constant in time because the rates of arrival and departure of stars in every volume element balance exactly. Stationary models are appropriate to describe a galaxy that is many revolutions old and hence presumably in a steady state. However, some stationary systems are unstable, in that the smallest perturbation causes the system to evolve to some quite different configuration. Such systems cannot be found in nature. Chapter 5 studies the stability of stellar systems.

In Chapter 6 we describe some of the complex phenomena that are peculiar to galactic disks. These include the beautiful spiral patterns that are usually seen in disk galaxies; the prominent bar-like structures seen at the centers of about half of all disks; and the warps that are present in many spiral galaxies, including our own.

Even though stellar collisions are extremely rare, the gravitational fields of passing stars exert a series of small tags that slowly randomize the orbits of stars. Gravitational encounters of this kind in a stellar system are analogous to collisions of molecules in a gas or Brownian motion of small particles in a fluid--all these processes drive the system towards energy equipartition and a thermally relaxed state. Relaxation by gravitational encounters operates so slowly that it can generally be neglected in galaxies, except very close to their centers (see SS1.2); however, this process plays a central role in determining the evolution and present form of many star clusters. Chapter 7 describes the kinetic theory of stellar systems, that is, the study of the evolution of stellar systems towards thermodynamic equilibrium as a result of gravitational encounters. The results can be directly applied to observations of star clusters in our Galaxy, and also have implications for the evolution of clusters of galaxies and the centers of galaxies.

Chapter 8 is devoted to the interplay between stellar systems. We describe the physics of collisions and mergers of galaxies, and the influence of the surrounding galaxy on the evolution of smaller stellar systems orbiting within it, through such processes as dynamical friction, tidal stripping, and shock heating. We also study the effect of irregularities in the galactic gravitational field--generated, for example, by gas clouds or spiral arms--on the orbits of disk stars.

Throughout much of the twentieth century, galaxies were regarded as "island universes"--distinct stellar systems occupying secluded positions in space. Explicitly or implicitly, they were seen as isolated, permanent structures, each a dynamical and chemical _unit_ that was formed in the distant past and did not interact with its neighbors. A major conceptual revolution in **extragalactic astronomy**--the study of the universe beyond the edges of our own Galaxy--was the recognition in the 1970s that this view is incorrect. We now believe in a model of **hierarchical galaxy formation**, the main features of which are that: (i) encounters and mergers of galaxies play a central role in their evolution, and in fact galaxies are formed by the mergers of smaller galaxies; (ii) even apparently isolated galaxies are surrounded by much larger dark halos whose outermost tendrils are linked to the halos of neighboring galaxies; (iii) gas, stars, and dark matter are being accreted onto galaxies up to the present time. A summary of the modern view of galaxy formation and its cosmological context is in Chapter 9.

### 1.1 An overview of the observations

#### Stars

The luminosity of the Sun is \(\,L_{\odot}=3.84\times 10^{26}\,{\rm W}\). More precisely, this is the **bolometric luminosity**, the total rate of energy output integrated over all wavelengths. The bolometric luminosity is difficult to determine accurately, in part because the Earth's atmosphere is opaque at most wavelengths. Hence astronomical luminosities are usually measured in one or more specified wavelength bands, such as the **blue** or \(B\) band centered on \(\lambda=450\,{\rm nm}\); the **visual** or \(V\) band at \(\lambda=550\,{\rm nm}\); the \(R\) band at \(\lambda=660\,{\rm nm}\); the near-infrared \(I\) band at \(\lambda=810\,{\rm nm}\); and the infrared \(K\) band centered on the relatively transparent atmospheric window at \(\lambda=2200\,{\rm nm}=2.2\,\mu{\rm m}\), all with width \(\Delta\lambda/\lambda\simeq 0.2\) (see Binney & Merrifield 1998, SS2.3; hereafter this book is abbreviated as BM). For example, the brightest star in the sky, Sirius, has luminosities

\[L_{V}=22\,L_{\odot V}\quad;\quad L_{R}=15\,L_{\odot R}, \tag{1.1}\]

while the nearest star, Proxima Centauri, has luminosities

\[L_{V}=5.2\times 10^{-5}\,L_{\odot V}\quad;\quad L_{R}=1.7\times 10^{-4}\,L_{ \odot R}. \tag{1.2}\]

This notation is usually simplified by dropping the subscript from \(\,L_{\odot}\), when the band to which it refers is clear from the context.

Luminosities are often expressed in a logarithmic scale, by defining the **absolute magnitude**

\[M\equiv-2.5\log_{10}L+{\rm constant}. \tag{1.3}\]The constant is chosen separately and arbitrarily for each wavelength band. The solar absolute magnitude is

\[M_{\odot B}=5.48\quad;\quad M_{\odot V}=4.83\quad;\quad M_{\odot R}=4.42. \tag{1.4}\]

Sirius has absolute magnitude \(M_{V}=1.46\), \(M_{R}=1.47\), and Proxima Centauri has \(M_{V}=15.5\), \(M_{R}=13.9\). The **flux** from a star of luminosity \(L\) at distance \(d\) is \(f=L/(4\pi d^{2})\), and a logarithmic measure of the flux is provided by the **apparent magnitude**

\[m\equiv M+5\log_{10}(d/10\,{\rm pc})=-2.5\log_{10}\left[L(10\,{\rm pc}/d)^{2} \right]+{\rm constant}; \tag{1.5}\]

thus, the absolute magnitude is the apparent magnitude that the star would have if it were at a distance of 10 parsecs. Note that _faint_ stars have _large_ magnitudes. Sirius is at a distance4 of \((2.64\pm 0.01)\,{\rm pc}\) and has apparent magnitude \(m_{V}=-1.43\), while Proxima Centauri is at \((1.295\pm 0.004)\,{\rm pc}\) and has apparent magnitude \(m_{V}=11.1\). The faintest stars visible to the naked eye have \(m_{V}\simeq 6\), and the limiting magnitude of the deepest astronomical images at this time is \(m_{V}\simeq 29\). The apparent magnitudes \(m_{V}\) and \(m_{R}\) are often abbreviated simply as \(V\) and \(R\).

Footnote 4: Throughout this book, quoted errors are all 1 standard deviation, i.e., there is a probability of 0.68 that the actual error is less than the quoted error. The reader is warned that astronomical errors are often dominated by unknown systematic effects and thus tend to be underestimated.

The **distance modulus**\(m-M=5\log_{10}(d/10\,{\rm pc})\) is often used as a measure of distance.

The **color** of a star is measured by the ratio of the luminosity in two wavelength bands, for example by \(L_{R}/L_{V}\) or equivalently by \(M_{V}-M_{R}=m_{V}-m_{R}=V-R\). Sirius has color \(V-R=-0.01\) and Proxima Centauri has \(V-R=1.67\). Stellar spectra are approximately black-body and hence the color is a measure of the temperature at the surface of the star.

A more precise measure of the surface temperature is the **effective temperature**\(T_{\rm eff}\), defined as the temperature of the black body with the same radius and bolometric luminosity as the star in question. If the stellar radius is \(R\), then the Stefan-Boltzmann law implies that the bolometric luminosity is

\[L=4\pi R^{2}\sigma T_{\rm eff}^{4}, \tag{1.6}\]

where \(\sigma=5.670\times 10^{-8}\,{\rm W\,m^{-2}\,K^{-4}}\). The relation between color and effective temperature is tabulated in BM SS3.4 and shown in Figure 1.

A third measure of the surface temperature of a star is its **spectral class**, which is assigned on the basis of the prominence of various absorption lines in the stellar spectrum. In order of decreasing temperature, the spectral classes are labeled O, B, A, F, G, K, M, L, and T, and each class is divided into ten subclasses by the numbers \(0,1,\ldots,9\). Thus a B0 star is slightly cooler than an O9 star. Using this scheme, experienced observers can determine the effective temperature of a star to within about 10% from a quick examination of its spectrum. For example, Sirius has spectral class A1 and effective temperature 9500 K, while Proxima Centauri has spectral class M5 and \(T_{\rm eff}=3000\) K. The Sun is a quite ordinary G2 star, with \(T_{\rm eff}=5780\) K.

The ultraviolet emission from the hottest stars ionizes nearby interstellar gas, forming a sphere of ionized hydrogen called an **HII region** (BM SS8.1.3). The brightest star-like objects in other galaxies are often HII regions shining in emission lines, rather than normal stars shining from thermal emission (see, for example, Plate 1).

The **color-magnitude** diagram is a plot of absolute magnitude against color; since color is related to effective temperature, each point on this diagram corresponds to a unique luminosity, effective temperature, and stellar radius (through eq. 6). In older work spectral type sometimes replaces color, since the two quantities are closely related, and in this case the plot is called a **Hertzsprung-Russell** or **HR** diagram (BM SS3.5). This simple diagram has proved to be the primary point of contact between observations and the theory of stellar structure and evolution.

The distribution of stars in the color-magnitude diagram depends on the age and chemical composition of the sample of stars plotted. Astronomers refer to all elements beyond helium in the periodic table as "metals"; with the exception of lithium, such elements are believed to be formed in stars rather than at the birth of the universe (see SS1.3.5). To a first approximation the abundances of groups of elements vary in lockstep since they are formed in the same reaction chain and injected into interstellar space by the same type of star. At an even cruder level the chemical composition of a star can be approximately specified by a single number \(Z\), the **metallicity**, which is the fraction by mass of all elements heavier than helium. Similarly, the fractions by mass of hydrogen and helium are denoted \(X\) and \(Y\) (\(X+Y+Z=1\)). The Sun's initial composition was \(X_{\odot}=0.71\), \(Y_{\odot}=0.27\), \(Z_{\odot}=0.019\).

Figure 1 shows the color-magnitude diagram for about \(10^{4}\) nearby stars. The most prominent feature is the well-defined band stretching from \((B-V,M_{V})\simeq(0,0)\) to \((B-V,M_{V})\simeq(1.5,11)\). This band, known as the **main sequence**, contains stars that are burning hydrogen in their cores. In this stage of a star's life, the mass--and to a lesser extent, chemical composition--uniquely determine both the effective temperature and the luminosity, so stars remain in a fixed position on the color-magnitude diagram. Main-sequence stars are sometimes called **dwarf** stars, to distinguish them from the larger giant stars that we discuss below. The main sequence is a mass sequence, with more massive stars at the upper left (high luminosity, high temperature, blue color) and less massive stars at the lower right (low luminosity, low temperature, red color). The most and least luminous main-sequence stars in this figure, with absolute magnitudes \(M\simeq-2\) and \(+12\), have masses of about 10 \({\cal M}_{\odot}\) and 0.2 \({\cal M}_{\odot}\), respectively (BM Table 3.13). Objects smaller than about 0.08 \({\cal M}_{\odot}\) never ignite hydrogen in their cores, and

are visible mainly from the radiation they emit as they contract and cool. The luminosity of these objects, known as **brown dwarfs**, therefore depends on both mass and age and they do not form a one-parameter sequence like their more massive siblings.

The massive, high-luminosity stars at the upper end of the main sequence exhaust their fuel rapidly and hence are short-lived (\(\lesssim 100\,\)Myr for stars with \(M_{V}=-2\)), while stars at the lower end of the main sequence

Figure 1.1: The color-magnitude diagram for over \(10^{4}\) nearby stars. Close binary stars have been excluded, since the companion contaminates the color and magnitude measurements. Most of the stars fall on the main sequence, which runs from upper left to lower right. The red-giant branch runs upward and to the right from the main sequence. The red-clump stars form a prominent concentration in the middle of the red-giant branch. The giants are chosen from a larger volume than the other stars to enhance their numbers and thereby show the structure of the giant branch more clearly. The absolute magnitudes are in the \(V\) band and the colors are based on \(B-V\), which gives the ratio of fluxes between \(\lambda=450\,\)nm and \(550\,\)nm (BM Table 2.1). The right axis shows the \(V\)-band luminosity in solar units, and the top axis shows approximate values of the effective temperature, which follows from the color and luminosity because the stars are approximate black bodies. From Perryman et al. (1995).

burn steadily for much longer than the current age of the universe. The Sun has a lifetime of \(10\,{\rm Gyr}\) on the main sequence.

From equation (6), stars that are luminous and cool (upper right of the color-magnitude diagram) must be large, while stars that are dim and hot (lower left of the diagram) must be small. Since the main sequence crosses from upper left to lower right, this argument suggests that radius is not a strong function of luminosity along the main sequence. The mass-radius relation in Table 3 of BM bears this out: between \(M\simeq 0\) and \(M\simeq 10\), a factor of \(10^{4}\) in luminosity, the radius varies by only a factor of six, from \(3\,R_{\odot}\) to \(0.5\,R_{\odot}\).

The color-magnitude diagram contains a handful of dim blue stars around \((B-V,M)\simeq(0,12)\). These are **white dwarfs**, stars that have exhausted their nuclear fuel and are gradually cooling to invisibility. As their location in the diagram suggests, white dwarfs are very small, with radii of order \(10^{-2}\,R_{\odot}\). White dwarfs are so dense that the electron gas in the interior of the star is degenerate; in other words, gravitational contraction is resisted, not by thermal pressure as in main-sequence stars, but rather by the Fermi energy of the star's cold, degenerate electron gas.

Figure 1 also contains a prominent branch slanting up and to the right from the main sequence, from \((B-V,M)\simeq(0.3,4)\) to \((B-V,M)\simeq(1.5,-1)\). These are **red giants**, stars that have exhausted hydrogen in their cores and are now burning hydrogen in a shell surrounding an inert helium core. As their location in the color-magnitude diagram suggests--red therefore cool, yet very luminous--red giants are much larger than main-sequence stars; the stars at the tip of the giant branch have radii \(\gtrsim 100\,R_{\odot}\). In contrast to the main sequence, on which stars remain in a fixed position determined by their mass, the red-giant branch is an evolutionary sequence: stars climb the giant branch from the main sequence to its tip, over an interval of about \(1\,{\rm Gyr}\) for stars like the Sun.

The prominent concentration in the middle of the red-giant branch, near \((B-V,M)\simeq(1,1)\), is called the **red clump**. This feature arises from a later evolutionary stage, which happens to coincide with the red-giant branch for stars of solar metallicity. Red-clump stars have already ascended the giant branch to its tip and returned, settling at the red clump when they begin burning helium in their cores (see below).

Red giants are rare compared to main-sequence stars because the red-giant phase in a star's life is much shorter than its main-sequence phase. Nevertheless, red giants are so luminous that they dominate the total luminosity of many stellar systems. Another consequence of their high luminosity is that a far larger fraction of red giants is found in flux-limited samples than in volume-limited samples. For example, over half of the 100 brightest stars are giants, but none of the 100 nearest stars is a giant.

Figure 2 illustrates the color-magnitude diagram of a typical globular star cluster (SS1.4). The advantage of studying a star cluster is that all of its members lie at almost the same distance, and have the same age and

chemical composition. Thus age and composition differences and distance errors do not blur the diagram, so the sequences are much sharper than in Figure 1 (BM SS6.1.2). In this diagram the main sequence stretches from \((V-I,M_{V})\simeq(0.6,4)\) to \((V-I,M_{V})\simeq(2.4,14)\). In contrast to Figure 1, the main sequence terminates sharply at \(M_{V}\simeq 4\) (the **turnoff**); the more luminous, bluer part of the main sequence that is seen in the sample of nearby stars is absent in the cluster, because such stars have lifetimes shorter than the cluster age. Figure 2 shows a few stars situated along the extrapolation of the main sequence past the turnoff point; these "blue stragglers" may arise from collisions and mergers of stars in the dense core of the cluster or mass transfer between the components of a binary star (page 628). The white dwarfs are visible near \((V-I,M_{V})\simeq(0.4,13)\), and the tip of the red-giant branch lies at \((V-I,M_{V})\simeq(1.3,-2)\).

As a star evolves, it climbs the giant branch until, at the tip of the giant branch, helium starts to burn in its core. The stars then evolve rapidly

Figure 2: The color-magnitude diagram for metal-poor globular clusters. The horizontal axis is the color \(V-I\). Labels denote the main sequence (MS), the main-sequence turnoff (TO), red giants (RG), horizontal branch (HB), blue stragglers (BS), and white dwarfs (WD). This is a composite diagram in which data from five globular clusters have been combined selectively to emphasize the principal sequences; thus the relative numbers of different types of stars are not realistic. From data supplied by W. E. Harris; see also Harris (2003).

to the **horizontal branch** (the sequence of stars near \(M_{V}\simeq 0\), stretching from \(V-I\simeq 0\) to 0.8), where they remain until the helium in the core is exhausted. The form of the horizontal branch depends on the metallicity: as the metallicity increases from very low values (\(Z\simeq 0.01Z_{\odot}\)) the horizontal branch shortens and moves to the right, until at near-solar metallicity it is truncated to the red clump seen in Figure 1.1.

Stars in metal-poor globular clusters are among the oldest objects in the Galaxy. Fits of theoretical models of stellar evolution to the color-magnitude diagrams of metal-poor globular clusters yield ages of (\(12.5\pm 1.5\)) Gyr (Krauss & Chaboyer 2003). This result is consistent with the age of the universe determined from measurements of the cosmic background radiation, \(t_{0}=(13.7\pm 0.2)\) Gyr (eq. 77), if the globular clusters formed when the universe was about 1 Gyr old.

#### The Galaxy

Most of the stars in the Galaxy lie in a flattened, roughly axisymmetric structure known as the **Galactic disk**. On clear, dark nights the cumulative light from the myriad of faint disk stars is visible as a luminous band stretching across the sky, which is the source of the name "Milky Way" for our Galaxy. The midplane of this disk is called the **Galactic plane** and serves as the equator of **Galactic coordinates**\((\ell,b)\), where \(\ell\) is the **Galactic longitude** and \(b\) is the **Galactic latitude** (BM SS2.1.2). The Galactic coordinate system is a heliocentric system in which \(\ell=0,b=0\) points to the Galactic center and \(b=\pm 90^{\circ}\) points to the **Galactic poles**, normal to the disk plane (see Figure 1.3).

The Sun is located at a distance \(R_{0}\) from the center of the Galaxy; the best current estimate \(R_{0}=(8.0\pm 0.5)\) kpc comes from the orbits of stars near the black hole that is believed to mark the center (see SS1.1.6 and Eisenhauer

Figure 1.3: A schematic picture of the Sun’s location in the Galaxy, illustrating the Galactic coordinate system. An arrow points in the direction of Galactic rotation, which is clockwise as viewed from the north Galactic pole.

et al. 2003). One measure of the distribution of stars in the Galactic disk is the surface brightness, the total stellar luminosity emitted per unit area of the disk (see Box 2.1 for a more precise definition). Observations of other disk galaxies suggest that the surface brightness is approximately an exponential function of radius,

\[I(R)=I_{\rm d}\exp(-R/R_{\rm d}). \tag{1.7}\]

The **disk scale length**\(R_{\rm d}\) is difficult to measure in our Galaxy because of our position within the disk. Current estimates place \(R_{\rm d}\) between about 2 and 3 kpc. Thus the Sun lies farther from the Galactic center than about 75-90% of the disk stars. The resulting concentration of luminosity towards the Galactic center is not apparent to the naked eye, since interstellar dust absorbs the light from distant disk stars (the optical depth in the \(V\) band along a line of sight in the Galactic midplane is unity at a distance of only about 0.7 kpc); however, in the infrared, where dust extinction is unimportant, our position near the edge of the disk is immediately apparent from the strong concentration of light in the direction of the constellation Sagittarius (at the center of the image in Plate 2). By contrast, the Galaxy is nearly transparent in the direction of the Galactic poles, which greatly facilitates studying the extragalactic universe.

The stars of the disk travel in nearly circular orbits around the Galactic center. The speed of a star in a circular orbit of radius \(R\) in the Galactic equator is denoted \(v_{\rm c}(R)\), and a plot of \(v_{\rm c}(R)\) versus \(R\) is called the **circular-speed curve**. The circular speed at the solar radius \(R_{0}\) is

\[v_{0}\equiv v_{\rm c}(R_{0})=(220\pm 20)\,{\rm km\,s}^{-1}. \tag{1.8}\]

A strong additional constraint on \(v_{0}\) and \(R_{0}\) comes from the angular motion of the radio source Sgr A* relative to extragalactic sources: if Sgr A* coincides with the black hole at the Galactic center, and if this black hole is at rest in the Galaxy--both very plausible assumptions, but not certainties--then the angular speed of the Sun is \(v_{0}/R_{0}=(236\pm 1)\,{\rm km\,s}^{-1}/(8\,{\rm kpc})\) (Reid & Brunthaler 2004).

The **Local Standard of Rest** (lsr) is an inertial reference frame centered on the Sun and traveling at speed \(v_{0}\) in the direction of Galactic rotation. Since most nearby disk stars are on nearly circular orbits, their velocities relative to the Local Standard of Rest are much smaller than \(v_{0}\). For example, the Sun's velocity relative to the lsr (the **solar motion**) is (BM SS10.3.1)

\[13.4\,{\rm km\,s}^{-1}\ {\rm in\ the\ direction}\ \ell=28^{\circ},\ b=32^{\circ}. \tag{1.9}\]

The root-mean-square (rms) velocity of old disk stars relative to the Local Standard of Rest is 50 km s\({}^{-1}\), larger than the Sun's velocity but still small compared to the circular speed \(v_{0}\).

In the direction perpendicular to the Galactic plane (usually called the "vertical" direction), the density of stars falls off exponentially,

\[\rho(R,z)=\rho(R,0){\rm e}^{-|z|/z_{\rm d}(R)}, \tag{1.10}\]

where \(z\) is the distance from the midplane and \(z_{\rm d}(R)\) is the **scale height** at radius \(R\).5 The thickness \(z_{\rm d}\) of the Galactic disk depends on the age of the stars that are being examined. Older stellar populations have larger scale heights, probably because stochastic gravitational fields due to spiral arms and molecular clouds gradually pump up the random velocities of stars (see SS8.4). In the solar neighborhood, the scale height ranges from \(\lesssim 100\) pc for the young O and B stars to \(\simeq 300\) pc for the stars with ages of order 10 Gyr that constitute the bulk of the disk mass.

Footnote 5: This formula has a discontinuous slope at \(z=0\), which reflects the gravitational attraction of the much thinner gas layer on the stars. The vertical distribution of stars in a thin disk is explored theoretically in Problem 4.22.

A more accurate representation of the vertical structure of the disk is obtained by superimposing two populations with densities described by equation (1.10): the **thin disk** with \(z_{\rm d}\simeq 300\) pc, and the **thick disk** with \(z_{\rm d}\simeq 1\) kpc (BM Figure 10.25). The stars of the thick disk are older and have a different chemical composition from those of the thin disk--thick-disk stars have lower metallicities, and at a given metallicity they have higher abundances of the \(\alpha\) nuclides (\({}^{16}\)O, \({}^{20}\)Ne, \({}^{24}\)Mg, \({}^{28}\)Si, etc.; see BM SS5.2.1 and Figure 10.17) relative to \({}^{56}\)Fe. The surface density of the thick disk is about 7% of that of the thin disk, so in the midplane, thin-disk stars outnumber thick-disk stars by about 50:1. The thick disk was probably created when the infant thin disk was shaken and thickened by an encounter with a smaller galaxy early in its history.

The enhanced \(\alpha\) nuclides found in the thick disk are the signature of stars formed early in the history of the disk, for the following reason. The interstellar gas is polluted with heavy elements by two main processes: (i) "core-collapse" supernovae, arising from the catastrophic gravitational collapse of massive stars, which lag star formation by no more than \(\sim 40\) Myr, and produce ejecta that are rich in \(\alpha\) nuclides; (ii) "thermonuclear" or Type Ia supernovae, which are caused by runaway nuclear burning on the surface of white-dwarf stars in binary systems, lag star formation by of order 0.5-10 Gyr, and produce mostly nuclei near \({}^{56}\)Fe. Thus the chemical composition of thick-disk stars suggests that the thick disk formed in less than about 1 Gyr. In contrast, it appears that stars in the thin disk have formed at a steady rate throughout the lifetime of the Galaxy.

Throughout this book, we shall distinguish the **kinematics** of a stellar system--the observational description of the positions and motions of the stars in the system--from its dynamics--the interpretation of these motions in terms of physical laws (forces, masses, etc.). Thus, the description of the Galaxy in this subsection has so far been kinematic. The simplest approximate dynamical description of the Galaxy is obtained by assuming that its mass distribution is spherical. Let the mass interior to radius \(r\) be \(M(r)\). From Newton's theorems (SS2.2.1) the gravitational acceleration at radius \(r\) is equal to that of a point whose mass is the same as the total mass interior to \(r\); thus the inward acceleration is \(GM(r)/r^{2}\), where the **gravitational constant**\(G=6.674\times 10^{-11}\,\mbox{m}^{3}\,\mbox{kg}^{-1}\,\mbox{s}^{-2}\). The central or **centripetal** acceleration required to hold a body in a circular orbit with speed \(v_{0}\) is \(v_{0}^{2}/r\). Thus the mass interior to the solar radius \(R_{0}\) in this crude model is

\[M(R_{0})=\frac{v_{0}^{2}R_{0}}{G}=9.0\times 10^{10}\,{\cal M}_{\odot}\left( \frac{v_{0}}{220\,\mbox{km}\,\mbox{s}^{-1}}\right)^{2}\left(\frac{R_{0}}{8\, \mbox{kpc}}\right). \tag{1.11}\]

The approximation that the mass distribution is spherical is reasonable for the dark halo, but not for the flat stellar disk. Better models suggest that this estimate is probably high by about 30%, since a disk requires less mass to produce a given centripetal acceleration (see Figure 2.17).

Most of our understanding of stellar astrophysics comes from observations of stars within a few hundred parsecs of the Sun. This distance is much smaller than the disk scale length, and hence it is reasonable to assume that the distribution of properties of these stars (chemical compositions, ages, masses, kinematics, fraction of binary stars, etc.) is constant within this region, even though there may be large-scale gradients in these properties across the Galactic disk. To formalize this assumption, we define the **solar neighborhood** to be a volume centered on the Sun that is much smaller than the overall size of the Galaxy but large enough to contain a statistically useful sample of stars. The concept is somewhat imprecise but nevertheless extremely useful. The appropriate size of the volume depends on which stars we wish to investigate: for white dwarfs, which are both common and dim, the "solar neighborhood" may consist of a sphere of radius only 30 pc centered on the Sun, while for the luminous but rare O and B stars, the solar neighborhood may be considered to extend as far as 1-2 kpc from the Sun.

Our best estimate of the inventory of the solar neighborhood is summarized in Table 1.1. The category "visible stars" includes all main-sequence and giant stars. The category "stellar remnants" includes white dwarfs and neutron stars, while "ism" (interstellar medium) includes atomic and molecular hydrogen, ionized gas, and a small contribution from interstellar dust. The volume density and luminosity density are quoted in the Galactic midplane and the surface density and surface brightness are integrated over a column perpendicular to the Galactic plane, extending to \(\pm 1.1\,\mbox{kpc}\) from the midplane. "Dynamical" denotes determinations of the total volume or surface density from the dynamics of disk stars (see SS4.9.3). The dynamically determined volume density in the midplane is consistent with the observed density in stars and gas to within about 10%, so there is no evidence for a significant component of dark matter in the disk--in other words, the inventory in Table 1.1 appears to be complete. The dynamically determined surface density appears to be higher than the surface density in stars and gas, by \((25\pm 9)\,{\cal M}_{\odot}\,{\rm pc}^{-2}\); if significant, this excess probably represents the contribution of the dark halo. The dark halo also contributes to the volume density in the midplane, but this contribution is undetectably small.

A stellar system is often characterized by its **mass-to-light ratio**, which we denote by \(\Upsilon\) and write in units of the solar ratio, \(\Upsilon_{\odot}=\,{\cal M}_{\odot}/\,L_{\odot}\). According to Table 1, the mass-to-light ratio of the solar neighborhood in the \(R\) band is \(\Upsilon_{R}\simeq 2\,\Upsilon_{\odot}\) in the midplane and \(\simeq 2.5\,\Upsilon_{\odot}\) after integrating to \(\pm 1.1\,{\rm kpc}\) from the plane. The second value is higher because the scale height \(z_{\rm d}\) of luminous young stars is smaller than that of older, dimmer stars.

In addition to the disk, the Galaxy contains a **bulge**, a small, amorphous, centrally located stellar system that is thicker than the disk and comprises \(\sim 15\%\) of the total luminosity. The Galactic bulge is clearly visible at the center of the disk in infrared images of the Galaxy (Plate 2). The evolutionary history, kinematics, and chemical composition of bulge stars are quite different from those of disk stars near the Sun. The bulge stars are believed to date from near the time of formation of the Galaxy, whereas the disk stars have a wide range of ages, since star formation in the disk is an ongoing process. While disk stars in the solar neighborhood are found in nearly circular orbits with speeds \(v_{\rm c}(R)\simeq 220\,{\rm km\,s}^{-1}\) and rms velocity relative to this speed of only \(50\,{\rm km\,s}^{-1}\), the velocity vectors of bulge stars are randomly oriented, with rms velocity \(\simeq 150\,{\rm km\,s}^{-1}\). The bulge stars exhibit a wide range of metallicities, spread around a median metallicity of about \(0.4Z_{\odot}\) (Zoccali et al. 2003), substantially smaller than the metallicity of young stars in the solar neighborhood--presumably because the interstellar gas from which the local disk stars form has steadily become more and more polluted by the metal-rich debris of exploding supernovae.

By analogy to the statistical-mechanical concept that temperature is proportional to mean-square velocity, a stellar population like the disk in

\begin{table}
\begin{tabular}{l c c c c} \hline component & volume & surface & luminosity & surface \\  & density & density & density & brightness \\  & ( \({\cal M}_{\odot}\,{\rm pc}^{-3}\)) & ( \({\cal M}_{\odot}\,{\rm pc}^{-2}\)) & ( \(L_{\odot}\,{\rm pc}^{-3}\)) & ( \(L_{\odot}\,{\rm pc}^{-2}\)) \\ \hline visible stars & 0.033 & 29 & 0.05 & 29 \\ stellar remnants & 0.006 & 5 & 0 & 0 \\ brown dwarfs & 0.002 & 2 & 0 & 0 \\ ISM & 0.050 & 13 & 0 & 0 \\ total & \(0.09\pm 0.01\) & \(49\pm 6\) & 0.05 & 29 \\ dynamical & \(0.10\pm 0.01\) & \(74\pm 6\) & – & – \\ \hline \end{tabular}
\end{table}
Table 1: Inventory of the solar neighborhood which the random velocities are much smaller than the ordered or mean velocity is said to be **cool**, while the bulge population, in which the random velocities are larger than the mean velocity, is said to be **hot**. A hypothetical disk in which the stars move on precisely circular orbits would be **cold**.

Although the distribution of bulge stars is symmetric about the Galactic midplane, the bulge is somewhat brighter and thicker on one side of the Galactic center (longitude \(\ell>0\)) than on the other. This asymmetry arises because the bulge is triaxial: the lengths of the two principal axes that lie in the Galactic plane are in the ratio 3:1, and the triaxial structure extends to about 3 kpc from the center. The long axis is oriented about \(20^{\circ}\) from the line between the Galactic center and the Sun (SS2.7e). Thus the bulge is brighter and thicker at positive longitudes simply because that side is closer to the Sun. Because the bulge is triaxial it is also sometimes called a "bar" and the Milky Way is said to be a barred galaxy (see SS1.1.3).

About 1% of the stellar mass in the Galaxy is contained in the **stellar halo**, which contains old stars of low metallicity (median about \(0.02Z_{\odot}\)). The stellar halo has little or no mean rotation, and a density distribution that is approximately spherical and a power-law function of radius, \(\rho\propto r^{-3}\), out to at least 50 kpc. The metal-poor globular clusters that we describe below (SS1.1.4) are members of the stellar halo. The low metallicity of this population suggests that it was among the first components of the Galaxy to form. Much of the halo comprises the debris of disrupted stellar systems, such as globular clusters and small satellite galaxies.

The dark halo is the least well understood of the Galaxy's components. We have only weak constraints on its composition, shape, size, mass, and local density. A wide variety of candidates for the dark matter have been suggested, most falling into one of two broad classes: (i) some unknown elementary particle--the preferred candidates are wimps, an acronym for weakly interacting massive particles, but there are also more exotic possibilities such as axions; (ii) non-luminous macroscopic objects, such as neutron stars or black holes, which are usually called machos, for massive compact halo objects. Measurements of the optical depth to gravitational lensing through the halo exclude machos in the range \(10^{-7}\)-30 \({\cal M}_{\odot}\) as the dominant component of the dark halo (Alcock et al. 2001; Tisserand et al. 2007), and indirect dynamical arguments (SS8.2.2e) suggest that more massive compact objects are also excluded. On the other hand, hypothetical massive, neutral, weakly interacting particles could be formed naturally in the early universe in approximately the numbers required to make a substantial contribution to the overall density. Thus most physicists and astronomers believe that the dark halo is probably composed of wimps. Ordinary matter--stars, dust, interstellar gas, machos, etc., whether luminous or dark--derives almost all of its mass from baryons and hence is usually referred to as **baryonic matter** to distinguish it from **non-baryonic matter** such as wimps.6The formation of flat astrophysical systems such as the solar system or a galaxy disk requires dissipation, which removes energy but conserves angular momentum and therefore leads naturally to a rapidly rotating thin disk. Since wimps cannot dissipate energy, the dark halo is expected to be approximately spherical. Numerical simulations of the formation of dark halos suggest that they are triaxial rather than precisely spherical, with minor-to-major axis ratios of 0.4-0.6, but there is little direct observational evidence on halo shapes (SS9.3.3).

The total size and mass of the Galaxy's halo can be constrained by the kinematics of distant globular clusters and nearby galaxies. Using this method Wilkinson & Evans (1999) find a best-fit mass of \(2\times 10^{12}\,{\cal M}_{\odot}\), with a **median** or **half-mass radius** (the radius containing half the total mass) of \(100\,{\rm kpc}\); however, these values are very uncertain and masses as small as \(2\times 10^{11}\,{\cal M}_{\odot}\) or as large as \(5\times 10^{12}\,{\cal M}_{\odot}\) are allowed. A reasonable guess of the total mass of the Galaxy inside \(100\,{\rm kpc}\) radius is

\[M(r<100\,{\rm kpc})=5\hbox{--}10\times 10^{11}\,{\cal M}_{\odot}. \tag{1.12}\]

The mass distribution in the dark halo is equally uncertain at smaller radii: the halo contribution to the radial gravitational force at the solar radius, which determines the circular speed, could lie anywhere from less than 10% to almost 50% of the total force without violating the observational constraints (SS6.3.3). The uncertain halo mass distribution inside \(R_{0}\) implies an uncertain halo density at \(R_{0}\), which is a significant concern to experimentalists hoping to detect the dark matter in laboratory experiments (Gaitskell 2004).

It is useful to parametrize the relative amounts of dark and luminous matter in a stellar system by the mass-to-light ratio. Stellar systems composed entirely of stars usually have mass-to-light ratios \(\Upsilon_{R}\) in the range 1-\(10\Upsilon_{\odot}\), depending on the age and chemical composition of the stars, while systems composed entirely of dark matter would have \(\Upsilon\to\infty\). The largest mass-to-light ratios known, \(\Upsilon_{R}\sim 500\Upsilon_{\odot}\), occur in dwarf spheroidal galaxies (page 24). In the \(R\) band, the luminosity of the Galaxy is \(3\times 10^{10}\,L_{\odot}\), so its mass-to-light ratio is \(\sim 60\Upsilon_{\odot}\), with large uncertainties (7-\(170\Upsilon_{\odot}\)) because of the uncertain mass of the dark halo.

A summary of properties of the Galaxy is provided in Table 1.2; for more details see SS2.7.

## Chapter 1 Introduction

The _Galactic_ satellite galaxy (GCs) is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite galaxy is a well-known phenomenon of the formation of a galaxy in the universe. The _Galactic_ satellite_ galaxy is a well-known phenomenon of the formation of a galaxy in the universe.

#### Other galaxies

The nearest known galaxy to our own is the **Sagittarius dwarf galaxy**, (see Table 4.3 of BM or van den Bergh 2000 for a list of nearby galaxies). The Sagittarius galaxy has a total luminosity \(L\simeq 2\times 10^{7}\,L_{\odot}\) and is located on the opposite side of the Galaxy from us, about 24 kpc from the Sun and 16 kpc from the Galactic center. The line of sight to the Sagittarius dwarf passes only \(15^{\circ}\) from the Galactic center, so the galaxy is masked by the dense star fields of the Galactic bulge, and thus was discovered only in 1994 (from anomalies in the kinematics of what were thought to be bulge stars). The orbit of Sagittarius carries it so close to the center of the Galaxy that it is being disrupted by the Galactic tidal field, and a tidal tail or streamer--a trail of stars torn away from the main body of the galaxy--can be traced across most of the sky (Figure 8.10).

Our next nearest neighbor is the **Large Magellanic Cloud** or LMC. Although some 50 times as luminous than Sagittarius, with luminosity \(L_{R}\simeq 1\times 10^{9}\,L_{\odot}\), the LMC is still a relatively modest galaxy. The LMC is 45-50 kpc from the Sun and is visible to the naked eye in the southern hemisphere as a faint patch of light (see Plates 2 and 11). Because of its proximity and its location at relatively high Galactic latitude, where foreground contamination and dust obscuration are small (\(b=-30^{\circ}\)), the LMC provides a unique laboratory for studies of interstellar gas and dust, stellar properties, and the cosmological distance scale. Also visible to the naked eye is the **Small Magellanic Cloud**, located \(20^{\circ}\) from the LMC on the sky, 20% further away, and with 20% of its luminosity. It is likely that the two Clouds are a former binary system that has been disrupted by tidal forces from the Galaxy.

The nearest large disk galaxy similar to our own is called the **Andromeda galaxy**, **M31**, or **NGC 224** (see Plate 3 and Hodge 1992). M31 is more than ten times as far away as the LMC (\(d\simeq 740\,\)kpc) and more than ten times as luminous (\(L\simeq 4\times 10^{10}\,L_{\odot}\)). Only the central parts of M31 are visible to the naked eye, but deep telescopic images show that its stellar disk extends across more than six degrees on the sky.

Our Galaxy is just one member of a vast sea of some \(10^{9}\) galaxies stretching to a distance of several thousand megaparsecs (1 megaparsec \(\equiv 1\,{\rm Mpc}=10^{6}\,{\rm pc}=3.086\times 10^{22}\,{\rm m}\)). The determination of distances to these galaxies is one of the most important tasks in extragalactic astronomy, since many of the properties derived for a galaxy depend on the assumed distance. Methods for measuring galaxy distances are described in detail in Chapter 7 of BM. For our purposes it is sufficient to note that in a universe that is homogeneous and isotropic, the relative velocity \(v\) between two galaxies that are separated by a large distance \(r\) is given by the **Hubble law**,

\[v=H_{0}r, \tag{1.13}\]

where \(H_{0}\) is the **Hubble constant** (see SS1.3.1). Our universe is nearly homogeneous and isotropic on large scales, so the velocity field or **Hubble flow**implied by the Hubble law is approximately correct: the only significant error comes from random velocities of a few hundred \(\,{\rm km\,s^{-1}}\) that are generated by the gravitational acceleration from small-scale irregularities in the cosmic matter density. Thus, for example, the distance of a galaxy with a velocity of \(7000\,{\rm km\,s^{-1}}\) is known to within about 5% once the Hubble constant is known.

By comparing the flux from Cepheid variable stars in the Large Magellanic Cloud and more distant galaxies, Freedman et al. (2001) deduce that

\[H_{0}=(72\pm 8)\,{\rm km\,s^{-1}\,Mpc^{-1}}; \tag{1.14}\]

while measurements of small fluctuations in the cosmic background radiation (SS1.3.5 and Spergel et al. 2007) give

\[H_{0}=(73.5\pm 3.2)\,{\rm km\,s^{-1}\,Mpc^{-1}}. \tag{1.15}\]

When precision is required, we shall write the Hubble constant as

\[\eqalign{H_{0}&\equiv 70\,h_{7}\,{\rm km\,s^{-1}\,Mpc^{-1}}\cr&=2.268\,h_{7} \times 10^{-18}\,{\rm Hz},\cr H_{0}^{-1}&=13.97\,h_{7}^{-1}\,{\rm Gyr},} \tag{1.16}\]

where the dimensionless parameter \(h_{7}\) is probably within 10% of unity. Any uncertainty in the Hubble constant affects the whole distance scale of the universe and hence is reflected in many of the average properties of galaxies; for example, the mean density of galaxies scales as \(h_{7}^{3}\) and the mean luminosity of a galaxy of a given type scales as \(h_{7}^{-2}\).

If galaxies suffered no acceleration due to external gravitational forces, the distance between any two galaxies would be a linear function of time. Combined with the Hubble law (1.13), this assumption implies that the distance between any two galaxies was zero at a time \(H_{0}^{-1}\) (the **Hubble time**) before the present. The Hubble time provides a rough estimate of the age of the universe. The actual age is somewhat different because the relative velocities of galaxies are decelerated by the gravitational attraction of baryonic and dark matter and accelerated by vacuum energy (see SS1.3.3); these effects nearly cancel at present, so the best estimate of the age, \(t_{0}=13.7\,{\rm Gyr}\) (eq. 1.77), is accidentally very close to the Hubble time.

Galaxies can usefully be divided into four main types according to the **Hubble classification system**--see BM SS4.1.1 or Sandage & Bedke (1994) for a more complete description.

**(a) Elliptical galaxies** These are smooth, featureless stellar systems containing little or no cool interstellar gas or dust and little or no stellar disk. The galaxy M87 shown in Plate 4 is a classic example of this type. The starsin most elliptical galaxies are old, having ages comparable to the age of the universe, consistent with the absence of gas from which new stars can form.

The fraction of luminous galaxies that are elliptical depends on the local density of galaxies, ranging from about 10% in low-density regions to over 40% in the centers of dense clusters of galaxies (BM SS4.1.2).

As the name suggests, the contours of constant surface brightness, or **isophotes**, of elliptical galaxies are approximately concentric ellipses, with axis ratio \(b/a\) ranging from 1 to about 0.3. The **ellipticity** is \(\epsilon\equiv 1-b/a\). In the Hubble classification system, elliptical galaxies are denoted by the symbols E0, E1, etc., where a galaxy of type E\(n\) has axis ratio \(b/a=1-n/10\). The most elongated elliptical galaxies are type E7. Since we see only the projected brightness distribution, it is impossible to determine directly whether elliptical galaxies are axisymmetric or triaxial; however, indirect evidence strongly suggests that both shapes are present (BM SSS4.2 and 4.3).

The surface brightness of an elliptical galaxy falls off smoothly with radius, until the outermost parts are undetectable against the background sky brightness. Because galaxies do not have sharp outer edges, their sizes must be defined with care. One useful measure of size is the **effective radius**\(R_{\rm e}\), the radius of the isophote containing half of the total luminosity7 (or the geometric mean of the major and minor axes of this isophote, if the galaxy is elliptical). The effective radius is correlated with the luminosity of the elliptical galaxy, ranging from 20 kpc for a giant galaxy such as M87 (Plate 4) to 0.2 kpc for a dwarf such as M32 (Plate 3).

Footnote 7: The effective radius is measured on the plane of the sky, and is not to be confused with the half-light or median radius (page 17), the radius of a sphere containing half the luminosity.

The Hubble classification is based on the ellipticity of the isophotes near the effective radius. In many galaxies the isophotes become more elliptical at large radii; thus, for example, M87 is classified as E0 but the isophotal axis ratio is only 0.5 in its outermost parts.

Several empirical formulae have been used to fit the surface-brightness profiles of ellipticals. One of the most successful is the **Sersic** law

\[I_{m}(R)=I(0)\exp(-kR^{1/m})=I_{\rm e}\exp\big{\{}-b_{m}[(R/R_{\rm e})^{1/m}-1] \big{\}}; \tag{1.17}\]

here \(I(R)\) is the surface brightness at radius \(R\) and \(I_{\rm e}\) is the surface brightness at the effective radius \(R_{\rm e}\). The parameter \(m\) is the **Sersic index**, which is correlated with the luminosity of the elliptical galaxy, luminous ellipticals having \(m\simeq 6\) and dim ones having \(m\simeq 2\). The middle of this range is \(m=4\), which defines the **de Vaucouleurs** or \(R^{1/4}\) law (de Vaucouleurs 1948). The function \(b_{m}\) must be determined numerically from the condition \(\int_{0}^{R_{\rm e}}{\rm d}R\,RI_{m}(R)=\frac{1}{2}\int_{0}^{\infty}{\rm d}R \,RI_{m}(R)\); but the fitting formula \(b_{m}=2m-0.324\) has fractional error \(\lesssim 0.001\) over the range \(1<m<10\) (see Ciotti & Bertin 1999 for properties of Sersic laws). For \(m=1\) the Sersic law reduces to the exponential profile (7) that describes the surface-brightness distribution of disk galaxies.

The total luminosity of a galaxy is difficult to define precisely because the outer parts are too faint to measure. One approach is to define a **model luminosity** by fitting the surface-brightness profile to a Sersic or de Vaucouleurs profile and then estimating the luminosity as \(L=\int{\rm d}^{2}{\bf R}\,I_{m}(R)\).

The luminosities of elliptical galaxies range over a factor of \(10^{8}\), from almost \(10^{12}\,L_{\odot}\) for the very luminous galaxies found at the centers of massive clusters of galaxies, to \(\lesssim 10^{4}\,L_{\odot}\) for the dimmest dwarf galaxies. The **luminosity function**\(\phi(L)\) describes the relative numbers of galaxies of different luminosities, and is defined so that \(\phi(L)\,{\rm d}L\) is the number of galaxies in the luminosity interval \(L\to L+{\rm d}L\) in a representative unit volume of the universe. A convenient analytic approximation to \(\phi(L)\) is the **Schechter law** (BM SS4.1.3),

\[\phi(L)\,{\rm d}L=\phi_{\star}\biggl{(}{L\over L_{\star}}\biggr{)}^{\alpha} \exp(-L/L_{\star}){{\rm d}L\over L_{\star}},\]

where \(\phi_{\star}\simeq 4.9\times 10^{-3}\,h_{7}^{3}\,{\rm Mpc}^{-3}\), \(\alpha=-1.1\), and \(L_{\star}\simeq 2.9\times 10^{10}\,h_{7}^{-2}\,L_{\odot}\) in the \(R\) band (Brown et al. 2001). The concept of a "universal" luminosity function embodied in the Schechter law is no more than a good first approximation: in fact the luminosity function is known to depend on both galaxy type and environment (BM SS4.1.3).

The average \(R\)-band luminosity density derived from equation (18) is

\[j_{R}=\int{\rm d}L\,L\phi(L)=\phi_{\star}L_{\star}\int_{0}^{\infty}{\rm d}x\,x ^{\alpha+1}{\rm e}^{-x}=(\alpha+1)!\,\phi_{\star}L_{\star},\]

where the factorial function is defined for non-integer arguments in Appendix C.2. For the parameters given above, \(j_{R}=1.5\times 10^{8}h_{7}\,L_{\odot}\,{\rm Mpc}^{-3}\), with an uncertainty of about 30%.

Most luminous elliptical galaxies exhibit little or no rotation, even those with large ellipticity; this is in contrast to stars or other gravitating gas masses, which must be spherical if they do not rotate and flattened when rotating. Among dimmer elliptical galaxies, however, rotation and flattening do appear to be correlated (see SS4.4.2c and Faber et al. 1997). This distinction between luminous and dim ellipticals may arise because the most recent mergers of luminous galaxies have been "dry," that is, between progenitors containing little or no gas, while the recent mergers of low-luminosity ellipticals have involved gas-rich systems. Whether or not this interpretation is correct, the different rotational properties of high-luminosity and low-luminosity elliptical galaxies illustrate that stellar systems can exhibit a much greater variety of equilibria than gaseous systems such as stars.

Each star in an elliptical galaxy orbits in the gravitational field of all the other stars and dark matter in the galaxy. The velocities of individual starscan be measured in only a few nearby galaxies, but in more distant galaxies the overall distribution of stellar velocities along the line of sight can be determined from the Doppler broadening of lines in the integrated spectrum of the galaxy. The most important parameter describing this distribution is the rms line-of-sight velocity \(\sigma_{\parallel}\), sometimes called simply the velocity dispersion (eq. 4.25).

The luminosity, velocity dispersion, and size of elliptical galaxies are correlated. Astronomers usually plot this correlation using not the luminosity but the average surface brightness within the effective radius, which is simply \(\overline{I}_{\rm e}\equiv{1\over 2}L/(\pi R_{\rm e}^{2})\). Then if we plot the positions of a sample of elliptical galaxies in the three-dimensional space with coordinates \(\log_{10}\overline{I}_{\rm e}\), \(\log_{10}R_{\rm e}\), and \(\log_{10}\sigma_{\parallel}\), they are found to lie on a two-dimensional surface, the **fundamental plane** (see BM SS4.3.4 and SS4.9.2), given by

\[\log_{10}R_{\rm e}=1.24\log_{10}\sigma_{\parallel}-0.82\log_{10}\overline{I}_ {\rm e}+{\rm constant}, \tag{1.20}\]

with an rms scatter of 0.08 in \(\log_{10}R_{\rm e}\) or 0.07 in \(\log_{10}\sigma_{\parallel}\) (Jorgensen et al. 1996).

The properties of galaxies are determined both by the fundamental plane and by their distribution within that plane. Let us think of the space with coordinates \((\log_{10}\overline{I}_{\rm e},\log_{10}R_{\rm e},\log_{10}\sigma_{\parallel})\) as a fictitious three-dimensional space, and imagine observing the distribution of galaxies from a distance. If the line of sight to the observer in this fictitious space lies close to the fundamental plane, the observer will find that galaxies lie close to a line in the two-dimensional space normal to the line of sight. This distribution of galaxies can be thought of as a projection of the distribution in the fundamental plane. The most important of these projections are:

(i) The **Faber-Jackson law** (BM SS4.3.4),

\[\log_{10}\left({\sigma_{\parallel}\over 150\,{\rm km\,s^{-1}}}\right)\simeq 0.25\log_{10}\left({L_{R}\over 10^{10}h_{7}^{-2}\,L_{\odot}}\right). \tag{1.21}\]

Thus the velocity dispersion of an \(L_{\star}\) galaxy is \(\sigma_{\parallel}\simeq 200\,{\rm km\,s^{-1}}\). The rms scatter in the Faber-Jackson law is about 0.1 in \(\log_{10}\sigma_{\parallel}\) (Davies et al. 1983).

(ii) The **Kormendy relation**

\[\log_{10}\left({\overline{I}_{\rm e,R}\over 1.2\times 10^{3}\,L_{\odot}\,{\rm pc ^{-2}}}\right)=-0.8\log_{10}\left({R_{\rm e}\over h_{7}^{-1}\,{\rm kpc}}\right).\] (1.22a) Here \[\overline{I}_{\rm e,R}\] denotes the mean \[R\] -band surface brightness interior to \[R_{\rm e}\] - The rms scatter is less than 0.25 in \[\log_{10}\overline{I}_{\rm e}\]. The Kormendy relation implies that \[\log_{10}\left({L_{R}\over 7.7\times 10^{9}h_{7}^{-2}\,L_{\odot}}\right)=1.2 \log_{10}\left({R_{\rm e}\over h_{7}^{-1}\,{\rm kpc}}\right). \tag{1.22b}\]Thus more luminous galaxies are larger, but have lower surface brightness.

Careful dynamical modeling (SS4.9.2) allows us to determine the mass-to-light ratio \(\Upsilon\) in elliptical galaxies. These studies show that at radii less than \(\sim R_{\rm e}\) the mass-to-light ratio is not strongly dependent on radius, and consistent with the mass-to-light ratio that we would expect from the observed stellar population (Cappellari et al. 2006). Thus the contribution of dark matter to the mass inside \(R_{\rm e}\) is \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}30\%\). The mass-to-light ratio is also tightly correlated with \(\sigma_{\rm e}\), the luminosity-weighted velocity dispersion within \(R_{\rm e}\):

\[\Upsilon_{I}=(3.80\pm 0.2)\,\Upsilon_{\odot}\times\Bigl{(}{\sigma_{\rm e} \over 200\,{\rm km\,s^{-1}}}\Bigr{)}^{0.84\pm 0.07} \tag{1.23}\]

with an intrinsic scatter of only 13%.

Just as stars are found in gravitationally bound systems such as galaxies, many galaxies are found in bound systems called **groups** or **clusters of galaxies** (see SS1.1.5). The largest clusters of galaxies are several Mpc in radius and contain thousands of galaxies. The most luminous galaxy in a large cluster--more often called a **rich cluster**--is often exceptional, in that it is (i) several times more luminous than any other cluster galaxy, and much more luminous than one would expect from the Schechter law (1.18) (\(L/L_{\star}\sim 3\)-10); (ii) at rest in the center of the cluster; (iii) surrounded by a dim stellar halo that extends out to \(\sim 1\,{\rm Mpc}\). Galaxies with these unique characteristics are called **brightest cluster galaxies**; the nearest example is M87 in the Virgo cluster (Plate 4).8 The existence of an extended dim halo is also the defining property of **cD galaxies** (BM SS4.3.1); in practice, the terms "brightest cluster galaxy" and "cD galaxy" are often used interchangeably. The halo probably arises from stars that have been stripped from individual cluster galaxies by tidal forces and now orbit independently in the cluster's gravitational field. Brightest cluster galaxies are believed to form during the hierarchical assembly of the cluster from smaller subunits (Dubinski 1998).

Footnote 8: The most luminous galaxy in the Virgo cluster is actually the E2 galaxy M49=NGC 4472, rather than M87. The Virgo cluster has a complex structure, consisting of two main concentrations, a dominant one near M87 and a smaller one near M49. These probably represent two merging sub-clusters, each with its own brightest cluster galaxy.

The dimmest elliptical galaxies are also unusual. In general, dim ellipticals have higher surface brightness than luminous ellipticals, a manifestation of the Kormendy relation (1.22). However, at luminosities \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}10^{9}\,L_{\odot}\) a distinct family of **diffuse dwarf elliptical** or **dwarf spheroidal** galaxies appears, with much larger effective radii and lower surface brightnesses than "normal" ellipticals of the same luminosity (Mateo 1998). Dwarf spheroidal galaxies are difficult to detect because their surface brightness is much less than that of the night sky; nearby dwarf spheroidals are discovered because their brightest stars produce a slight enhancement in star counts that are otherwise dominated by foreground stars belonging to our own Galaxy.

There are at least 20 dwarf spheroidal galaxies within 200 kpc, and given the limited sky coverage of existing surveys the actual number may be 50-100 (Belokurov et al. 2007). All appear to be satellites orbiting the Galaxy.Galaxy, satellites of Their luminosities range from \(2\times 10^{7}\,L_{\odot}\) to \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}10^{4}\,L_{\odot}\). The dwarf spheroidals offer a unique probe of dark matter in galaxies, for the following reason. In more luminous galaxies, both baryonic matter (stars and gas) and dark matter contribute comparable amounts to the total mass within the visible stellar system; thus, disentangling their effects to isolate the properties of the dark-matter distribution at small radii is difficult. In some dwarf spheroidal galaxies, however, dark matter contributes 90% or more of the total mass, even at the center of the galaxy, so the dynamics is determined entirely by the gravitational field of the dark matter.

The distribution of mass in the dark halos of ellipticals can be constrained by several methods, including: (i) The kinematics of tracer particles such as globular clusters or planetary nebulae, which typically sample radii from 10-30 kpc (Cote et al. 2003; Romanowsky et al. 2003). This approach relies on the statistical analysis of the positions and velocities of hundreds or thousands of objects, assuming they are found at random orbital phases. (ii) Diffuse X-ray emission from hot gas around the galaxy (Mathews & Brighenti 2003). Measurements of the emissivity and temperature distribution, combined with the plausible assumption that the gas is in hydrostatic equilibrium, can be used to constrain the distribution of the dark matter out to \(\sim 30\,\)kpc in isolated galaxies. The same technique can be applied to brightest cluster galaxies out to much larger radii, but in this case we are measuring the combined dark-matter distribution of the galaxy and the cluster. (iii) Kinematics of satellite galaxies. This technique is similar in principle to the use of globular clusters or planetary nebulae; the satellite galaxies have the advantage that they sample much larger radii, from 100-400 kpc, but the disadvantage that generally no more than one satellite is detected around a given galaxy, so the method yields only an average of the dark-matter distribution over many galaxies (Prada et al. 2003). (iv) Weak gravitational lensing, in which the gravitational field of a nearby galaxy distorts the images of distant background galaxies (Schneider 2006); once again, this method requires averaging over a large sample of lensing galaxies.

The preliminary conclusion from these studies is that luminous, isolated elliptical galaxies contain dark halos that are much larger--both in size and in mass--than the stellar systems they surround. Within uncertainties of at least a factor of two, the halos extend to \(\sim 300\,\)kpc and contain \(\sim 10\) times the mass in stars.

**(b) Spiral galaxies** These are galaxies, like the Milky Way and M31, that contain a prominent disk composed of stars, gas, and dust. The disk contains **spiral arms**, filaments in which stars are continuously being formed. The same spiral arms are seen in the old stars that dominate the mass of the disk (see Figure 6.1 and SS6.1.2). The spiral arms vary greatly in their shape, length and prominence from one galaxy to another but are always present.

In low-density regions of the universe, about 60% of all luminous galaxies are spirals, but the fraction drops to in dense regions such as the cores of galaxy clusters (BM SS4.1.2).

The surface brightness in spiral galaxy disks, which traces the radial distribution of stars, obeys the exponential law (1.7) (de Jong 1996). A typical disk scale length is, but scale lengths range from to more than. The typical central surface brightness is (BM Figure 4.52). The interstellar gas in spiral galaxy disks often extends to much larger radii than the stars, probably because star formation is suppressed when the gas surface density falls below a critical value (see Plates 5, 6 and BM SS8.2.8).

Using the 21-cm line of interstellar neutral hydrogen, the circular-speed curves of spiral galaxies can be followed out to radii well beyond the outer edge of the stellar distribution. The circular-speed curves of luminous spirals are nearly flat out to the largest radii at which they can be measured, often a factor of two or more larger than the edge of the stellar disk (BM SS8.2.4). If most of the mass of the galaxy were in stars, we would expect the circular-speed curve at these large radii to fall as where is the total stellar mass (see Figure 2.17). The inescapable conclusion is that the mass of the galaxy at these large radii is dominated by the dark halo rather than the stars.

Typical circular speeds of spirals are between 100 and 300 km s\({}^{-1}\). Just as the velocity dispersion of elliptical galaxies is related to their luminosity by the Faber-Jackson law (1.21), the rotation rate of spirals in the flat part of the circular-speed curve is related to their luminosity by the **Tully-Fisher law** (BM SS7.3.4; Sakai et al. 2000),

(1.24)

the rms scatter in this relation is about 0.14 in. The slope of the Tully-Fisher law is a function of the wavelength band in which the luminosity is measured, ranging from in the band centered at in the band centered at in the band centered at. Applied to our Galaxy, using, consistent with Table 1.2.

Like the Milky Way, most spiral galaxies contain a bulge, a centrally concentrated stellar system that has a smooth or amorphous appearance--quite unlike that of the disk, which exhibits spiral arms, dust lanes, concentrations of young stars, and other structure. The origin of bulges is not well understood: some resemble small elliptical galaxies and presumably formed in the same way, while others resemble thickened disks, and may have formed from the disk through dynamical processes (see SS6.6.2 and Kormendy & Kennicutt 2004). Bulges and elliptical galaxies are sometimes called **spheroidal stellar systems** or **spheroids**, even though their shapes are not necessarily close to mathematical spheroids (page 76)--in particular, many of them are probably not axisymmetric.

The luminosity of the bulge relative to that of the disk is correlated with many other properties of the galaxy, such as the fraction of the disk mass in gas, the color of the disk, and how tightly the spiral arms are wound. This correlation is the basis of a sub-division in the Hubble classification system, which breaks up spiral galaxies into four classes or types, called Sa, Sb, Sc, Sd (Sandage & Bedke 1994). Along the sequence Sa\(\rightarrow\)Sd, (i) the relative luminosity of the bulge decreases; (ii) the spiral arms become more loosely wound; (iii) the relative mass of gas increases; and (iv) the spiral arms become more clumpy, so individual patches of young stars and HII regions become more prominent. This sequence is illustrated by comparing the images of M104 (Plate 7), which is classified Sa; M81 (Plate 8), which is classified Sab (i.e., between Sa and Sb); the Sb galaxy M31 (Plate 3); the Sbc galaxies M51, M63, and M100 (Plates 1, 9, and 17); the Sc galaxy M101 (Plate 18), and the Scd galaxy M33 (Plate 19). The Milky Way is type Sbc.

The Hubble classification also divides spiral galaxies into "normal" and "barred" categories. The bar is an elongated, smooth stellar system that is reminiscent of a rigid paddle or stirrer rotating at the center of the galactic disk. The bar can be thought of as a triaxial bulge, and in practice there is no clear distinction between these two categories of stellar system: for example, a "bar" in a face-on galaxy might well be classified as a "bulge" if the galaxy were viewed edge-on. Further properties of bars are described in SS6.5.

A classic barred galaxy is NGC 1300 (Plate 10) although most bars are less prominent than the one in this galaxy. Other barred galaxies are shown in Figures 6.27 and 6.28. Our own Galaxy and its neighbor, the Large Magellanic Cloud (Plate 11), are both barred. About half of all spirals are barred, and bars appear in all of the Hubble classes Sa, Sb, Sc, Sd, where their presence is indicated by inserting the letter "B" into the notation (SBa, SBb, etc.). Elliptical galaxies do not have bars.

The first evidence for dark halos in spiral galaxies came from circular-speed curves; as we have discussed, neutral-hydrogen rotation curves in some spirals remain flat out to as much as 10 times the scale length of the stellar disk, which implies that the mass at large radii is dominated by dark matter rather than stars. At much larger radii, \(\mathrel{\hbox to 0.0pt{\lower 3.0pt\hbox{$\mathchar 536$}\hss}\raise 2.0pt \hbox{$\mathchar 318$}}100\,{\rm kpc}\), the distribution of dark matter can be measured by the same techniques that are used for ellipticals, in particular satellite galaxy kinematics and weak gravitational lensing. Within the large uncertainties, the data are consistent with the hypothesis that the size and mass of the dark halos that surround luminous spiral galaxies are the same as those surrounding isolated ellipticals--about \(300\,{\rm kpc}\) in radius and containing \(\sim 10\) times the stellar mass of the galaxy.

For most spiral galaxies, the relative contributions of dark and luminous matter within the visible stellar system are difficult to disentangle (SS6.3.3). However, in some low-luminosity and low surface-brightness spirals, dark matter appears to dominate the mass at all radii (Swaters et al. 2003). Like the dwarf spheroidals, these galaxies provide valuable probes of the properties of dark halos on small scales.

**(c) Lenticular galaxies** These are transition objects between elliptical and spiral galaxies: like spirals, they contain a rapidly rotating disk, a bulge, and sometimes a bar, and the disk obeys the exponential surface-brightness law (1.7) characteristic of spirals. Like ellipticals, they have little or no cool gas or recent star formation, are smooth and featureless in appearance, and exhibit no spiral structure. The absence of young stars is a consequence of the absence of gas, since this is the raw material from which stars are formed.

Lenticulars are rare in low-density regions, but comprise almost half of the galaxies in the high-density centers of galaxy clusters (BM Figure 4.10). This correlation suggests that lenticulars may be spirals that have been depleted of interstellar gas by interactions with the hot gas in the cluster (van Gorkom 2004).

Lenticulars are labeled in the Hubble classification by the notation S0, or SB0 if barred. The transition from ellipticals to lenticulars to spirals is smooth and continuous, so there are S0 galaxies that might well be classified as E7 and others that could be Sa (Sandage & Bedke 1994).

**(d) Irregular galaxies** Along the sequence from Sc to Sd, galaxies become progressively less luminous and their spiral structure becomes less well defined. These trends continue beyond Sd: we find low-luminosity ("dwarf") disk galaxies in which the young stars are arranged chaotically rather than in spirals. These are called "irregular" galaxies and are denoted in the Hubble classification by Sm or Im, the prototypes of these two classes being the Large and Small Magellanic Clouds.

Irregular galaxies are extremely common--more than a third of our neighbors are of this type--but they do not feature prominently in most galaxy catalogs, because any flux-limited catalog is biased against intrinsically dim systems.

In irregulars the circular speed is a linear function of radius (corresponding to a constant angular speed) over most of the stellar disk, reaching a maximum of \(\sim 50\)-\(70\,{\rm km\,s^{-1}}\) near the edge of the disk. These properties are in sharp contrast to luminous spiral galaxies, in which the circular speed is much higher and the circular-speed curve is nearly flat.

Much of the luminosity of irregular galaxies is emitted by massive young stars and large HII regions. These systems are extremely gas-rich: the interstellar gas in their disks often contains more than 30% of the mass in stars. Their irregular appearance arises partly because the optical emission is dominated by a relatively small number of luminous young stars and HII regions, and partly because the circular speed in the disk is not that much larger than the turbulent velocities in the interstellar gas (\(\sim 10\,{\rm km\,s^{-1}}\)).

A minority of galaxies are assigned to the "irregular" bin simply because they fit nowhere else: these include spiral or elliptical galaxies that have been violently distorted by a recent encounter with a neighbor (see Plate 12), galaxies in the last stages of merging, and galaxies that are undergoing an intense burst of star formation that overwhelms the stellar population that usually determines the classification.

It is convenient to think of the Hubble classification as a sequence E\(\rightarrow\)S0\(\rightarrow\)Sa\(\rightarrow\)Sb\(\rightarrow\)Sc\(\rightarrow\)Sd\(\rightarrow\)Sm\(\rightarrow\)Im. Galaxies near the beginning of this sequence are called **early**, while those near the end are **late**. Thus the term "early-type galaxies" refers to ellipticals and lenticulars; an Sa galaxy is an "early-type spiral," while an Sc or Sd galaxy is a "late-type spiral," etc. This terminology is a fossil of the initial incorrect belief that the Hubble sequence was an evolutionary or time sequence.

#### Open and globular clusters

A typical galaxy contains many small stellar systems of between \(10^{2}\) and \(10^{6}\) stars. These systems are called **star clusters** and can be divided into two main types.

**Open clusters** are irregular stellar systems that contain \(\sim 10^{2}\) to \(10^{4}\) stars (see Table 3, Plate 3, and BM SS6.2). New open clusters are formed continuously in the Galactic disk, and most of the ones we see are younger than 1 Gyr (Figure 8.5). Older clusters are rare because most have been disrupted, probably by gravitational shocks from passing interstellar gas clouds (SS8.2.2c). There are over 1000 cataloged open clusters out of an estimated \(10^{5}\) throughout the Galaxy. It is likely that most of the stars in the Galactic disk formed in open clusters that have since dissolved.

**Globular clusters** are much more massive stellar systems, containing \(10^{4}\)-\(10^{6}\) stars in a nearly spherical distribution (BM SSSS4.5 and 6.1, and Plate 14; see Ashman & Zepf 1998 and Carney & Harris 2001 for reviews). Globular clusters do not contain gas, dust, or young stars. Our Galaxy contains about 150 globular clusters, but large elliptical galaxies such as M87 can contain as many as 10 000 (Plate 4). Unlike open clusters, the Galaxy's globular clusters are old, and are believed to be relics of the formation of the Galaxy itself.9 The metallicity appears to be the same for all the stars in a given cluster--presumably because the cluster formed from a well-mixed gas cloud--but different clusters have a wide range of metallicity, from only \(0.005Z_{\odot}\) to nearly solar. The spatial distribution and the kinematics of a group of clusters are correlated with the metallicity, and for many purposes the clusters in our Galaxy can be divided into two groups (Zinn 1985): a roughly spherical population that contains 80% of the clusters, shows little or no rotation and has metallicity \(Z<0.1Z_{\odot}\), and is associated with the stellar halo; and a flattened population that contains the remaining 20%, has \(Z>0.1Z_{\odot}\), exhibits rapid rotation, and is associated with the disk and bulge. This bimodal distribution of metallicities is present in the globular-cluster systems of other galaxies as well (Gebhardt & Kissler-Patig 1999).

The stellar density in the center of a globular cluster is extremely high: a typical value is \(10^{4}\,{\cal M}_{\odot}\,{\rm pc}^{-3}\), compared with \(0.05\,{\cal M}_{\odot}\,{\rm pc}^{-3}\) in the solar neighborhood. Because globular clusters have strong or high **central concentration** (the central density is much larger than the mean density) three different measures of the radius are usually quoted for globular clusters: the **core radius**, where the surface brightness has fallen to half its central value; the median or half-light radius, the radius of a sphere that contains half of all the luminosity; and the **limiting** or **tidal radius**, the outer limit of the cluster where the density drops to zero. Typical values of these and other cluster parameters are given in Table 3.

Luminous globular clusters emit as much light as dwarf spheroidal galaxies. However, a dwarf spheroidal galaxy is a very low surface-brightness object with a half-light radius of \(\sim 300\,{\rm pc}\), while a luminous globular cluster has a much smaller radius (\(\sim 3\,{\rm pc}\)) and a correspondingly higher surface brightness. A handful of exceptionally luminous globular clusters, such as \(\omega\) Centauri in our Galaxy and G1 in M31, may be the dense centers of tidally disrupted galaxies (Freeman 1993).

Globular clusters are among the simplest stellar systems: they are spherical, they have no dust or young stars to obscure or confuse the observations, they appear to have no dark matter other than low-luminosity stars, and they are **dynamically old**: a typical star in a globular cluster has completed many orbits (\(\sim 10^{4}\)) since the cluster was formed. Thus globular clusters provide the best physical realization we have of the **gravitational N-body problem**, which is to understand the evolution of a system of \(N\) point masses interacting only by gravitational forces (Chapter 7).

#### Groups and clusters of galaxies

Galaxies are not distributed uniformly in the universe. They belong to a rich hierarchy of structure that includes binary galaxies, small groups of a few galaxies in close proximity, enormous voids in which the number density of galaxies is greatly depleted, filaments and walls stretching for tens of Mpc, and rare giant clusters containing thousands of galaxies (see SS9.2.2 and Mulchaey, Dressler, & Oemler 2004). Only on scales \(\gtrsim 100\,{\rm Mpc}\) is the distribution of galaxies statistically homogeneous.

Associations that contain only a handful of galaxies are called groups while bigger associations are called clusters of galaxies (see Plates 15 and 16). The dividing line between groups and clusters is arbitrary, since the distribution of properties is continuous from one class to the other.

The galaxies within \(\sim 1\,\)Mpc are members of the **Local Group**. The two dominant members of this group are the Galaxy and M31. Dozens of smaller galaxies, mostly satellites of the two dominant galaxies, are also members (see BM SS4.1.4 and van den Bergh 2000). The Local Group is believed to be a physical system rather than a chance superposition because the density of galaxies in this region is substantially higher than average, and because the Galaxy and M31 are approaching one another rather than receding with the Hubble flow. It is believed that the gravitational attraction between these two galaxies slowed and then reversed their recession, and that they will eventually merge into a single giant stellar system (see Box 3.1 and Figure 8.1).

Like star clusters, groups and clusters of galaxies may be regarded for many purposes as assemblies of masses orbiting under their mutual gravitational attraction, except that now the masses are galaxies rather than stars. However, there are two important differences between the dynamics of star clusters and galaxy groups or clusters. First, groups and clusters of galaxies are **dynamically young**: a typical galaxy in even the largest and most populous clusters has completed only a few orbits since the cluster formed, and in many smaller groups, including the Local Group, galaxies are still falling towards the group center for the first time. Second, the fractional volume of a group or cluster that is occupied by galaxies (\(\mathrel{\hbox to 0.0pt{\lower 3.0pt\hbox{$\mathchar 536$}\hss}\raise 2.0pt \hbox{$\mathchar 318$}}10^{-3}\)) is much larger than the fractional volume of a star cluster that is occupied by stars (\(\approx 10^{-19}\)). Thus collisions between galaxies in a cluster are much more frequent than collisions between stars in a star cluster (see Chapter 8).

Clusters of galaxies are the largest equilibrium structures in the universe. They arose from the gravitational collapse of rare high peaks in the fluctuating density field of dark matter in the early universe (SS9.2). Conse

\begin{table}
\begin{tabular}{l l l} \hline  & globular & open \\ \hline central density \(\rho_{0}\) & \(1\times 10^{4}\,{\cal M}_{\odot}\,{\rm pc}^{-3}\) & \(10\,{\cal M}_{\odot}\,{\rm pc}^{-3}\) \\ core radius \(r_{\rm c}\) & \(1\,\)pc & \(1\,\)pc \\ half-mass radius \(r_{\rm h}\) & \(3\,\)pc & \(2\,\)pc \\ tidal radius \(r_{\rm t}\) & \(35\,\)pc & \(10\,\)pc \\ central velocity dispersion \(\sigma_{0}\) & \(6\,\)km s\({}^{-1}\) & \(0.3\,\)km s\({}^{-1}\) \\ crossing time \(r_{\rm h}/\sigma_{0}\) & \(0.5\,\)Myr & \(7\,\)Myr \\ (line-of-sight) & & \\ mass-to-light ratio \(\Upsilon_{R}\) & \(2\Upsilon_{\odot}\) & \(1\Upsilon_{\odot}\) \\ mass \(M\) & \(2\times 10^{5}\,{\cal M}_{\odot}\) & \(300\,{\cal M}_{\odot}\) \\ lifetime & \(10\,\)Gyr & \(300\,\)Myr \\ number in the Galaxy & \(150\) & \(10^{5}\) \\ \hline \end{tabular} notes: Values for globular clusters are medians from the compilation of Harris (1996). Values for open clusters are from Figure 8.5, Piskunov et al. (2007), and other sources.

\end{table}
Table 3: Parameters of globular and open clustersquently their properties provide a sensitive probe of cosmological parameters. Clusters also offer a unique probe of the distribution of dark matter on large scales. The mass distribution in clusters of galaxies can be measured by many complementary methods, including (i) statistical analysis of the velocities and positions of large numbers of galaxies in the cluster; (ii) measurements of the X-ray emissivity and temperature of hot gas in the cluster; (iii) distortion of the images of background galaxies by weak gravitational lensing; (iv) strong gravitational lensing, which can produce multiple images of background galaxies near the center of the cluster; (v) the **Sunyaev-Zeldovich effect**, which is a slight depression in the measured temperature of the cosmic microwave background at the locations of clusters, caused by Compton scattering of photons by electrons in the hot cluster gas.

The biggest clusters have masses \(\sim 10^{15}\,{\cal M}_{\odot}\) within \(2\,{\rm Mpc}\) of their centers and velocity dispersions of \(\sim 1000\,{\rm km\,s^{-1}}\). The mass-to-light ratios are

\[\Upsilon_{R}\simeq(200\pm 50)h_{7}\Upsilon_{\odot}, \tag{25}\]

(Fukugita, Hogan, & Peebles 1998), with no detectable dependence on cluster properties such as velocity dispersion or total population.

Most of the baryons in clusters of galaxies are in the hot gas. The mass in gas is a fraction \(0.11h_{7}^{-3/2}\) of the total mass (Allen, Schmidt & Fabian 2002), while the mass in stars is only about \(0.02h_{7}^{-1}\) of the total. Thus the fraction of the total mass that resides in baryons is

\[f_{\rm b}=0.13\pm 0.02, \tag{26}\]

with the remaining 87% comprised of wimps or other non-baryonic dark matter. In structures as large as clusters it is difficult to imagine how baryons and non-baryonic dark matter could be segregated (in contrast to individual galaxies, where the baryons have concentrated at the center of the dark halo to form the visible stars). Thus the baryon-to-total mass ratio \(f_{\rm b}\) that is found in clusters should be a fair sample of the universe as a whole.

#### Black holes

Dynamical studies of the centers of galaxies reveal that they often contain "massive dark objects"--concentrations of \(10^{6}\)-\(10^{9}\,{\cal M}_{\odot}\) contained within a few pc of the center (BM SS11.2.2). The best-studied of these objects, the one at the center of the Galaxy, has a mass of \((3.9\pm 0.3)\times 10^{6}\,{\cal M}_{\odot}\) contained within a radius less than \(0.001\,{\rm pc}\). Astronomers believe that these objects must be black holes, for two main reasons. First, dynamical arguments show that no long-lived astrophysical system other than a black hole could be so massive and so small (SS7.5.2). Second, many galaxies contain strong sources of non-stellar radiation at their centers, called **active galactic nuclei** or agn; the most luminous and rare of these, the quasars, can achieve luminosities of \(10^{13}\,L_{\odot}\) and outshine their host galaxies by two orders of magnitude (see BM SS4.6.2 and Krolik 1999). By far the most plausible power source for agn is accretion onto a massive black hole, and the demography of massive dark objects in galaxy centers is roughly consistent with the hypothesis that these are dormant agn.

It appears that most galaxies--or at least most early-type galaxies--contain a central black hole. The mass of the black hole typically amounts to \(\approx 0.001\)-0.002 of the total mass of the stars in the host galaxy (Haring & Rix 2004). Another correlation that is more directly observable is between the black-hole mass \(M_{\bullet}\) and the velocity dispersion \(\sigma_{\parallel}\) near the center of the host galaxy,

\[\log_{10}\left(\frac{M_{\bullet}h_{7}}{10^{8}\,{\cal M}_{\odot}}\right)=(4\pm 0.3)\log_{10}\left(\frac{\sigma_{\parallel}}{200\,{\rm km\,s^{-1}}}\right)+(0.2 \pm 0.1). \tag{27}\]

The rms scatter in this relation is \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}0.3\) in \(\log_{10}M_{\bullet}\) (Tremaine et al. 2002).

Massive black holes are probably formed at the centers of galaxies. When galaxies merge, their black holes are dragged to the center of the merged galaxy by dynamical friction (SS8.1.1a). If the resulting binary black hole is so tightly bound that it continues to decay by gravitational radiation, the two black holes will eventually merge. The final stages of this merger could provide a powerful source of gravitational radiation (SS8.1.1e; Begelman, Blandford & Rees 1980).

### 2 Collisionless systems and the relaxation time

There is a fundamental difference between galaxies and the systems that are normally dealt with in statistical mechanics, such as molecules in a box. This difference lies in the nature of the forces that act between the constituent particles. The interaction between two molecules is short-range: the force is small unless the molecules are very close to each other, when it becomes strongly repulsive. Consequently, molecules in a diffuse gas are subject to violent and short-lived accelerations as they collide with one another, interspersed with much longer periods when they move at nearly constant velocity. In contrast, the gravitational force that acts between the stars of a galaxy is long-range.

Consider the force from the stars in the cone shown in Figure 4 on a star at the apex of the cone. The force from any one star falls off with distance \(r\) as \(r^{-2}\), but if the density of stars is uniform, the number of attracting stars per unit length of the cone increases as \(r^{2}\). Let us call a factor of two interval in radius an **octave**, by analogy with the musical octave. Then each octave in radius, from \(r\) to \(2r\), has a length proportional to \(r\), so each octave attractsthe star at the apex with a force proportional to \(r^{-2}\times r^{2}\times r=r\). This simple argument shows that the force on the star at the apex is dominated by the most distant stars in the system, rather than by its closest neighbors. Of course, if the density of attracting stars were exactly spherical, the star at the apex would experience no net force because it would be pulled equally in all directions. But in general the density of attracting stars falls off in one direction more slowly than in the opposing direction, so the star at the apex is subject to a net force, and this force is determined by the structure of the galaxy on the largest scale. Consequently--in contrast to the situation for molecules--the force on a star does not vary rapidly, and each star may be supposed to accelerate smoothly through the force field that is generated by the galaxy as a whole. In other words, for most purposes we can treat the gravitational force on a star as arising from a smooth density distribution rather than a collection of mass points.

#### The relaxation time

We now investigate this conclusion more quantitatively, by asking how accurately we can approximate a galaxy composed of \(N\) identical stars of mass \(m\) as a smooth density distribution and gravitational field. To answer this question, we follow the motion of an individual star, called the **subject star**, as its orbit carries it once across the galaxy, and seek an order-of-magnitude estimate of the difference between the actual velocity of this star after this interval and the velocity that it would have had if the mass of the other stars were smoothly distributed. Suppose the subject star passes within distance \(b\) of another star, called the **field star** (Figure 5). We want to estimate the amount \(\delta{\bf v}\) by which the encounter deflects the velocity \({\bf v}\) of the subject star. In SS3.1d we calculate \(\delta{\bf v}\) exactly, but for our present purposes an approximate estimate is sufficient. To make this estimate we shall assume that \(|\delta{\bf v}|/v\ll 1\), and that the field star is stationary during the encounter. In this case \(\delta{\bf v}\) is perpendicular to \({\bf v}\), since the accelerations parallel to \({\bf v}\) average to zero. We may calculate the magnitude of the velocity change, \(\delta v\equiv|\delta{\bf v}|\), by assuming that the subject star passes the field star on a straight-line trajectory, and integrating the perpendicular force \(F_{\perp}\) along this trajectory. We place the origin of time at the instant of closest approach of the two stars,

Figure 4: If the density of stars were everywhere the same, the stars in each of the shaded segments of a cone would contribute equally to the force on a star at the cone’s apex. Thus the acceleration of a star at the apex is determined mainly by the large-scale distribution of stars in the galaxy, not by the star’s nearest neighbors.

and find in the notation of Figure 1.5,

\[F_{\perp}=\frac{Gm^{2}}{b^{2}+x^{2}}\cos\theta=\frac{Gm^{2}b}{\left(b^{2}+x^{2} \right)^{3/2}}=\frac{Gm^{2}}{b^{2}}\biggl{[}1+\left(\frac{vt}{b}\right)^{2} \biggr{]}^{-3/2}. \tag{1.28}\]

But by Newton's laws

\[m\dot{\bf v}={\bf F}\quad\mbox{so}\quad\delta v=\frac{1}{m}\int_{-\infty}^{ \infty}{\rm d}t\,F_{\perp}, \tag{1.29}\]

and we have

\[\delta v=\frac{Gm}{b^{2}}\int_{-\infty}^{\infty}\frac{{\rm d}t}{[1+(vt/b)^{2}] ^{3/2}}=\frac{Gm}{bv}\int_{-\infty}^{\infty}\frac{{\rm d}s}{(1+s^{2})^{3/2}}= \frac{2Gm}{bv}. \tag{1.30}\]

In words, \(\delta v\) is roughly equal to the acceleration at closest approach, \(Gm/b^{2}\), times the duration of this acceleration \(2b/v\). Notice that our assumption of a straight-line trajectory breaks down, and equation (1.30) becomes invalid, when \(\delta v\simeq v\); from equation (1.30), this occurs if the impact parameter \(b\mathrel{\hbox to 0.0pt{\raise 2.1973pt\hbox{$<$}}{\lower 2.1973pt\hbox{$ \sim$}}}b_{90}\equiv 2Gm/v^{2}\). The subscript 90 stands for a 90-degree deflection--see equation (3.51) for a more precise definition.

Now the surface density of field stars in the host galaxy is of order \(N/\pi R^{2}\), where \(N\) is the number of stars and \(R\) is the galaxy's radius, so in crossing the galaxy once the subject star suffers

\[\delta n=\frac{N}{\pi R^{2}}2\pi b\,{\rm d}b=\frac{2N}{R^{2}}b\,{\rm d}b \tag{1.31}\]

encounters with impact parameters in the range \(b\) to \(b+{\rm d}b\). Each such encounter produces a perturbation \(\delta{\bf v}\) to the subject star's velocity, but because these small perturbations are randomly oriented in the plane perpendicular to \({\bf v}\), their mean is zero.10 Although the mean velocity change is zero, the mean-square change is not: after one crossing this amounts to

Footnote 10: Strictly, the mean change in velocity is zero only if the distribution of perturbing stars is the same in all directions. A more precise statement is that the mean change in velocity is due to the smoothed-out mass distribution, and we ignore this because the goal of our calculation is to determine the _difference_ between the acceleration due to the smoothed mass distribution and the actual stars.

\[\sum\delta v^{2}\simeq\delta v^{2}\delta n=\left(\frac{2Gm}{bv}\right)^{2} \frac{2N}{R^{2}}b\,{\rm d}b. \tag{1.32}\]Integrating equation (1.32) over all impact parameters from \(b_{\rm min}\) to \(b_{\rm max}\), we find the mean-square velocity change per crossing,

\[\Delta v^{2}\equiv\int_{b_{\rm min}}^{b_{\rm max}}\sum\delta v^{2}\simeq 8N \biggl{(}\frac{Gm}{Rv}\biggr{)}^{2}\ln\Lambda,\] (1.33a) where the factor \[\ln\Lambda\equiv\ln\left(\frac{b_{\rm max}}{b_{\rm min}}\right) \tag{1.33b}\]

is called the **Coulomb logarithm**. Our assumption of a straight-line trajectory breaks down for impact parameters smaller than \(b_{90}\), so we set \(b_{\rm min}=f_{1}b_{90}\), where \(f_{1}\) is a factor of order unity. Our assumption of a homogeneous distribution of field stars breaks down for impact parameters of order \(R\), so we set \(b_{\rm max}=f_{2}R\). Then

\[\ln\Lambda=\ln\left(\frac{R}{b_{90}}\right)+\ln(f_{2}/f_{1}). \tag{1.34}\]

In most systems of interest \(R\gg b_{90}\) (for example, in a typical elliptical galaxy \(R/b_{90}\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$>$} }10^{10}\)), so the fractional uncertainty in \(\ln\Lambda\) arising from the uncertain values of \(f_{1}\) and \(f_{2}\) is quite small, and we lose little accuracy by setting \(f_{2}/f_{1}=1\).

Thus encounters between the subject star and field stars cause a kind of diffusion of the subject star's velocity that is distinct from the steady acceleration caused by the overall mass distribution in the stellar system. This diffusive process is sometimes called **two-body relaxation** since it arises from the cumulative effect of myriad two-body encounters between the subject star and passing field stars.

The typical speed \(v\) of a field star is roughly that of a particle in a circular orbit at the edge of the galaxy,

\[v^{2}\approx\frac{GNm}{R}. \tag{1.35}\]

If we eliminate \(R\) from equation (1.33a) using equation (1.35), we have

\[\frac{\Delta v^{2}}{v^{2}}\approx\frac{8\ln\Lambda}{N}. \tag{1.36}\]

If the subject star makes many crossings of the galaxy, the velocity \({\bf v}\) will change by roughly \(\Delta v^{2}\) at each crossing, so the number of crossings \(n_{\rm relax}\) that is required for its velocity to change by of order itself is given by

\[n_{\rm relax}\simeq\frac{N}{8\ln\Lambda}. \tag{1.37}\]The **relaxation time** may be defined as \(t_{\rm relax}=n_{\rm relax}t_{\rm cross}\), where \(t_{\rm cross}=R/v\) is the **crossing time**, the time needed for a typical star to cross the galaxy once. Moreover \(\Lambda=R/b_{90}\approx Rv^{2}/(Gm)\), which is \(\approx N\) by equation (1.35). Thus our final result is

\[t_{\rm relax}\simeq\frac{0.1N}{\ln N}t_{\rm cross}. \tag{1.38}\]

After one relaxation time, the cumulative small kicks from many encounters with passing stars have changed the subject star's orbit significantly from the one it would have had if the gravitational field had been smooth. In effect, after a relaxation time a star has lost its memory of its initial conditions. Galaxies typically have \(N\approx 10^{11}\) stars and are a few hundred crossing times old, so for these systems stellar encounters are unimportant, except very near their centers. In a globular cluster, on the other hand, \(N\approx 10^{5}\) and the crossing time \(t_{\rm cross}\approx 1\,{\rm Myr}\) (Table 1.3), so relaxation strongly influences the cluster structure over its lifetime of \(10\,{\rm Gyr}\).

In all of these systems the dynamics over timescales \(\lesssim t_{\rm relax}\) is that of a **collisionless system** in which the constituent particles move under the influence of the gravitational field generated by a smooth mass distribution, rather than a collection of mass points. Non-baryonic dark matter is also collisionless, since both weak interactions and gravitational interactions between individual wimps are negligible in any galactic context.

In most of this book we focus on collisionless stellar dynamics, confining discussion of the longer-term evolution that is driven by gravitational encounters among the particles to Chapter 7.

### 1.3 The cosmological context

This section provides a summary of the aspects of cosmology that we use in this book. For more information the reader can consult texts such as Weinberg (1972), Peebles (1993), and Peacock (1999).

To a very good approximation, the universe is observed to be homogeneous and isotropic on large scales--here "large" means \(\gtrsim 100\,{\rm Mpc}\), which is still much smaller than the characteristic "size" of the universe, the **Hubble length**\(c/H_{0}=4.3h_{7}^{-1}\,{\rm Gpc}\) where \(1\,{\rm Gpc}=10^{9}\,{\rm pc}=10^{3}\,{\rm Mpc}\) and \(c\) is the speed of light. Therefore a useful first approximation is to average over the small-scale structure and treat the universe as _exactly_ homogeneous and isotropic. Of course, the universe does not appear isotropic to all observers: an observer traveling rapidly with respect to the local matter will see galaxies approaching in one direction and receding in another. Therefore we define a set of **fundamental observers**, who are at rest with respect to the matter around them.11 The universe is expanding, so we may synchronize the 

#### 1.3.1 Kinematics

Consider the triangle defined by three nearby fundamental observers. As the universe evolves, the triangle may change in size, but cannot change in shape or orientation--in the contrary case, it would define a preferred direction, thereby violating the isotropy assumption. Thus, if \(r_{ij}(t)\) is the length of the side joining observers \(i\) and \(j\) at cosmic time \(t\), we must have \(r_{ij}(t)=r_{ij}(t_{0})a(t)\), where \(a(t)\) is independent of \(i\) and \(j\). Since this argument holds for all fundamental observers, the distance between any two of them must have the form

\[r(t)=r(t_{0})a(t), \tag{1.39}\]

where the **scale factor**\(a(t)\) is a universal function, which we may normalize so that \(a(t_{0})=1\) at the present cosmic time \(t_{0}\). The relative velocity of the two observers is

\[v(t)={{\rm d}r\over{\rm d}t}=r(t_{0})\dot{a}(t)=r(t){\dot{a}(t)\over a(t)} \equiv r(t)H(t), \tag{1.40}\]

where \(H(t)\) is the **Hubble parameter**. At the present time, \(H(t_{0})\equiv H_{0}\) is the Hubble constant, and equation (1.40) is a statement of the Hubble law (1.13). Thus we see that (i) the Hubble law is a consequence of homogeneity and isotropy; (ii) in a homogeneous, isotropic universe the Hubble law remains true at all times but the Hubble "constant" varies with cosmic time.

Next consider a photon that at cosmic time \(t\) passes a fundamental observer, who observes it to have frequency \(\nu\). After an infinitesimal time interval \({\rm d}t\), the photon has traveled a distance \({\rm d}r=c\,{\rm d}t\) and hence is overtaking a second fundamental observer who is moving away from the first at speed \({\rm d}v=H(t){\rm d}r=H(t)c\,{\rm d}t\). This observer will measure a different frequency for the photon because of the Doppler shift. The measured frequency will be \(\nu(1-{\rm d}v/c)=\nu[1-H(t){\rm d}t]\); the use of this first-order formula is justified because \({\rm d}v\) is infinitesimal. Thus the frequency of a propagating photon as measured by a local fundamental observer decreases at a rate

\[{{\rm d}\nu\over{\rm d}t}=-H(t)\nu\quad{\rm or}\quad{\dot{\nu}\over\nu}=-{ \dot{a}\over a},\quad{\rm thus}\quad\nu(t)\propto{1\over a(t)}. \tag{1.41}\]In words, a photon emitted by a fundamental observer at frequency \(\nu_{\rm e}\) and wavelength \(\lambda_{\rm e}=c/\nu_{\rm e}\), and received by a second fundamental observer at the present time \(t_{0}\), will be observed to have frequency \(\nu_{0}\) and wavelength \(\lambda_{0}\) given by

\[\frac{\nu_{\rm e}}{\nu_{0}}=\frac{\lambda_{0}}{\lambda_{\rm e}}=\frac{a(t_{0}) }{a(t_{\rm e})}=\frac{1}{a(t_{\rm e})}\equiv 1+z. \tag{42}\]

Here \(z\) is the **redshift**. Redshift is often used instead of time \(t\) to describe the cosmic time of an event, since redshift is directly observable from the wavelengths of known spectral lines, whereas the relation between time and redshift depends on the cosmological model (Figure 7).

These derivations assume only that spacetime is locally Euclidean, and thus they are correct even in a curved spacetime, so long as it is homogeneous and isotropic.

#### Geometry

Let the position of any fundamental observer be labeled by time-independent coordinates \((q_{1},q_{2},q_{3})\). At a given cosmic time \(t\), the distance \({\rm d}l\) between the observers at \((q_{1},q_{2},q_{3})\) and \((q_{1}+{\rm d}q_{1},q_{2}+{\rm d}q_{2},q_{3}+{\rm d}q_{3})\) can be written in the form

\[{\rm d}r^{2}=a^{2}(t)h_{ij}{\rm d}q_{i}{\rm d}q_{j}, \tag{43}\]

where we have used the summation convention (page 772), and the metric tensor \(h_{ij}\) (cf. eq. 13) must be independent of time in a homogeneous, isotropic universe. It can be shown that homogeneity and isotropy also imply that the \(q_{i}\) can be chosen such that equation (43) takes the form of the **Robertson-Walker metric**,

\[{\rm d}r^{2}=a^{2}(t)\biggl{[}\frac{{\rm d}x^{2}}{1-kx^{2}/x_{\rm u}^{2}}+x^{2 }\bigl{(}{\rm d}\theta^{2}+\sin^{2}\theta\,{\rm d}\phi^{2}\bigr{)}\biggr{]}. \tag{44}\]

Here \(\theta\) and \(\phi\) are the usual angles in spherical coordinates (Appendix B.2), \(x\) is a radial coordinate, \(x_{\rm u}\) is a constant called the **radius of curvature**, and \(k\) is \(+1\), \(0\) or \(-1\). Since \(x\) remains fixed as the fundamental observers recede from one another, it is called a **comoving coordinate**.

In the case \(k=0\), the metric (44) corresponds to ordinary spherical polar coordinates (cf. eq. B.32), so at a given cosmic time the geometry of the universe is that of ordinary Euclidean or **flat** space. In the case \(k=+1\), (44) is the three-dimensional generalization of the metric on the surface of a sphere of radius \(x_{\rm u}\), \({\rm d}r^{2}={\rm d}x^{2}/(1-x^{2}/x_{\rm u}^{2})+x^{2}{\rm d}\phi^{2}\), where \(x\) is the perpendicular distance from the polar axis to the point in question. This case is said to represent a **closed universe**, since the volume of space is finite (Problem 7). The case \(k=-1\) has no analogous 2-surface embedded in Euclidean 3-space (e.g.,Weinberg 1972). It represents an **open universe** with infinite volume.

#### Dynamics

The evolution of the scale factor \(a(t)\) is determined by the equations of general relativity and the equation of state of the material in the universe. We shall assume that all of the major components of this material can be described as (possibly relativistic) fluids. To derive the equations governing \(a(t)\) we then need only one result from relativity: that a fluid with inertial mass density \(\rho\) and pressure \(p\) has a gravitational mass density (Problem 9.5)

\[\rho^{\prime}=\rho+\frac{3p}{c^{2}}. \tag{1.45}\]

By isotropy, the universe is spherically symmetric as viewed by any fundamental observer. Now draw a sphere of radius \(r\) around such an observer, where \(r\) is large enough that the approximation of homogeneity and isotropy is valid, but small enough that Newtonian physics applies within it. As shown at the beginning of this section, in practice this means \(100\,\mathrm{Mpc}\ll r\ll 4000\,\mathrm{Mpc}\). By analogy with Newton's famous theorem that a body experiences no gravitational force from a spherical shell of matter outside it (SS2.2.1), we ignore the effects of material outside the sphere. Then Newton's law of gravity tells us that a fundamental observer on the surface of the sphere is accelerated towards its center at a rate

\[\frac{\mathrm{d}^{2}r}{\mathrm{d}t^{2}}=-\frac{GM}{r^{2}}, \tag{1.46}\]

where \(M\) is the gravitational mass inside the sphere. Note that there are no pressure forces, since \(\boldsymbol{\nabla}p=0\) by homogeneity. Since \(M=\rho^{\prime}V\), where \(V=\frac{4}{3}\pi r^{3}\), and \(r=r_{0}a(t)\), we may rewrite equation (1.46) as

\[\frac{\ddot{a}}{a}=-\frac{4\pi G\rho^{\prime}}{3}=-\frac{4\pi G}{3}\bigg{(} \rho+\frac{3p}{c^{2}}\bigg{)}. \tag{1.47}\]

To integrate this equation, we need to know how \(p\) and \(\rho\) vary with the scale factor \(a(t)\). The internal energy of the sphere, including its rest-mass energy, is \(U=\rho c^{2}V\). The material satisfies \(\mathrm{d}U+p\,\mathrm{d}V=0\) (eq. F.22 with \(\mathrm{d}S=0\), since there is no heat flow in a homogeneous, isotropic universe), so

\[c^{2}\mathrm{d}(\rho V)+p\,\mathrm{d}V=0\quad\mathrm{or}\quad\mathrm{d}\rho+ \bigg{(}\rho+\frac{p}{c^{2}}\bigg{)}\frac{\mathrm{d}V}{V}=0. \tag{1.48}\]

Since \(V\propto a^{3}(t)\), we have \(\mathrm{d}V/V=3\,\mathrm{d}a/a\), and equations (1.47) and (1.48) can be combined to eliminate \(p\):

\[\frac{\ddot{a}}{a}=\frac{4\pi G}{3}\bigg{(}2\rho+a\frac{\mathrm{d}\rho}{ \mathrm{d}a}\bigg{)}. \tag{1.49}\]After multiplying by \(a\dot{a}\) this equation can be integrated to yield

\[\dot{a}^{2}-\frac{8\pi G\rho}{3}a^{2}=2E, \tag{1.50}\]

where \(E\) is a constant of integration, analogous to the Newtonian energy.

These equations can also be derived directly from general relativity. The relativistic derivation also connects the geometry to the energy density, by relating the parameters of the Robertson-Walker metric (1.44) to the integration constant \(E\):

\[2E=-\frac{kc^{2}}{x_{\rm u}^{2}}. \tag{1.51}\]

Equations (1.44), (1.50), and (1.51) specify the **Friedmann-Robertson-Walker** or **FRW** model of the universe.

When \(k=0\), space is flat, \(E=0\), and the density equals the **critical density**

\[\rho_{\rm c}(t)\equiv\frac{3\dot{a}^{2}}{8\pi Ga^{2}}=\frac{3H^{2}(t)}{8\pi G}. \tag{1.52}\]

If we define the **density parameter**

\[\Omega(t)\equiv\frac{\rho(t)}{\rho_{\rm c}(t)}=\frac{8\pi G\rho(t)}{3H^{2}(t)}, \tag{1.53}\]

then equation (1.50) can be written

\[\Omega^{-1}-1=\frac{3E}{4\pi G\rho a^{2}}=-\frac{3kc^{2}}{8\pi G\rho a^{2}x_{ \rm u}^{2}}. \tag{1.54}\]

This result implies that if \(\Omega<1\) at any time, it always remains so; this case corresponds to a universe that is open (\(k=-1\)) and infinite. In contrast, if \(\Omega\) exceeds unity it always remains so, and we have a universe that is closed (\(k=+1\)) and finite. Finally, if \(\Omega=1\) at any instant it is unity for all time, and the universe is always flat. Thus the geometry of the universe is determined by its mass content, and an open universe cannot turn into a closed one or vice versa.

The present value of the critical density is

\[\rho_{\rm c0}=\rho_{\rm c}(t_{0})=9.204\times 10^{-27}\,h_{7}^{2}\,{\rm kg\, m}^{-3}=1.3599\times 10^{11}\,h_{7}^{2}\,{\cal M}_{\odot}\,{\rm Mpc}^{-3}. \tag{1.55}\]

We have parametrized galaxies and other stellar systems by their mass-to-light ratio. Since the universe is homogeneous, the mass-to-light ratio measured on sufficiently large scales must be the same everywhere at a given cosmic time. The present \(R\)-band luminosity density \(j_{R}\) is given by equation (1.19), so the \(R\)-band mass-to-light ratio \(\Upsilon_{R}\) is related to the density parameter by

\[\Upsilon_{R}=\frac{\rho_{\rm c0}\Omega_{0}}{j_{R}}=(900\pm 300)\,h_{7}\Omega_{ 0}\,\Upsilon_{\odot}; \tag{1.56}\]the subscript "0" on \(\Omega\) indicates the density parameter at the present epoch.

An obvious next step is to compare this result to observed mass-to-light ratios and thereby estimate \(\Omega_{0}\). Unfortunately, the total mass-to-light ratios of individual galaxies are quite uncertain, because the total mass contained in their dark halos is difficult to determine. However, as we argued after equation (1.26), it is likely that the mixture of baryonic and non-baryonic dark matter in rich clusters of galaxies is representative of the universe as a whole, so we might hope that the mass-to-light ratios of rich clusters are a reasonable approximation to the total mass-to-light ratios of galaxies. Taking \(\Upsilon_{R}\simeq(200\pm 50)\,h_{7}\Upsilon_{\odot}\) from equation (1.25), we conclude that \(\Omega_{0}=0.22\pm 0.09\). This argument is subject to at least two possible biases: first, the galaxy population in rich clusters has a higher fraction of ellipticals than average, and hence fewer luminous young stars; second, most of the baryons in rich clusters are in the form of hot gas, which does not contribute to the \(R\)-band luminosity, but in isolated galaxies this gas might cool to form additional stars. Both of these effects should increase the mass-to-light ratio in clusters relative to isolated galaxies, and hence lead us to overestimate \(\Omega_{0}\). Thus we can conclude from this argument only that

\[\Omega_{\rm m0}\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt \hbox{$<$}}0.3. \tag{1.57}\]

The subscript "m" on \(\Omega_{0}\) is a reminder that this value refers only to the density in non-relativistic matter that can collapse along with the baryons into clusters of galaxies. Any uniformly distributed component of the density, such as a population of relativistic particles or vacuum energy, is excluded.

The inequality (1.57) encapsulates one of the fundamental conclusions of modern cosmology: the most "natural" model, a matter-dominated flat universe in which \(\Omega=1\) at all times, is excluded by the observations.

To solve the differential equations that describe FRW models, we need to know the equation of state relating the pressure \(p\) to the density \(\rho\) for each component of the universe. For our purposes a sufficiently general parametrization is

\[p=w\rho c^{2}, \tag{1.58}\]

where \(w\) is a constant. If the equation of state has this form, equation (1.48) can be integrated to yield

\[\rho\propto V^{-1-w}\propto a^{-3(1+w)}. \tag{1.59}\]

Three major components contribute to the dynamics of the universe:

1. Non-relativistic matter. This has \(p\ll\rho c^{2}\) so \(w=0\). We label the corresponding density \(\rho_{\rm m}(t)\), and for brevity we simply call this component "matter." In this case there is no distinction between the inertial mass density \(\rho_{\rm m}\) and the gravitational density \(\rho^{\prime}_{\rm m}=\rho_{\rm m}\) (eq. 1.45). From equation (1.59) \(\rho_{\rm m}\propto a^{-3}\), as expected from conservation of mass.

2. Radiation and other massless or highly relativistic particles. We label this density \(\rho_{\gamma}(t)\), and call this component "radiation." In this case \(p={1\over 3}\rho c^{2}\) so \(w={1\over 3}\), and from equation (1.45) the gravitational attraction is twice as strong as non-relativistic matter with the same density: \(\rho_{\gamma}^{\prime}=2\rho_{\gamma}\). As the universe expands, the radiation density declines as \(\rho_{\gamma}\propto a^{-4}\) from equation (1.59). Physically, this dependence arises because the number of photons is conserved so the number density declines as \(a^{-3}\), and their frequency and thus the energy per photon decay as \(a^{-1}\) (eq. 1.42).
3. A hypothetical energy density \(\rho_{\Lambda}\) associated with the vacuum (Carroll, Press, & Turner 1992). This must be accompanied by a _negative_ pressure \(p=-\rho_{\Lambda}c^{2}\) (i.e., a tension) because the energy-momentum tensor of the vacuum must be proportional to the Minkowski metric if the vacuum is to appear the same to all observers, regardless of their relative motion. In the parametrization of equation (1.58), vacuum energy therefore has \(w=-1\). Equation (1.59) shows that as the universe expands, \(\rho_{\Lambda}\) is independent of the scale factor, as expected since it is a universal constant.

A remarkable feature of vacuum energy is that it exerts repulsive gravitational forces--equations (1.45) and (1.58) show that gravity is repulsive for any medium with \(w<-{1\over 3}\). Consequently, the gravity from such a medium tends to accelerate rather than decelerate the expansion of the universe.

Vacuum energy plays a significant role in cosmology only if the vacuum-energy density \(\rho_{\Lambda}\) is comparable to the current critical density \(\rho_{c}\) (eq. 1.55). There is no motivation from fundamental physics for a vacuum-energy density of this magnitude: the theoretical prejudice is that either \(\rho_{\Lambda}\) has a very large value, or else is exactly zero on account of some unidentified symmetry. There is no known mechanism that would favor a value of \(\rho_{\Lambda}\) comparable to \(\rho_{\rm c}\). Moreover, because the critical density evolves with time while the vacuum-energy density does not, any approximate coincidence between \(\rho_{\Lambda}\) and \(\rho_{\rm c}\) must be a special feature of the present epoch. These difficulties have led physicists to explore quantum fields with more general behavior than vacuum energy, under the general heading of **dark energy**.

By analogy with equation (1.53), we define

\[\Omega_{\rm m0}\equiv{\rho_{\rm m0}\over\rho_{\rm c0}}\quad;\quad\Omega_{ \gamma 0}\equiv{\rho_{\gamma 0}\over\rho_{\rm c0}}\quad;\quad\Omega_{\Lambda 0} \equiv{\rho_{\Lambda 0}\over\rho_{\rm c0}}\]

to be the present densities of matter, radiation, and vacuum energy in units of the critical density. With this notation \(\Omega_{\rm m0}+\Omega_{\gamma 0}+\Omega_{\Lambda 0}=\Omega_{0}\). Then equation (1.50) can be rewritten as

\[\dot{a}^{2}=H_{0}^{2}\left[1+\Omega_{\rm m0}(a^{-1}-1)+\Omega_{\gamma 0}(a^{-2}-1)+ \Omega_{\Lambda 0}(a^{2}-1)\right],\]which can be integrated to yield a formula for the time dependence of the scale factor \(a(t)\):

\[H_{0}t=\int_{0}^{a(t)}\frac{a\,\mathrm{d}a}{\sqrt{\Omega_{\gamma 0}+\Omega_{ \mathrm{m}0}a+(1-\Omega_{\mathrm{m}0}-\Omega_{\gamma 0}-\Omega_{\Lambda 0})a^{2}+ \Omega_{\Lambda 0}a^{4}}}. \tag{1.62}\]

This integral can be evaluated analytically or numerically for arbitrary values of \(\Omega_{\mathrm{m}0}\), \(\Omega_{\gamma 0}\), and \(\Omega_{\Lambda 0}\), but it is more illuminating to examine special cases:

1. A flat, matter-dominated universe (the **Einstein-de Sitter universe**) has \(\Omega_{\gamma 0}=\Omega_{\Lambda 0}=0\), \(\Omega_{\mathrm{m}0}=1\), so \[a(t)\propto t^{2/3}\quad;\quad\rho_{\mathrm{m}}(t)=\frac{1}{6\pi Gt^{2}};\] (1.63) the second equation follows when the first is substituted into equation (1.50) with \(E=0\).
2. A flat, radiation-dominated universe has \[a(t)\propto t^{1/2}\quad;\quad\rho_{\gamma}(t)=\frac{3}{32\pi Gt^{2}}.\] (1.64)
3. A flat universe dominated by vacuum energy has \[a(t)\propto\exp(H_{0}t)=\exp\left[(\tfrac{8}{3}\pi G\rho_{\Lambda})^{1/2}t \right]\quad;\quad\rho_{\Lambda}=\frac{3H_{0}^{2}}{8\pi G}=\mathrm{constant}.\] (1.65)

At the present time, \(\Omega_{\gamma 0}\simeq 10^{-4}\) (eq. 1.72), so the evolution of the universe is determined by \(\Omega_{\mathrm{m}0}\) and \(\Omega_{\Lambda 0}\) except at very early times. Thus the properties of the universe can be parametrized on a diagram such as Figure 1.6. Lines on this figure mark the boundary between models that have open or closed geometries (\(k=-1\) or \(k=+1\)), and between models that expand forever and those that collapse at some future time. We have also marked off models that have no initial singularity: as we follow these "bounce" models back in time from the present, the repulsion from the vacuum energy becomes so strong that the expansion rate \(\dot{a}\) reaches zero at some time \(t_{\mathrm{b}}\) and is negative for \(t<t_{\mathrm{b}}\). Physically, this means that the universe was contracting for \(t<t_{\mathrm{b}}\), coated to a halt because of increasing repulsion by the vacuum energy, and then began the expansion that continues at the present time. Such models are excluded by observations because they predict a maximum redshift, \(z\simeq 2\), much smaller than the largest observed redshifts, \(z\gtrsim 6\).

#### The Big Bang and inflation

There is strong evidence that the universe was much hotter and denser in the past--this evidence includes the existence of the cosmic microwave background and the primordial abundances of the light elements (see SS1.3.5). This is consistent with the discussion of the preceding paragraph, which shows that all FRW models that are consistent with observations begin from an initial singularity or **Big Bang**. Immediately after the Big Bang the universe satisfied several striking constraints:

1. A matter- or radiation-dominated FRW universe always evolves away from \(\Omega=1\): equation (1.54) shows that \(|\Omega^{-1}-1|\) grows in proportion to \(1/\rho a^{2}\), which grows as \(a(t)\) or \(a^{2}(t)\), respectively. At present \(\Omega\) is not

Figure 1.6: Characteristics of FRW models of the universe in which the current radiation density \(\Omega_{\gamma 0}\) is negligible. The solutions are parametrized by the current matter density \(\Omega_{\rm m0}\) and vacuum energy \(\Omega_{\Lambda 0}\), both relative to the critical density (1.52). The lines divide models in which the geometry is open from those with closed geometry; models that will expand forever from those that will eventually collapse; and models in which the expansion is accelerating (\(\tilde{a}>0\)) from those in which it is decelerating. The shaded region denotes models with no initial singularity or Big Bang; these bounced from a collapsing to an expanding state at some non-zero value \(a(t)<1\) of the scale factor. The large oval marked SNe is the 1-\(\sigma\) error ellipse from measurements of distant supernovae (Riess et al. 2004), and the small oval labeled cmb is the 1-\(\sigma\) error ellipse from measurements of fluctuations in the cosmic microwave background combined with local measurements of the Hubble constant (Spergel et al. 2007). For further discussion see page 50.

far from unity, so soon after the Big Bang, when \(a(t)\) was much smaller than now, \(\Omega\) must have been extremely close to unity. This fine-tuning of the initial conditions is called the "flatness problem."
2. The universe is homogeneous on large scales. It is natural to ask whether this property could be the result of physical processes occurring shortly after the Big Bang. Since information cannot propagate faster than the speed of light, the size of the largest causally connected region is given by the distance a photon can propagate since the Big Bang. Light travels at speed \(c={\rm d}r/{\rm d}t\), where \({\rm d}r\) is the distance. In the Robertson-Walker metric (1.44), the comoving coordinate of a photon that is moving towards the origin therefore satisfies \[\frac{{\rm d}x}{{\rm d}t}=-\frac{c}{a(t)}\left(1-\frac{kx^{2}}{x_{\rm u}^{2}} \right)^{1/2}.\] (1.66) We have seen that in the early universe, \(|\Omega-1|\) must have been very small, so the geometry is nearly flat and we may set \(k=0\). Thus a photon that is emitted at \(t_{\rm i}\) and arrives at the origin at \(t\) has come from a comoving coordinate \[x=c\int_{t_{\rm i}}^{t}\frac{{\rm d}t}{a(t)}.\] (1.67) The comoving radius of the region that has been in causal contact since the Big Bang is called the **particle horizon**\(x_{\rm h}(t)\), and is obtained from equation (1.67) by letting \(t_{\rm i}\) shrink to zero. At early times the universe is expected to be radiation-dominated, since \(\rho_{\gamma}(t)\propto a^{-4}(t)\) while \(\rho_{\rm m}\propto a^{-3}\) and \(\rho_{\Lambda}\) is constant. In a flat radiation-dominated universe, the scale factor is \(a(t)=bt^{1/2}\), where \(b\) is a constant (eq. 1.64). Thus we obtain \[x_{\rm h}(t)=\frac{2ct^{1/2}}{b},\] (1.68) which shows that the comoving horizon shrinks to zero as \(t\to 0\); this in turn implies that right after the Big Bang different parts of the universe are not causally connected, so the large-scale homogeneity of the universe must be imposed as an initial condition. This uncomfortable situation is called the "horizon problem."
3. The rich structure in the present universe--galaxies, clusters of galaxies, etc.--has grown by gravitational instability. The spectrum of perturbations that seeded this growth must be inserted as an initial condition (the "structure problem").

Remarkably, all three of these problems can be resolved at one stroke by a single powerful assumption: that the early universe underwent a phase of accelerated expansion or **inflation**. Inflation arises when the dominant contributor to the mass density has an equation of state with \(w<-\frac{1}{3}\) (eq. 1.58).

For example, suppose that there is an early inflationary phase in which the universe is dominated by a large vacuum energy, which has \(w=-1\). Then the scale factor grows exponentially with time, as described by equation (1.65), but with much larger constants \(H_{0}\) and \(\rho_{\Lambda}\). As the universe inflates, the density of non-relativistic matter falls as \(a^{-3}(t)\), and the density of photons and other relativistic matter falls as \(a^{-4}(t)\), while the vacuum-energy density remains constant. Hence the dynamics rapidly becomes completely dominated by the vacuum energy, equation (1.65) applies with ever greater precision, and the density parameter \(\Omega\) tends to unity. More precisely, if the inflationary phase lasts for \(n\) e-foldings of the scale factor, then at the end of this phase \(|\Omega-1|\) will be smaller by a factor \(\sim\exp(-2n)\) than it was at the beginning. Thus inflation naturally produces \(\Omega\) very close to unity, thereby solving the flatness problem. Moreover, since \(|\Omega-1|\) is zero at the end of inflation with exponential precision, it is plausible to assume that it is exactly zero for all practical purposes, even today. Thus inflation strongly suggests that \(\Omega_{0}=1\); in other words, \(\Omega_{\gamma 0}+\Omega_{\rm m0}+\Omega_{\Lambda 0}=1\). Since \(\Omega_{\gamma 0}\) is negligible, the universe must lie on the line \(\Omega_{\rm m0}+\Omega_{\Lambda 0}=1\) that separates open from closed universes in Figure 1.6, just as the observations seem to indicate.

Next, inflation solves the horizon problem: equation (1.65) tells us that \(\dot{a}\propto a\), so the integral in equation (1.67) is \(\int{\rm d}t/a=\int{\rm d}a/(a\dot{a})\propto\int{\rm d}a/a^{2}\), which diverges as \(a\to 0\). Thus the region that is in causal contact becomes arbitrarily large if the inflationary phase begins early enough, so all regions in the observable universe could have been in causal contact in the interval between the Big Bang and the onset of inflation.

Inflation also predicts that when quantum fluctuations in the matter density are inflated past the event horizon, they are frozen into classical density fluctuations that provide the initial conditions for the growth of structure in the universe. These fluctuations enjoy a number of properties that greatly simplify the study of structure formation in the later universe: (i) they are nearly scale-invariant, in the sense that the rms fluctuations in the gravitational potential are independent of scale; (ii) they form a Gaussian random field; (iii) they are adiabatic, that is, the entropy per particle is constant (see SS9.1 for further discussion of these concepts).

Finally, inflation solves the **monopole problem**: point topological defects known as monopoles arise naturally in grand unified theories of particle physics, and the predicted density of these objects is far larger than allowed by observational constraints. Inflation solves this problem by diluting the density of monopoles--like non-relativistic matter, this density falls as \(a^{-3}(t)\)--to an undetectably small value.

Particle physics has no difficulty embracing particle fields that could have caused inflation. Inflation is thought to end when a phase transition converts the inflating matter to ordinary matter and radiation (in this context, "ordinary" includes wimps or other non-baryonic dark matter). Anymatter or radiation present before inflation was diluted to negligible densities by this time. The newly formed matter and radiation will be in thermal equilibrium, with density parameter \(\Omega=1\) and density fluctuations that are Gaussian, adiabatic, and nearly scale-invariant--precisely the conditions we need to explain many of the properties of the observed universe.

Thus the inflationary hypothesis not only solves the horizon, flatness, and monopole problems but also provides simple, well-defined initial conditions that enable quantitative predictions about the growth of structure in the universe. It should be kept in mind, however, that despite its central role in modern cosmology, the inflationary hypothesis is still unsupported by any evidence from other arenas in theoretical or experimental physics.

#### The cosmic microwave background

Following inflation, the universe was radiation-dominated, so the scale factor grew as \(a(t)\propto t^{1/2}\) and the density fell as \(\rho\propto a^{-4}\) (eq. 64). All particle species were in thermal equilibrium at a temperature \(T(t)\), which declined approximately as \(a^{-1}\). Once the temperature dropped below \(100\,\)MeV, \(10^{-4}\,\)s after the Big Bang, the constituents of this hot plasma consisted of relativistic electrons, positrons, neutrinos, and photons, and non-relativistic protons, neutrons, and perhaps wimps.

As the universe continued to expand and cool, the collision time between particles grew faster than the expansion time, so particles began to drift out of thermal equilibrium. In particular, weakly interacting particles such as neutrinos dropped out of thermal equilibrium at \(T\simeq 10^{10}\,\)K = \(0.86\,\)MeV, about \(1\,\)s after the Big Bang. At this point the neutron/proton ratio, which had been kept in equilibrium by weak interactions, was frozen at about 0.2. The free neutrons then began to decay, with e-folding time \(886\,\)s. However, long before this decay process was completed, nucleosynthesis began: below \(10^{9}\,\)K, at \(t\simeq 100\,\)s, \(k_{\rm B}T\) was much smaller than the deuteron binding energy, so deuterium began to accumulate. Eventually its abundance grew large enough for deuterium to burn to tritium and then helium. Nucleosynthesis was essentially complete \(200\,\)s after the Big Bang, leaving most of the nucleons as hydrogen (\(75\%\) by mass) or \({}^{4}\)He (\(25\%\) by mass), with traces of deuterium, \({}^{3}\)He and \({}^{7}\)Li. The abundance of deuterium, in particular, depends sensitively on the density of baryons at a given temperature, which is determined by the baryon-to-photon ratio \(\eta\). Thus measurements of the abundance of deuterium in primordial astrophysical systems such as intergalactic clouds can be used to determine \(\eta\); measurements of the cosmic microwave background radiation (see below) determine the current photon density, and from these two quantities we can determine the baryon density. This method yields a current density parameter for baryons (Yao et al. 2006)

\[\Omega_{\rm b0}=(0.042\pm 0.004)\,h_{7}^{-2}. \tag{69}\]As the universe expanded further, the density in radiation and relativistic matter (photons and neutrinos) continued to decline as \(a^{-4}\), while the density in non-relativistic matter (mostly protons, electrons, and helium nuclei) declined as \(a^{-3}\). Eventually, at redshift and time

\[z_{\gamma{\rm m}}\simeq 3100,\quad t_{\gamma{\rm m}}\simeq 6\times 10^{4}\,{\rm yr}, \tag{1.70}\]

the density of matter equaled that of radiation (see Figure 1.7). At this point the matter was still fully ionized. However, as the universe continued to expand, at

\[z_{\rm d}\simeq 1100,\quad t_{\rm d}\simeq 4\times 10^{5}\,{\rm yr}, \tag{1.71}\]

the electrons and protons combined to form neutral atomic hydrogen. This **decoupling** or **recombination epoch** was a milestone in the history of the universe for two reasons: (i) before recombination, the ionized baryonic plasma was locked to the photons by Thomson scattering, while after decoupling, the baryonic matter could move relative to the photons so the assembly of bound baryonic structures such as galaxies could begin; (ii) the universe became transparent.

Recombination occurred rather quickly: the fractional rms dispersion in the scale factor at which photons suffer their last scattering is less than 10%. Thus we can imagine ourselves to be surrounded by an opaque **last-scattering surface** that hides the Big Bang from us.12

Footnote 12: The last-scattering surface is analogous to a stellar photosphere, except we are in a cavity in the middle of optically thick material rather than outside a sphere of optically thick material.

At recombination, the photons had a black-body spectrum, and this spectrum was preserved even after the universe became transparent: the photon frequencies all decline as \(a^{-1}(t)\) (eq. 1.42) so the spectrum remained black-body with a temperature that declined in the same way.

The relic black-body radiation from the last-scattering surface, the **cosmic microwave background** or **CMB**, was discovered in 1965. It dominates the night sky at wavelengths in the range millimeters to centimeters. The spectrum is accurately black-body, with temperature \(T=(2.725\pm 0.001)\,{\rm K}\), and this finding provides compelling evidence that the universe arose from a hot, dense initial state--it is only in such a state that the photons can be thermalized in less than a Hubble time. The energy density of the cmb photons corresponds to a density parameter \(5.04\times 10^{-5}h_{7}^{-2}\); to compute the total density in radiation we must add to this the energy density contributed by relic neutrinos (this cosmic neutrino background has not yet been detected, but is a firm prediction of Big Bang cosmology). Thus the current energy density in radiation is

\[\Omega_{\gamma 0}=8.48\times 10^{-5}\,h_{7}^{-2}. \tag{1.72}\]The cmb is remarkably close to isotropic: apart from a dipole term that arises from the velocity of the solar system with respect to a fundamental observer (\(368\pm 2\,\rm km\,s^{-1}\)), the largest fractional rms anisotropies are \(\lesssim 10^{-4}\). These are believed to arise from the primordial fluctuations introduced by inflation, and the power spectrum of these anisotropies provides an exquisitely sensitive probe of many of the fundamental parameters of the universe.

In particular, assuming a FRW universe currently dominated by non-relativistic matter and vacuum energy, and \(\Omega_{0}=1\) as predicted by inflation, the power spectrum of cmb fluctuations strongly constrains the Hubble constant, the density in baryons, and the matter density (Spergel et al. 2007):

\[h_{7}=1.05\pm 0.05,\quad\Omega_{\rm b0}=(0.0455\pm 0.0015)\,h_{7}^{-2},\quad \Omega_{\rm m0}=0.237\pm 0.034. \tag{1.73}\]

The vacuum-energy density is then \(\Omega_{\Lambda 0}=1-\Omega_{\rm m0}=0.763\pm 0.034\). This result implies that the dynamics of the universe is currently dominated by vacuum energy--in other words, the universe appears to have entered a second period of inflation.

With these parameters, the density in non-relativistic matter is much larger than the density in baryons. Thus there must be non-baryonic dark matter that contributes roughly 19% of the critical density. Note also that the present density in vacuum energy exceeds the density in matter; since the former is independent of scale factor and the latter scales as \(a^{-3}=(1+z)^{3}\), equality occurred quite recently (Figure 1.7), at

\[z_{\rm m\Lambda}=\left(\frac{\Omega_{\Lambda 0}}{\Omega_{\rm m0}}\right)^{1/3} -1=0.48\pm 0.09. \tag{1.74}\]

The fluctuation spectrum deduced from the cmb measurements is also approximately scale-invariant, again as predicted by inflation.

The parameters in equation (1.73) are consistent with a wide variety of astronomical measurements, including the following: (i) The Hubble constant is consistent with the best direct estimate of the distance scale, using Cepheid distances, which yields \(h_{7}=1.03\pm 0.11\) (eq. 1.14). Moreover, if measurements of the cmb power spectrum are combined with this measurement of the Hubble constant, then the assumption that \(\Omega_{0}=1\) can be eliminated, and the data yield \(\Omega_{0}=1.014\pm 0.017\), consistent with the prediction of inflation that \(\Omega=1\). (ii) The fraction of the total mass composed of baryons is

\[f_{\rm b}=\frac{\Omega_{\rm b0}}{\Omega_{\rm m0}}=0.17\pm 0.01, \tag{1.75}\]

in reasonable agreement with the estimate from clusters of galaxies, \(0.13\pm 0.02\) (eq. 1.26). (ii) The baryon density \(\Omega_{\rm b0}\) is consistent with the result from nucleosynthesis, equation (1.69). (iii) The matter density \(\Omega_{\rm m0}\) is consistent with measurements of the geometry of the universe from supernovae, which yield \(\Omega_{\rm m0}=0.29\pm 0.04\) for a flat universe (see Figure 1.6 and Riess et al. 2004). (iv) The matter density \(\Omega_{\rm m0}\), together with equation (1.56), predicts that the average mass-to-light ratio in the universe is

\[\Upsilon_{R}=(220\pm 80)\Upsilon_{\odot}, \tag{1.76}\]

consistent with the observed mass-to-light ratio of large clusters of galaxies, \(\Upsilon_{R}=(210\pm 50)\Upsilon_{\odot}\). (v) Given \(\Omega_{\rm m0}\), \(\Omega_{\Lambda 0}\), and \(\Omega_{\gamma 0}\) (eq. 1.72), the temporal evolution of the scale factor is entirely determined by equation (1.61) (see Figure 1.7). The age of the universe is thus found to be

\[t_{0}=(13.73\pm 0.16)\,{\rm Gyr}, \tag{1.77}\]

consistent with the ages of globular-cluster stars (SS1.1.1) and radioactive dating of the oldest stars (Cayrel et al. 2001).

Figure 1.7: The fraction of the critical density provided by radiation (\(\Omega_{\gamma}\)), matter (\(\Omega_{\rm m}\)), and vacuum energy (\(\Omega_{\Lambda}\)) as a function of redshift \(z\) or scale factor \(a(t)=(1+z)^{-1}\) (bottom axis) or age (top axis). The values shown are for a flat FRW universe with present matter density \(\Omega_{\rm m0}=0.24\), vacuum-energy density \(\Omega_{\Lambda 0}=0.76\) (eq. 1.73), and radiation density \(\Omega_{\gamma 0}\) determined from the temperature of the cmb (eq. 1.72). The redshifts of equal densities of matter and radiation (eq. 1.70), decoupling (eq. 1.71), and equal densities of matter and vacuum energy (eq. 1.74) are marked.

This approximate but encouraging agreement among quite different methods of measuring the same cosmological parameters strongly suggests that we live in a universe with a flat geometry containing three main components: vacuum energy or some other field with a similar equation of state (\(\sim 76\%\)); non-baryonic dark matter (\(\sim 20\%\)), and baryons (\(\sim 4\%\))--for a detailed inventory see Fukugita, Hogan, & Peebles (1998) and Fukugita & Peebles (2004).

There are unsatisfying aspects to this picture. In particular, there is no independent experimental evidence or strong theoretical justification for three of the central ingredients of this cosmological model: vacuum energy, the particle(s) that comprise the non-baryonic dark matter, and the field that drives inflation. There is also no explanation of why we happen to live at the special epoch when the densities in matter and vacuum energy are similar. Much work remains to be done.

**Problems**

**1.1** [2] In principle, the density of matter in the solar neighborhood can be measured from its effects on planetary orbits. Assume that the solar system is permeated by a uniform medium of density \(0.1\,{\cal M}_{\odot}\,{\rm pc}^{-3}\) (Table 1.1). Estimate the rate of precession of the perihelion of Neptune (orbital radius \(4.5\times 10^{12}\,{\rm m}\)) due to the perturbing force from this medium, and compare your result to the minimum measurable precession, which is \(\approx 0.01\,{\rm arcsec}\,{\rm yr}^{-1}\). An answer to within an order of magnitude is sufficient.

**1.2** [2] (a) The **luminosity density**\(j({\bf r})\) of a stellar system is the luminosity per unit volume at position \({\bf r}\). For a transparent spherical galaxy, show that the surface brightness \(I(R)\) (Box 2.1) and luminosity density \(j(r)\) are related by the formula

\[I(R)=2\int_{R}^{\infty}{\rm d}r\,{rj(r)\over\sqrt{r^{2}-R^{2}}}.\]

(b) What is the surface brightness of a transparent spherical galaxy with luminosity density \(j(r)=j_{0}(1+r^{2}/b^{2})^{-5/2}\) (this is the Plummer model of SS2.2.2c)?

(c) Invert equation (1.78) using Abel's formula (eq. B.72) to obtain

\[j(r)=-{1\over\pi}\int_{r}^{\infty}{{\rm d}R\over\sqrt{R^{2}-r^{2}}}{{\rm d}I \over{\rm d}R}.\]

(d) Determine numerically the luminosity density in a spherical galaxy that follows the \(R^{1/4}\) surface-brightness law. Plot \(\log_{10}j(r)\) versus \(\log_{10}r/R_{\rm e}\), where \(R_{\rm e}\) is the effective radius.

**1.3** [2] The **strip brightness**\(S(x)\) is defined so that \(S(x)\,{\rm d}x\) is the total luminosity in a strip of width \({\rm d}x\) that passes a distance \(x\) from the projected center of the system.

(a) Show that in a transparent, spherical system

\[S(x)=2\int_{x}^{\infty}{\rm d}R\,{RI(R)\over\sqrt{R^{2}-x^{2}}},\]

where \(I(R)\) is the surface brightness at radius \(R\).

(b) Show that the luminosity density and the total luminosity interior to \(r\) are related to the strip brightness by (Plummer 1911)

\[j(x)=-{1\over 2\pi x}{{\rm d}S\over{\rm d}x}\ \ \ ;\ \ \ L(r)=-2\int_{0}^{r}{ \rm d}x\,x{{\rm d}S\over{\rm d}x}.\]

**1.4**: [2] An axisymmetric transparent galaxy has luminosity density that is constant on spheroids \(R^{2}+z^{2}/q^{2}\) having axis ratio \(q\). A distant observer located on the symmetry axis of the galaxy sees an image with circular isophotes and central surface brightness \(I_{\rm n}\). A second distant observer, observing the galaxy from a line of sight that is inclined by an angle \(i\) to the symmetry axis, sees an image with elliptical isophotes with axis ratio \(Q<1\) and central surface brightness \(I_{0}\).

(a) What is the relation between \(I_{0}\), \(I_{\rm n}\), and \(Q\)? Hint: the answers are different for oblate (\(q<1\)) and prolate (\(q>1\)) galaxies.

(b) What is the relation between \(q\), \(Q\), and \(i\)?

(c) Assuming that galaxies are oriented randomly, what fraction are seen from a line of sight that lies within \(10^{\circ}\) of the symmetry axis? From within \(10^{\circ}\) of the equatorial plane?

**1.5**: [1] (a) Why is the estimated mass-to-light ratio of clusters of galaxies, equation (1.25), proportional to the assumed value of the Hubble constant \(h_{7}\)?

(b) Dark matter was discovered by Zwicky (1933), who compared the mass-to-light ratio of the Coma cluster of galaxies (as measured by the virial theorem, SS4.8.3) with the mass-to-light ratios of the luminous parts of spiral galaxies as measured by circular-speed curves, and concluded that there was 400 times as much dark matter as luminous matter in the Coma cluster. However, Zwicky's conclusion was based on a Hubble constant \(H_{0}=558\,{\rm km\,s^{-1}\,Mpc^{-1}}\). How would his conclusion about the ratio of dark to luminous matter have been affected had he used the correct value of the Hubble constant, which is smaller by a factor of eight?

**1.6**: [1] (a) Associated with the vacuum-energy density \(\rho_{\Lambda}\) is the characteristic timescale \((G\rho_{\Lambda})^{-1/2}\). What is its value for the cosmological parameters in equation (1.73), and what is its physical significance?

(b) Einstein's original formulation of general relativity included a contribution from vacuum energy, which he called the **cosmological constant** and parametrized by

\[\Lambda\equiv\frac{8\pi G\rho_{\Lambda}}{c^{2}}. \tag{1.82}\]

\(\Lambda^{-1/2}\) is a characteristic length. What is its value for the cosmological parameters in equation (1.73)?

**1.7**: [2] Prove that the volume of a closed FRW universe is \(2\pi^{2}a^{3}(t)x_{\rm u}^{3}\).

**1.8**: [1] Einstein proposed a static FRW universe, that is, one in which the scale factor \(a(t)=a_{0}=\mbox{\it constant}\) and the Hubble constant \(H_{0}=0\).

(a) If the radiation density is negligible, prove that the matter density in this universe equals twice the vacuum-energy density.

(b) Suppose that the scale factor is perturbed from \(a_{0}\) by a small amount, \(a(t)=a_{0}+\epsilon a_{1}(t)\) with \(\epsilon\ll 1\). Show that \(a_{1}(t)\) grows exponentially, so the static universe is unstable, and derive the growth rate.

**1.9**: [1] Assuming a flat FRW universe with parameters given by equation (1.73) at the present time, what is the value of the Hubble parameter in the distant future? If this is less than its present value \(H_{0}\), why is the universe said to be accelerating?

**1.10**: [1] Suppose that some of the dark matter is composed of iron asteroids of density \(\rho=8\,{\rm g\,cm^{-3}}\) and radius \(r\) that are uniformly distributed throughout intergalactic space. If the density in this form is \(\Omega_{\rm a}=0.01\), find an approximate lower limit on \(r\) from the condition that the universe is not opaque, i.e., that we can see distant quasars. Your answer need be correct only to within a factor of two or so.

**1.11**: [2] Reproduce Figure 1.6.

**1.12**: [2] Write a function to do the following task: given values of the Hubble constant \(H_{0}\), the density parameters \(\Omega_{\rm m0}\), \(\Omega_{\gamma 0}\), \(\Omega_{\Lambda 0}\), and a specified redshift \(z\), find the age of the universe at that redshift. For a flat universe with parameters given by equations (1.72) and (1.73), what is the age at redshifts \(z=1000\), \(z=1\), and \(z=0\)?

**1.13**: [2] The redshift at which the densities in matter and radiation are equal is \(z_{\gamma{\rm m}}\). For a flat FRW universe containing matter, radiation, and vacuum energy, with parameters not too far from our own, prove that (a)

\[1+z_{\gamma{\rm m}}=\frac{\Omega_{\rm m0}}{\Omega_{\gamma 0}}=1.18\times 10^{4} \,\Omega_{\rm m0}h_{7}^{2} \tag{1.83}\]

(hint: use eq. 1.72); (b) the age of the universe at \(z_{\gamma{\rm m}}\) is

\[t_{\gamma{\rm m}}=\frac{2(2-\surd 2)}{3H_{0}}\frac{\Omega_{\gamma 0}^{3/2}}{ \Omega_{\rm m0}^{2}}; \tag{1.84}\]

(c) the comoving horizon at \(z_{\gamma{\rm m}}\) (eq. 1.67) is

\[x_{\gamma{\rm m}}=2(\sqrt{2}-1)\frac{c}{H_{0}}\frac{\Omega_{\gamma 0}^{1/2}}{ \Omega_{\rm m0}}=\frac{32.7\,{\rm Mpc}}{\Omega_{\rm m0}h_{7}^{2}}. \tag{1.85}\]

Evaluate \(z_{\gamma{\rm m}}\), \(t_{\gamma{\rm m}}\), and \(x_{\gamma{\rm m}}\) for the parameters of equation (1.73).

**1.14**: [1] The universe was opaque before decoupling at \(z>z_{\rm d}\simeq 1100\) (eq. 1.71) because the ionized baryonic plasma had a high optical depth to Thomson scattering. For \(z<z_{\rm d}\) the electrons and protons recombined to form neutral atoms and the universe became transparent. Somewhere between \(z\sim 20\) and \(z\sim 6\) high-energy photons from newly formed quasars reionized most of the intergalactic medium. Why is the universe not opaque for \(z\lesssim 6\)?

## 2 Potential Theory

Much of the mass of a galaxy resides in stars. To compute the gravitational potential of a large collection of stars, we should in principle simply add the point-mass potentials of all the stars together. Of course, this is not practicable for the \(\approx 10^{11}\) stars in a typical galaxy, and for most purposes it is sufficient to model the potential by smoothing the mass density in stars on a scale that is small compared to the size of the galaxy, but large compared to the mean distance between stars. In particular, in SS1.2.1 we saw that we obtain an excellent approximation to the orbit of a single star in a galaxy by treating the star as a test particle that moves in a smooth potential of this kind. In this chapter we show how the force field of such an idealized galaxy can be calculated.

The chapter is divided into eight sections. We start by reviewing some general results on potential theory, and then in SS2.2 we specialize to discuss the simplest potentials, those of spherical bodies. In SS2.3 we describe flattened density distributions that also have simple potentials. These special systems give us insight into the potentials of real galaxies and provide useful prototypes, but they are not adequate for accurate modeling. Therefore in SS2.4 and SS2.5 we describe a variety of general techniques for computing the potentials of aspherical bodies. The potentials of razor-thin disks form an important limiting case, which we discuss in SS2.6. In SS2.7 we use these results to examine the potential of the Milky Way. In SS2.8 and SS2.9 we describe how gravitational potentials are found in computer simulations of stellar systems.

The discussion in SSSS2.4 to 2.6 is rather mathematical, and readers who are willing to take a few results on trust may prefer to move straight from SS2.3 to SS2.7.

### 2.1 General results

Our goal is to calculate the force \({\bf F}({\bf x})\) on a particle of mass \(m_{\rm s}\) at position \({\bf x}\) that is generated by the gravitational attraction of a distribution of mass \(\rho({\bf x}^{\prime})\). According to Newton's inverse-square law of gravitation, the force \({\bf F}({\bf x})\) may be obtained by summing the small contributions

\[\delta{\bf F}({\bf x})=Gm_{\rm s}\frac{{\bf x}^{\prime}-{\bf x}}{|{\bf x}^{ \prime}-{\bf x}|^{3}}\delta m({\bf x}^{\prime})=Gm_{\rm s}\frac{{\bf x}^{ \prime}-{\bf x}}{|{\bf x}^{\prime}-{\bf x}|^{3}}\rho({\bf x}^{\prime})\,{\rm d} ^{3}{\bf x}^{\prime} \tag{2.1}\]

to the overall force from each small element of volume \({\rm d}^{3}{\bf x}^{\prime}\) located at \({\bf x}^{\prime}\). Thus

\[{\bf F}({\bf x})=m_{\rm s}{\bf g}({\bf x})\quad\mbox{where}\quad{\bf g}({\bf x })\equiv G\int{\rm d}^{3}{\bf x}^{\prime}\frac{{\bf x}^{\prime}-{\bf x}}{|{ \bf x}^{\prime}-{\bf x}|^{3}}\rho({\bf x}^{\prime}) \tag{2.2}\]

is the **gravitational field**, the force per unit mass.

If we define the **gravitational potential**\(\Phi({\bf x})\) by

\[\Phi({\bf x})\equiv-G\int{\rm d}^{3}{\bf x}^{\prime}\frac{\rho({\bf x}^{\prime })}{|{\bf x}^{\prime}-{\bf x}|}, \tag{2.3}\]

and notice that

\[\mathbf{\nabla}_{\bf x}\biggl{(}\frac{1}{|{\bf x}^{\prime}-{\bf x}|} \biggr{)}=\frac{{\bf x}^{\prime}-{\bf x}}{|{\bf x}^{\prime}-{\bf x}|^{3}}, \tag{2.4}\]

we find that we may write \({\bf g}\) as

\[\eqalign{{\bf g}({\bf x})&=\mathbf{\nabla}_{\bf x}\int{\rm d}^{3}{ \bf x}^{\prime}\frac{G\rho({\bf x}^{\prime})}{|{\bf x}^{\prime}-{\bf x}|}\cr& =-\mathbf{\nabla}\Phi,\cr} \tag{2.5}\]

where for brevity we have dropped the subscript \({\bf x}\) on the gradient operator \(\nabla\).

The potential is useful because it is a scalar field that is easier to visualize than the vector gravitational field but contains the same information. Also, in many situations the easiest way to obtain \({\bf g}\) is first to calculate the potential and then to take its gradient.

If we take the divergence of equation (2.2), we find

\[\mathbf{\nabla}\cdot{\bf g}({\bf x})=G\int{\rm d}^{3}{\bf x}^{\prime }\,\mathbf{\nabla}_{\bf x}\cdot\left(\frac{{\bf x}^{\prime}-{\bf x}}{ |{\bf x}^{\prime}-{\bf x}|^{3}}\right)\rho({\bf x}^{\prime}). \tag{2.6}\]Now

\[\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left(\frac{\mathbf{x}^{\prime}-\mathbf{x}}{| \mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right)=-\frac{3}{|\mathbf{x}^{\prime}- \mathbf{x}|^{3}}+\frac{3(\mathbf{x}^{\prime}-\mathbf{x})\cdot(\mathbf{x}^{ \prime}-\mathbf{x})}{|\mathbf{x}^{\prime}-\mathbf{x}|^{5}}. \tag{2.7}\]

When \(\mathbf{x}^{\prime}-\mathbf{x}\neq 0\) we may cancel the factor \(|\mathbf{x}^{\prime}-\mathbf{x}|^{2}\) from top and bottom of the last term in this equation to conclude that

\[\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left(\frac{\mathbf{x}^{\prime}-\mathbf{x }}{|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right)=0\qquad(\mathbf{x}^{\prime} \neq\mathbf{x}). \tag{2.8}\]

Therefore, any contribution to the integral of equation (2.6) must come from the point \(\mathbf{x}^{\prime}=\mathbf{x}\), and we may restrict the volume of integration to a small sphere of radius \(h\) centered on this point. Since, for sufficiently small \(h\), the density will be almost constant through this volume, we can take \(\rho(\mathbf{x}^{\prime})\) out of the integral. The remaining terms of the integrand may then be arranged as follows:

\[\boldsymbol{\nabla}\cdot\mathbf{g}(\mathbf{x}) =G\rho(\mathbf{x})\int_{|\mathbf{x}^{\prime}-\mathbf{x}|\leq h} \mathrm{d}^{3}\mathbf{x}^{\prime}\,\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left( \frac{\mathbf{x}^{\prime}-\mathbf{x}}{|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right) \tag{2.9a}\] \[=-G\rho(\mathbf{x})\int_{|\mathbf{x}^{\prime}-\mathbf{x}|\leq h} \mathrm{d}^{2}\mathbf{S}^{\prime}\cdot\frac{(\mathbf{x}^{\prime}-\mathbf{x})} {|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}.\]

The last step in this sequence uses the divergence theorem to convert the volume integral into a surface integral (eq. B.43). Now on the sphere \(|\mathbf{x}^{\prime}-\mathbf{x}|=h\) we have \(\mathrm{d}^{2}\mathbf{S}^{\prime}=(\mathbf{x}^{\prime}-\mathbf{x})h\,\mathrm{ d}^{2}\Omega\), where \(\mathrm{d}^{2}\Omega\) is a small element of solid angle. Hence equation (2.9a) becomes

\[\boldsymbol{\nabla}\cdot\mathbf{g}(\mathbf{x})=-G\rho(\mathbf{x})\int\mathrm{d }^{2}\Omega=-4\pi G\rho(\mathbf{x}). \tag{2.9b}\]

If we substitute from equation (2.5) for \(\boldsymbol{\nabla}\cdot\mathbf{g}\), we obtain **Poisson's equation** relating the potential \(\Phi\) to the density \(\rho\);

\[\nabla^{2}\Phi=4\pi G\rho. \tag{2.10}\]

This is a differential equation that can be solved for \(\Phi(\mathbf{x})\) given \(\rho(\mathbf{x})\) and an appropriate boundary condition.1 For an isolated system the boundary condition is \(\Phi\to 0\) as \(|\mathbf{x}|\to\infty\). The potential given by equation (2.3) automatically satisfies this boundary condition. Poisson's equation providesa route to \(\Phi\) and then to \({\bf g}\) that is often more convenient than equations (2.2) or (2.3). In the special case \(\rho=0\) Poisson's equation becomes **Laplace's equation**,

\[\nabla^{2}\Phi=0. \tag{2.11}\]

If we integrate both sides of equation (2.10) over an arbitrary volume containing total mass \(M\), and then apply the divergence theorem (eq. B.43), we obtain

\[4\pi GM=4\pi G\int{\rm d}^{3}{\bf x}\,\rho=\int{\rm d}^{3}{\bf x}\,\nabla^{2} \Phi=\int{\rm d}^{2}{\bf S}\cdot\mathbf{\nabla}\Phi. \tag{2.12}\]

This result is **Gauss's theorem**, which states that _the integral of the normal component of \(\mathbf{\nabla}\Phi\) over any closed surface equals \(4\pi G\) times the mass contained within that surface_.

Since \({\bf g}\) is determined by the gradient of a potential, the gravitational field is conservative, that is, the work done against gravitational forces in moving two stars from infinity to a given configuration is independent of the path along which they are moved, and is defined to be the potential energy of the configuration (Appendix D.1). Similarly, the work done against gravitational forces in assembling an arbitrary continuous distribution of mass \(\rho({\bf x})\) is independent of the details of how the mass distribution was assembled, and is defined to be equal to the **potential energy** of the mass distribution. An expression for the potential energy can be obtained by the following argument.

Suppose that some of the mass is already in place so that the density and potential are \(\rho({\bf x})\) and \(\Phi({\bf x})\). If we now bring in a additional small mass \(\delta m\) from infinity to position \({\bf x}\), the work done is \(\delta m\,\Phi({\bf x})\). Thus, if we add a small increment of density \(\delta\rho({\bf x})\), the change in potential energy is

\[\delta W=\int{\rm d}^{3}{\bf x}\,\delta\rho({\bf x})\Phi({\bf x}). \tag{2.13}\]

According to Poisson's equation the resulting change in potential \(\delta\Phi({\bf x})\) satisfies \(\nabla^{2}(\delta\Phi)=4\pi G(\delta\rho)\), so

\[\delta W=\frac{1}{4\pi G}\int{\rm d}^{3}{\bf x}\,\Phi\nabla^{2}(\delta\Phi)\,. \tag{2.14}\]

Using the divergence theorem in the form (B.45), we may write this as

\[\delta W=\frac{1}{4\pi G}\int\Phi\mathbf{\nabla}(\delta\Phi)\cdot{\rm d }^{2}{\bf S}-\frac{1}{4\pi G}\int{\rm d}^{3}{\bf x}\,\mathbf{\nabla} \Phi\cdot\mathbf{\nabla}(\delta\Phi), \tag{2.15}\]

where the surface integral vanishes because \(\Phi\propto r^{-1}\), \(|\mathbf{\nabla}\delta\Phi|\propto r^{-2}\) as \(r\to\infty\), so the integrand \(\propto r^{-3}\) while the total surface area \(\propto r^{2}\). But \(\mathbf{\nabla}\Phi\cdot\mathbf{\nabla}(\delta\Phi)=\frac{1} {2}\delta(\mathbf{\nabla}\Phi\cdot\mathbf{\nabla}\Phi)= \frac{1}{2}\delta|(\mathbf{\nabla}\Phi)|^{2}\). Hence

\[\delta W=-\frac{1}{8\pi G}\delta\bigg{(}\int{\rm d}^{3}{\bf x}\,|\mathbf{\nabla}\Phi|^{2}\bigg{)}. \tag{2.16}\]If we now sum up all of the contributions \(\delta W\), we have a simple expression for the potential energy,

\[W=-\frac{1}{8\pi G}\int{\rm d}^{3}{\bf x}\,|\mathbf{\nabla}\Phi|^{2}. \tag{2.17}\]

To obtain an alternative expression for \(W\), we again apply the divergence theorem and replace \(\nabla^{2}\Phi\) by \(4\pi G\rho\) to obtain

\[W={{1\over 2}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\Phi({\bf x}). \tag{2.18}\]

**The potential-energy tensor** In SS4.8.3 we shall encounter the tensor \({\bf W}\) that is defined by

\[W_{jk}\equiv-\int{\rm d}^{3}{\bf x}\,\rho({\bf x})x_{j}\frac{\partial\Phi}{ \partial x_{k}}, \tag{2.19}\]

where \(\rho\) and \(\Phi\) are the density and potential of some body, and the integral is to be taken over all space. We now deduce some useful properties of \({\bf W}\), which is known as the **Chandrasekhar potential-energy tensor**.2

Footnote 2: Subramanyan Chandrasekhar (1910–1995) was educated in India and England and spent most of his career at the University of Chicago. He discovered the Chandrasekhar limit, the maximum mass of a white dwarf star, and elucidated the concept of dynamical friction in astrophysics (SS8.1). He shared the 1983 Nobel Prize in Physics with W. A. Fowler.

If we substitute for \(\Phi\) from equation (2.3), \({\bf W}\) becomes

\[W_{jk}=G\int{\rm d}^{3}{\bf x}\,\rho({\bf x})x_{j}\frac{\partial}{\partial x_ {k}}\int{\rm d}^{3}{\bf x^{\prime}}\,\frac{\rho({\bf x^{\prime}})}{|{\bf x^{ \prime}}-{\bf x}|}. \tag{2.20}\]

Since the range of the integration over \({\bf x^{\prime}}\) does not depend on \({\bf x}\), we may carry the differentiation inside the integral to find

\[W_{jk}=G\int{\rm d}^{3}{\bf x}\int{\rm d}^{3}{\bf x^{\prime}}\,\rho({\bf x}) \rho({\bf x^{\prime}})\frac{x_{j}(x_{k}^{\prime}-x_{k})}{|{\bf x^{\prime}}-{ \bf x}|^{3}}.\] (2.21a) Furthermore, since \[{\bf x}\] and \[{\bf x^{\prime}}\] are dummy variables of integration, we may relabel them and write \[W_{jk}=G\int{\rm d}^{3}{\bf x^{\prime}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x^{ \prime}})\rho({\bf x})\frac{x_{j}^{\prime}(x_{k}-x_{k}^{\prime})}{|{\bf x}-{ \bf x^{\prime}}|^{3}} \tag{2.21b}\]

Finally, on interchanging the order of integration in equation (2.21b) and adding the result to equation (2.21a), we obtain

\[W_{jk}=-{{1\over 2}}G\int{\rm d}^{3}{\bf x}\int{\rm d}^{3}{\bf x^{ \prime}}\,\rho({\bf x})\rho({\bf x^{\prime}})\frac{(x_{j}^{\prime}-x_{j})(x_{ k}^{\prime}-x_{k})}{|{\bf x^{\prime}}-{\bf x}|^{3}}. \tag{2.22}\]

**Figure 2.1** Proof of Newton's first theorem.

From this expression we draw the important inference that the tensor \({\bf W}\) is **symmetric**, that is, that \(W_{jk}=W_{kj}\). If the body is flattened along some axis, say the \(x_{3}\) axis, \(W_{33}\) will be smaller than the other components because for most pairs of matter elements, \(|x_{3}-x_{3}^{\prime}|<|x_{1}-x_{1}^{\prime}|\) or \(|x_{2}-x_{2}^{\prime}|\).

When we take the **trace** of both sides of equation (2.22), we find

\[\begin{split}{\rm trace}({\bf W})&\equiv\sum_{j=1 }^{3}W_{jj}=-{{1\over 2}}G\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\int{\rm d}^{3}{ \bf x}^{\prime}\,{\rho({\bf x}^{\prime})\over|{\bf x}^{\prime}-{\bf x}|}\\ &={{1\over 2}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\Phi({\bf x }).\end{split} \tag{2.23}\]

Comparing this with equation (2.18) we see that \({\rm trace}({\bf W})\) is simply the total gravitational potential energy \(W\). Taking the trace of (2.19) we have

\[W=-\int{\rm d}^{3}{\bf x}\,\rho{\bf x}\cdot\mathbf{\nabla}\Phi, \tag{2.24}\]

which provides another useful expression for the potential energy of a body.

**2.2 Spherical systems**

**2.2.1 Newton's theorems**

Newton proved two results that enable us to calculate the gravitational potential of any spherically symmetric distribution of matter easily:

**Newton's first theorem**_A body that is inside a spherical shell of matter experiences no net gravitational force from that shell._

**Newton's second theorem**_The gravitational force on a body that lies outside a spherical shell of matter is the same as it would be if all the shell's matter were concentrated into a point at its center._Figure 2.1 illustrates the proof of Newton's first theorem. Consider the cone associated with a small solid angle \(\delta{\bf\Omega}\) centered on the point \({\bf r}\). This cone intersects the spherical shell of matter at two points, at distances \(r_{1}\) and \(r_{2}\) from \({\bf r}\). Elementary geometrical considerations assure us that the angles \(\theta_{1}\) and \(\theta_{2}\) are equal, and therefore that the masses \(\delta m_{1}\) and \(\delta m_{2}\) contained within \(\delta{\bf\Omega}\) where it intersects the shell are in the ratio \(\delta m_{1}/\delta m_{2}=(r_{1}/r_{2})^{2}\). Hence \(\delta m_{2}/r_{2}^{2}=\delta m_{1}/r_{1}^{2}\) and a particle placed at \({\bf r}\) is attracted equally in opposite directions. Summing over all cones centered on \({\bf r}\), one concludes that the body at \({\bf r}\) experiences no net force from the shell.\(\triangleleft\)

An important corollary of Newton's first theorem is that the gravitational potential inside an empty spherical shell is constant because \({\bf\nabla}\Phi=-{\bf g}=0\). Thus we may evaluate the potential \(\Phi({\bf r})\) inside the shell by calculating the integral expression (2.3) for \({\bf r}\) located at any interior point. The most convenient place for \({\bf r}\) is the center of the shell, for then all points on the shell are at the same distance \(R\), and one immediately has

\[\Phi=-{GM\over R}.\]

The proof of his second theorem eluded Newton for more than ten years. Yet with hindsight it is easy. The trick (Figure 2.2) is to compare the potential \(\Phi\) at a point \({\bf p}\) located a distance \(r\) from the center of a spherical inner shell of mass \(M\) and radius \(a\) (\(r>a\)), with the potential \(\Phi^{\prime}\) at a point \({\bf p}^{\prime}\) located a distance \(a\) from the center of an outer shell of mass \(M\) and radius \(r\). Consider the contribution \(\delta\Phi\) to the potential at \({\bf p}\) from the portion of the inner shell with solid angle \(\delta{\bf\Omega}\) located at \({\bf q}^{\prime}\). Evidently

\[\delta\Phi=-{GM\over|{\bf p}-{\bf q}^{\prime}|}{\delta{\bf\Omega}\over 4\pi}.\]

But the contribution \(\delta\Phi^{\prime}\) of the matter in the outer shell near \({\bf q}\) to the potential at \({\bf p}^{\prime}\) is

\[\delta\Phi^{\prime}=-{GM\over|{\bf p}^{\prime}-{\bf q}|}{\delta{\bf\Omega} \over 4\pi}.\]Finally, as \(|{\bf p}-{\bf q}^{\prime}|=|{\bf p}^{\prime}-{\bf q}|\) by symmetry, it follows that \(\delta\Phi=\delta\Phi^{\prime}\), and then by summation over all points \({\bf q}\) and \({\bf q}^{\prime}\) that \(\Phi=\Phi^{\prime}\). But we already know that \(\Phi^{\prime}=-GM/r\), therefore \(\Phi=-GM/r\), which is exactly the potential that would be generated by concentrating the entire mass of the inner shell at its center.\(\triangleleft\)

Alternative proofs of Newton's theorems, using the machinery of spherical harmonics, are given in SS2.4.

From Newton's first and second theorems, it follows that the gravitational attraction of a spherical density distribution \(\rho(r^{\prime})\) on a unit mass at radius \(r\) is entirely determined by the mass interior to \(r\):

\[{\bf F}(r)=-\frac{GM(r)}{r^{2}}\hat{\bf e}_{r},\] (2.27a) where \[M(r)=4\pi\int_{0}^{r}{\rm d}r^{\prime}\,r^{\prime 2}\rho(r^{\prime}). \tag{2.27b}\]

The total gravitational potential may be considered to be the sum of the potentials of spherical shells of mass \({\rm d}M(r)=4\pi\rho(r)r^{2}{\rm d}r\), so we may calculate the gravitational potential at \({\bf r}\) generated by an arbitrary spherically symmetric density distribution \(\rho({\bf r}^{\prime})\) by adding the contributions to the potential produced by shells (i) with \(r^{\prime}<r\), and (ii) with \(r^{\prime}>r\). In this way we obtain

\[\eqalign{\Phi(r)&=-\frac{G}{r}\int_{0}^{r}{\rm d}M(r^{\prime})-G\int_{r}^{ \infty}\frac{{\rm d}M(r^{\prime})}{r^{\prime}}\cr&=-4\pi G\left[\frac{1}{r}\int _{0}^{r}{\rm d}r^{\prime}\,r^{\prime 2}\rho(r^{\prime})+\int_{r}^{\infty}{\rm d}r^{ \prime}\,r^{\prime}\rho(r^{\prime})\right].} \tag{2.28}\]

It is worthwhile to check that the force \({\bf F}=-\mathbf{\nabla}\Phi\) obtained from (2.28) recovers the simple expression (2.27a).

An important property of a spherical matter distribution is its **circular speed**\(v_{\rm c}(r)\), defined to be the speed of a particle of negligible mass (a **test particle**) in a circular orbit at radius \(r\). We may readily evaluate \(v_{\rm c}\) by equating the gravitational attraction \(|{\bf F}|\) from equation (2.27a) to the centripetal acceleration \(v_{\rm c}^{2}/r\):

\[v_{\rm c}^{2}=r|{\bf F}|=r\frac{{\rm d}\Phi}{{\rm d}r}=\frac{GM(r)}{r}. \tag{2.29}\]

The associated angular frequency is called the **circular frequency**

\[\Omega\equiv\frac{v_{\rm c}}{r}=\sqrt{\frac{GM(r)}{r^{3}}}. \tag{2.30}\]The circular speed and frequency measure the mass interior to \(r\). Another important quantity is the **escape speed**\(v_{\rm e}\) defined by3

Footnote 3: This result is correct only if the potential \(\Phi(r)\to 0\) as \(r\to\infty\)—we have assumed this so far but for systems with very extended mass distributions other zero points may be necessary (cf. eq. 2.62).

\[v_{\rm e}(r)\equiv\sqrt{2|\Phi(r)|}. \tag{2.31}\]

A star at \(r\) can escape from the gravitational field represented by \(\Phi\) only if it has a speed at least as great as \(v_{\rm e}(r)\), for only then does its (positive) kinetic energy \(\frac{1}{2}v^{2}\) exceed the absolute value of its (negative) potential energy \(\Phi\). The escape speed at \(r\) depends on the mass both inside and outside \(r\).

**Potential energy of spherical systems** The simplest expression for the potential energy of a spherical body is obtained from equation (2.24). Substituting equation (2.27a) and integrating over all directions of \({\bf r}\), we obtain

\[W=-4\pi G\int_{0}^{\infty}{\rm d}r\,r\rho(r)M(r). \tag{2.32}\]

It is straightforward to show (see Problem 2.2) that the potential-energy tensor of a spherical body is **diagonal**, that is, \(W_{jk}=0\) for \(j\neq k\), and has the form

\[W_{jk}={{1\over 3}}W\delta_{jk}, \tag{2.33}\]

where \(\delta_{ij}\) is unity if \(i=j\) and zero otherwise. Such tensors are said to be **isotropic**.

#### 2.2.2 Potentials of some simple systems

It is instructive to discuss the potentials generated by several simple density distributions:

**(a) Point mass** In this case

\[\Phi(r)=-{GM\over r}\quad;\quad v_{\rm c}(r)=\sqrt{GM\over r}\quad;\quad v_{\rm e }(r)=\sqrt{2GM\over r}. \tag{2.34}\]

Potentials of this form, and orbits within them, are frequently referred to as **Keplerian** because Kepler first understood that \(v_{\rm c}\propto r^{-1/2}\) in the solar system.

**(b) Homogeneous sphere** If the density is some constant \(\rho\), we have \(M(r)={4\over 3}\pi r^{3}\rho\) and

\[v_{\rm c}=\sqrt{4\pi G\rho\over 3}r. \tag{2.35}\]Thus in this case the circular speed rises linearly with radius, and the orbital period of a mass on a circular orbit is

\[T=\frac{2\pi r}{v_{\rm c}}=\sqrt{\frac{3\pi}{G\rho}}, \tag{2.36}\]

independent of the radius of its orbit. The inverse of the angular frequency of a circular orbit is

\[\frac{r}{v_{\rm c}}=\sqrt{\frac{3}{4\pi G\rho}}=0.4886(G\rho)^{-1/2}. \tag{2.37}\]

If a small mass is released from rest at radius \(r\) in the gravitational field of a homogeneous sphere, its equation of motion is

\[\frac{{\rm d}^{2}r}{{\rm d}t^{2}}=-\frac{GM(r)}{r^{2}}=-\frac{4\pi G\rho}{3}r, \tag{2.38}\]

which is the equation of motion of a harmonic oscillator of angular frequency \(2\pi/T\). Therefore no matter what is the initial value of \(r\), the test mass will reach \(r=0\) in a quarter of a period, or in a time

\[\sqrt{\frac{3\pi}{16G\rho}}=0.767(G\rho)^{-1/2}. \tag{2.39}\]

The times in equations (2.37) and (2.39) are rather similar, and this suggests that the time taken for a particle to complete a significant fraction of its orbit is \(\sim(G\rho)^{-1/2}\), independent of the size and shape of the orbit. This result also holds for inhomogeneous systems, so long as \(\rho\) is replaced by the mean density \(\overline{\rho}\) interior to the particle's current radius. Thus we estimate the crossing time (sometimes also called the **dynamical time**) to be

\[t_{\rm cross}\simeq t_{\rm dyn}\simeq(G\,\overline{\rho})^{-1/2} \tag{2.40}\]

and shall use this as a measure of the characteristic time associated with the orbital motion of a star. Note that a complete orbital period is larger than \(t_{\rm cross}\) by a factor \(\simeq 2\pi\simeq 6\).

The potential energy of a homogeneous sphere of radius \(a\) and density \(\rho\) is conveniently obtained from equation (2.32). We have \(M(r)=\frac{4}{3}\pi\rho r^{3}\), and therefore

\[W=-\frac{16\pi^{2}}{3}G\rho^{2}\int_{0}^{a}{\rm d}r\,r^{4}=-\frac{16}{15}\pi^ {2}G\rho^{2}a^{5}=-\frac{3}{5}\frac{GM^{2}}{a}. \tag{2.41}\]

Sometimes it is useful to characterize the size of a system that lacks a sharp boundary by quoting the **gravitational radius**, which is defined as

\[r_{\rm g}\equiv\frac{GM^{2}}{|W|}. \tag{2.42}\]For a homogeneous sphere of radius \(a\), \(r_{\rm g}=\frac{5}{3}a\).

From equation (2.28) the gravitational potential of a homogeneous sphere of radius \(a\) is

\[\Phi(r)=\left\{\begin{array}{ll}-2\pi G\rho(a^{2}-\frac{1}{3}r^{2})&(r<a),\\ -\frac{4\pi G\rho a^{3}}{3r}&(r>a).\end{array}\right. \tag{2.43}\]

**(c) Plummer model** We might expect that in many spherical systems the density is roughly constant near the center, and falls to zero at large radii. The potential of a system of this type would be proportional to \(r^{2}+\)_constant_ at small radii and to \(r^{-1}\) at large radii. A simple potential with these properties is the **Plummer model**

\[\Phi=-\frac{GM}{\sqrt{r^{2}+b^{2}}}. \tag{2.44a}\]

The linear scale of the system that generates this potential is set by the **Plummer scale length**\(b\), while \(M\) is the system's total mass.

From equation (B.53) for \(\nabla^{2}\) in spherical polar coordinates we have

\[\nabla^{2}\Phi=\frac{1}{r^{2}}\frac{\rm d}{{\rm d}r}\left(r^{2}\frac{{\rm d} \Phi}{{\rm d}r}\right)=\frac{3GMb^{2}}{(r^{2}+b^{2})^{5/2}}. \tag{2.45}\]

Thus from Poisson's equation (2.10) we have that the density corresponding to the potential (2.44a) is

\[\rho(r)=\frac{3M}{4\pi b^{3}}\left(1+\frac{r^{2}}{b^{2}}\right)^{-5/2}. \tag{2.44b}\]

The potential energy of a Plummer model is

\[W=-\frac{3\pi GM^{2}}{32b}. \tag{2.46}\]

Plummer (1911) used the potential-density pair that is described by equations (2.44) to fit observations of globular clusters. We shall encounter it again in SS4.3.3a as a member of the family of stellar systems known as polytropes.

**(d) Isochrone potential** The position of a star orbiting in a Plummer potential cannot be given in terms of elementary functions. However, in Chapter 3 we shall see that all orbits are analytic in the **isochrone potential**

\[\Phi(r)=-\frac{GM}{b+\sqrt{b^{2}+r^{2}}}\,, \tag{2.47}\]which owes its name to a property of its orbits that we shall derive in SS3.1c. By equation (2.29) we have for the circular speed at radius \(r\)

\[v_{\rm c}^{2}(r)=\frac{GMr^{2}}{(b+a)^{2}a},\] (2.48a) where \[a\equiv\sqrt{b^{2}+r^{2}}. \tag{2.48b}\]

When \(r\) is large \(v_{\rm c}\simeq\sqrt{GM/r}\), as required for a system of finite mass and extent. By Poisson's equation the density associated with the isochrone potential is

\[\rho(r)=\frac{1}{4\pi G}\frac{1}{r^{2}}\frac{\rm d}{\rm d r}\left(r^{2}\frac{ \rm d\Phi}{\rm d r}\right)=M\left[\frac{3(b+a)a^{2}-r^{2}(b+3a)}{4\pi(b+a)^{3} a^{3}}\right]. \tag{2.49}\]

Thus the central density is

\[\rho(0)=\frac{3M}{16\pi b^{3}}, \tag{2.50}\]

and at large radii the density tends to

\[\rho(r)\simeq\frac{bM}{2\pi r^{4}}\ \ \ \ (r\gg b). \tag{2.51}\]

**(e) Modified Hubble model** The surface brightnesses of many elliptical galaxies may be approximated over a large range of radii by the **Hubble**-**Reynolds law

\[I_{\rm H}(R)=\frac{I_{0}}{(1+R/R_{\rm H})^{2}}, \tag{2.52}\]

or the \(R^{1/4}\) law (eq. 1.17 with \(m=4\)). It is possible to solve for the spherical luminosity density \(j(r)\) that generates a given axisymmetric brightness

Figure 2.3: Projection of a spherical body along the line of sight.

### Box 2.1: Definitions of surface brightness

Two definitions of surface brightness are used in the astronomical literature. Consider the radiative power that enters a telescope of aperture \(\mathrm{d}A\) at normal incidence from directions in the element of solid angle \(\mathrm{d}^{2}\Omega\) due to the distribution of luminosity density \(j(\mathbf{r})\). We take the coordinate origin to lie at the center of the telescope aperture. Then in the distance range \((r,r+\mathrm{d}r)\) the volume that lies within the given solid-angle element is \(r^{2}\mathrm{d}r\,\mathrm{d}^{2}\Omega\), and the associated luminosity is \(\mathrm{d}L=j(\mathbf{r})r^{2}\mathrm{d}r\,\mathrm{d}^{2}\Omega\). A fraction \(\mathrm{d}A/(4\pi r^{2})\) of this luminosity enters the telescope, so the power received in the given solid-angle element from the given distance range is \((4\pi)^{-1}j(\mathbf{r})\mathrm{d}r\,\mathrm{d}^{2}\Omega\,\mathrm{d}A\). Summing over all distances and dividing by \(\mathrm{d}^{2}\Omega\,\mathrm{d}A\) we find that the flux per unit solid angle is

\[\widehat{I}=\frac{1}{4\pi}\int\mathrm{d}r\,j(\mathbf{r}).\]

The surface brightness \(\widehat{I}\) might be reported in units of \(\,\mathrm{W}\,\mathrm{m}^{-2}\,\mathrm{sr}^{-1}\).

The second definition of surface brightness is the integral

\[I=\int\mathrm{d}r\,j(\mathbf{r}).\]

\(I\) is the galaxy's luminosity per unit area when viewed from the given direction, and is conveniently given in units of solar luminosities per square parsec. Surface brightnesses are often reported by observers as so many magnitudes per square arcsecond, for example \(20\,\mathrm{mag}\,\mathrm{arcsec}^{-2}\), meaning that in one square arcsecond of the image as much radiation is received as from a 20th magnitude star. In this book we follow the second convention and call \(I\) the "surface brightness."Using the substitution \(y\equiv z/\sqrt{a^{2}+R^{2}}\), we obtain the **modified Hubble model**

\[I_{\rm h}(R)=\frac{2j_{0}a}{1+R^{2}/a^{2}}\int_{0}^{\infty}\frac{{\rm d}y}{(1+y^ {2})^{3/2}}=\frac{2j_{0}a}{1+R^{2}/a^{2}}. \tag{2.55}\]

Thus \(I_{\rm h}(a)=\frac{1}{2}I_{\rm h}(0)\), so \(a\) is the core radius as defined on page 30. At large \(R\), \(I_{\rm h}(R)\propto R^{-2}\), just as in the Hubble-Reynolds law (2.52). However, the Hubble-Reynolds law and the modified Hubble model behave quite differently near the center: while the luminosity density \(j_{\rm h}\) is well behaved at the origin, in the Hubble-Reynolds law, \({\rm d}I_{\rm H}/{\rm d}R\neq 0\) at \(R=0\), which implies that the luminosity density \(j_{\rm H}(r)\) diverges as \(r\to 0\) (Hubble 1930).

Using equation (2.28) we can calculate the potential that would be generated by the modified Hubble model if its mass were distributed in the same way as its light. If \(\rho(r)=\Upsilon j(r)\), where \(\Upsilon\) is the constant mass-to-light ratio in the galaxy, one has

\[M_{\rm h}(r)=4\pi a^{3}\Upsilon j_{0}\bigg{[}\ln\left(\frac{r}{a}+\sqrt{1+ \frac{r^{2}}{a^{2}}}\right)-\frac{r}{a}\bigg{(}1+\frac{r^{2}}{a^{2}}\bigg{)}^ {-1/2}\bigg{]}, \tag{2.56}\]

\[\Phi_{\rm h}=-\frac{GM_{\rm h}(r)}{r}-\frac{4\pi G\Upsilon j_{0}a^{2}}{\sqrt{1 +(r/a)^{2}}}. \tag{2.57}\]

One feature of both the Hubble-Reynolds law and the modified Hubble model is that the mass diverges logarithmically at large \(r\); from equation (2.56) \(M_{\rm h}\simeq 4\pi a^{3}\Upsilon j_{0}\left[\ln(2r/a)-1\right]\) for \(r\gg a\). In practice, a galaxy must have a finite mass, so \(j(r)\) must fall below \(j_{\rm h}(r)\) at sufficiently large \(r\). Nevertheless, the potential \(\Phi_{\rm h}\) is finite, and in fact rather nearly equal to \(-GM_{\rm h}(r)/r\) whenever \(r\gg a\). This behavior indicates that from the gravitational point of view the density distribution of equation (2.53) behaves much like a point mass at large radii. The circular speed is shown in Figure 2.4. It peaks at \(r=2.9a\) and then falls nearly as steeply as in the Keplerian case.

**(f) Power-law density model**  Many galaxies have luminosity profiles that approximate a power law over a large range in radius. Consider the

Figure 2.4: Circular speed versus radius for a body whose projected density follows the modified Hubble model (2.55). The circular speed \(v_{\rm c}\) is plotted in units of \(\sqrt{Gj_{0}\Upsilon a^{2}}\).

structure of a system in which the mass density drops off as some power of the radius:

\[\rho(r)=\rho_{0}\left(\frac{r_{0}}{r}\right)^{\alpha}. \tag{2.58}\]

The surface density of this system is

\[\Sigma(R)=\frac{\rho_{0}r_{0}^{\alpha}}{R^{\alpha-1}}\frac{(-\frac{1}{2})!( \frac{\alpha-3}{2})!}{(\frac{\alpha-2}{2})!}. \tag{2.59}\]

We assume that \(\alpha<3\), since only in this case is the mass interior to \(r\) finite, namely

\[M(r)=\frac{4\pi\rho_{0}r_{0}^{\alpha}}{3-\alpha}r^{3-\alpha}. \tag{2.60}\]

From equations (2.60) and (2.29) the circular speed is given by

\[v_{\rm c}^{2}(r)=\frac{4\pi G\rho_{0}r_{0}^{\alpha}}{3-\alpha}r^{2-\alpha}. \tag{2.61}\]

In Chapter 1 we saw that the circular-speed curves of many galaxies are remarkably flat. Equation (2.61) suggests that the mass density in these galaxies is proportional to \(r^{-2}\), corresponding to \(\alpha=2\). In SS4.3.3(b) we shall find that this is the density profile characteristic of a stellar-dynamical model called the "singular isothermal sphere."

The potential difference between radius \(r\) and the reference radius \(r_{0}\) is

\[\eqalign{\Phi(r)-\Phi(r_{0})&=G\int_{r_{0}}^{r}{\rm d}r^{\prime}\,\frac{M(r^{ \prime})}{r^{\prime 2}}=\frac{4\pi G\rho_{0}r_{0}^{\alpha}}{3-\alpha}\int_{r_{0}}^ {r}{\rm d}r^{\prime}\,r^{\prime(1-\alpha)}\cr&=\left\{\begin{array}{ll}\frac {v_{\rm c}^{2}(r_{0})-v_{\rm c}^{2}(r)}{\alpha-2}&\hbox{for $\alpha\neq 2$}\\ v_{\rm c}^{2}\ln(r/r_{0})&\hbox{for $\alpha=2$}\end{array}\right.\cr} \tag{2.62}\]

Equation (2.60) shows that \(M(r)\) diverges at large \(r\) for all \(\alpha<3\). However, such models are still useful because by Newton's first theorem, the mass exterior to any radius \(r\) does not affect the dynamics interior to \(r\). For \(3>\alpha>2\), \(v_{\rm c}^{2}(r)\) decreases with increasing \(r\) (eq. 2.61), so by (2.62) there is only a finite potential difference between radius \(r\) and infinity. In fact, the escape speed \(v_{\rm e}(r)\) from radius \(r\) is given by

\[v_{\rm e}^{2}(r)=2[\Phi(\infty)-\Phi(r)]=2\frac{v_{\rm c}^{2}(r)}{\alpha-2} \ \ \ \ \ (\alpha>2). \tag{2.63}\]

For \(\alpha<2\), \(\Phi(r)\) grows without limit as \(r\to\infty\), so the interpretation of \(\Phi\) as the energy per unit mass required to remove a particle to infinity is no longer valid. The potential is nevertheless a useful concept because the gravitational field is given by \({\bf g}=-{\bf\nabla}\Phi\). Since the light distributions of elliptical galaxies suggest \(\alpha\simeq 3\) at large \(r\) (see eq. 2.53), while the flatness of the circular-speed curves in spiral galaxies suggest \(\alpha\simeq 2\), it is clear that the escape speeds of galaxies are very uncertain.

**(g) Two-power density models** The luminosity density of many elliptical galaxies can be approximated as a power law in radius at both the largest and smallest observable radii, with a smooth transition between these power laws at intermediate radii (BM SS4.3.1). Numerical simulations of the clustering of dark-matter particles suggest that the mass density within a dark halo has a similar structure (SS9.3). For these reasons much attention has been devoted to models in which the density is given by

\[\rho(r)={\rho_{0}\over(r/a)^{\alpha}(1+r/a)^{\beta-\alpha}}. \tag{2.64}\]

With \(\beta=4\) these models have particularly simple analytic properties, and are known as **Dehnen models** (BM eq. 4.15; Dehnen 1993; Tremaine et al. 1994). BM Table 4.5 gives formulae for the projected surface density of Dehnen models for the cases \(\alpha=0\), \(1\), \(3\over 2\), and \(2\). The model with \(\alpha=1\) and \(\beta=4\) is called a **Hernquist model** (Hernquist 1990), while that with \(\alpha=2\) and \(\beta=4\) is called a **Jaffe model** (Jaffe 1983). Dehnen models with \(\alpha\) in the range \((0.6,2)\) provide reasonable models of the centers of elliptical galaxies (BM SS4.3.1).

Dark halos can be modeled by equation (2.64) with \(\beta\simeq 3\) and \(\alpha\) in the range \((1,1.5)\). The model with \((\alpha,\beta)=(1,3)\) is called the **NFW model** after Navarro, Frenk, & White (1995). The NFW formula contains two free parameters: \(\rho_{0}\) and \(a\). Navarro, Frenk, & White (1996) showed that the values taken by these parameters for the halos that formed in their simulations were strongly correlated, so the halos were essentially members of a one-parameter family. The conventional choice of parameter is the distance \(r_{200}\) from the center of the halo at which the mean density is 200 times the cosmological critical density, \(\rho_{\rm c}\) (eq. 1.52).4 A more physical choice of parameter is the mass interior to \(r_{200}\), which is \(M=200\rho_{\rm c}{4\over 3}\pi r_{200}^{3}\). The **concentration** of the halo is \(c\equiv r_{200}/a\). The central result of Navarro, Frenk, & White (1996) is that at a given value of \(M\) (and therefore \(r_{200}\)), halos show a relatively small scatter in \(c\). The mean value of \(c\) falls from \(\simeq 16\) to \(\simeq 6\) as the halo mass increases from \(\sim 3\times 10^{11}\,{\cal M}_{\odot}\) to \(\sim 3\times 10^{15}\,{\cal M}_{\odot}\).

Footnote 4: In §9.2.1 we shall show that \(r_{200}\) approximately divides the interior region in which material has crossed the halo at least once from the exterior one in which matter is still falling in to the halo for the first time.

According to (2.64) the mass interior to radius \(r\) is

\[M(r)=4\pi\rho_{0}a^{3}\int_{0}^{r/a}{\rm d}s\,{s^{2-\alpha}\over(1+s)^{\beta- \alpha}}. \tag{2.65}\]\[M(r)=4\pi\rho_{0}a^{3}\times\left\{\begin{array}{ll}\frac{r/a}{1+ r/a}&\mbox{for a Jaffe model}\\ \frac{(r/a)^{2}}{2(1+r/a)^{2}}&\mbox{for a Hernquist model}\\ \ln(1+r/a)-\frac{r/a}{1+r/a}&\mbox{for a NFW model.}\end{array}\right. \tag{2.66}\]

In the Jaffe and Hernquist models the mass asymptotes to a finite value as \(r\to\infty\), while in the NFW model the mass diverges logarithmically with \(r\). The circular speed in each model, which follows immediately from (2.66) and (2.29), is plotted in Figure 2.5. From equation (2.29) the potentials of the three models are

\[\Phi =-G\int_{r}^{\infty}\mathrm{d}r\,\frac{M(r)}{r^{2}}\] \[=-4\pi G\rho_{0}a^{2}\times\left\{\begin{array}{ll}\frac{ \ln\left(1+a/r\right)}{2(1+r/a)}&\mbox{for a Hernquist model}\\ \frac{\ln(1+r/a)}{r/a}&\mbox{for a NFW model.}\end{array}\right. \tag{2.67}\]

From these formulae and equations (2.32) and (2.42) it is straightforward to show that the Jaffe and Hernquist models have gravitational radii \(r_{\rm g}=2a\) and \(6a\), respectively, while for the NFW model \(r_{\rm g}\) is undefined.

Figure 2.5: Circular speed versus radius for the Jaffe, Hernquist, and NFW models.

### 2.3 Potential-density pairs for flattened systems

Later in this chapter we will show how to obtain the gravitational potentials of systems of arbitrary shape. However, we shall find that the calculation of the gravitational potential and field generated by a given distribution of matter is often an arduous task that leads to cumbersome formulae involving special functions, or numerical calculations. Fortunately, for many purposes it suffices to represent a galaxy by a simple model that has the same gross structure as the galaxy. In this section we describe families of potentials that are generated by fairly simple and realistic axisymmetric density distributions. These potentials help us to understand how the gravitational potential of an initially spherical body is affected by flattening, and in later chapters we shall use several of these potentials to illustrate features of dynamics in axisymmetric galaxies.

#### 2.3.1 Kuzmin models and generalizations

Consider the axisymmetric potential

\[\Phi_{\rm K}(R,z)=-\frac{GM}{\sqrt{R^{2}+(a+|z|)^{2}}}\quad(a\geq 0). \tag{2.68a}\]

As Figure 2.6 indicates, at points with \(z<0\), \(\Phi_{\rm K}\) is identical with the potential of a point mass \(M\) located at the point \((R,z)=(0,a)\); and when \(z>0\), \(\Phi_{\rm K}\) coincides with the potential generated by a point mass at \((0,-a)\). Hence \(\nabla^{2}\Phi_{\rm K}\) must vanish everywhere except on the plane \(z=0\). By applying Gauss's theorem (2.12) to a flat volume that contains a small portion of the plane \(z=0\), we conclude that \(\Phi_{\rm K}\) is generated by the surface density

\[\Sigma_{\rm K}(R)=\frac{aM}{2\pi(R^{2}+a^{2})^{3/2}}. \tag{2.68b}\]

The potential-density pair of equations (2.68) was introduced by Kuzmin (1956), but it is often referred to as "Toomre's model 1" because it became widely known in the West only after Toomre (1963) unknowingly re-derived it.

Consider next the potential

\[\Phi_{\rm M}(R,z)=-\frac{GM}{\sqrt{R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{2}}}.\] (2.69a) When \[a=0\], \[\Phi_{\rm M}\] reduces to Plummer's spherical potential ( 2.44a ), and when \[b=0\], \[\Phi_{\rm M}\] reduces to Kuzmin's potential of a razor-thin disk ( 2.68a ). Thus, depending on the choice of the two parameters \[a\] and \[b\], \[\Phi_{\rm M}\] can represent the potential of anything from an infinitesimally thin disk to a spherical system. If we calculate \[\nabla^{2}\Phi_{\rm M}\], we find that the mass distribution with which it is associated is (Miyamoto & Nagai 1975 ) \[\rho_{\rm M}(R,z)=\left(\frac{b^{2}M}{4\pi}\right)\frac{aR^{2}+(a+3\sqrt{z^{2} +b^{2}}\,)(a+\sqrt{z^{2}+b^{2}}\,)^{2}}{\left[R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{ 2}\right]^{5/2}(z^{2}+b^{2})^{3/2}}. \tag{2.69b}\]

In Figure 2.7 we show contour plots of \(\rho_{\rm M}(R,z)\) for various values of \(b/a\). When \(b/a\simeq 0.2\), these are qualitatively similar to the light distributions of disk galaxies, although there are quantitative differences. For example, from equation (2.69b) we have that \(\rho(R,0)\propto R^{-3}\) when \(R\) is large, whereas the brightness profiles of disks fall off at least as fast as \(\exp(-R/R_{\rm d})\) (eq. 1.7).

Since Poisson's equation is linear in \(\Phi\) and \(\rho\), the difference between any two potential-density pairs is itself a potential-density pair. Therefore, if we differentiate a potential-density pair with respect to one of its parameters, we obtain a new potential-density pair. For example, Toomre (1963) derived a family of potential-density pairs by differentiating \(\Phi_{\rm K}(R,z)/a\)\(n\) times with respect to \(a^{2}\). Similarly, Satoh (1980) obtained a series of spherical potential-density pairs by differentiating \(b^{-2}\) times the Plummer potential and density (eq. 2.44) \(n\) times with respect to \(b^{2}\). He flattened these potentials by replacing \(r^{2}+b^{2}\) with \(R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{2}\), and in the limit \(n\to\infty\) obtained

\[\Phi_{\rm S}(R,z)=-\frac{GM}{S},\] (2.70a) where \[S^{2}\equiv R^{2}+z^{2}+a\left(a+2\sqrt{z^{2}+b^{2}}\,\right).\] (2.70c) The corresponding density distribution follows from Poisson's equation: \[\rho_{\rm S}(R,z)=\frac{ab^{2}M}{4\pi S^{3}(z^{2}+b^{2})}\left[\frac{1}{\sqrt {z^{2}+b^{2}}}+\frac{3}{a}\left(1-\frac{R^{2}+z^{2}}{S^{2}}\right)\right]. \tag{2.70b}\]

Figure 2.8 shows that at large \(b/a\) the isodensity surfaces \(\Phi_{\rm S}\) are more nearly elliptical than those of \(\Phi_{\rm M}\).

#### 2.3.2 Logarithmic potentials

Since the Kuzmin and other models in the previous subsection all have finite mass, the circular speed associated with these potentials falls off in Keplerian fashion, \(v_{\rm c}\propto R^{-1/2}\), at large \(R\). However, in Chapter 1 it was shown that the circular-speed curves of spiral galaxies tend to be flat at large radii. If at large \(R\), \(v_{\rm c}=v_{0}\), a constant, then \({\rm d}\Phi/{\rm d}R=v_{0}^{2}/R\), and hence \(\Phi\propto v_{0}^{2}/R\).

Figure 2.7: Contours of equal density in the \((R,z)\) plane for the Miyamoto–Nagai density distribution (2.69b) when: \(b/a=0.2\) (top); \(b/a=1\) (middle); \(b/a=5\) (bottom). There are two contours per decade, and the highest contour levels are \(0.3M/a^{3}\) (top), \(0.03M/a^{3}\) (middle), and \(0.001M/a^{3}\) (bottom).

\(v_{0}^{2}\ln R+\mbox{\it constant}\) in this region. Therefore, consider the potential

\[\Phi_{\rm L}={{1\over 2}}v_{0}^{2}\ln\left(R_{\rm c}^{2}+R^{2}+{z^{2} \over q_{\Phi}^{2}}\right)+\mbox{constant},\] (2.71a) where \[R_{\rm c}\] and \[v_{0}\] are constants, and \[q_{\Phi}\] is the axis ratio of the equipotential surfaces. The circular speed at radius \[R\] in the equatorial plane of \[\Phi_{\rm L}\] is \[v_{\rm c}={v_{0}R\over\sqrt{R_{\rm c}^{2}+R^{2}}}. \tag{2.71b}\]

The density distribution to which \(\Phi_{\rm L}\) corresponds is

\[\rho_{\rm L}(R,z)={v_{0}^{2}\over 4\pi Gq_{\Phi}^{2}}\ {(2q_{\Phi}^{2}+1)R_{ \rm c}^{2}+R^{2}+(2-q_{\Phi}^{-2})z^{2}\over(R_{\rm c}^{2}+R^{2}+z^{2}q_{\Phi}^ {-2})^{2}}. \tag{2.71c}\]

Figure 2.8: Contours of equal density in the \((R,z)\) plane for Satoh’s density distribution (2.70c) when: \(b/a=1\) (top); \(b/a=10\) (bottom). There are two contours per decade, and the highest contour levels are \(0.1M/a^{3}\) (top), and \(0.001M/a^{3}\) (bottom).

At small \(R\) and \(z\), \(\rho_{\rm L}\) tends to a constant value, and when \(R\) or \(|z|\) is large, \(\rho_{\rm L}\) falls off as \(R^{-2}\) or \(z^{-2}\).

The equipotential surfaces of \(\Phi_{\rm L}\) are spheroids5 of axial ratio \(q_{\Phi}\), but Figure 2.9 shows that the equidensity surfaces are rather flatter and can deviate strongly from spheroids. In fact, if we define the axial ratio \(q_{\rho}\) of the isodensity surfaces by the ratio \(z_{m}/R_{m}\) of the distances down the \(z\) and \(R\) axes at which a given isodensity surface cuts the \(z\) axis and the \(x\) or \(y\) axis, we find

Footnote 5: A **spheroid** is the surface generated by rotating an ellipse about one of its principal axes. An **oblate**, or flattened, spheroid is generated if the axis of rotation is the minor axis, and a **prolate**, or elongated, spheroid is generated if this axis is the major axis.

\[q_{\rho}^{2}\simeq\frac{1+4q_{\Phi}^{2}}{2+3/q_{\Phi}^{2}}\quad(r\ll R_{\rm c}) \tag{2.72a}\]or

\[q_{\rho}^{2}\simeq q_{\Phi}^{4}\left(2-\frac{1}{q_{\Phi}^{2}}\right)\quad(r\gg R_ {c}). \tag{2.72b}\]

Outside the core, the flattening \(1-q_{\Phi}\) of the potential is only about a third that of the density distribution: \(1-q_{\Phi}\simeq\frac{1}{3}(1-q_{\rho})\). The density \(\rho_{\rm L}\) becomes negative on the \(z\) axis when \(q_{\Phi}<1/\surd 2=0.707\).

#### 2.3.3 Poisson's equation in very flattened systems

In any axisymmetric system with density \(\rho(R,z)\), Poisson's equation can be written (eq. B.52)

\[\frac{\partial^{2}\Phi}{\partial z^{2}}=4\pi G\rho(R,z)+\frac{1}{R}\frac{ \partial}{\partial R}\left(RF_{R}\right), \tag{2.73}\]

where \(F_{R}=-\partial\Phi/\partial R\) is the radial force. Now consider, for example, the Miyamoto-Nagai potential-density pair given by equations (2.69). As the parameter \(b\to 0\), the density distribution becomes more and more flattened, and at fixed \(R\) the density in the plane \(z=0\) becomes larger and larger as \(b^{-1}\). However, the radial force \(F_{R}\) remains well behaved as \(b\to 0\); indeed, in the limit \(b=0\), \(F_{R}=-\partial\Phi_{\rm K}/\partial R\), where \(\Phi_{\rm K}(R,z)\) is simply the Kuzmin potential (2.68a). Thus, near \(z=0\) the first term on the right side of equation (2.73) becomes very large compared to the second, and Poisson's equation simplifies to the form

\[\frac{\partial^{2}\Phi(R,z)}{\partial z^{2}}=4\pi G\rho(R,z). \tag{2.74}\]

This result applies to almost any thin disk system. It implies that the vertical variation of the potential at a given radius \(R\) depends only on the density distribution at that radius. Effectively, this means that the solution of Poisson's equation in a thin disk can be decomposed into two steps: (i) Approximate the thin disk as a surface density layer of zero thickness and determine the potential in the plane of the disk \(\Phi(R,0)\) using the models of this section or the more general techniques of SS2.6. (ii) At each radius \(R\) solve equation (2.74) to find the vertical variation of \(\Phi(R,z)\).

Thus we have

\[\Phi(R,z)=\Phi(R,0)+\Phi_{z}(R,z)\] (2.75a) where \[\Phi_{z}(R,z)\equiv 4\pi G\int_{0}^{z}{\rm d}z^{\prime}\int_{0}^{z^{\prime}}{ \rm d}z^{\prime\prime}\rho(R,z^{\prime\prime})+a(R)z. \tag{2.75b}\]

The constant of integration, \(a\), is zero if the disk is symmetric around the equatorial plane.

### 2.4 Multipole expansion

In the last section we encountered a number of axisymmetric density distributions that give rise to potentials of known form. By adding a few of these distributions together one can obtain quite a wide range of model galaxies that have readily available potentials. However, for many purposes one requires a systematic procedure for calculating the potential of an arbitrary density distribution to whatever accuracy one pleases. The next few sections are devoted to this task.

The first such technique, based on spherical harmonics, works best for systems that are neither very flattened nor very elongated. Hence it is a good method for calculating the potentials of bulges and dark-matter halos (SSSS1.1.2 and 1.1.3).

Our first step is to obtain the potential of a thin spherical shell of variable surface density. Since the shell has negligible thickness, the task of solving Poisson's equation \(\nabla^{2}\Phi=4\pi G\rho\) reduces to that of solving Laplace's equation \(\nabla^{2}\Phi=0\) inside and outside the shell, subject to suitable boundary conditions at infinity, at the origin, and on the shell. Now in spherical coordinates Laplace's equation is (eq. B.53)

\[\frac{1}{r^{2}}\frac{\partial}{\partial r}\left(r^{2}\frac{\partial\Phi}{ \partial r}\right)+\frac{1}{r^{2}\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta\frac{\partial\Phi}{\partial\theta}\right)+\frac{1}{r^{2}\sin^ {2}\theta}\frac{\partial^{2}\Phi}{\partial\phi^{2}}=0. \tag{2.76}\]

This may be solved by the method of **separation of variables**. We seek special solutions that are the product of functions of one variable only:

\[\Phi(r,\theta,\phi)=R(r)P(\theta)Q(\phi). \tag{2.77a}\]

Substituting equation (2.77a) into (2.76) and rearranging, we obtain

\[\frac{\sin^{2}\theta}{R}\frac{\mathrm{d}}{\mathrm{d}r}\left(r^{2}\frac{ \mathrm{d}R}{\mathrm{d}r}\right)+\frac{\sin\theta}{P}\frac{\mathrm{d}}{ \mathrm{d}\theta}\left(\sin\theta\frac{\mathrm{d}P}{\mathrm{d}\theta}\right)= -\frac{1}{Q}\frac{\mathrm{d}^{2}Q}{\mathrm{d}\phi^{2}}. \tag{2.77b}\]

The left side of this equation does not depend on \(\phi\), and the right side does not depend on \(r\) or \(\theta\). It follows that both sides are equal to some constant, say \(m^{2}\). Hence

\[-\frac{1}{Q}\frac{\mathrm{d}^{2}Q}{\mathrm{d}\phi^{2}}=m^{2}, \tag{2.78a}\] \[\frac{\sin^{2}\theta}{R}\frac{\mathrm{d}}{\mathrm{d}r}\left(r^{2}\frac{ \mathrm{d}R}{\mathrm{d}r}\right)+\frac{\sin\theta}{P}\frac{\mathrm{d}}{ \mathrm{d}\theta}\left(\sin\theta\frac{\mathrm{d}P}{\mathrm{d}\theta}\right)= m^{2}. \tag{2.78b}\]

Equation (2.78a) may be immediately integrated to

\[Q(\phi)=Q_{m}^{+}\mathrm{e}^{\mathrm{i}m\phi}+Q_{m}^{-}\mathrm{e}^{-\mathrm{ i}m\phi}. \tag{2.79a}\]We require \(\Phi\) to be a periodic function of \(\phi\) with period \(2\pi\), so \(m\) can take only integer values. Since equations (2.78) depend only on \(m^{2}\), we could restrict our attention to non-negative values of \(m\) without loss of generality. However, a simpler convention is to allow \(m\) to take both positive and negative values, so the second exponential in equation (2.79a) becomes redundant, and we may write simply

\[Q=Q_{m}{\rm e}^{{\rm i}m\phi}\quad\,(m=\ldots,-1,0,1,\ldots). \tag{2.79b}\]

Equation (2.78b) can be written

\[\frac{1}{R}\frac{{\rm d}}{{\rm d}r}\left(r^{2}\frac{{\rm d}R}{{\rm d}r}\right) =\frac{m^{2}}{\sin^{2}\theta}-\frac{1}{P\sin\theta}\frac{{\rm d}}{{\rm d} \theta}\left(\sin\theta\frac{{\rm d}P}{{\rm d}\theta}\right). \tag{2.80}\]

Since the left side of this equation does not depend on \(\theta\) and the right side does not depend on \(r\), both sides must equal some constant, which we write as \(l(l+1)\). Thus equation (2.80) implies

\[\frac{{\rm d}}{{\rm d}r}\left(r^{2}\frac{{\rm d}R}{{\rm d}r}\right)-l(l+1)R=0,\] (2.81a) and in terms of \[x\equiv\cos\theta\], \[\frac{{\rm d}}{{\rm d}x}\left[(1-x^{2})\frac{{\rm d}P}{{\rm d}x}\right]-\frac {m^{2}}{1-x^{2}}P+l(l+1)P=0. \tag{2.81b}\]

Two linearly independent solutions of equation (2.81a) are

\[R(r)=Ar^{l}\quad\text{and}\quad R(r)=Br^{-(l+1)}. \tag{2.82}\]

The solutions of equation (2.81b) are associated Legendre functions \(P_{l}^{m}(x)\) (see Appendix C.5). Physically acceptable solutions exist only when \(l\) is an integer. Without loss of generality we can take \(l\) to be non-negative, and then physically acceptable solutions exist only for \(|m|\leq l\). When \(m=0\) the solutions are simply polynomials in \(x\), called Legendre polynomials \(P_{l}(x)\).

Rather than write out the product \(P_{l}^{m}(\cos\theta){\rm e}^{{\rm i}m\phi}\) again and again, it is helpful to define the spherical harmonic \({\rm Y}_{l}^{m}(\theta,\phi)\), which is equal to \(P_{l}^{m}(\cos\theta){\rm e}^{{\rm i}m\phi}\) times a constant chosen so the \({\rm Y}_{l}^{m}\) satisfy the orthogonality relation (see eq. C.44)

\[\begin{split}\int{\rm d}^{2}\Omega\,{\rm Y}_{l}^{m\,*}(\mathbf{\Omega }){\rm Y}_{l^{\prime}}^{m^{\prime}}(\mathbf{\Omega})&\equiv\int_{0 }^{\pi}{\rm d}\theta\,\sin\theta\int_{0}^{2\pi}{\rm d}\phi\,{\rm Y}_{l}^{m\,*} (\theta,\phi){\rm Y}_{l^{\prime}}^{m^{\prime}}(\theta,\phi)\\ &=\delta_{ll^{\prime}}\delta_{mm^{\prime}},\end{split} \tag{2.83}\]

where we have used \(\mathbf{\Omega}\) as a shorthand for \((\theta,\phi)\) and \({\rm d}^{2}\Omega\) for \(\sin\theta\,{\rm d}\theta\,{\rm d}\phi\). The spherical harmonics with \(l\leq 2\) are listed in equation (C.50).

Putting all these results together, we have from equations (2.77a), (2.79b), and (2.82) that

\[\Phi_{lm}(r,\boldsymbol{\Omega})=\left(A_{lm}r^{l}+B_{lm}r^{-(l+1)}\right){\rm Y }_{l}^{m}(\boldsymbol{\Omega}) \tag{2.84}\]

is a solution of \(\nabla^{2}\Phi=0\) for all non-negative integers \(l\) and integer \(m\) in the range \(-l\leq m\leq l\).

Now let us apply these results to the problem of determining the potential of a thin shell of radius \(a\) and surface density \(\sigma(\boldsymbol{\Omega})\). We write the potential internal and external to the shell as

\[\Phi_{\rm int}(r,\boldsymbol{\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l} \left(A_{lm}r^{l}+B_{lm}r^{-(l+1)}\right){\rm Y}_{l}^{m}(\boldsymbol{\Omega}) \quad(r\leq a),\] (2.85a) and \[\Phi_{\rm ext}(r,\boldsymbol{\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l} \left(C_{lm}r^{l}+D_{lm}r^{-(l+1)}\right){\rm Y}_{l}^{m}(\boldsymbol{\Omega}) \quad(r\geq a). \tag{2.85b}\]

The potential at the center must be non-singular, so \(B_{lm}=0\) for all \(l,m\). Similarly, the potential at infinity must be zero, so \(C_{lm}=0\) for all \(l,m\). Furthermore, \(\Phi_{\rm ext}(a,\boldsymbol{\Omega})\) must equal \(\Phi_{\rm int}(a,\boldsymbol{\Omega})\) because no work can be done in passing through an infinitesimally thin shell. Hence from equations (2.85) we have

\[\sum_{l=0}^{\infty}\sum_{m=-l}^{l}A_{lm}a^{l}{\rm Y}_{l}^{m}(\boldsymbol{\Omega })=\sum_{l=0}^{\infty}\sum_{m=-l}^{l}D_{lm}a^{-(l+1)}{\rm Y}_{l}^{m}( \boldsymbol{\Omega}). \tag{2.86}\]

The coefficients \(A_{lm}a^{l}\) etc. of each spherical harmonic \({\rm Y}_{l}^{m}\) on the two sides of equation (2.86) must be equal, as can be shown by multiplying both sides of the equation by \({\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}(\boldsymbol{\Omega})\), integrating over \(\boldsymbol{\Omega}\), and using the orthogonality relation (2.83). Therefore, from equation (2.86) we have

\[D_{lm}=A_{lm}a^{2l+1}. \tag{2.87}\]

Now let us expand the surface density of the thin shell as

\[\sigma(\boldsymbol{\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\sigma_{lm}{\rm Y }_{l}^{m}(\boldsymbol{\Omega}), \tag{2.88}\]

where the \(\sigma_{lm}\) are numbers yet to be determined. To obtain the coefficient \(\sigma_{l^{\prime}m^{\prime}}\), we multiply both sides of equation (2.88) by \({\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}(\boldsymbol{\Omega})\) and integrate over \(\boldsymbol{\Omega}\). With equation (2.83) we find

\[\int{\rm d}^{2}\Omega\,{\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}(\boldsymbol{ \Omega})\,\sigma(\boldsymbol{\Omega})=\sigma_{l^{\prime}m^{\prime}}. \tag{2.89}\]Since \({\rm Y}_{0}^{0}=1/\sqrt{4\pi}\), \(\sigma_{00}=M/(2a^{2}\sqrt{\pi})\), where \(M\) is the mass of the shell.

Gauss's theorem (2.12) applied to a small piece of the shell tells us that

\[\left(\frac{\partial\Phi_{\rm ext}}{\partial r}\right)_{r=a}-\left(\frac{ \partial\Phi_{\rm int}}{\partial r}\right)_{r=a}=4\pi G\sigma({\bf\Omega}), \tag{2.90}\]

so inserting equations (2.85) and (2.88) into equation (2.90), we obtain

\[\begin{split}-\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\bigg{(}(l+1)D_{ lm}a^{-(l+2)}+& IA_{lm}a^{l-1}\bigg{)}{\rm Y}_{l}^{m}({\bf\Omega})=\\ & 4\pi G\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\sigma_{lm}{\rm Y}_{l}^{ m}({\bf\Omega}).\end{split} \tag{2.91}\]

Once again the coefficients of \({\rm Y}_{l}^{m}\) on each side of the equation must be identical, so with (2.87) we have

\[A_{lm}=-4\pi Ga^{-(l-1)}\frac{\sigma_{lm}}{2l+1}\quad;\quad D_{lm}=-4\pi Ga^{ l+2}\frac{\sigma_{lm}}{2l+1}. \tag{2.92}\]

Collecting these results together, we have from equations (2.85) that

\[\begin{split}\Phi_{\rm int}(r,{\bf\Omega})&=-4\pi Ga \sum_{l=0}^{\infty}\bigg{(}\frac{r}{a}\bigg{)}^{l}\sum_{m=-l}^{l}\frac{\sigma _{lm}}{2l+1}{\rm Y}_{l}^{m}({\bf\Omega}),\\ \Phi_{\rm ext}(r,{\bf\Omega})&=-4\pi Ga\sum_{l=0}^{ \infty}\bigg{(}\frac{a}{r}\bigg{)}^{l+1}\sum_{m=-l}^{l}\frac{\sigma_{lm}}{2l+ 1}{\rm Y}_{l}^{m}({\bf\Omega}),\end{split} \tag{2.93}\]

where the \(\sigma_{lm}\) are given by equation (2.89).

Finally we evaluate the potential of a solid body by breaking it down into a series of spherical shells. We let \(\delta\sigma_{lm}(a)\) be the \(\sigma\)-coefficient of the shell lying between \(a\) and \(a+\delta a\), and \(\delta\Phi(r,{\bf\Omega};a)\) be the corresponding potential at \(r\). Then we have by equation (2.89)

\[\delta\sigma_{lm}(a)=\int_{0}^{\pi}{\rm d}\theta\,\sin\theta\int_{0}^{2\pi}{ \rm d}\phi\,{\rm Y}_{l}^{m*}({\bf\Omega})\rho(a,{\bf\Omega})\delta a\equiv \rho_{lm}(a)\delta a. \tag{2.94}\]

Substituting these values of \(\sigma_{lm}\) into equations (2.93) and integrating over all \(a\), we obtain the potential at \(r\) generated by the entire collection of shells:

\[\begin{split}\Phi(r,{\bf\Omega})&=\sum_{a=0}^{r} \delta\Phi_{\rm ext}+\sum_{a=r}^{\infty}\delta\Phi_{\rm int}\\ &=-4\pi G\sum_{l,m}\frac{{\rm Y}_{l}^{m}({\bf\Omega})}{2l+1} \bigg{(}\frac{1}{r^{l+1}}\int_{0}^{r}\!\!{\rm d}a\,a^{l+2}\rho_{lm}(a)+r^{l} \!\int_{r}^{\infty}\!\frac{{\rm d}a}{a^{l-1}}\rho_{lm}(a)\bigg{)}.\end{split} \tag{2.95}\]This equation gives the potential generated by the body as an expansion in **multipoles**: the terms associated with \(l=m=0\) are the **monopole** terms, those associated with \(l=1\) are **dipole** terms, those with \(l=2\) are **quadrupole** terms, and those with larger \(l\) are \(2^{l}\)-poles. Similar expansions occur in electrostatics (e.g., Jackson 1999). The monopole terms are the same as in equation (2.28) for the potential of a spherical system.6 Since there is no gravitational analog of negative charge, pure dipole or quadrupole gravitational potentials cannot arise, in contrast to the electrostatic case. In fact, if one places the origin of coordinates at the center of mass of the system, the dipole term vanishes identically outside any matter distribution. While the monopole terms generate a circular-speed curve \(v_{\rm c}(r)=\sqrt{GM(r)/r}\) that never declines with increasing \(r\) more steeply than in the Keplerian case (\(v_{\rm c}\propto r^{-1/2}\)), over a limited range in \(r\) the higher-order multipoles may cause the circular speed to fall more steeply with increasing radius.

Footnote 6: Thus the spherical-harmonic expansion provides an alternative proof of Newton’s first and second theorems.

As an illustration of the effectiveness of the multipole expansion, we show in Figure 2.10 the contours of Satoh's potential \(\Phi_{\rm S}(R,z)\) (eq. 2.70a), together with the approximations to this potential that one obtains from equation (2.95) if one includes only terms with \(l\leq\,2\) or \(8\). The flexibility

Figure 2.10: Equipotentials of Satoh’s density distribution (2.70c) with \(b/a=1\). Full curves show the exact equipotentials computed from equation (2.70a), and dashed curves show the estimate provided by equation (2.95) with the sum over \(l\) extending to \(l=2\). Contours based on the sum to \(l=8\) are also plotted (dotted contours) but almost overlie the full curves.

of the multipole expansion makes it a powerful tool for numerical work, and it plays a central role in some of the Poisson solvers for N-body codes that will be described in SS2.9. However, multipole expansions are poorly suited for modeling the potentials of disks.

### 2.5 The potentials of spheroidal and ellipsoidal systems

Many galaxies have nearly spheroidal or ellipsoidal equidensity surfaces (BM SS4.3.3). Moreover, Newton's theorems for spherical bodies can be generalized to include spheroidal and ellipsoidal bodies, so models with isodensity surfaces of this shape are relatively easy to construct. Finally, as the axis ratio shrinks to zero a spheroid becomes a disk, and thus we can obtain the potentials of razor-thin disks as a limiting case of spheroids.

In this section we develop efficient techniques for calculating the potentials of such objects. In SSSS2.5.1 and 2.5.2 we derive formulae for oblate (i.e., flattened) spheroidal systems, and in SS2.5.3 we briefly discuss ellipsoidal systems. Results for prolate spheroidal systems can be obtained either by adapting our derivations for oblate systems, or by specializing the results for ellipsoidal systems. The principal formulae for all three geometries are given in Tables 2.1 and 2.2.

Figure 2.11: Curves of constant \(u\) and \(v\) in the \((R,z)\) plane. Semi-ellipses are curves of constant \(u\), and hyperbolae are curves of constant \(v\). The common focus of all curves is marked by a dot. In order to ensure that each point has a unique \(v\)-coordinate, we exclude the disk (\(z=0,\ R\leq\Delta\)) from the space to be considered.

#### 2.5.1 Potentials of spheroidal shells

Consider a system in which the isodensity surfaces are similar concentric spheroids. We align our coordinate system such that the \(z\) axis is the minor axis of the spheroids, and designate the principal-axis lengths of the spheroids by \(a\) and \(c\), with \(a\geq c\). Spheroidal bodies call for spheroidal coordinates, so we consider the form of Laplace's equation, \(\nabla^{2}\Phi=0\), in **oblate spheroidal coordinates**. These coordinates employ the usual azimuthal angle \(\phi\) of cylindrical coordinates, but replace the coordinates \((R,z)\) with new coordinates \((u,v)\) that are defined by

\[R=\Delta\cosh u\sin v\quad;\quad z=\Delta\sinh u\cos v\quad(u\geq 0,0\leq v\leq \pi), \tag{2.96}\]

where \(\Delta\) is a constant. Figure 2.11 shows the curves of constant \(u\) and \(v\) in the \((R,z)\) plane. The curves \(u=\)_constant_ are confocal half-ellipses with foci at \((R,z)=(\Delta,0)\), namely

\[\frac{R^{2}}{\cosh^{2}u}+\frac{z^{2}}{\sinh^{2}u}=\Delta^{2}. \tag{2.97}\]

Similarly, the curves \(v=\)_constant_ coincide with the hyperbolae

\[\frac{R^{2}}{\sin^{2}v}-\frac{z^{2}}{\cos^{2}v}=\Delta^{2} \tag{2.98}\]

formed by the normals to these ellipses.

From equations (2.96) we see that if we increase one of \(u\), \(v\), and \(\phi\) by a small amount while holding the other two coordinates constant, the point \((u,v,\phi)\) moves parallel to the three orthogonal unit vectors \(\hat{\bf e}_{u}\), \(\hat{\bf e}_{v}\), \(\hat{\bf e}_{\phi}\) by the distances \(h_{u}\delta u\), \(h_{v}\delta v\) and \(h_{\phi}\delta\phi\), where the scale factors are

\[h_{u}=h_{v}=\Delta\sqrt{\sinh^{2}u+\cos^{2}v}\quad;\quad h_{\phi}=\Delta\cosh u \sin v. \tag{2.99}\]

Hence the gradient of a potential \(\Phi\) may be expressed in these coordinates as (eq. B.39)

\[\boldsymbol{\nabla}\Phi=\frac{1}{\Delta\sqrt{\sinh^{2}u+\cos^{2}v}}\left[ \frac{\partial\Phi}{\partial u}\hat{\bf e}_{u}+\frac{\partial\Phi}{\partial v }\hat{\bf e}_{v}\right]+\frac{1}{\Delta\cosh u\sin v}\frac{\partial\Phi}{ \partial\phi}\hat{\bf e}_{\phi}. \tag{2.100}\]

We further have (eq. B.54)

\[\begin{split}\nabla^{2}\Phi&=\frac{1}{\Delta^{2}( \sinh^{2}u+\cos^{2}v)}\biggl{[}\frac{1}{\cosh u}\frac{\partial}{\partial u} \biggl{(}\cosh u\frac{\partial\Phi}{\partial u}\biggr{)}\\ &\qquad\qquad+\frac{1}{\sin v}\frac{\partial}{\partial v}\biggl{(} \sin v\frac{\partial\Phi}{\partial v}\biggr{)}\biggr{]}+\frac{1}{\Delta^{2} \cosh^{2}u\sin^{2}v}\frac{\partial^{2}\Phi}{\partial\phi^{2}}.\end{split} \tag{2.101}\]We concentrate on potentials that are functions \(\Phi(u)\) of only the "radial" coordinate \(u\). For potentials of this class, \(\nabla^{2}\Phi=0\) reduces to

\[{{\rm d}\over{\rm d}u}\left(\cosh u{{\rm d}\Phi\over{\rm d}u}\right)=0.\]

Hence either

\[\Phi=\Phi_{0}\qquad\hbox{(a constant)},\]

or \({\rm d}\Phi/{\rm d}u=A\,{\rm sech}\,u\), where \(A\) is a constant. Integrating this last equation we find

\[\Phi=-A\sin^{-1}({\rm sech}\,u)+B,\]

where \(B\) is a constant.

For \(u\) large, \({\rm sech}\,u\to\Delta/r\to 0\), where \(r\) is the usual spherical radius. So a potential of the form (2.103b) varies as

\[\Phi\simeq-A\,{\rm sech}\,u+B\to-{A\Delta\over r}+B,\]

Hence, if we set \(B=0\) and \(A=G\delta M/\Delta\), the potential given by equation (2.103b) tends to zero at infinity like the gravitational potential of a shell of mass \(\delta M\). Thus we are led to consider the potential defined by

\[\Phi=-{G\delta M\over\Delta}\times\cases{\sin^{-1}({\rm sech}\,u_{0})&$(u<u_{0 })$,\cr\sin^{-1}({\rm sech}\,u)&$(u\geq u_{0})$.\cr}\]

This potential is everywhere continuous and solves \(\nabla^{2}\Phi=0\) everywhere except on the spheroid \(u=u_{0}\) (see eqs. 2.103). Hence it is the gravitational potential of a shell of material on the surface \(u=u_{0}\). This shell has principal semi-axes of lengths \(a\equiv\Delta\cosh u_{0}\) and \(c\equiv\Delta\sinh u_{0}\). Hence the shell's **eccentricity**

\[e\equiv\sqrt{1-{c^{2}\over a^{2}}}={\rm sech}\,u_{0},\]

and we may rewrite equations (2.105) as

\[\Phi=-{G\delta M\over ae}\times\cases{\sin^{-1}(e)&$(u<u_{0})$,\cr\sin^{-1}({ \rm sech}\,u)&$(u\geq u_{0})$.\cr}\]We can find the surface density of the shell \(u=u_{0}\) by applying Gauss's theorem (2.12) to the potential (2.107). Since \(\boldsymbol{\nabla}\Phi=0\) inside the shell, by equation (2.100) the surface density of the shell is

\[\begin{split}\Sigma(v)=\frac{\hat{\mathbf{e}}_{u}\cdot \boldsymbol{\nabla}\Phi}{4\pi G}&=\frac{1}{4\pi G\Delta\sqrt{ \sinh^{2}u_{0}+\cos^{2}v}}\biggl{(}\frac{\mathrm{d}\Phi}{\mathrm{d}u}\biggr{)} _{u=u_{0}+}\\ &=\frac{\delta M}{4\pi a^{2}\sqrt{1-e^{2}\sin^{2}v}},\end{split} \tag{2.108}\]

where evaluation at \(u_{0}+\) denotes the limiting value as \(u\to u_{0}\) from above.

Equation (2.108) has a simple physical interpretation: \(\Sigma(v)\) is the surface density of the thin shell of uniform density \(\rho\) that is bounded by the two surfaces \(\beta\) and \(\beta+\delta\beta\) of the set of similar spheroids,

\[\frac{R^{2}}{a^{2}}+\frac{z^{2}}{c^{2}}=\beta^{2}, \tag{2.109}\]

where \(\delta\beta\) and \(\delta M\) are related by (2.113) below. _Proof:_ The small perpendicular \(\mathbf{s}\) in Figure 2.12 runs between the shell's inner and outer skins. Thus \(\mathbf{s}=s\boldsymbol{\nabla}\beta/|\boldsymbol{\nabla}\beta|\), and at any point on the surface we have \(\delta\beta=(\mathbf{s}\cdot\boldsymbol{\nabla}\beta)=s|\boldsymbol{\nabla}\beta|\). Hence \(s=\delta\beta/|\boldsymbol{\nabla}\beta|\) and the surface density of the shell is

\[\widetilde{\Sigma}=\rho s=\frac{\rho\delta\beta}{|\boldsymbol{\nabla}\beta|}= \biggl{(}\frac{R^{2}}{a^{4}}+\frac{z^{2}}{c^{4}}\biggr{)}^{-1/2}\rho\beta\, \delta\beta. \tag{2.110}\]

Finally, writing \(R=\beta a\sin v\), \(z=\beta c\cos v\), and \(e=\sqrt{1-c^{2}/a^{2}}\), we find

\[\widetilde{\Sigma}=\frac{a\sqrt{1-e^{2}}\,\rho\,\delta\beta}{\sqrt{1-e^{2}\sin ^{2}v}}. \tag{2.111}\]

The volume inside an oblate spheroidal shell with semi-axis lengths \(a\beta\) and \(c\beta\) is

\[V=\tfrac{4}{3}\pi a^{2}c\beta^{3}=\tfrac{4}{3}\pi a^{3}\beta^{3}\sqrt{1-e^{2}}, \tag{2.112}\]

so the mass that is bounded by the surfaces \(\beta\) and \(\beta+\delta\beta\) is

\[\delta M=4\pi\rho a^{3}\sqrt{1-e^{2}}\,\beta^{2}\delta\beta. \tag{2.113}\]

We can now set \(\beta=1\) and substitute (2.113) into equation (2.111) to find that \(\widetilde{\Sigma}=\Sigma\), where \(\Sigma\) is given by equation (2.108).\(\triangleleft\)

We have shown that the potential (2.107) is generated by a thin shell of uniform density that is bounded by similar spheroids of eccentricity \(e\). We call such a shell a **thin homoeoid** and have:

**Homoeoid theorem**_The exterior isopotential surfaces of a thin homoeoid are the spheroids that are confocal with the shell itself. Inside the shell the potential is constant._

The homoeoid theorem applies only to a _thin_ homoeoid. But it immediately yields a remarkable property of any homoeoid--that is, of any shell of constant density, no matter how thick, whose inner and outer surfaces are similar (_not_ confocal) spheroids:

**Newton's third theorem**_A mass that is inside a homoeoid experiences no net gravitational force from the homoeoid._

_Proof:_ Break the given homoeoid into a series of thin homoeoids. The interior of the thick homoeoid lies in the interior of each of its component thin homoeoids, and the interior potential of each thin homoeoid is constant. Hence the aggregate interior potential is constant and generates no gravitational force.\(\triangleleft\)

Newton's first theorem, for spherical systems, thus emerges as a special case of Newton's third theorem for spheroidal systems. Newton's second theorem, for spherical systems, has no analog for spheroidal systems because the potential outside a spheroidal body _does_ depend on the distribution of matter within it.

These theorems help us to understand qualitatively the potential of an inhomogeneous spheroidal body. Each shell of the body makes a contribution to the potential that is constant interior to the shell and on the shell, and gradually becomes rounder as one moves outward from the shell. This tendency of isopotentials to become spherical at large radii manifested itself already in SS2.4 in the rapid radial decay of the higher multipole components of the gravitational potential. The shape of the isopotential surface at a distance \(r\) from the center of an inhomogeneous spheroidal body represents a compromise between the rather round contributions of the central shells, and the more aspherical contributions of the shells just interior to \(r\). Thus, if the body is very centrally concentrated, the isopotentials near its edge will be nearly round, while a more homogeneous spheroidal body will have more flattened isopotentials.

**2.5.2 Potentials of spheroidal systems**

We now use equation (2.107) to calculate the gravitational potential of a body whose isodensity surfaces are the similar spheroids

\[\mbox{constant}=m^{2}\equiv R^{2}+\frac{z^{2}}{1-e^{2}}, \tag{2.114}\]

i.e., a body in which \(\rho=\rho(m^{2})\). Comparing equations (2.109) and (2.114), we see that \(m=\beta a\), so the mass of the shell between \(m\) and \(m+\delta m\) is given by equation (2.113) as

\[\delta M=4\pi\rho(m^{2})\sqrt{1-e^{2}}\,m^{2}\delta m. \tag{2.115}\]For a spherical system (\(e=0\)) this reduces to the familiar formula \(\delta M=4\pi\rho r^{2}\delta r\).

There is a unique family of confocal spheroids such that one member of the family coincides with the homoeoid labeled by \(m\). Let \(u_{m}(R_{0},z_{0})\) be the label of the member of this family that passes through the point \((R_{0},z_{0})\) at which the potential is required (see eq. 2.122 below for an explicit formula). Then if \((R_{0},z_{0})\) lies inside the homoeoid \(m\), we have on setting \(a=m\) in equation (2.107) and substituting for \(\delta M\) from equation (2.115) that the contribution of \(m\) to the potential at \((R_{0},z_{0})\) is

\[\delta\Phi_{\rm int}\equiv\delta\Phi(R_{0},z_{0})=-4\pi G\rho(m^{2})m\,\delta m \frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(e).\] (2.116a) Similarly, if \[(R_{0},z_{0})\] lies outside the homoeoid, \[\delta\Phi_{\rm ext}\equiv\delta\Phi(R_{0},z_{0})=-4\pi G\rho(m^{2})m\,\delta m \frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(\operatorname{sech}u_{m}). \tag{2.116b}\]

The potential of the entire body is the sum of contributions (2.116) from all the homoeoids that make up the body. If we define

\[\psi(m)\equiv\int_{0}^{m^{2}}{\rm d}m^{2}\,\rho(m^{2}), \tag{2.117}\]

the sum of the \(\delta\Phi_{\rm int}\) is

\[\sum_{m>m_{0}}\delta\Phi_{\rm int}=-2\pi G\frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(e) \left[\psi(\infty)-\psi(m_{0})\right], \tag{2.118}\]

where \(m_{0}\) is the label of the homoeoid that passes through \((R_{0},z_{0})\):

\[m_{0}^{2}\equiv R_{0}^{2}+\frac{z_{0}^{2}}{1-e^{2}}. \tag{2.119}\]

Similarly,

\[\sum_{m<m_{0}}\delta\Phi_{\rm ext}=-2\pi G\frac{\sqrt{1-e^{2}}}{e}\int_{0}^{m _{0}^{2}}{\rm d}m^{2}\,\rho(m^{2})\sin^{-1}(\operatorname{sech}u_{m}). \tag{2.120}\]

Integrating equation (2.120) by parts,

\[\begin{split}\sum_{m<m_{0}}&\delta\Phi_{\rm ext}=-2 \pi G\frac{\sqrt{1-e^{2}}}{e}\\ &\times\left\{\left[\psi(m)\sin^{-1}(\operatorname{sech}u_{m}) \right]_{m=0}^{m_{0}}-\int_{m=0}^{m_{0}}\frac{\psi(m){\rm d}\operatorname{sech }u_{m}}{\sqrt{1-\operatorname{sech}^{2}u_{m}}}\right\}.\end{split} \tag{2.121}\]The quantity \(u_{m}\) appearing in equation (2.121) is a function \(u_{m}(R_{0},z_{0})\) by virtue of the condition that \(u_{m}\) label the spheroid through \((R_{0},z_{0})\) that is confocal with the homoeoid \(m=\mathit{constant}\). Let the \(\Delta\) parameter of the confocal family of spheroids containing \(m\) be \(\Delta_{m}\), and let \(u_{\star}\) be the label of the homoeoid \(m\) within this family. Then \(m=\Delta_{m}\cosh u_{\star}\) and \(\sqrt{1-e^{2}}\,m=\Delta_{m}\sinh u_{\star}\), so \(\Delta_{m}=me\), and we have from equation (2.97) that

\[\begin{split}\frac{R_{0}^{2}}{\Delta_{m}^{2}\cosh^{2}u_{m}}+ \frac{z_{0}^{2}}{\Delta_{m}^{2}\sinh^{2}u_{m}}&=1,\\ \text{which implies}\qquad\frac{R_{0}^{2}}{1+\sinh^{2}u_{m}}+ \frac{z_{0}^{2}}{\sinh^{2}u_{m}}&=m^{2}e^{2}.\end{split} \tag{2.122}\]

This is the required equation for \(u_{m}\). Thus, in particular, \(m=0\) implies \(\sinh u_{m}=\infty\), and \(m=m_{0}\) implies \(\sinh u_{m}=\sqrt{1-e^{2}}\,/e\). Inserting these limits into equation (2.121), and adding the result to equation (2.116), we find

\[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\frac{ \sqrt{1-e^{2}}}{e}\\ &\quad\times\biggl{(}\psi(\infty)\sin^{-1}e-\int_{\sinh u_{m}= \sqrt{1-e^{2}}\,/e}^{\infty}\psi(m)\frac{\mathrm{d}\sinh u_{m}}{1+\sinh^{2}u_{ m}}\biggr{)}.\end{split} \tag{2.123}\]

We can simplify this equation by defining a new variable of integration

\[\tau\equiv a_{0}^{2}e^{2}\biggl{[}\sinh^{2}u_{m}-\biggl{(}\frac{1}{e^{2}}-1 \biggr{)}\biggr{]}, \tag{2.124}\]

where \(a_{0}\) is any constant. Then equation (2.122) becomes

\[\frac{R_{0}^{2}}{\tau+a_{0}^{2}}+\frac{z_{0}^{2}}{\tau+c_{0}^{2}}=\frac{m^{2} }{a_{0}^{2}}\quad\ (c_{0}\equiv\sqrt{1-e^{2}}a_{0}),\] (2.125a) and equation ( 2.123 ) becomes \[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\frac{ \sqrt{1-e^{2}}}{e}\\ &\quad\times\biggl{(}\psi(\infty)\sin^{-1}e-\frac{a_{0}e}{2}\int_ {0}^{\infty}\mathrm{d}\tau\,\frac{\psi(m)}{(\tau+a_{0}^{2})\sqrt{\tau+c_{0}^{2 }}}\biggr{)}.\end{split} \tag{2.125b}\]

The integral in this equation gives the contributions to \(\Phi\) from homoeoids for which \((R_{0},z_{0})\) is an exterior point, with \(\tau=0\) corresponding to the homoeoid that touches \((R_{0},z_{0})\), and large \(\tau\) corresponding to small homoeoids.

It is instructive to apply equations (2.125) to the determination of the interior potential of a homogeneous spheroid of density \(\rho_{0}\) and eccentricity 

\begin{table}
\begin{tabular}{c c c} Thin shell & \(\Phi({\bf x}_{\rm int})=\frac{Ga_{1}}{2a_{2}a_{3}}I({\bf a})M_{\rm shell}\) & \(\Phi({\bf x}_{\rm ext})=\frac{Ga_{1}^{\prime}}{2a_{2}^{\prime}a_{3}^{\prime}}I({ \bf a})M_{\rm shell}\) \\ Homogeneous & \(\Phi({\bf x}_{\rm int})=-\pi G\rho\{I({\bf a})a_{1}^{2}-\sum_{i=1}^{3}A_{i}({ \bf a})x_{i}^{2}\}\) & \(W_{\bar{q}j}=-\frac{8}{15}\pi^{2}G\rho^{2}a_{1}a_{2}a_{3}A_{\bar{n}}a_{\bar{n} }^{2}\delta_{ij}\) \\  & \(\Phi({\bf x}_{\rm ext})=-\pi G\rho\frac{a_{1}a_{2}a_{3}}{a_{1}^{\prime}a_{2}^{ \prime}a_{3}^{\prime}}I({\bf a}){d_{1}^{\prime}}^{2}-\sum_{i=1}^{3}A_{i}({\bf a })x_{i}^{2}\}\) & \(W=-\frac{8}{15}\pi^{2}G\rho^{2}a_{1}^{3}a_{2}a_{3}I\) \\ Inhomogeneous & \(\Phi({\bf x})=-\pi G\frac{a_{2}a_{3}}{a_{1}}\int_{0}^{\infty}\frac{{\rm d} \tau}{\Delta}\left\{\psi(\infty)-\psi[m(\tau,{\bf x})]\right\}\) & \(W_{\bar{q}j}=-2\pi^{2}G\frac{a_{2}a_{3}}{a_{1}^{\prime}}SA_{i}a_{\bar{n}}^{2} \delta_{ij}\) & \(W=-2\pi^{2}G\frac{a_{2}a_{3}}{a_{1}^{\prime}}SI\delta_{ij}\) \\ \end{tabular}
\end{table}
Table 2: Potentials and potential-energy tensors of ellipsoidal bodiesthat has semi-axes of lengths \(a_{1}\) and \(a_{3}=\sqrt{1-e^{2}}\,a_{1}\). For this case, equation (2.117) yields

\[\psi(m)=\rho_{0}\times\cases{m^{2}&(m^{2}<a_{1}^{2}),\cr a_{1}^{2}&(m^{2}\geq a_ {1}^{2}).\cr} \tag{2.126}\]

Equation (2.125b) takes on a particularly simple form if we set the arbitrary constant \(a_{0}\) equal to \(a_{1}\). If \((R_{0},z_{0})\) lies inside the spheroid, \(m(\tau)\) is always smaller than \(a_{0}\). Hence, we may substitute from equation (2.125a) and (2.126) into (2.125b), to obtain

\[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\rho_{0}a_{1 }^{2}\frac{\sqrt{1-e^{2}}}{e}\biggl{[}\sin^{-1}e\\ &\quad-\frac{a_{1}e}{2}\int_{0}^{\infty}\frac{d\tau}{(\tau+a_{1}^ {2})\sqrt{\tau+a_{3}^{2}}}\biggl{(}\frac{R_{0}^{2}}{\tau+a_{1}^{2}}+\frac{z_{ 0}^{2}}{\tau+a_{3}^{2}}\biggr{)}\biggr{]}.\end{split} \tag{2.127}\]

This potential is quadratic in the coordinates and may be written

\[\Phi({\bf x})=-\pi G\rho_{0}(Ia_{1}^{2}-A_{1}R^{2}-A_{3}z^{2}), \tag{2.128}\]

where the dimensionless coefficients \(I\) and \(A_{i}\) are given in Table 2.1. An expression for the exterior potential of the homogeneous spheroid is given in Table 2.2.

With the help of equations (2.117) and (2.125) we obtain the gravitational field generated by a spheroidal system as

\[{\bf g}=-\boldsymbol{\nabla}\Phi=-\pi G\sqrt{1-e^{2}}\,a_{0}\int_{0}^{\infty} \mathrm{d}\tau\,\frac{\rho(m^{2})\boldsymbol{\nabla}m^{2}}{(\tau+a_{0}^{2}) \sqrt{\tau+c_{0}^{2}}},\] (2.129a) where \[\boldsymbol{\nabla}m^{2}=2a_{0}^{2}\left(\frac{R}{\tau+a_{0}^{2}}\hat{\bf e}_ {R}+\frac{z}{\tau+c_{0}^{2}}\hat{\bf e}_{z}\right). \tag{2.129b}\]

We may use equation (2.129) to find the circular speed \(v_{\mathrm{c}}(R)\) in the equatorial plane of an oblate spheroidal galaxy. The radial component of the field (2.129) is

\[g_{R}(R,z)=-2\pi G\sqrt{1-e^{2}}\,a_{0}^{3}R\int_{0}^{\infty}\mathrm{d}\tau\, \frac{\rho(m^{2})}{(\tau+a_{0}^{2})^{2}\sqrt{\tau+c_{0}^{2}}}. \tag{2.130}\]

In the equatorial plane \(z=0\), equation (2.125a) yields

\[m=\frac{a_{0}R}{\sqrt{\tau+a_{0}^{2}}}.\] (2.131a) Hence \[\frac{\mathrm{d}\tau}{(\tau+a_{0}^{2})^{2}}=-\frac{2m}{R^{2}a_{0}^{2}}\mathrm{ d}m, \tag{2.131b}\]and equation (2.130) yields

\[v_{\rm c}^{2}(R)=-Rg_{R}(R,0)=4\pi G\sqrt{1-e^{2}}\int_{0}^{R}{\rm d}m\,\frac{m^{2 }\rho(m^{2})}{\sqrt{R^{2}-m^{2}e^{2}}}. \tag{2.132}\]

Let us see how these formulae work out in a specific case. Consider the oblate spheroidal density distribution

\[\rho(m^{2})=\rho_{0}\biggl{[}1+\biggl{(}\frac{m}{a_{0}}\biggr{)}^{2}\biggr{]}^ {-3/2}, \tag{2.133}\]

where \(a_{0}\) is the core radius and the parameter \(e\) that appears in the definition (2.114) of \(m\) is the eccentricity of the system. In the limit \(e\to 0\) this reduces to the modified Hubble model (2.53). We substitute for \(\rho\) in equation (2.132) to obtain

\[v_{\rm c}^{2}(R)=4\pi G\rho_{0}a_{0}^{3}\frac{\sqrt{1-e^{2}}}{e}\int_{0}^{R} \frac{m^{2}{\rm d}m}{(a_{0}^{2}+m^{2})^{3/2}\sqrt{R^{2}/e^{2}-m^{2}}}. \tag{2.134}\]

By making the substitution

\[m=\frac{R\sin\theta}{e\sqrt{1+\left(R/ea_{0}\right)^{2}\cos^{2}\theta}} \tag{2.135}\]

Figure 2.13: Circular speed versus radius for three bodies with the same face-on projected density profile (the modified Hubble model, eq. 2.133) but different axis ratios \(q=c/a\). Though all three bodies have the same mass inside a spheroid of given semi-major axis, \(v_{\rm c}\) increases with flattening \(1-q\).

one may show that the integral of equation (2.134) equals

\[\frac{ek}{R}\left[F(\theta_{m},k)-E(\theta_{m},k)\right], \tag{2.136}\]

where \(F\) and \(E\) are incomplete elliptic integrals (see Appendix C.4),

\[k\equiv\frac{R}{\sqrt{e^{2}a_{0}^{2}+R^{2}}},\quad\mbox{and}\quad\theta_{m} \equiv\sin^{-1}\sqrt{\frac{e^{2}a_{0}^{2}+R^{2}}{a_{0}^{2}+R^{2}}}. \tag{2.137a}\]

Hence

\[v_{\rm c}^{2}(R)=4\pi G\rho_{0}a_{0}^{3}\frac{\sqrt{1-e^{2}}}{R}k\left[F( \theta_{m},k)-E(\theta_{m},k)\right]. \tag{2.137b}\]

We may use this result to investigate how strongly a galaxy's circular speed is affected by its shape. In Figure 2.13 we plot the circular-speed curves of three galaxies whose density profiles are given by equation (2.133) for axis ratio \(q=\sqrt{1-e^{2}}=1\) (spherical system), \(q=0.5\) (E5 galaxy), and \(q=0.1\) (the flatness characteristic of disk galaxies). The central density has in each case been adjusted so as to hold constant the mass \(M(a)\) interior to the spheroid of semi-major axis \(a\). The peak circular speed of the \(q=0.1\) model is about 20% higher than that of the spherical system because flattening the system increases the radial component of the force between a given mass element and a test mass in the equatorial plane.

Figure 2.14: The ellipticity \(\epsilon_{\Phi}\) of an equipotential surface versus the surface’s semi-major axis length \(r\). Each curve is labeled by the ellipticity \(\epsilon_{\rho}=1-q\) of the body with density (2.133) that generates the corresponding potential. Notice the rapidity with which the equipotential surfaces become spherical at large \(r/a_{0}\).

For the density distribution defined by equation (2.133), Figure 2.14 shows the ellipticity \(\epsilon_{\Phi}\) of the isopotential surfaces for several values of the ellipticity \(\epsilon_{\rho}\equiv 1-q\) of the density distribution. One sees that in the core \(r<a_{0}\), \(\epsilon_{\Phi}\mathrel{\hbox to 0.0pt{\raise 2.1973pt\hbox{$>$}}{\lower 2.1973pt \hbox{$\sim$}}}{1\over 2}\epsilon_{\rho}\), while at a few core radii \(\epsilon_{\Phi}\approx{1\over 3}\epsilon_{\rho}\), and at \(r\gg a\), \(\epsilon_{\Phi}\) rapidly approaches zero. Thus, in the region containing the bulk of the mass, the potential is generally flattened only about a third as much as the density, just as we found for logarithmic potentials in SS2.3.2.

#### Potentials of ellipsoidal systems

The problem of calculating the gravitational potential of a body whose isodensity surfaces are similar, coaxial ellipsoids challenged some of the best minds of the eighteenth and nineteenth centuries--see Chandrasekhar (1969) for details. The general problem was solved by George Green (1793-1841), a Nottingham millwright, in 1835 using rather specialized geometrical methods that we shall not present here. Green's results are natural generalizations of the ones we deduced above by a more accessible technique for axisymmetric systems. We now summarize the results for triaxial systems and refer readers to Kellogg (1953) or Chandrasekhar (1969) for proofs.

On surfaces of constant density, the variable

\[m^{2}\equiv a_{1}^{2}\sum_{i=1}^{3}{x_{i}^{2}\over a_{i}^{2}}\]

is constant, where \((x_{1},x_{2},x_{3})\) are Cartesian coordinates and \(a_{1}\), \(a_{2}\), \(a_{3}\) are the semi-axes of the ellipsoid. A thin shell of uniform density, whose inner and outer skins are the surfaces \(m\) and \(m+\delta m\), generates an exterior potential that is constant on the ellipsoidal surfaces

\[m^{2}=a_{1}^{2}\sum_{i=1}^{3}{x_{i}^{2}\over a_{i}^{2}+\tau},\]

where \(\tau\geq 0\) labels the surfaces. (This is a straightforward extension of the homoeoid theorem proved in SS2.5.1.) There is no gravitational field inside such a shell.

We may find the gravitational potential of any body in which \(\rho=\rho(m^{2})\) by breaking the body down into thin triaxial homoeoids: the triaxial analog of equation (2.125b) is

\[\Phi({\bf x})=-\pi G{a_{2}a_{3}\over a_{1}}\int_{0}^{\infty}{\rm d}\tau\,{ \psi(\infty)-\psi(m)\over\sqrt{(\tau+a_{1}^{2})(\tau+a_{2}^{2})(\tau+a_{3}^{2} )}},\]

where \(\psi(m)\) is again defined by (2.117) and \(m=m({\bf x},\tau)\) through equation (2.139). Merritt & Fridman (1996) give expressions derived from (2.140)for the gravitational potentials and fields of triaxial generalizations of the Dehnen models of SS2.2.2g.

**(a) Ferrers potentials** A particularly simple application of equation (2.140) is to the case in which

\[\rho(m^{2})=\cases{\rho_{0}\left(1-m^{2}/a_{1}^{2}\right)^{n}&for $m\leq a_{1}$\cr 0&for $m>a_{1}$,\cr}\]

where \(m=m({\bf x})\) through equation (2.138). By (2.117) we now have

\[\psi(\infty)-\psi(m)={\rho_{0}a_{1}^{2}\over n+1}\left(1-{m^{2}\over a_{1}^{2} }\right)^{n+1}\quad(m\leq a_{1}).\]

Hence the internal potential of a body whose density is of the form (2.141) is

\[\eqalign{\Phi({\bf x})=-{\pi G\rho_{0}a_{1}a_{2}a_{3}\over n+1}&\int_{0}^{ \infty}{{\rm d}\tau\over\sqrt{(\tau+a_{1}^{2})(\tau+a_{2}^{2})(\tau+a_{3}^{2}) }}\cr&\qquad\qquad\qquad\qquad\times\left(1-\sum_{i=1}^{3}{x_{i}^{2}\over\tau +a_{i}^{2}}\right)^{n+1}.\cr}\]

If \(n\) is an integer, the bracket involving \({\bf x}\) in equation (2.143) can be multiplied out, and the potential at any point obtained as a sum of terms of the form \(A_{pqr}x_{1}^{p}x_{2}^{q}x_{3}^{r}\), where the coefficients \(A_{pqr}\) are independent of \({\bf x}\). Potentials of this simple form are ideally suited to numerical studies of orbits in triaxial galaxies, such as we shall describe in SS3.3. We shall refer to these as **Ferrers potentials**.

The \(n=0\) Ferrers potential arises from a homogeneous ellipsoid with semi-axes \(a_{1}\), \(a_{2}\), \(a_{3}\). Expressions for the interior and exterior potentials of such bodies can be derived from equations (2.140) and (2.143) and are given in Tables 2.1 and 2.2.

**(b) Potential-energy tensors of ellipsoidal systems** Roberts (1962) showed that for ellipsoidal bodies equation (2.22) has a remarkably simple form:

\[W_{jk}=-\pi^{2}G{a_{2}a_{3}\over a_{1}^{2}}\left({a_{j}\over a_{1}}\right)^{2} A_{j}\delta_{jk}\int_{0}^{\infty}{\rm d}m\,\left[\psi(\infty)-\psi(m)\right]^{2},\]

where the \(A_{j}\) are given in Table 2.1. Notice that the right side of equation (2.144) comprises a constant times the product of two factors: (i) a factor \((a_{j}/a_{1})^{2}A_{j}\delta_{jk}\) that depends only on the axial ratios \((a_{2}/a_{1})\) etc.; and (ii) a factor \(\int{\rm d}m\,\left[\psi(\infty)-\psi(m)\right]^{2}\) that is independent of the body's ellipticity and the same for all components of the tensor; this integral can be evaluated from a knowledge of the radial density structure alone. In particular, ratiosof potential-energy terms, for example \(W_{11}/W_{33}\), depend only on the body's ellipticity, and _are entirely independent of the radial density structure_ so long as the density is stratified on similar ellipsoids. We shall exploit this useful result in SS4.8.3. In Table 2.2 we give expressions for the potential-energy tensors of homogeneous ellipsoids.

### 2.6 The potentials of disks

Most of the light emitted by a typical spiral galaxy comes from a thin disk. Thus we anticipate that a substantial fraction of the galaxy's mass is concentrated in the disk, and it is therefore important to be able to calculate efficiently the gravitational field of a thin disk. We begin by investigating the potential of an idealized axisymmetric disk of zero thickness.

#### Disk potentials from homoeoids

We may consider any axisymmetric disk to be a very flat spheroid and use the formulae of SS2.5.1 to obtain the potential. A homogeneous spheroid of density \(\rho\), semi-axes \(a\) and \(c\), and axial ratio \(q=c/a\) has mass \(M(a)=\frac{4}{3}\pi\rho qa^{3}\) (eq. 112) and surface density (see Figure 2.15)

\[\Sigma(a,R)=2\rho q\sqrt{a^{2}-R^{2}}, \tag{2.145}\]

where \(R\) is the usual cylindrical radius. Differentiating these expressions with respect to \(a\), we obtain the mass \(\delta M(a)\) and the surface density \(\delta\Sigma(a,R)\) of

Figure 2.15: A spheroid of axis ratio \(q\) and semi-major axis \(a\) is viewed along a line of sight that cuts the spheroid’s equatorial plane perpendicularly at radius \(R\). This line of sight cuts through the spheroid for a distance \(2q\sqrt{a^{2}-R^{2}}\).

the thin homoeoid of density \(\rho\), semi-major axis \(a\), thickness \(\delta a\), and axial ratio \(q\):

\[\delta M(a)=4\pi\rho qa^{2}\delta a\quad;\quad\delta\Sigma(a,R)=\frac{2\rho qa}{ \sqrt{a^{2}-R^{2}}}\delta a. \tag{2.146}\]

If we now let \(q\) tend to zero while holding \(2\rho qa\equiv\Sigma_{0}\) constant, we obtain the mass and surface density of an infinitely flattened homoeoid:

\[\delta M(a)=2\pi\Sigma_{0}a\,\delta a\quad;\quad\delta\Sigma(a,R)=\frac{\Sigma _{0}\,\delta a}{\sqrt{a^{2}-R^{2}}}. \tag{2.147}\]

We may construct a razor-thin disk of known surface density \(\Sigma(R)\) by finding the family of homoeoids whose combined surface density equals \(\Sigma(R)\) at all \(R\). In mathematical language, we have to find the function \(\Sigma_{0}(a)\) that satisfies the integral equation

\[\Sigma(R)=\sum_{a\geq R}\delta\Sigma(a,R)=\int_{R}^{\infty}\mathrm{d}a\,\frac {\Sigma_{0}(a)}{\sqrt{a^{2}-R^{2}}}.\] (2.148a) This is an Abel integral equation. Its solution is (eq. B.72) \[\Sigma_{0}(a)=-\frac{2}{\pi}\frac{\mathrm{d}}{\mathrm{d}a}\int_{a}^{\infty} \mathrm{d}R\,\frac{R\Sigma(R)}{\sqrt{R^{2}-a^{2}}}. \tag{2.148b}\]

Note that \(\Sigma_{0}(a)\) is _not_ the same function as \(\Sigma(R)\). In particular, some of the mass that lies interior to radius \(R\) comes from homoeoids having \(a>R\). By Newton's third theorem, this portion of matter does not contribute to the gravitational force at \(R\), because a point in the equatorial plane at radius \(R\) is an interior point of all homoeoids with \(a>R\). Thus two disks can have identical surface-density distributions for \(R^{\prime}<R\) and yet have very different force fields at \(R\). In this respect disks differ from spherical distributions of mass, for which the force at \(r_{0}\) depends only on the density at \(r<r_{0}\). In fact, the surface density of a disk at \(R^{\prime}>R\) affects the attraction at \(R\) because the annulus of material exterior to \(R\) actually pulls a star placed at radius \(R\) outward, thus partially compensating the inward attraction of the interior matter. For example on the perimeter of a sharp-edged disk, the circular speed can be much higher than at the edge of a spherical body, or a more extended disk, with the same mass interior to this point.

We now calculate the potential of a thin disk by adding the potentials of the thin homoeoids into which we have decomposed it. By Gauss's theorem, the gravitational field is discontinuous across a sheet of finite surface density, but the potential is continuous. Consequently, the potential in the equatorial plane differs infinitesimally from the potential just above or below the disk.

Therefore we need only calculate the potential at points that are external to all homoeoids, and take the limit \(z\to 0\) to find the potential in the plane.

Equation (2.107) gives the potential outside a homoeoid of mass \(M\). For a completely flattened homoeoid, we have \(e=1\) and the mass is given in terms of \(\Sigma_{0}\) by the first of equations (2.147). Hence, at location \((R,z)\) the potential of this homoeoid is

\[\delta\Phi(R,z)=-2\pi G\Sigma_{0}\delta a\sin^{-1}(\operatorname{sech}u), \tag{2.149}\]

where \(u\) is determined by the equations \(R=a\cosh u\sin v\), \(z=a\sinh u\cos v\) (eq. 2.96). Eliminating \(v\) from these equations by using \(1=\cos^{2}v+\sin^{2}v\), we obtain a quadratic equation for \(\cosh^{2}u\):

\[a^{2}\cosh^{4}u-(R^{2}+z^{2}+a^{2})\cosh^{2}u+R^{2}=0. \tag{2.150}\]

The root that we require is the one with \(\cosh^{2}u\geq 1\), which is

\[\begin{split}\cosh^{2}u&=\frac{1}{2a^{2}}\left[R^{2 }+z^{2}+a^{2}+\sqrt{(R^{2}+z^{2}+a^{2})^{2}-4a^{2}R^{2}}\,\right]\\ &=\frac{1}{4a^{2}}\left[\sqrt{z^{2}+(a+R)^{2}}+\sqrt{z^{2}+(a-R) ^{2}}\,\right]^{2}.\end{split} \tag{2.151}\]

Taking the square root of both sides and substituting the result into equation (2.149), we obtain

\[\delta\Phi=-2\pi G\Sigma_{0}\,\delta a\sin^{-1}\bigg{(}\frac{2a}{\sqrt{z^{2}+( a+R)^{2}}+\sqrt{z^{2}+(a-R)^{2}}}\bigg{)}. \tag{2.152}\]

Finally, the potential of an axisymmetric disk of arbitrary surface-density profile is obtained by combining this result with equations (2.148), which decompose a disk into homoeoids. We have (Cuddeford 1993)

\[\Phi(R,z)=4G\int_{0}^{\infty}\mathrm{d}a\,\sin^{-1}\!\bigg{(}\frac{2a}{\sqrt{ +}+\sqrt{-}}\bigg{)}\frac{\mathrm{d}}{\mathrm{d}a}\int_{a}^{\infty}\mathrm{d} R^{\prime}\frac{R^{\prime}\Sigma(R^{\prime})}{\sqrt{R^{\prime 2}-a^{2}}}.\] (2.153a) where \[\sqrt{\pm}\equiv\sqrt{z^{2}+(a\pm R)^{2}}. \tag{2.153b}\]

An alternative form is obtained by integrating by parts:

\[\begin{split}\Phi(R,z)=-2\sqrt{2}G\int_{0}^{\infty}\mathrm{d}a& \,\frac{[(a+R)/\sqrt{+}]-[(a-R)/\sqrt{-}]}{\sqrt{R^{2}-z^{2}-a^{2}+ \sqrt{+}\sqrt{-}}}\\ &\times\int_{a}^{\infty}\mathrm{d}R^{\prime}\frac{R^{\prime} \Sigma(R^{\prime})}{\sqrt{R^{\prime 2}-a^{2}}}.\end{split} \tag{2.154}\]This form does not require differentiation of the term that depends on the surface density. Equations (2.153a) and (2.154) are numerically convenient because the inner integrals depend only on \(a\), and thus can be tabulated on a grid of values of \(a\) at the outset. Then only a single integral is required to evaluate \(\Phi\) at each fresh point \((R,z)\). Moreover, the integrands do not oscillate in sign, so numerical integrations converge rapidly.

We are particularly interested in the value of the potential in the equatorial plane. Consider first the case \(a>R\). For small \(z\), it is easy to see that \(\sqrt{\pm}\to(a\pm R)+{\rm O}(z^{2})\), with the consequence that the numerator of the fraction in the first line in equation (2.154) vanishes like \(z^{2}\) as \(z\to 0\). In the same limit the denominator vanishes too, but more slowly, like \(z\). Hence, for \(a>R\) the integrand tends to zero with \(z\) and we readily find that

\[\Phi(R,0)=-4G\int_{0}^{R}{{\rm d}a\over\sqrt{R^{2}-a^{2}}}\int_{a}^{\infty}{\rm d }R^{\prime}{R^{\prime}\Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.155}\]

To obtain the circular speed at radius \(R\) in the equatorial plane, the natural procedure is to differentiate this expression with respect to \(R\), which is the upper limit of the outer integral. The usual formula for differentiating such an integral requires us to evaluate the integrand at \(a=R\), when it diverges. Instead of resolving this problem we return to equation (2.153a), in which we may put \(z\) to zero without any awkwardness, to obtain

\[\Phi(R,0)=4G\int_{0}^{\infty}{\rm d}a\,\sin^{-1}\left({2a\over(a+R)+|a-R|} \right)\!{{\rm d}\over{\rm d}a}\int_{a}^{\infty}{\rm d}R^{\prime}{R^{\prime} \Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.156}\]

The argument of \(\sin^{-1}\) is unity for \(R<a\) and \(a/R\) otherwise. Consequently, when we differentiate with respect to \(R\) we obtain

\[v_{\rm c}^{2}(R)=R{\partial\Phi\over\partial R}=-4G\int_{0}^{R}{\rm d}a\,{a \over\sqrt{R^{2}-a^{2}}}{{\rm d}\over{\rm d}a}\int_{a}^{\infty}{\rm d}R^{ \prime}{R^{\prime}\Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.157}\]

**(a) The Mestel disk**  As a simple application of equation (2.157) consider a disk in which the surface density is given by

\[\Sigma(R)=\left\{\begin{array}{ll}{v_{0}^{2}\over 2\pi GR}&{\rm for }\ R<R_{\rm max}\\ 0&{\rm otherwise},\end{array}\right. \tag{2.158}\]

where \(v_{0}\) and \(R_{\rm max}\) are constants with dimensions of velocity and length, respectively. For this surface density the inner integral in equation (2.157) is proportional to \(\cosh^{-1}(R_{\rm max}/a)\), so its derivative with respect to \(a\) follows from

\[{{\rm d}\over{\rm d}a}\cosh^{-1}(R_{\rm max}/a)=-{R_{\rm max}\over a\sqrt{R_{ \rm max}^{2}-a^{2}}}. \tag{2.159}\]We let the outer radius of the disk, \(R_{\rm max}\), tend to infinity. In this limit the disk becomes the **Mestel disk** (Mestel 1963) and the derivative (2.159) becomes \(-1/a\). Substituting this value into equation (2.157), we find that the circular speed in the Mestel disk is

\[v_{\rm c}^{2}=\frac{2v_{0}^{2}}{\pi}\int_{0}^{R}\frac{{\rm d}a}{\sqrt{R^{2}-a^ {2}}}=v_{0}^{2}. \tag{2.160}\]

Hence, the circular speed of a disk in which the surface density is inversely proportional to radius is independent of radius. Moreover, for this surface-density law, \(v_{\rm c}(R)\) is given by the simple formula

\[v_{\rm c}^{2}(R)=\frac{GM(R)}{R},\] (2.161a) where \[M(R)=2\pi\int_{0}^{R}{\rm d}R^{\prime}\,R^{\prime}\Sigma(R^{\prime})=\frac{v_ {0}^{2}R}{G} \tag{2.161b}\]

is the mass interior to \(R\). This is precisely analogous to equation (2.29) for a spherical system. Although we have argued that for general disks the circular speed is affected by the mass exterior to \(R\), for the particular case of the Mestel disk the simple formula (2.161a) happens to give the correct answer--we are aware of no other disks with this property.

**(b) The exponential disk** The surface-brightness profiles of many galactic disks are approximately exponential in form (eq. 1.7). Let us use the results just derived to calculate the potential that such a disk would generate if its surface mass density were also exponential. Setting

\[\Sigma(R)=\Sigma_{0}{\rm e}^{-R/R_{\rm d}}, \tag{2.162}\]

we use equation (C.69) to show that the inner integral in equations (2.153a) to (2.157) is

\[\int_{a}^{\infty}{\rm d}R^{\prime}\frac{R^{\prime}\Sigma_{0}{\rm e}^{-R^{ \prime}/R_{\rm d}}}{\sqrt{R^{\prime 2}-a^{2}}}=\Sigma_{0}aK_{1}(a/R_{\rm d}), \tag{2.163}\]

where \(K_{1}\) is a modified Bessel function (Appendix C.7). Figure 2.16 shows contours of the potential that one obtains by substituting this formula into equation (2.154).

The potential in the equatorial plane is given by substituting (2.163) into equation (2.155):

\[\begin{split}\Phi(R,0)&=-4G\Sigma_{0}\int_{0}^{R}{ \rm d}a\,\frac{aK_{1}(a/R_{\rm d})}{\sqrt{R^{2}-a^{2}}}\\ &=-\pi G\Sigma_{0}R\big{[}I_{0}(y)K_{1}(y)-I_{1}(y)K_{0}(y)\big{]},\end{split} \tag{2.164a}\]where

\[y\equiv{R\over 2R_{\rm d}},\]

we have used equation (C.70), and the \(I_{n}\) are modified Bessel functions (Appendix C.7).

If we differentiate equation (2.164a) with respect to \(R\), we obtain the circular speed of the exponential disk (Freeman 1970):

\[v_{\rm c}^{2}(R)=R{\partial\Phi\over\partial R}=4\pi G\Sigma_{0}R_{\rm d}y^{2} \left[I_{0}(y)K_{0}(y)-I_{1}(y)K_{1}(y)\right].\]

In Figure 2.17 we show this circular speed together with the circular speed of the spherical body that has as much mass \(M_{\rm s}(r)\) interior to \(r=R\) as the exponential disk, that is,

\[\eqalign{M_{\rm s}(R)=M_{\rm d}(R)&=2\pi\int_{0}^{R}{\rm d}R^{\prime}\,R^{ \prime}\Sigma_{0}{\rm e}^{-R^{\prime}/R_{\rm d}}\cr&=2\pi\Sigma_{0}R_{\rm d}^{2 }\biggl{[}1-{\rm e}^{-R/R_{\rm d}}\Bigl{(}1+{R\over R_{\rm d}}\Bigr{)}\biggr{]}.}\]

The exponential disk achieves a peak circular speed that is about 15% higher than that of the equivalent spherical distribution. The dotted line in Figure 2.17 gives the Keplerian circular speed for a system in which the entire mass of the disk is concentrated at the center. Notice that the disk's circular speed approaches the Keplerian speed only slowly and from above, whereas the circular speed of the equivalent spherical distribution tends rapidly to the Keplerian speed from below.

**(c) Thick disks** Although galactic disks are thin in the sense that the density falls off much faster perpendicular to the equatorial plane than in the radial direction within the plane, it is frequently essential to take into account the non-zero thickness of the disk in the perpendicular direction. For example, the dynamics of the solar neighborhood, and of the Sun itself, would be very different if the Galactic disk were razor-thin rather than some hundreds of parsecs thick. The techniques for deriving the potential of a spheroidal system that are described in SS2.5.1 are not directly applicable to this problem because the density of a galactic disk is generally not constant on spheroids. The multipole expansion described in SS2.4 is also not suitable, because it converges slowly for flat systems. Here we describe how to calculate the potential of a disk when the density is of the form

\[\rho(R,z)=\Sigma(R)\zeta(z). \tag{167}\]

Physically, this formula implies that a cross-section through the disk always has the same shape, no matter at what radius it is taken. In particular, the characteristic scale height of the disk is independent of \(R\), an assumption that is in reasonable agreement with observations of edge-on disk galaxies (BM SS4.4.3).

It is convenient to normalize the function \(\zeta(z)\) in equation (167) such that \(\int{\rm d}z\,\zeta(z)=1\). With this normalization, \(\Sigma(R)\) is the total surface density

Figure 17: The circular-speed curves of: an exponential disk (full curve); a point with the same total mass (dotted curve); the spherical body for which \(M(r)\) is given by equation (166) (dashed curve).

and \(\Sigma(R)\zeta(z)\,{\rm d}z\) is the surface density of the layer of material of thickness \({\rm d}z\) that lies a distance \(z\) above the equatorial plane. Let \(\Phi_{0}(R,z)\) be the potential that would be generated by a razor-thin disk with surface density \(\Sigma(R)\) that lay in the plane \(z=0\). Then the potential generated at \((R,z)\) by the layer at distance \(z^{\prime}\) from the plane is

\[{\rm d}\Phi(R,z)={\rm d}z^{\prime}\,\Phi_{0}(R,z-z^{\prime})\zeta(z^{\prime}). \tag{2.168}\]

Adding the contributions to the disk's potential from every layer, we obtain for the overall potential

\[\Phi(R,z)=\int_{-\infty}^{\infty}{\rm d}z^{\prime}\,\zeta(z^{\prime})\Phi_{0}( R,z-z^{\prime}), \tag{2.169}\]

where \(\Phi_{0}\) can be obtained from either (2.153a) or (2.154).

Consider, for example, the exponential disk (2.162). Then inserting into equation (2.153a) the derivative \(-\Sigma_{0}(a/R_{\rm d})K_{0}(a/R_{\rm d})\) with respect to \(a\) of equation (2.163), and then substituting the resulting value of \(\Phi_{0}\) into equation (2.169), we find

\[\Phi(R,z)=-\frac{4G\Sigma_{0}}{R_{\rm d}}\int_{-\infty}^{\infty}{\rm d}z^{ \prime}\,\zeta(z^{\prime})\int_{0}^{\infty}{\rm d}a\,\sin^{-1}\bigg{(}\frac{2a }{\sqrt{+}+\sqrt{-}}\bigg{)}aK_{0}(a/R_{\rm d}), \tag{2.170}\]

where \(\sqrt{\pm}\) is defined by equation (2.153b) with \(z\) replaced by \(z-z^{\prime}\). We shall use this formula in SS2.7 below.

#### 2.6.2 Disk potentials from Bessel functions

Disk galaxies generally contain non-axisymmetric features such as a bar or spiral arms. Hence it is essential to know how to calculate the potential of a flattened, non-axisymmetric system. Several methods may be employed and none is ideal for every problem. Evans & de Zeeuw (1992) show how the results of SS2.5.3 may be used to obtain the potential of razor-thin, elliptical disks in analogy with the work of SS2.6.1. However, the technique they present is not easy to apply, so in the rest of this section we present three alternatives, each with its own strengths when applied to particular problems. All these methods can also be applied to axisymmetric disks, and all yield alternatives to the formulae of SS2.5.

Above and below an isolated razor-thin disk the gravitational potential satisfies Laplace's equation, \(\nabla^{2}\Phi=0\), with appropriate boundary conditions on the disk and at infinity. In cylindrical coordinates Laplace's equation is (eq. B.52)

\[\frac{1}{R}\frac{\partial}{\partial R}\left(R\frac{\partial\Phi}{\partial R} \right)+\frac{1}{R^{2}}\frac{\partial^{2}\Phi}{\partial\phi^{2}}+\frac{ \partial^{2}\Phi}{\partial z^{2}}=0. \tag{2.171}\]Writing

\[\Phi(R,z)=J(R)F(\phi)Z(z), \tag{2.172}\]

we obtain by the method of separation of variables (see SS2.4)

\[\frac{1}{J(R)R}\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{\mathrm{d}J}{\mathrm{d }R}\right)+\frac{1}{F(\phi)R^{2}}\frac{\mathrm{d}^{2}F}{\mathrm{d}\phi^{2}}=- \frac{1}{Z(z)}\frac{\mathrm{d}^{2}Z}{\mathrm{d}z^{2}}=-k^{2}, \tag{2.173}\]

where \(k\) is an arbitrary real or complex number. Thus

\[0 =\frac{\mathrm{d}^{2}Z}{\mathrm{d}z^{2}}-k^{2}Z, \tag{2.174}\] \[0 =\frac{1}{J(R)R}\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{ \mathrm{d}J}{\mathrm{d}R}\right)+\frac{1}{F(\phi)R^{2}}\frac{\mathrm{d}^{2}F} {\mathrm{d}\phi^{2}}+k^{2}.\]

The first of equations (2.174) may be immediately integrated to

\[Z(z)=\mathrm{e}^{\pm kz}. \tag{2.175}\]

When multiplied by \(R^{2}\), the second of equations (2.174) separates into equations for \(J\) and \(F\):

\[0 =\frac{\mathrm{d}^{2}F}{\mathrm{d}\phi^{2}}+m^{2}F \tag{2.176}\] \[0 =R\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{\mathrm{d}J}{ \mathrm{d}R}\right)+k^{2}R^{2}J(R)-m^{2}J.\]

The first of these equations trivially yields \(F\propto\mathrm{e}^{\mathrm{i}m\phi}\), where \(m\) is an integer. If we make the substitution \(u\equiv kR\), the second equation simplifies to

\[u\frac{\mathrm{d}}{\mathrm{d}u}\left(u\frac{\mathrm{d}J}{\mathrm{d}u}\right)+( u^{2}-m^{2})J(u)=0. \tag{2.177}\]

We require the solution of this equation to be finite at \(u=0\) (\(R=0\)). This solution is conventionally written \(J_{m}(u)=J_{m}(kR)\) and is called the Bessel function of order \(m\) (Appendix C.7). Summarizing these results, we have that the functions

\[\Phi_{\pm}(R,z)=\mathrm{e}^{\mathrm{i}(m\phi\pm kz)}J_{m}(kR) \tag{2.178}\]

are solutions of \(\nabla^{2}\Phi=0\).

Figure 2.18: The disk mass within the box shown in cross-section equals \(-(4\pi G)^{-1}\) times the integral of the normal component of \(\boldsymbol{\nabla}\Phi_{km}\) over the surface of the box. The horizontal component of \(\boldsymbol{\nabla}\Phi_{km}\) is due to the gravitational attraction from the rest of the galaxy.

Now consider the function

\[\Phi_{km}(R,z)={\rm e}^{{\rm i}m\phi-k|z|}J_{m}(kR),\]

where \(k\) is real and positive. \(\Phi_{km}\) satisfies all the conditions required for it to be the potential generated by an isolated density distribution: it is non-singular at \(R=0\), periodic in \(\phi\) and vanishes at large distances from the origin. Furthermore, for \(z>0\), \(\Phi_{km}\) coincides with \(\Phi_{-}\), and for \(z<0\), \(\Phi_{km}\) coincides with \(\Phi_{+}\). Therefore, \(\Phi_{km}\) solves \(\nabla^{2}\Phi=0\) everywhere except in the plane \(z=0\). At \(z=0\), \(\Phi_{km}\) does not satisfy Laplace's equation because its gradient suffers a discontinuity. Figure 2.18 illustrates how we may use Gauss's theorem (eq. 2.12) to evaluate the surface density \(\Sigma_{km}(R,\phi)\) of the sheet that generates this discontinuity. We have that

\[\lim_{z\to 0+}{\partial\Phi_{km}\over\partial z}=-k{\rm e}^{{\rm i}m\phi}J_{m}( kR)\quad\hbox{and}\quad\lim_{z\to 0-}{\partial\Phi_{km}\over\partial z}=+k{\rm e}^{{ \rm i}m\phi}J_{m}(kR).\]

The integral of \(\hbox{\boldmath$\nabla$}\Phi_{km}\) over the closed unit surface that is shown in the figure must equal \(4\pi G\Sigma_{km}\) from which it follows that

\[\Sigma_{km}(R,\phi)=-{k\over 2\pi G}\,{\rm e}^{{\rm i}m\phi}J_{m}(kR).\]

We now use equations (2.179) to find the potential generated by a disk of arbitrary surface density \(\Sigma(R,\phi)\). If we can find functions \(S_{m}(k)\) such that

\[\eqalign{\Sigma(R,\phi)&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)\Sigma_{km}(R,\phi)\cr&=-{1\over 2\pi G}\sum_{m=-\infty}^{\infty}\int_{0}^{ \infty}{\rm d}k\,kS_{m}(k){\rm e}^{{\rm i}m\phi}J_{m}(kR),\cr}\]

then we will have

\[\eqalign{\Phi(R,\phi,z)&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)\Phi_{km}(R,\phi,z)\cr&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)J_{m}(kR){\rm e}^{{\rm i}m\phi-k|z|}.\cr}\]

Multiplying (2.181) through by \({\rm e}^{-{\rm i}m^{\prime}\phi}\) and averaging over \(\phi\), we obtain

\[\Sigma_{m^{\prime}}(R)\equiv{1\over 2\pi}\int_{0}^{2\pi}{\rm d}\phi\,{\rm e}^{-{ \rm i}m^{\prime}\phi}\Sigma(R,\phi)=-{1\over 2\pi G}\int_{0}^{\infty}{\rm d}k\, kS_{m^{\prime}}(k)J_{m^{\prime}}(kR).\]Equation (2.183) states that \(S_{m}(k)\) is the \(m\)th-order Hankel transform of \(-2\pi G\Sigma_{m}\) (eq. C.60b). Hankel transforms have properties that are similar to those of the familiar Fourier transforms (Appendix B.4). In particular, they may be inverted by use of equation (C.60a). We find

\[S_{m}(k)=-2\pi G\int_{0}^{\infty}{\rm d}R\,RJ_{m}(kR)\Sigma_{m}(R). \tag{2.184}\]

When we eliminate \(S_{m}(k)\) between this equation and (2.182), we obtain finally

\[\Phi(R,\phi,z)=-2\pi G\!\!\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}\!\!{\rm d }k\,{\rm e}^{{\rm i}m\phi-k|z|}J_{m}(kR)\!\int_{0}^{\infty}\!\!{\rm d}R^{\prime }\,R^{\prime}J_{m}(kR^{\prime})\Sigma_{m}(R^{\prime}). \tag{2.185}\]

Application to axisymmetric disks Potential-density pairs for axisymmetric disks are obtained by setting \(z=0\) in equation (2.182) and restricting the sum to the case \(m=0\). We have (Toomre 1963)

\[\Phi(R,0)=\int_{0}^{\infty}{\rm d}k\,S_{0}(k)J_{0}(kR). \tag{2.186}\]

Differentiating with respect to \(R\) and using the identity \({\rm d}J_{0}(x)/{\rm d}x=-J_{1}(x)\) (eq. C.58), we obtain

\[v_{\rm c}^{2}(R)=R\frac{\partial\Phi}{\partial R}=-R\int_{0}^{\infty}{\rm d}k \,kS_{0}(k)J_{1}(kR). \tag{2.187}\]

Substituting for \(S_{0}(k)\) from equation (2.184) this can be rewritten

\[v_{\rm c}^{2}(R)=2\pi GR\int_{0}^{\infty}{\rm d}k\,kJ_{1}(kR)\int_{0}^{\infty} {\rm d}R^{\prime}\,R^{\prime}\Sigma(R^{\prime})J_{0}(kR^{\prime}). \tag{2.188}\]

Applying to equation (2.187) the inversion formula for Hankel transforms (eqs. C.60) we find

\[S_{0}(k)=-\int_{0}^{\infty}{\rm d}R^{\prime}\,v_{\rm c}^{2}(R^{\prime})J_{1}( kR^{\prime}). \tag{2.189}\]

Substituting this expression for \(S_{0}\) into equation (2.181), we have

\[\Sigma(R)=\frac{1}{2\pi G}\int_{0}^{\infty}{\rm d}k\,kJ_{0}(kR)\int_{0}^{ \infty}{\rm d}R^{\prime}\,v_{\rm c}^{2}(R^{\prime})J_{1}(kR^{\prime}). \tag{2.190}\]

Comparison of this formula with our expression (2.188) for the reverse relation reveals complete symmetry between the quantities \(v_{\rm c}(R)\) and \(2\pi GR\Sigma(R)\)(Kalnajs 1999). Hence our mathematics seems to be saying that it is as easy to determine a disk's surface density from measurements of its circular speed, as to obtain the circular speed from the surface density. Unfortunately, observational constraints destroy this symmetry. The key point is that the left side of either equation (2.188) or (2.190) can be determined at any given value of \(R\) only if the variable on the right side can be measured out to radii at which its value becomes negligible. The surface density declines rapidly with radius, so equation (2.188) can be used to derive accurate values of \(v_{\rm c}\). Circular speeds, by contrast, decline little if at all out to the largest observable radii. Consequently, in practice we cannot obtain the data needed to determine \(\Sigma\) accurately from equation (2.190).

##### 2.6.3 Disk potentials from logarithmic spirals

An alternative technique for finding non-axisymmetric potential-density pairs was introduced by Kalnajs (1971). The potential \(\Phi(R,\phi)\) at any point in the plane of a disk is

\[\Phi(R,\phi) =-G\int{\rm d}R^{\prime}\,R^{\prime}\int{\rm d}\phi^{\prime}\, \frac{\Sigma(R^{\prime},\phi^{\prime})}{|{\bf x}-{\bf x}^{\prime}|} \tag{2.191}\] \[=-G\int_{0}^{\infty}{\rm d}R^{\prime}\,R^{\prime}\int_{0}^{2\pi }{\rm d}\phi^{\prime}\,\frac{\Sigma(R^{\prime},\phi^{\prime})}{\sqrt{R^{ \prime 2}+R^{2}-2RR^{\prime}\cos(\phi^{\prime}-\phi)}}.\]

The integral in this expression can be simplified if we define a new radial coordinate,

\[u\equiv\ln R, \tag{2.192}\]

and introduce the **reduced potential**\(V\) and the **reduced surface density**\(S\) by

\[R^{1/2}\Phi\equiv V(u,\phi)={\rm e}^{u/2}\Phi\left[R(u),\phi\right] \tag{2.193}\] \[R^{3/2}\Sigma\equiv S(u,\phi)={\rm e}^{3u/2}\Sigma\left[R(u),\phi \right].\]

With these substitutions (2.191) becomes

\[V(u,\phi)=-G\int_{-\infty}^{\infty}{\rm d}u^{\prime}\int_{0}^{2\pi}{\rm d} \phi^{\prime}\,K(u-u^{\prime},\phi-\phi^{\prime})S(u^{\prime},\phi^{\prime}),\] (2.194a) where \[K(u-u^{\prime},\phi-\phi^{\prime})\equiv\frac{1}{\sqrt{2}\sqrt{\cosh(u-u^{ \prime})-\cos(\phi-\phi^{\prime})}}. \tag{2.194b}\]

Now consider the reduced potential \(V_{\alpha m}(u,\phi)\) that is generated by the particular reduced surface density

\[S_{\alpha m}(u,\phi)={\rm e}^{{\rm i}(\alpha u+m\phi)}, \tag{2.195}\]where \(\alpha\) is a real number and \(m\) is an integer. We have

\[V_{\alpha m}(u,\phi)=-G\int_{-\infty}^{\infty}\mathrm{d}u^{\prime} \int_{0}^{2\pi}\mathrm{d}\phi^{\prime}\,K(u-u^{\prime},\phi-\phi^{\prime}) \mathrm{e}^{\mathrm{i}(\alpha u^{\prime}+m\phi^{\prime})} \tag{2.196}\] \[=-G\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}\int_{-\infty}^{\infty} \mathrm{d}u^{\prime}\int_{0}^{2\pi}\mathrm{d}\phi^{\prime}\,K(u-u^{\prime}, \phi-\phi^{\prime})\mathrm{e}^{\mathrm{i}[\alpha(u^{\prime}-u)+m(\phi^{\prime} -\phi)]}.\]

If we change to new variables of integration \(u^{\prime\prime}\equiv u-u^{\prime}\) and \(\phi^{\prime\prime}\equiv\phi-\phi^{\prime}\), equation (2.196) becomes

\[V_{\alpha m}=-GN(\alpha,m)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}, \tag{2.197}\]

where

\[\begin{split} N(\alpha,m)&\equiv\int_{-\infty}^{ \infty}\mathrm{d}u^{\prime\prime}\int_{0}^{2\pi}\mathrm{d}\phi^{\prime\prime} \,K(u^{\prime\prime},\phi^{\prime\prime})\mathrm{e}^{-\mathrm{i}(\alpha u^{ \prime\prime}+m\phi^{\prime\prime})}\\ &=\pi\frac{(\frac{1}{2}m-\frac{3}{4}+\frac{1}{2}\mathrm{i}\alpha)!(\frac{1}{2}m-\frac{3}{4}-\frac{1}{2}\mathrm{i}\alpha)!}{(\frac{1}{2}m-\frac{ 1}{4}+\frac{1}{2}\mathrm{i}\alpha)!(\frac{1}{2}m-\frac{1}{4}-\frac{1}{2} \mathrm{i}\alpha)!}.\end{split} \tag{2.198}\]

The kernel \(N(\alpha,m)\) is real and even in both \(\alpha\) and \(m\).7 The reduced potential generated by an arbitrary linear combination

Footnote 7: These statements can be proved using equations (C.12) and (C.14).

\[S(u,\phi)\equiv\sum_{m=-\infty}^{\infty}\int_{-\infty}^{\infty}\frac{\mathrm{ d}\alpha}{2\pi}\,A_{m}(\alpha)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}\] (2.199a) of surface densities of the form ( 2.195 ) is \[V(u,\phi)=-G\sum_{m=-\infty}^{\infty}\int_{-\infty}^{\infty}\frac{\mathrm{d} \alpha}{2\pi}\,N(\alpha,m)A_{m}(\alpha)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}.\] (2.199b) Furthermore, equation ( 2.199a ) states that \[A_{m}(\alpha)\] is nothing but the Fourier transform of the reduced surface density \[S(u,\phi)\] (eqs. B.64  and B.67 ). Consequently, \[A_{m}(\alpha)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathrm{d}u\int_{0}^{2\pi} \mathrm{d}\phi\,S(u,\phi)\mathrm{e}^{-\mathrm{i}(\alpha u+m\phi)}. \tag{2.199c}\]

So we may use equations (2.199) to obtain the potential in the plane \(z=0\) that is generated by any distribution of surface density. Since \(\alpha u+m\phi=\alpha\ln R+m\phi\) is constant on **logarithmic spirals**, equations (2.199) determine the potential of a disk by decomposing the density into spirals. Note that this derivation does not produce an expression for the value of the potential away from the plane \(z=0\) (Problem 2.19 remedies this defect).

#### 2.6.4 Disk potentials from oblate spheroidal coordinates

In some situations we require the potential of a disk with a sharp outer edge. If the outer edge is circular, this problem can be efficiently solved using the oblate spheroidal coordinates of SS2.5.1.8 We substitute \(\Phi=U(u)V(v){\rm e}^{{\rm i}m\phi}\) into Laplace's equation using (2.101), and separate variables in the usual way. Then we find that \(U\) and \(V\) satisfy

Footnote 8: In the more general case in which the outer edge is an ellipse, one uses ellipsoidal coordinates (Morse & Feshbach 1953; Tremaine 1976b; Evans & de Zeeuw 1992).

\[\frac{m^{2}}{\sin^{2}v}-\frac{1}{V\sin v}\frac{{\rm d}}{{\rm d}v} \left(\sin v\frac{{\rm d}V}{{\rm d}v}\right) =l(l+1), \tag{2.200a}\] \[\frac{m^{2}}{\cosh^{2}u}+\frac{1}{U\cosh u}\frac{{\rm d}}{{\rm d}u }\left(\cosh u\frac{{\rm d}U}{{\rm d}u}\right) =l(l+1), \tag{2.200b}\]

where \(l(l+1)\) is the separation constant. The left side of equation (2.200a) is the same as the right side of equation (2.80) with \(V(v)\) substituted for \(P(\theta)\). Furthermore, the boundary conditions at \(v=0\) or \(\pi\) (i.e., along the \(z\) axis) that must be satisfied by a physically acceptable function \(V(v)\) are the same as the conditions we imposed on \(P(\theta)\). Hence

\[V(v,\phi)=V_{lm}{\rm Y}_{l}^{m}(v,\phi), \tag{2.201}\]

where \(V_{lm}\) is a constant and \({\rm Y}_{l}^{m}\) is the spherical harmonic defined by equation (C.42). Since the potential must be symmetrical about the plane of the disk \(v=\pi/2\), we must restrict ourselves to values of \(l\) and \(m\) for which \({\rm Y}_{l}^{m}(v,\phi)\) is an even function of \(\cos v\). Hence we require \(l-m\) to be even.

If we change the independent variable in equation (2.200b) to \(x={\rm i}\sinh u\), the equation becomes the associated Legendre equation (2.81b) with \(x\) now pure imaginary. If the potential is to vanish at infinity (large \(u\)), it must be proportional to the solution of equation (2.81b) that vanishes at large \(x\). This is written \(Q_{l}^{m}(x)\) (see C.5). Hence the functions

\[\Phi_{lm}(u,v,\phi)\equiv\frac{V_{lm}}{Q_{l}^{m}(0)}Q_{l}^{m}({\rm i}\sinh u){ \rm Y}_{l}^{m}(v,\phi)\ \ \ \ \ (l-m\ {\rm even}) \tag{2.202}\]

satisfy Laplace's equation everywhere outside the excluded disk \(u=0\) (\(z=0\), \(R\leq\Delta\)) and vanish at infinity. However, there is a discontinuity in the gradient of \(\Phi_{lm}\) on the excluded disk. By Gauss's theorem, this discontinuity is generated by a surface density \(\Sigma_{lm}(v,\phi)\); thus from equation (2.100) we have

\[\begin{split} 4\pi G\Sigma_{lm}(v,\phi)&=2\left(\hat{ \bf e}_{u}\!\cdot\!\mathbf{\nabla}\Phi_{lm}\right)_{u\to 0+}=\frac{2}{\Delta|\cos v |}\lim_{u\to 0+}\left(\frac{\partial\Phi_{lm}}{\partial u}\right)\\ &=2V_{lm}{\rm i}\lim_{x\to 0}\left[\frac{{\rm d}\ln Q_{l}^{m}(x)}{{ \rm d}x}\right]\frac{{\rm Y}_{l}^{m}(v,\phi)}{\Delta|\cos v|},\end{split} \tag{2.203}\]where \(x\) approaches zero along the positive imaginary axis. Using equations (C.31) and (C.13) to evaluate the limit in equation (2.203), we then find (Hunter 1963)

\[\Sigma_{lm}=-\frac{2V_{lm}}{\pi^{2}G\Delta g_{lm}}\,\frac{{\rm Y}_{l}^{m}(v, \phi)}{|\cos v|},\] (2.204a) where \[g_{lm}\equiv\frac{(l+m)!(l-m)!}{2^{2l-1}\left[\left(\frac{l+m}{2}\right)! \left(\frac{l-m}{2}\right)!\right]^{2}}. \tag{2.204b}\]

A general disk potential, which is a sum over \(l\) and \(m\) of potentials of the form (2.202), is generated by the surface density \(\Sigma(v,\phi)\) that is the sum of surface densities \(\Sigma_{lm}(v,\phi)\). According to equation (2.204a), \(-2V_{lm}/(\pi^{2}G\Delta g_{lm})\) is the coefficient of \({\rm Y}_{l}^{m}(v,\phi)\) when \(|\cos v|\Sigma(v,\phi)\) is expanded in spherical harmonics. Thus with the orthogonality relation (C.44) we have

\[\frac{2V_{lm}}{\pi^{2}G\Delta g_{lm}}=-\int_{0}^{2\pi}{\rm d}\phi\int_{0}^{ \pi}{\rm d}v\,\sin v|\cos v|\Sigma(v,\phi){\rm Y}_{l}^{m\,*}(v,\phi). \tag{2.205}\]

The integrand in equation (2.205) is symmetrical about \(v=\pi/2\) when \(l-m\) is even, so we may restrict the \(v\) integration to the range \((0,\pi/2)\) and double the result. Hence

\[V_{lm}=-\frac{\pi^{2}Gg_{lm}}{\Delta}\int_{0}^{2\pi}{\rm d}\phi\int_{0}^{ \Delta}{\rm d}R\,R\Sigma(R,\phi){\rm Y}_{l}^{m\,*}\Big{(}\sin^{-1}(R/\Delta), \phi\Big{)}. \tag{2.206}\]

All the techniques in this section are special cases of a general method for finding disk potential-density pairs that is described by Qian (1992).

### 2.7 The potential of our Galaxy

In this section we investigate the gravitational field of our own galaxy, the Milky Way. The Galaxy is made of several components, the disk, the bulge, the stellar halo, and the dark halo. The mix of stars, gas and dark matter that makes up a galaxy such as our own varies from component to component and is even likely to depend on location within each component.

Ideally, we should rely solely on dynamical tracers, such as the velocity fields of gas and stars and observations of gravitational lensing, to map out the distribution of mass in the Galaxy. Sadly, at the present time such a project is unfeasible.

Since we are not yet in a position to model the Galactic density and gravitational field in a purely dynamical way, we flesh out the available dynamical constraints with photometric information. In particular, we simply assume_ that each component has a mass-to-light ratio \(\Upsilon\) that is independent of position. For the reason given above, this procedure is arbitrary and unsatisfactory, but it yields concrete Galactic potentials, which make testable predictions regarding the kinematics of stars and gas. Proceeding in this spirit, we now investigate models of our Galaxy, following Dehnen & Binney (1998a) and BM SS10.6.

The brightness distribution of each component is assumed to be similar to those of external galaxies (BM SSSS4.3 and 4.4), while the size and total luminosity of each component is determined from photometry and star counts, or by fitting to the available dynamical constraints. We do not model the stellar halo here since its contribution to the potential is negligible.

The models are constrained by fitting to the following data (cf. Table 1.2):

1. The circular-speed curve \(v_{\rm c}(R)\) for an assumed value of the solar circular speed, \(v_{0}\equiv v_{\rm c}(R_{0})\). Since this curve is determined from the line-of-sight velocities of tracers such as HI clouds and Cepheid stars, the circular-speed curve depends on \(v_{0}\), which must be determined by other methods.
2. The values of the Oort constants (Table 1.2, eq. 3.83, and BM SS10.3.3).
3. The total surface density within 1.1 kpc of the Galactic plane near the Sun, \(\Sigma_{1.1}(R_{0})\), and the contribution of the disk to this density (Table 1.1).
4. The velocity dispersion of bulge stars in Baade's window, a line of sight that passes \(\sim 500\) pc from the Galactic center in which absorption by intervening dust is unusually low. We take this dispersion to be \(117\pm 15\) km s\({}^{-1}\).
5. The total mass within 100 kpc of the Galactic center (eq. 1.12).
6. The solar radius \(R_{0}=8\) kpc.

The functional forms assumed for each of the Galaxy's components are as follows.

**(a) The bulge** The density of this component is assumed to be

\[\rho_{\rm b}(R,z)=\rho_{\rm b0}\Bigl{(}{m\over a_{\rm b}}\Bigr{)}^{-\alpha_{ \rm b}}{\rm e}^{-m^{2}/r_{\rm b}^{2}},\] (2.207a) where \[m=\sqrt{R^{2}+z^{2}/q_{\rm b}^{2}}. \tag{2.207b}\]

For \(q_{\rm b}<1\) this is an oblate, spheroidal power-law model that is truncated at an outer radius \(r_{\rm b}\). Its potential is conveniently calculated from equations (2.125) with

\[e=\sqrt{1-q_{\rm b}^{2}}\quad;\quad\psi(m)=\rho_{\rm b0}\int_{0}^{m}{\rm d}m^ {2}\,\Bigl{(}{m\over a_{\rm b}}\Bigr{)}^{-\alpha_{\rm b}}{\rm e}^{-m^{2}/r_{ \rm b}^{2}}. \tag{2.208}\]

Near-infrared photometry (BM SS10.2.1) suggests values for three of the parameters, \(\alpha_{\rm b}=1.8\), \(q_{\rm b}=0.6\), \(r_{\rm b}=1.9\) kpc, and without loss of generality,we can set \(a_{\rm b}=1\,{\rm kpc}\). The parameter \(\rho_{\rm b0}\), and hence the mass of the bulge, are determined by fitting the dynamical constraints.

**(b) The dark halo** By extending the spherical two-power-law models of SS2.2.2f to oblate models, the density of this component is taken to have the form

\[\rho_{\rm h}(R,z)=\rho_{\rm h0}\Bigl{(}\frac{m}{a_{\rm h}}\Bigr{)}^{-\alpha_{ \rm h}}\Bigl{(}1+\frac{m}{a_{\rm h}}\Bigr{)}^{\alpha_{\rm h}-\beta_{\rm h}}, \tag{2.209}\]

where \(m\) is again given by equation (2.207b) with \(q_{\rm b}\) replaced by \(q_{\rm h}\). The potential of this component, in which the density varies as \(r^{-\alpha_{\rm h}}\) for \(r\ll a_{\rm h}\) and \(r^{-\beta_{\rm h}}\) at large \(r\), can also be obtained from equation (2.125). Clearly, photometry provides no guidance as to the values of any of the parameters in equation (2.209); all five parameters \(\rho_{\rm h0}\), \(a_{\rm h}\), \(\alpha_{\rm h}\), \(\beta_{\rm h}\), and \(q_{\rm h}\) can only be determined by fitting the dynamical constraints. The data we use have little sensitivity to \(q_{\rm h}\), and we arbitrarily set it to 0.8.

**(c) The stellar disk** The density of the stellar disk is assumed to fall off exponentially with radius \(R\), as in equation (1.7), and to depend on distance from the midplane \(z\) through the sum of two exponentials, representing the thin and thick disks described on page 13--this dependence on \(z\) is motivated by observations such as those of Gilmore & Reid (1983), shown in BM Figure 10.25. Mathematically,

\[\rho_{\rm d}(R,z)=\Sigma_{\rm d}{\rm e}^{-R/R_{\rm d}}\biggl{(}\frac{\alpha_{ 0}}{2z_{0}}{\rm e}^{-|z|/z_{0}}+\frac{\alpha_{1}}{2z_{1}}{\rm e}^{-|z|/z_{1}} \biggr{)}, \tag{2.210}\]

where \(\alpha_{0}+\alpha_{1}=1\), \(\Sigma_{\rm d}\) is the central surface density, \(R_{\rm d}\) is the disk scale length, and \(z_{0}=0.3\,{\rm kpc}\) and \(z_{1}=1\,{\rm kpc}\) are scale heights for the thin and thick components. The potential generated by this density distribution is given by equation (2.170) with \(\zeta(z)\) replaced by the expression in large brackets in equation (2.210).

**(d) The interstellar medium** The disk formed by a galaxy's interstellar medium (ism) is thinner and more extended radially than the galaxy's stellar disk (see, for example, BM Figures 8.25 and 9.19). In the case of the Milky Way there is a hole of radius \(\sim 4\,{\rm kpc}\) at the center of the disk of the ism (BM Figure 9.19). These observations are crudely represented by taking the density of the ism to be

\[\rho_{\rm g}(R,z)=\frac{\Sigma_{\rm g}}{2z_{\rm g}}\exp\Big{(}-\frac{R}{R_{ \rm g}}-\frac{R_{\rm m}}{R}-\frac{|z|}{z_{\rm g}}\Bigr{)}, \tag{2.211}\]

with \(R_{\rm m}=4\,{\rm kpc}\) and \(z_{\rm g}=80\,{\rm pc}\). The parameters \(\Sigma_{\rm g}\) and \(R_{\rm g}\) are related to the parameters \(\Sigma_{\rm d}\) and \(R_{\rm d}\) of equation (2.210) by the assumption that \(R_{\rm g}=2R_{\rm d}\) and that the ism contributes 25% of the total disk surface density at the solar radius, \(R_{0}\). The potential implied by equation (2.211) is best found from equation (2.154).

Dehnen & Binney (1998a) found that fits to the constraints described above could be obtained for a wide range of models made up of the components (a) to (d). The most important single parameter for determining the properties of a model is the scale length of the stellar disk, \(R_{\rm d}\). In SS1.1.2 we estimated that \(R_{\rm d}\) lies between 2 and 3 kpc. When \(R_{\rm d}\) is at the lower end of this range, the disk dominates the gravitational field out to beyond the solar radius, whereas when \(R_{\rm d}=3\) kpc, the halo dominates at all radii. It is useful to examine the properties of two extreme models, namely the most and the least halo-dominated models; we designate them Models I and II and list their parameters in Table 2.3.

Model I has a small scale length, \(R_{\rm d}=2\) kpc, and gives rise to the isopotential surfaces and circular-speed curves shown in Figures 2.19 and 2.20. At small radii the halo density is \(\rho_{\rm h}\propto r^{-\alpha_{\rm h}}=r^{2}\), which is the smallest value of \(\alpha_{\rm h}\) allowed by the fitting program--with this disk scale length, the best fit has the smallest possible halo contribution near the center. Figure 2.20 illus

\begin{table}
\begin{tabular}{l|c c} \hline \hline Parameter & Model I & Model II \\ \hline \(R_{\rm d}/{\rm kpc}\) & 2 & 3.2 \\ \((\Sigma_{\rm d}+\Sigma_{\rm g})/{\cal M}_{\odot}\) pc\({}^{-2}\) & 1905 & 536 \\ \(\rho_{\rm b0}/{\cal M}_{\odot}\) pc\({}^{-3}\) & 0.427 & 0.3 \\ \(\rho_{\rm h0}/{\cal M}_{\odot}\) pc\({}^{-3}\) & 0.711 & 0.266 \\ \(\alpha_{\rm h}\) & \(-2\) & 1.63 \\ \(\beta_{\rm h}\) & 2.96 & 2.17 \\ \(a_{\rm h}/{\rm kpc}\) & 3.83 & 1.90 \\ \(M_{\rm d}/10^{10}\,{\cal M}_{\odot}\) & 5.13 & 4.16 \\ \(M_{\rm b}/10^{10}\,{\cal M}_{\odot}\) & 0.518 & 0.364 \\ \(M_{\rm h,<10\,kpc}/10^{10}\,{\cal M}_{\odot}\) & 2.81 & 5.23 \\ \(M_{\rm h,<100\,kpc}/10^{10}\,{\cal M}_{\odot}\) & 60.0 & 55.9 \\ \(v_{\rm e}(R_{0})/{\rm km\,s}^{-1}\) & 520 & 494 \\ \(f_{\rm b}\) & 0.05 & 0.04 \\ \(f_{\rm d}\) & 0.60 & 0.33 \\ \(f_{\rm h}\) & 0.35 & 0.63 \\ \hline \end{tabular}

Notes: In both models \(0.75\Sigma(R_{0})\) is contributed by stars, of which \(0.05\Sigma(R_{0})\) is in the thick disk. Interstellar gas accounts for the remaining \(0.25\Sigma(R_{0})\). The thin and thick disks have the same scale length \(R_{\rm d}\), while the gas disk has scale length \(2R_{\rm d}\) and a central hole of radius \(R_{\rm m}=4\) kpc. The thicknesses of the disks are \(z_{0}=300\) pc, \(z_{1}=1\) kpc, \(z_{\rm g}=80\) pc. In both models the bulge parameters are \(a_{\rm b}=1\) kpc, \(\alpha_{\rm b}=1.8\), \(r_{\rm b}=1.9\) kpc, \(q_{\rm b}=0.6\), while the halo axis ratio \(q_{\rm h}=0.8\). The quantity \(v_{\rm e}(R_{0})\) is the escape speed from the solar neighborhood; \(f_{\rm b}\), \(f_{\rm d}\) and \(f_{\rm h}\) are the fractions of the radial force supplied by bulge, disk and halo at \(R_{0}=8\) kpc. These are slightly modified forms of Models 1 and 4 of Dehnen & Binney (1998a).

\end{table}
Table 2.3Parameters of Galaxy modelstates the dynamical importance of the disk and bulge interior to the solar radius, showing that at such radii the halo makes only a small contribution to the overall circular speed--since \(v_{\rm c}^{2}\propto g\), the contribution to the gravitational force is even smaller. This dominance is reflected in the contour plots of Figure 2.19 by the much closer packing of the equipotential contours of the bulge (top left panel) and disk (lower left panel) than those of the halo (top right panel). The equipotential surfaces of the disk are naturally more

Figure 2.19: The lower right panel shows equipotential contours of a model of the Galaxy with \(R_{\rm d}=2\,{\rm kpc}\) (Model I). Contour levels are \((-0.5,-1,\,-1.5\ldots)\times(100\,{\rm km\,s^{-1}})^{2}\). The top left panel shows the potential of the bulge, while the potentials of halo and disk are shown at top right and lower left, respectively. From top left to lower right the potentials at \((R,z)=(8\,{\rm kpc},0)\) are \(-0.28,\,-10.2,\,-2.98,\,-13.46\times(100\,{\rm km\,s^{-1}})^{2}\).

Figure 2.20: The full curve shows the circular-speed curve of Model I, whose potential is contoured in Figure 2.19. The contributions from the bulge, halo and disk are shown by the long-dashed, dotted and short-dashed curves, respectively. Notice that the total circular speed is given by the sum in quadrature of the circular speeds of the components.

highly flattened than those of either the bulge or the halo, so the equipotential surfaces of the total potential are most flattened at radii \(r\sim 5\,{\rm kpc}\), where the disk's potential dominates.

Although in Model I the disk dominates the gravitational field (potential gradient) at \(R_{0}\), the halo makes by far the largest contribution to the total potential at all radii. For example, at the Sun's location the halo contributes \(-10.2\times(100\,{\rm km\,s^{-1}})^{2}\) to the overall potential, while the disk and bulge together contribute only \(-3.26\times(100\,{\rm km\,s^{-1}})^{2}\). The large contribution from the halo reflects the its enormous mass, most of it beyond \(R_{0}\). Just how much mass the halo contains is ill-determined because the Galaxy's circular speed \(v_{\rm c}(R)\) is uncertain beyond \(\approx 2R_{0}\).

Figures 2.21 and 2.22 analyze the potential of Model II, a model that has a larger disk scale length, \(R_{\rm d}=3.2\,{\rm kpc}\). As Figure 2.22 shows, in this model the halo dominates the circular speed at all radii. It does so because it is much more centrally concentrated than the halo of Model I: at small \(r\) its density rises towards the center as \(r^{-1.63}\) rather than falling as in Model I. At the solar position the escape speed in this model is \(v_{\rm e}(R_{0})=494\,{\rm km\,s^{-1}}\), which is observationally indistinguishable from \(v_{\rm e}(R_{0})=520\,{\rm km\,s^{-1}}\) in Model I; both are consistent with the observational estimate \(v_{\rm e}(R_{0})=(550\pm 50)\,{\rm km\,s^{-1}}\) in Table 1.2.

Figure 2.21: Equipotential contours of the halo-dominated Galaxy model, Model II, which has \(R_{\rm d}=3.2\,{\rm kpc}\). The top left panel shows the potential of the bulge, while the potentials of halo and disk are shown at top right and lower left, respectively. The lower right panel shows the overall potential with contour levels \((-0.5,-1,\,-1.5\ldots)\times(100\,{\rm km\,s^{-1}})^{2}\). From top left to lower right the potentials at \((R,z)=(8\,{\rm kpc},0)\) are \(-0.20\), \(-9.83\), \(-2.19\), \(-12.21\times(100\,{\rm km\,s^{-1}})^{2}\).

One of the striking conclusions from these models is that the relative contributions of the disk and the halo to the interior mass and the circular speed at \(R_{0}\) are very uncertain. As \(R_{\rm d}\) varies from 3.2 kpc to 2 kpc, the mass of the dark halo inside 10 kpc decreases by nearly a factor 2 and the fraction of the gravitational force at \(R_{0}\) contributed by the halo falls9 from 0.63 to 0.35. Similar uncertainties are encountered in models of external disk galaxies (van Albada et al. 1985; Sellwood 1999). This degeneracy between the disk and halo parameters has to be resolved by bringing other observational constraints or dynamical arguments to bear, such as those obtained from measurements of the dynamics of galactic bars (SS6.5.2e), and

Figure 2.23: In each panel the full curve shows as a function of \(z\) in a Galactic model the force towards the galactic plane, \(K_{z}=\partial\Phi/\partial z\) at \(R_{0}=8\) kpc. The contributions from the bulge plus halo and disk are shown by the dotted and dashed curves, respectively. The left panel is for disk-dominated model, Model I (Figures 2.19 and 2.20), while the right panel is for Model II (Figures 2.21 and 2.22).

Figure 2.22: The full curve shows the circular-speed curve of Model II. The contributions from the bulge, halo and disk are shown by the long-dashed, dotted and short-dashed curves, respectively.

the optical depth to gravitational microlensing towards the Galactic center (Bissantz & Gerhard 2002; Famaey & Binney 2005).

Even though the halo of Model II dominates the circular speed at \(R_{0}\), Figure 2.23 shows that the vertical force towards the disk, \(K_{z}=\partial\Phi/\partial z\), is dominated by the disk within \(\sim 2\,{\rm kpc}\) of the plane. Even a relatively low-mass disk can dominate \(K_{z}\) in this way because a disk's contribution to \(K_{z}\) rises extremely quickly near the plane, where the density of disk material is high. Above one scale height, \(\sim 200\,{\rm pc}\), the disk's contribution to \(K_{z}\) flattens off to the nearly constant value \(2\pi G\Sigma(R)\) (cf. Problem 2.3). By contrast, in both panels of Figure 2.23 the halo's contribution to \(K_{z}\) (dotted curves) rises nearly linearly with \(z\) out to several kiloparsecs above the Sun. Notice how similar the full curves in Figure 2.23 are: despite the very different contributions to \(v_{\rm c}\) from disk and halo in the two models, the shape of the observationally measurable quantity \(K_{z}\) (SS4.9.3) is almost the same in the two cases.

**(e) The bulge as a bar** There is both kinematic and photometric evidence that the Milky Way's bulge is in fact a bar, that is, a highly elongated, rapidly rotating stellar system (SS6.5 and BM SSSS9.4 and 10.1). From the vantage point of the Sun, it is hard to determine the precise shape of the bar, but, as sketched in Figure 2.24, the bar is believed to extend to a Galactocentric radius \(\sim 3\,{\rm kpc}\), with its longest axis inclined by about \(20^{\circ}\) to the line from the Sun to the Galactic center (Bissantz & Gerhard 2002). The lengths of the bar's semi-axes are roughly in the ratios \(1\,{:}\,0.3\,{:}\,0.3\).

Both photometric studies of the bar itself and comparisons with bars in other galaxies suggest that the isodensity surfaces deviate significantly from ellipsoids (Lopez-Corredoira et al. 2005). Nonetheless, when considering the impact that the bar has on the Galaxy's gravitational potential, it is useful to start by approximating the isodensity surfaces by ellipsoids for in this case we can obtain the potential from equation (2.140)--if a more exact result were required, one could expand the difference \(\rho({\bf x})-\rho_{\rm e}({\bf x})\) between the actual density distribution \(\rho\) and the elliptical model \(\rho_{\rm e}\) in spherical harmonics, and obtain the small correction to the potential from equation (2.95). In this spirit, we estimate the effect of the bar on the Galaxy's potential by fashioning a bar out of the axisymmetric bulge of Model I as follows.

In equations (2.207) we increase the scale radius \(r_{\rm b}\) from \(1.9\,{\rm kpc}\) to \(3\,{\rm kpc}\), and redefine \(m\) by \(m^{2}=x^{2}+(y^{2}+z^{2})/q^{2}\), where \(x\) runs along the bar's long axis. We adopt \(q=0.35\) and increase \(\rho_{0}\) so that the bar has roughly the same mass as the original bulge. In Figure 2.25 the full curves show the

Figure 2.24: Schematic diagram of the Galactic bar.

intersection with the Galactic plane of the bar's isopotential surfaces, while the dotted curves show the corresponding curves for the bulge of Model I. As expected, the bar's isopotential surfaces are elongated. The effect is very small near the solar circle but appreciable at \(R\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}5\,\)kpc. On account of this elongation, the potential now generates tangential forces: Along a radius that makes an angle of \(45^{\circ}\) with the bar's long axis, the ratio \(F_{\phi}/F_{r}\) of the tangential and radial forces from the bar falls from 0.4 at the center to 0.27 at 2 kpc and 0.125 at 4 kpc. From Figure 2.20 we see that the bulge dominates \(F_{r}\) at \(R\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}1\,\)kpc, so in this crude model tangential forces are very important at small radii. Conversely, at \(R\simeq 4\,\)kpc the bulge contributes only 11% of \(F_{r}\), so at that radius \(F_{\phi}\) is only \(\sim 1\%\) of \(F_{r}\). Nonetheless, the tangential forces that the bar induces can be dynamically significant for resonant orbits as far out as the solar circle because along such orbits the effect of \(F_{\phi}\) can accumulate over several periods (SS3.7.2 and Dehnen 2000a).

We conclude that accurate models of the triaxial bar are needed to understand the dynamics of the Milky Way at \(R\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}2\)-3 kpc, and possibly beyond.

### 2.8 Potentials from functional expansions

A common theme of many of the methods we have described is the expansion of the gravitational potential and density in a set of functions that are potential-density pairs. We shall encounter such methods again in SS2.9.4 as efficient tools for N-body simulation, and in SS5.3.2, where we study linear response theory for stellar systems. In this section we re-examine these techniques from a general standpoint.

The basic idea of SS2.3 was to approximate a real galactic density distribution by a density for which the potential is known analytically. Only a

Figure 2.25: Full curves show the intersection with the Galactic plane of the isopotential surfaces of a model of the galactic bar. For comparison the dotted curves show the same curves for the axisymmetric bulge of Model I.

small number of different functional forms for the density were presented, so with them the potential of a given galaxy could not be calculated to arbitrary accuracy. In SSSS2.6.2 to 2.6.4 we described a second approach: representing the system's density as an infinite sum of density distributions of known potential--for example the Bessel-function distributions \(\Sigma_{km}(R,\phi)\) that are defined by equations (2.179). This second approach has the advantage that the potential and density can be approximated to arbitrarily high accuracy. However, a good approximation will require that a large number of terms are taken in the sum for the potential, because none of the density distributions of individual terms resembles real galaxies.

Here we show how to combine the best aspects of these two approaches. In mathematical language, we find pairs of (possibly complex) **basis functions**\(\Phi_{\beta}({\bf x})\) and \(\rho_{\beta}({\bf x})\) for \(\beta=1,2,\ldots\), that satisfy

\[\nabla^{2}\Phi_{\beta}=4\pi G\rho_{\beta}, \tag{2.212}\]

and determine coefficients \(a_{\beta}\) such that the density of the system under study can be written as the sum

\[\rho({\bf x})=\sum_{\beta}a_{\beta}\rho_{\beta}({\bf x});\] (2.213a) then the system's potential \[\Phi({\bf x})\] is given by \[\Phi({\bf x})=\sum_{\beta}a_{\beta}\Phi_{\beta}({\bf x}). \tag{2.213b}\]

We determine the coefficients \(a_{\beta}\) as follows. We multiply equation (2.213a) by \(-\Phi_{\alpha}^{*}\) and integrate over all space to obtain

\[s_{\alpha}=\sum_{\beta}M_{\alpha\beta}a_{\beta},\] (2.214a) where \[s_{\alpha}=-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x})\rho({\bf x}) \quad;\quad M_{\alpha\beta}=-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x })\rho_{\beta}({\bf x}). \tag{2.214b}\]

The elements of the matrix \({\bf M}\) have a simple physical interpretation: \(M_{\alpha\beta}\) is minus the potential energy of the density distribution \(\rho_{\beta}\) in the gravitational potential \(\Phi_{\alpha}^{*}\). Using Poisson's equation (2.212) and applying the divergence theorem (B.45), we can show that \({\bf M}\) is a Hermitian matrix:10

Footnote 10: In the language of linear operators, the natural inner product on the space spanned by \(\{\Phi_{\alpha}\}\) is \((f,g)=-(4\pi G)^{-1}\int{\rm d}^{3}{\bf x}\,f^{*}\nabla^{2}g\). Then \((f,g)=(g,f)^{*}\) is minus the interaction energy of the density distributions associated with the potentials \(f^{*}\) and \(g\).

\[\eqalign{M_{\alpha\beta}&=-{1\over 4\pi G}\int{\rm d}^{3}{\bf x}\,\Phi_{ \alpha}^{*}\nabla^{2}\Phi_{\beta}\cr&=-{1\over 4\pi G}\oint\Phi_{\alpha}^{*}{ \boldsymbol{\nabla}}\Phi_{\beta}\cdot{\rm d}^{2}{\bf S}+{1\over 4\pi G}\int{\rm d }^{3}{\bf x}\,{\boldsymbol{\nabla}}\Phi_{\alpha}^{*}\cdot{\boldsymbol{\nabla}} \Phi_{\beta}.\cr} \tag{2.215}\]The surface term vanishes when the integral is taken over all space, because \(\Phi_{\alpha}\) falls off at least as fast as \(r^{-1}\). This result shows that \(M_{\alpha\beta}=M^{*}_{\beta\alpha}\) so \({\bf M}\) is Hermitian. Note that \({\bf M}\) does not depend on the galactic mass distribution, so it can be computed once and for all after the basis potentials \(\Phi_{\alpha}\) have been chosen, and subsequently used time and again to follow the evolution of the potentials of many different galaxies, or of a single dynamically evolving galaxy.

The coefficients \(a_{\beta}\) can now be found by solving the linear equation (2.214a). We can choose the basis functions to facilitate this process. There are two strategies for exploiting this freedom.

**(a) Bi-orthonormal basis functions** We choose the basis functions such that \({\bf M}\) is the unit matrix, so equation (2.214a) has the trivial solution \(a_{\alpha}=s_{\alpha}\). From equation (2.214b) we see that this requires that the basis functions are **bi-orthonormal**:

\[-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x})\rho_{\beta}({\bf x})= \delta_{\alpha\beta}. \tag{2.216}\]

A straightforward way of ensuring bi-orthonormality is to require that the \(\Phi_{\alpha}\) are eigenfunctions of the Hermitian operator \(\nabla^{2}\)--in this case \(\rho_{\alpha}\propto\Phi_{\alpha}\), and the orthogonality of \(\Phi_{\alpha}\) and \(\rho_{\beta}\) is assured by the usual theorem that the eigenfunctions of a Hermitian operator are mutually orthogonal. Examples include the three functional expansions for disk potentials described in SSSS2.6.2 to 2.6.4. In SS5.3.2 we shall use bi-orthonormal functional expansions to investigate the stability of stellar systems.

**(b) Designer basis functions** In principle \({\bf a}\) and \({\bf s}\) are vectors of infinite dimension. In practice it is necessary to truncate them and work with finite-dimensional vectors and matrices. The philosophy of **designer basis functions** is to choose the basis functions so that the galaxy can be accurately represented by the smallest possible number of them; the computational savings of having smaller vectors and matrices can more than offset the disadvantage that \({\bf M}\) no longer has a simple form. The approach is most easily described by a concrete example. We examine the important special case in which each basis function is the product of a function of radius \(r\) and a spherical harmonic:

\[\Phi_{\bf n}({\bf x})=F_{\bf n}(r){\rm Y}_{l}^{m}({\bf\Omega}), \tag{2.217}\]

where the potentials are enumerated by the vector \({\bf n}=(n,l,m)\), which has integer components, rather than the index \(\alpha\) used above; here \(n\) indexes an infinite number of radial functions for each spherical harmonic. Since the spherical harmonics (eq. C.44) are orthogonal, \({\bf M}\) is now block diagonal, that is, \(M_{{\bf n}^{\prime}{\bf n}}=0\) for \(l^{\prime}\neq l\) or \(m^{\prime}\neq m\). Thus the equations (2.214a) can be solved separately for each spherical-harmonic index pair \((l,m)\).

Applying the Laplacian operator (C.49) to equation (2.217), we find with Poisson's equation (2.212) that \(\rho_{\bf n}\) is given by

\[4\pi G\rho_{\bf n}({\bf x})=\nabla^{2}\Phi_{\bf n}={\rm Y}_{l}^{m}({\bf\Omega} )\biggl{[}{1\over r^{2}}{{\rm d}\over{\rm d}r}\Bigl{(}r^{2}{{\rm d}F_{\bf n} \over{\rm d}r}\Bigr{)}-{l(l+1)\over r^{2}}F_{\bf n}\biggr{]}. \tag{2.218}\]For _any_ choice of the radial function \(F_{\bf n}\), equations (2.217) and (2.218) yield a potential-density pair. We now exploit this freedom to arrange for the first few functions \(\Phi_{\bf n}\) in the set to provide a good approximation to the potentials of real galaxies. One way of doing this is to set \(F_{000}(r)\) equal to the potential of one of the two-power-law models described in SS2.2.2g. For guidance in choosing \(F_{0lm}\) for \(l>0\) we turn to the solution of Poisson's equation that we obtained in terms of spherical harmonics in SS2.4. Considering the coefficient of \({\rm Y}_{l}^{m}\) in equation (2.95), we see that the terms proportional to \(r^{l}\) will be dominant at small \(r\) and the terms proportional to \(r^{-(l+1)}\) will be dominant at large \(r\). These observations imply that a promising choice for \(F_{0lm}\) is

\[F_{0lm}(r)=F_{l}(r)\equiv{r^{l}\over(1+r/r_{0})^{2l+1}}\quad(l>0),\]

where \(r_{0}\) is a suitable scale radius. If we also apply this equation for \(l=0\), then \(F_{0}(r)\) is proportional to the potential of a Hernquist model (eq. 2.67), consistent with our earlier argument that \(F_{000}\) should be the potential of a two-power-law galaxy model.

We must still expand our basis to include functions \(F_{\bf n}(r)\) for each given \((l,m)\) and \(n>0\) to describe accurately the radial dependence. To this end we write

\[F_{nl}(r)\equiv F_{\bf n}(r)=U_{n}(r)F_{l}(r),\]

where \(U_{0}(r)=1\) and the set of \(U_{n}\) is complete. A possible choice would be

\[U_{n}(r)=u^{n}\quad{\rm where}\quad u\equiv{r/r_{0}-1\over r/r_{0}+1}\quad(-1 \leq u<1).\]

When our choice of basis functions is inserted in equation (2.214b), we find with equation (2.218) that the matrix \({\bf M}\) and the vector \({\bf s}\) take the forms

\[\eqalign{M_{{\bf n}^{\prime}{\bf n}}&=-(4\pi G)^{-1}\delta_{l^{\prime}l} \delta_{m^{\prime}m}\int{\rm d}r\,F_{n^{\prime}l}^{*}(r)\biggl{[}{{\rm d}\over {\rm d}r}\Bigl{(}r^{2}{{\rm d}\over{\rm d}r}\Bigr{)}-l(l+1)\biggr{]}F_{nl}(r) \cr s_{{\bf n}^{\prime}}&=-\int{\rm d}^{3}{\bf x}\,{\rm Y}_{l}^{m*}({\bf\Omega })F_{n^{\prime}l}^{*}(r)\rho({\bf x}).}\]

It is possible to combine the best features of bi-orthonormal and designer basis functions. For example, if we choose \(F_{nl}(r)=U_{nl}(r)F_{l}(r)\), where \(F_{l}(r)\) is given by (2.219) and \(U_{nl}(r)\) is an appropriate polynomial in the variable \(u\) defined by equation (2.221), the designer basis functions are bi-orthonormal (Hernquist & Ostriker 1992).

## Chapter 2 Potential Theory

### 2.1 Introduction

The studyPoisson solvers for collisional problems can be designed to be essentially perfect: in SS7.4.6d we shall see that the conceptually difficult part of a collisional simulation is integrating the orbits of particles. By contrast, Poisson solvers for collisionless simulations are fundamentally limited by particle noise: since we do not really know \(\rho({\bf r})\) but only the locations of a finite number of particles that sample \(\rho({\bf r})\), we cannot recover \(\Phi({\bf r})\) accurately no matter how much potential theory we know. On account of this fundamental limitation, Poisson solvers for collisionless simulations inevitably involve a compromise between inadequate resolution and excessive statistical noise. Some solvers are undoubtedly better than others, but the solver that is best suited to a given simulation depends on the scientific problem that is to be addressed. In this section we describe the most important types of Poisson solver, and discuss their strengths and weaknesses.

#### Direct summation

Consider evaluating the force on particle \(\alpha\) by simply summing the contributions from all the other particles in the simulation,

\[{\bf F}_{\alpha}=\sum_{\beta\neq\alpha}Gm_{\beta}\frac{{\bf r}_{\beta}-{\bf r }_{\alpha}}{|{\bf r}_{\beta}-{\bf r}_{\alpha}|^{3}}. \tag{223}\]

Each such force evaluation involves the calculation of \(N-1\) distances \(|{\bf r}_{\beta}-{\bf r}_{\alpha}|\). Each distance can be used twice, once for the contribution of particle \(\beta\) to the force on particle \(\alpha\) and once for the force from particle \(\alpha\) on particle \(\beta\). So, if forces are evaluated by direct summation a minimum of \(\frac{1}{2}N(N-1)\) distances have to be evaluated, where \(N\gg 1\) is the number of particles in the simulation. Thus, the work per timestep increases with \(N\) as \(N^{2}\). Below we shall see that there are vastly more efficient ways of evaluating forces, which scale as \(N\ln N\).

The first N-body calculations were restricted to small values of \(N\), for which the difference between \(N^{2}\) and \(N\ln N\) is not large, so direct summation was a viable option. For the values of \(N>10\,000\) now current, \(N^{2}/(N\ln N)>10^{3}\), so direct summation is in principle not an attractive strategy. Notwithstanding this fact it is still in use because its simple formulae can be encoded in hardware, so special-purpose processors can calculate forces between tens of thousands of particles at acceptable speeds (Makino et al. 2003).

**Softening** If two particles, say \(\alpha\) and \(\beta\), approach each other closely, the term in equation (223) that describes the force \({\bf F}_{\alpha\beta}\) between them becomes large. This phenomenon is problematic for both collisional and collisionless calculations, for different reasons.

In the collisional case the divergence of \({\bf F}_{\alpha\beta}\) as \({\bf r}_{\alpha}\to{\bf r}_{\beta}\) is a real physical effect, but one that is computationally awkward because it implies that the equations of motion of particles \(\alpha\) and \(\beta\) have to be integrated with very small timesteps. Unless sophisticated workarounds such as "regularization" (SS3.4.7) are employed to handle this situation, close encounters can bring the integration virtually to a halt. "Softening" of the force-law as described below is an expedient that keeps the integration moving along at an acceptable pace at the price of a loss of realism.

In the collisionless case the divergence of \({\bf F}_{\alpha\beta}\) predicted by equation (2.223) is entirely unphysical, for the mass distribution we are trying to model is inherently smooth. The divergence is an artifact of the Monte-Carlo sampling of the density distribution. In this case softening can enhance rather than detract from the realism of the simulation.

Softening involves replacing equation (2.223) with

\[{\bf F}_{\alpha}=\sum_{\beta\neq\alpha}Gm_{\beta}S_{\rm F}(|{\bf r}_{\beta}-{ \bf r}_{\alpha}|)\,{{\bf r}_{\beta}-{\bf r}_{\alpha}\over|{\bf r}_{\beta}-{\bf r }_{\alpha}|}. \tag{2.224}\]

This equation differs from (2.223) only in the replacement of \(r^{-2}\) by \(S_{\rm F}(r)\), where \({\bf r}={\bf r}_{\beta}-{\bf r}_{\alpha}\). \(S_{\rm F}(r)\), the **force softening kernel**, is some function that tends to \(r^{-2}\) for values of its argument bigger than the **softening length**\(\epsilon\), and tends smoothly to zero for small values of its argument. Equation (2.224) has the desirable features that: (i) the force exerted by particle \(\beta\) on particle \(\alpha\), \(Gm_{\alpha}m_{\beta}S_{F}(r){\bf r}/r\), is equal and opposite to the force exerted by \(\alpha\) on \(\beta\), so Newton's third law is satisfied; (ii) the force between any two particles acts along the line that joins them; (iii) the force approaches the usual gravitational force at large separations; (iv) the force between two particles at the same location is zero.

\(S_{\rm F}(r)\) is the derivative of another function \(S(r)\), the **softening kernel**, which appears in the equation for the potential at the location of particle \(\alpha\):

\[\Phi_{\alpha}\equiv\Phi({\bf r}_{\alpha})=\sum_{\beta\neq\alpha}Gm_{\beta}S(| {\bf r}_{\beta}-{\bf r}_{\alpha}|). \tag{2.225}\]

A widely used form of \(S\) is

\[S({\bf r})=-{1\over\sqrt{r^{2}+\epsilon^{2}}}. \tag{2.226}\]

In this case, the gravitational potential of each particle is just that of a Plummer sphere of scale length \(\epsilon\) (eq. 2.44a). In a collisionless simulation this makes physical sense: the mass that is represented by a particle is in reality distributed through a non-zero volume.11 The density law of a Plummer sphere (eq. 2.44b) places most of the sphere's mass inside \(r=\epsilon\), so the natural choice is to make \(\epsilon\) of order the inter-particle separation.

In collisionless simulations the choice of softening kernel and softening length is a compromise between maximizing the smoothness of the force-field and minimizing the degradation of the spatial resolution caused by the softening. Despite its popularity, the choice (2.226) of \(S\) is not optimal in this sense, because the density of a Plummer sphere falls off too slowly with radius. A better choice is

\[S({\bf r})=-\frac{r^{2}+\frac{3}{2}\epsilon^{2}}{(r^{2}+\epsilon^{2})^{3/2}}, \tag{2.227}\]

which amounts to replacing the potential of each particle with that of a sphere of radius \(\epsilon\) in which the density is proportional to \((r^{2}+\epsilon^{2})^{-7/2}\). See Dehnen (2001) for a discussion of the merits of various softening kernels.

An ideal Poisson solver would allow \(\epsilon\) to vary as a particle moves from a high-density to a low-density region. In practice most contemporary Poisson solvers use fixed softening due to technical difficulties associated with energy conservation.

We now consider algorithms that enable one to evaluate the sum (2.225) to high accuracy in a number of arithmetic operations that scales as \(N\ln N\), rather as \(N^{2}\).

#### Tree codes

Our discussion is based on Dehnen (2000b). The particles are first organized into a structure that was introduced by Barnes & Hut (1986): we place an imaginary cube around the simulation and divide it into eight equal sub-cubes. If any sub-cube contains more than one particle, we divide it in turn into eight equal cubes, and so on until every cube contains at most one particle. This hierarchy of cubes forms an **oct-tree**, and the original cube is called the **root** of the tree. Each cube after the root has a parent cube, and seven sibling cubes. Any cube that contains more than one particle has eight child cubes. There is a clear analogy with a real tree, whose trunk divides into great boughs, which divide into branches, which divide into twigs, which ultimately carry leaves. Particles are the leaves of our oct-tree.

Suppose now that we locate the center of mass of the particles in each cube and evaluate the sums

\[M_{0}\equiv\sum_{\alpha}m_{\alpha}\quad;\quad M_{ij}=\sum_{\alpha}m_{\alpha}x _{i}^{\alpha}x_{j}^{\alpha}\quad;\quad M_{ijk}=\sum_{\alpha}m_{\alpha}x_{i}^{ \alpha}x_{j}^{\alpha}x_{k}^{\alpha} \tag{2.228}\]

and so forth, where the sums run over the particles in the cube and \({\bf x}^{\alpha}\) is the position vector of particle \(\alpha\) relative to the cube's center of mass. This hierarchy of sums is closely related to the multipole expansion of SS2.4, and these quantities are called the **Cartesian multipole moments**. The three in equation (2.228) are the monopole, quadrupole, and octopole moments.

### 2.2 Scaling of tree codes

Consider the work involved in determining the potential at the location of one of \(N\) simulation particles. For simplicity we assume that the system is not very inhomogeneous, although the argument we give can be generalized. The sum over cubes for the potential includes some cubes ("leaves") that contain only one particle, the rest being "branches" that contain more than one particle. All branch cubes have opening angle \(\leq\theta_{\rm o}\), while most of the leaf cubes have opening angle \(>\theta_{\rm o}\). If the simulation is representing a system of linear size \(L\), the leaf cubes have a characteristic linear size \(l=L/N^{1/3}\) and lie within distance \(\sim D=l/\theta_{\rm o}\) of the given particle; hence there are \(\sim(D/l)^{3}=\theta_{\rm o}^{-3}\) leaf cubes.

Suppose we now increase the number of simulation particles by a factor 8. Then branch cubes will continue to be branch cubes and will not require further subdivision because the angles they subtend are \(<\theta_{\rm o}\). Hence the extra work that comes with increased \(N\) arises mainly from the \(\theta_{\rm o}^{-3}\) leaf cubes that previously had only one particle; most will now need to be subdivided. Thus every time we increase \(N\) by a factor 8 we have to do a fixed amount of additional work. It now follows that the work required to determine the potential at the location of a given particle is proportional to \(\ln N\), and the work involved in determining the forces on all particles scales as \(N\ln N\).

The object \(M_{i}=\sum_{\alpha}m_{\alpha}x_{i}^{\alpha}\) that might have been listed in equation (2.228) is the cube's dipole moment, and it vanishes identically by virtue of the fact that \({\bf x}^{\alpha}\) is the position of \(\alpha\) relative to the center of mass. If the cube is one of the tree's leaves, \(M_{0}=m_{\alpha}\) and all the other multipoles vanish. There are of order \(N\log_{2}N\) cubes in the tree, so the labor involved in setting it up scales as \(N\ln N\).

Once the tree has been constructed, we can evaluate the sum (2.225) that yields the potential at any location \({\bf x}\) to good accuracy with only \(\sim\ln N\) operations as follows. We first consider evaluating the force as the sum of the forces due to the monopole, quadrupole, octopole,..., \(2^{k}\)-pole etc., of the root cube, up to some predetermined order \(k=K\). This sum would converge rapidly and could be truncated after a few terms without unacceptable inaccuracy if \({\bf x}\) were remote from the root cube in the sense that the root cube subtended a small **opening angle**\(\theta_{\rm o}\), say \(\theta_{\rm o}\mathrel{\raise 1.29pt\hbox{$<$\kern-7.5pt\lower 4.3pt\hbox{$ \sim$}}}1^{\circ}\), at \({\bf x}\). In general, \({\bf x}\) will lie within the root cube, so the desired condition will be not be satisfied. However, we may then instead consider evaluating the potential by summing the multipole contributions from each of the root's eight child cubes. If any of these subtends an angle at \({\bf x}\) that exceeds \(\theta_{\rm o}\), we consider the sum of the multipoles of its children, and so on recursively until the whole potential is obtained as a sum of the multipoles from cubes thatsubtend angles at \({\bf x}\) smaller than \(\theta_{\rm o}\). Some of these final cubes will be leaves, which are deemed to subtend zero angle, because they contain only a single particle. The key point is that as the number of particles in the simulation is increased, the number of cubes over which we sum to get the force at \({\bf x}\) increases much more slowly--see Box 2.2.

**Cartesian multipole expansion** To derive explicit formulae for the potential in terms of the multipoles of cubes, we now develop some of the theory of Cartesian multipoles. We consider the contribution to the gravitational potential \(\Phi\) at position \({\bf X}\) in cube A that is generated by the matter in cube B. We have

\[\Phi({\bf X})=G\int_{\rm cube\ B}{\rm d}^{3}{\bf Y}\,S({\bf X}-{\bf Y})\rho({ \bf Y}), \tag{2.229}\]

where \(\rho\) is the matter density and \(S\) is the softening kernel (eq. 2.225). We specialize to the case of well-separated cubes and write \({\bf X}=\hat{\bf X}+{\bf x}\) and \({\bf Y}=\hat{\bf Y}+{\bf y}\), where \(\hat{\bf X}\) and \(\hat{\bf Y}\) are the centers of mass of cubes A and B, respectively. Then we Taylor expand \(S({\bf X}-{\bf Y})\) in powers of \({\bf x}-{\bf y}\) around \(\hat{\bf X}-\hat{\bf Y}\):

\[\eqalign{S({\bf X}-{\bf Y})&=S(\hat{\bf X}-\hat{\bf Y})+\sum_{i=1}^{3}({\bf x }-{\bf y})_{i}{\partial S({\bf R})\over\partial R_{i}}\bigg{|}_{{\bf R}=\hat{ \bf X}-\hat{\bf Y}}\cr&\qquad+{1\over 2!}\sum_{i,j=1}^{3}({\bf x}-{\bf y})_{i}({\bf x}-{ \bf y})_{j}{\partial^{2}S({\bf R})\over\partial R_{i}\partial R_{j}}\bigg{|}_ {{\bf R}=\hat{\bf X}-\hat{\bf Y}}+\cdots\cr&=\sum_{n}{1\over n!}({\bf x}-{\bf y })^{(n)}\cdot\big{[}\partial_{(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X}-\hat{ \bf Y}}.}\]

Here the last line employs a notation in which \({\bf r}^{(n)}\equiv r_{i_{1}}r_{i_{2}}\cdots r_{i_{n}}\) is a product of \(n\) components of the vector \({\bf r}\) and \(\partial_{(n)}\) is the corresponding product of partial derivatives with respect to these components, while the centered dot implies summation over all the \(n\) indices \(i_{k}\) (a total of \(3^{n}\) terms). Substituting (2.230) into (2.229), we obtain

\[\Phi(\hat{\bf X}+{\bf x})=G\sum_{n}{1\over n!}\bigg{[}\int{\rm d}^{3}{\bf y}\, \rho(\hat{\bf Y}+{\bf y})({\bf x}-{\bf y})^{(n)}\bigg{]}\cdot\big{[}\partial_ {(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X}-\hat{\bf Y}}.\]

Using the expansion

\[({\bf x}-{\bf y})^{(n)}=\sum_{k=0}^{n}{n!\over k!(n-k)!}{\bf x}^{(k)}{\bf y}^{ (n-k)},\]

we have

\[\Phi(\hat{\bf X}+{\bf x})=G\sum_{n}\sum_{k=0}^{n}{1\over k!(n-k)!}{\bf x}^{(k) }{\bf M}^{(n-k)}\cdot\big{[}\partial_{(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X }-\hat{\bf Y}},\]

**Box 2.3: Derivatives of a spherically symmetric softening kernel**

Consider the case of a spherically symmetric softening kernel \(S({\bf R})\), i.e., one of the form \(S(|{\bf R}|)\). In this case the evaluation of the first few tensors \(\partial_{(n)}S\) is straightforward:

\[\eqalign{\partial_{(1)}S(R)&={S^{\prime}}{R_{i}\over R}\cr\partial_{(2)}S(R)&= \Bigl{(}{S^{\prime\prime}}-{S^{\prime}\over R}\Bigr{)}{R_{i}R_{j}\over R^{2}}+ {S^{\prime}\over R}\delta_{ij}\cr\partial_{(3)}S(R)&=\Bigl{(}{S^{\prime\prime \prime}}-3{S^{\prime\prime}\over R}+3{S^{\prime}\over R^{2}}\Bigr{)}{R_{i}R_{ j}R_{k}\over R^{3}}\cr&\qquad+\Bigl{(}{S^{\prime\prime}}-{S^{\prime}\over R}\Bigr{)}{ \delta_{ij}R_{k}+\delta_{jk}R_{i}+\delta_{ki}R_{j}\over R^{2}}\cr\partial_{(4 )}S(R)&=\Bigl{(}{S^{iv}}-6{S^{\prime\prime\prime}\over R}+9{S^{\prime\prime} \over R^{2}}-9{S^{\prime}\over R^{3}}\Bigr{)}{R_{i}R_{j}R_{k}R_{l}\over R^{4}} \cr&\qquad+\Bigl{(}{S^{\prime\prime\prime}}-3{S^{\prime\prime}\over R}+3{S^{ \prime}\over R^{2}}\Bigr{)}\bigl{(}\delta_{ij}R_{k}R_{l}+\delta_{jk}R_{i}R_{l}+ \delta_{ki}R_{j}R_{l}\cr&\qquad+\delta_{il}R_{j}R_{k}+\delta_{lj}R_{i}R_{k}+ \delta_{lk}R_{i}R_{j}\Bigr{)}/R^{3}\cr&\qquad+\Bigl{(}{S^{\prime\prime}}-{S^{ \prime}\over R}\Bigr{)}{\delta_{ij}\delta_{kl}+\delta_{ik}\delta_{jl}+\delta_ {il}\delta_{jk}\over R^{2}}\cr}\]

where

\[{\bf M}^{(k)}\equiv\int_{\rm cube\ B}\!\!{\rm d}^{3}{\bf y}\,\rho({\bf\hat{Y}} +{\bf y}){\bf y}^{(k)}.\]

When the density distribution is simulated with particles, \(\rho({\bf r})=\sum_{\alpha}m_{\alpha}\delta({\bf r}-{\bf r}^{\alpha})\) is a sum of delta functions centered on the locations of the particles. In this case the integral in (2.234) can be immediately evaluated and yields the objects defined by equations (2.228).

Equation (2.233) expresses the potential generated by cube B at an arbitrary point in cube A as a power series in the components of \({\bf x}\), the separation between the point of observation and A's center of mass. The coefficients in this power series are made up of (a) the multipole moments of B, which were evaluated during tree construction, and (b) the derivatives \(\partial_{(n)}S\) of the softening kernel evaluated on the vector \({\bf R}\) that joins the centers of mass of the two cubes, which can be evaluated once and for all at the start of the integration. Once these quantities are all to hand, we can quickly evaluate the force on every particle in cube A by summing the series with the appropriate value of \({\bf x}\). The derivatives \(\partial_{(n)}S\) are explicitly evaluated for a spherically symmetric kernel in Box 2.3.

An important simplification arises because the same derivatives occur in the analogous series for the potential that cube A generates at a point within cube B. Dehnen (2000b) explains how one can exploit this fact, both to accelerate the computation and to achieve exact momentum conservation.

Unlike some of the codes that we are about to present, a tree code employs no grid. This feature enables tree codes to handle problems such as galaxy mergers, in which dense stellar systems move through a large volume of nearly empty space--most grid-based codes cannot handle such problems efficiently because they would waste most of their computing resources covering low-density regions with the same high-resolution grid that they require to handle the dense stellar systems. Another merit of tree codes is that they are readily parallelized by, for example, delegating to a different processor construction of each of the trees that emerge from the root's eight child cubes.

#### Particle-mesh codes

A wide variety of N-body codes solve Poisson's equation using estimates of the density at a set of regularly spaced points, the nodes of a mesh or grid. The simplest mesh is a Cartesian grid and we concentrate on this case, although most of the principles we describe carry over to other meshes, such as ones based on spherical polar coordinates. More detail can be found in Hockney & Eastwood (1988).

The process of estimating the density on a grid from the positions of a large number of particles that trace the density is called **mass assignment** because it involves assigning the mass of each particle to one or more nearby nodes. The simplest algorithm is to assign all of the mass of each particle to the nearest node. This procedure, which is known as the **nearest grid point** (**NGP**) scheme, is rarely used for two reasons. First, the NGP scheme only samples the density distribution crudely. Second, as explained on page 134 below, for technical reasons associated with momentum conservation the NGP scheme leads to solutions of Poisson's equation in which forces change discontinuously midway between nodes.

Better mass-assignment schemes spread the mass of each particle over several nearby nodes. Box 2.4 describes a hierarchy of widely used schemes that spread the mass over 1, \(2^{D}\), \(3^{D},\ldots\) nodes of a \(D\)-dimensional grid. If we decide on one node, we have the NGP scheme. If we want to split a particle's mass over \(2^{D}\) nodes, the resulting scheme is called the **cloud in cell** (**CIC**) mass-assignment scheme because it may be visualized by expanding every mass point into a homogeneous cube with side length equal to the grid spacing, and assigning every mass element in this cube to the nearest node (Figure 2.26). If we split a particle's mass over \(3^{D}\) nodes, we have the **triangular shaped cloud** (**TSC**) mass-assignment scheme, so called because the scheme may be derived by regarding the particle to be a cloud 

### 2.4 Mass assignment schemes

A mass-assignment scheme is a function \(W_{\mathbf{p}}(\mathbf{r})\) that gives the fraction of the mass of a particle at \(\mathbf{r}\) that is assigned to node \(\mathbf{p}\). Here \(\mathbf{p}\) is a triple of integers and the node's location is \(\mathbf{x_{p}}=(p_{1},p_{2},p_{3})\Delta\), with \(\Delta\) the grid spacing. The simplest schemes for a three-dimensional Cartesian grid are the product of three functions, each evaluated on one component of \(\mathbf{r}\)

\[W_{\mathbf{p}}(\mathbf{r})=w(x-p_{1}\Delta)w(y-p_{2}\Delta)w(z-p_{3}\Delta).\]

The condition that all the mass is assigned somewhere is \(\sum_{\mathbf{p}}W_{\mathbf{p}}(\mathbf{r})=1\), which is assured if \(M_{0}\equiv\sum_{i}w(x-i\Delta)=1\). Additional constraints arise from demanding that the grid-scale fluctuations are as small as possible at large distances. Suppose that we are modeling a one-dimensional potential with softening kernel \(S(x)\). Then the potential due to a mass \(m\) at \(x\) is \(\Phi(x^{\prime})=mS(x^{\prime}-x)\). The potential computed from a grid is

\[\Phi_{\mathrm{g}}(x^{\prime})=m\sum_{i}w(x-i\Delta)S(x^{\prime}-i\Delta).\]

If \(|x^{\prime}-x|\gg\Delta\), we can Taylor expand \(S(x^{\prime}-i\Delta)\) in powers of \(x-i\Delta\):

\[\Phi_{\mathrm{g}}(x^{\prime})=m\sum_{i}\sum_{n=0}^{\infty}\frac{1}{n!}w(x-i \Delta)S^{(n)}(x^{\prime}-x)(x-i\Delta)^{n},\]

where \(S^{(n)}\) is the \(n\)th derivative of \(S\). If condition \(M_{0}=1\) is satisfied, the \(n=0\) term equals the exact potential, so grid-scale fluctuations are minimized if

\[M_{n}\equiv\sum_{i}(x-i\Delta)^{n}w(x-i\Delta)=\mathrm{constant}\quad\mathrm{ for}\quad n=1,2,\ldots\]

If the mass is distributed between two nodes,

\[w(x)=\cases{1-|x|/\Delta&for $|x|<\Delta$,\cr 0&otherwise,} \tag{1}\]

satisfies \(M_{0}=1\), \(M_{1}=0\). This is the cloud in cell (CIC) mass-assignment scheme. If the mass is distributed between three nodes,

\[w(x)=\cases{\frac{3}{4}-|x|^{2}/\Delta^{2}&for $|x|<\frac{1}{2}\Delta$\cr\frac{1}{2}( \frac{3}{2}-|x|/\Delta)^{2}&for $\frac{1}{2}\Delta<|x|<\frac{3}{2}\Delta$\cr 0& otherwise.} \tag{2}\]

satisfies \(M_{0}=1\), \(M_{1}=0\), \(M_{2}=\frac{1}{4}\Delta^{2}\). This is the triangular shaped cloud (TSC) mass-assignment scheme. There is an alternative three-node scheme in which \(M_{2}=0\), but in this scheme \(w(x)\) is discontinuous at \(|x|/\Delta=\frac{1}{2}\), \(\frac{3}{2}\), whereas in the TSC scheme \(w(x)\) is continuous and differentiable.

in which the mass density falls linearly with coordinate differences from the location of the particle (Figure 2.26).

In the NGP scheme, the mass assigned to a node changes discontinuously as a particle moves through the grid. In the CIC scheme, the mass changes continuously but with discontinuous first derivative. In the TSC scheme, both the mass and its derivative change continuously. In view of the role a mass-assignment scheme plays in force interpolation--see page 134 below--the progressive increase in smoothness as one proceeds up this hierarchy of mass-assignment schemes is valuable. This advantage must be set against two disadvantages of proceeding up the hierarchy: (i) in three dimensions the computational cost increases rapidly as the number of nodes to which mass is assigned increases from 1 for NGP, to 8 for CIC, 27 for CIC, etc.; (ii) spreading mass over many nodes involves a loss of spatial resolution. In practice the most widely used schemes are CIC and TSC.

Given the density on the mesh, we are ready to solve Poisson's equation for the potential. To do this we must specify boundary conditions, which in practice are one of two types: **periodic** and **vacuum**. Periodic boundary conditions are used when the grid is imagined to be one cell of an infinite lattice; these are natural for cosmological simulations. With vacuum boundary conditions we require that at large distances \(\Phi\to-GM/r\), where \(M\) is the total mass on the grid. These are appropriate for simulations of isolated stellar systems.

**(a) Periodic boundary conditions** We solve Poisson's equation by representing \(\nabla^{2}\) as a finite-difference operator. For example, we can make the approximation

\[\eqalign{\left(\nabla^{2}\Phi\right)_{lmn}\simeq&\big{(}\Phi_{l+1,m,n}+\Phi_{ l-1,m,n}+\Phi_{l,m+1,n}+\Phi_{l,m-1,n}\cr&\qquad+\Phi_{l,m,n+1}+\Phi_{l,m,n-1}-6 \Phi_{l,m,n}\big{)}/\Delta^{2},}\]

where \(\Delta\) is the mesh spacing. This substitution converts the Poisson equation into a large system of linear equations for the \(\Phi_{lmn}\) in terms of the known \(\rho_{lmn}\). The system obtained by equating (2.235) to \(4\pi G\rho_{lmn}\) is most

Figure 2.26: The CIC (left) and TSC (right) mass-assignment schemes in one dimension. The dotted lines mark the boundaries between cells of the grid, and the rectangle (CIC) and triangle (TSC) represent the mass of the particle. Mass is assigned to cells in proportion to the fraction of the area of the rectangle or triangle that lies in each cell—for example, the shaded portions are assigned to cell 1.

efficiently solved using discrete Fourier transforms (DFTs; see Appendix G and Problem 2.23).

**(b) Vacuum boundary conditions** Consider now how to solve Poisson's equation with vacuum boundary conditions. We use the integral form of Poisson's equation (2.3), or its smoothed form (2.229), in which the softening kernel \(S\) already contains our choice of boundary conditions. We write

\[\Phi({\bf r})=G\sum_{\bf p}S({\bf r}-{\bf r_{p}})m_{\bf p}, \tag{2.236}\]

where \(m_{\bf p}\) is the mass assigned to node \({\bf p}\). The labor required to evaluate \(\Phi\) at the location of every particle is proportional to the number of particles times the number of nodes. A much more efficient approach is to evaluate \(\Phi\) only at the nodes, and then to interpolate to the locations of particles. At the nodes, equation (2.236) reads

\[\Phi_{\bf q}=G\sum_{\bf p}S_{{\bf q}-{\bf p}}m_{\bf p}, \tag{2.237}\]

where \({\bf p}\) and \({\bf q}\) are three-vectors with integer components in the range \((0,K-1)\), with \(K\) the number of nodes along a side of the computational box. In equation (2.237), each component of \(S\)'s subscript ranges from \(-(K-1)\) (when \(q_{1}=0\) and \(p_{1}=K-1\)) to \(K-1\) (when \(q_{1}=K-1\) and \(p_{1}=0\)). Thus \(S\)'s subscript has components that take on \(2K-1\) values, while the subscript of \(m\) has components that range over only \(K\) possible values. Discrete Fourier transforms provide an extremely efficient way of solving equations of this form, but before we can apply them, we have to make the problem symmetrical in the subscripts, and arrange for them to take \(2^{n}\) values, for some integer \(n\). We do this by taking \(K=2^{n-1}\) and padding \(m\) out to a matrix of size \((2K)^{3}\), whose subscripts cover the range \((-K,K-1)\) with \(m_{\bf p}\) set to zero when any component of the subscript lies outside the physically significant range, \((0,K-1)\). Finally we eliminate negative indices by making \(S\) and \(m\) periodic functions of each index with period \(2K\). Thus extended, equation (2.237) takes the form of a discrete convolution. So we take the DFT of both sides of this equation, and, with the aid of the discrete Fourier convolution theorem (eq. G.5), we obtain

\[\hat{\Phi}_{\bf k}=G\hat{S}_{\bf k}\hat{m}_{\bf k}. \tag{2.238}\]

According to this equation, the DFT of \(\Phi\) can be obtained from that of \(m\) simply by multiplying by the DFT of \(S\). With \(\hat{\Phi}_{\bf k}\) in hand, \(\Phi\) is easily obtained by doing an inverse DFT. Moreover, the DFT of \(S\) can be calculated once and for all at the start of the simulation and stored for use at each timestep.

### 2.5: James's Fourier Poisson solver

We describe the method of James (1977) for imposing vacuum boundary conditions on the system (2.235) without doubling the range of all the indices. This method is both fast and economical with computer memory.

We start from the density values on a cubical grid and imagine the values to represent electric charge density rather than mass density. Next, we find the potential that would be generated by the charges attached to the interior of the grid if the boundary of the grid were grounded--that is, if the potential \(\Phi\) vanished on the boundary. This potential is the solution of Poisson's equation for the given charge density at interior points of the grid, subject to the boundary condition \(\Phi=0\) on the grid boundary. We obtain the required solution by writing \(\Phi\) in terms of its sine transform (eq. G.7a)

\[\Phi_{lmn}=\sum_{\alpha\beta\gamma=1}^{K-1}\Phi^{\alpha\beta\gamma}(\mbox{SSS })\sin\left(\frac{\pi l\alpha}{K}\right)\sin\left(\frac{\pi m\beta}{K}\right) \sin\left(\frac{\pi n\gamma}{K}\right)\!, \tag{1}\]

where \(0\leq l,m,n\leq K\). The sine transform automatically ensures that \(\Phi_{lmn}\) vanishes on the boundary. Substituting this expression for \(\Phi_{lmn}\) into the numerical approximation (2.235) for the Laplacian, and then equating this to \(4\pi G\rho_{lmn}\) with \(\rho_{lmn}\) expressed in terms of its sine transform, we discover that each amplitude \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\) is simply a multiple of the corresponding amplitude \(\rho^{\alpha\beta\gamma}(\mbox{SSS})\). Since the sine transform is its own inverse (eq. G.7b), it is a simple matter to recover the \(\Phi_{lmn}\) from the \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\).

The potential we obtain in this way differs from the one we require because the walls bear charges that differ from those specified in the original problem. (When the walls of the grid are grounded, charges flow along the grounding cables until \(\Phi\) vanishes on the boundary.) We use Gauss's theorem to determine the actual surface density of wall charges \(\Sigma\)--since the potential vanishes outside the box, \(\Sigma=-g_{\perp}/(4\pi G)\), where \(g_{\perp}=|{\bf n}\cdot\nabla\Phi|\) is the magnitude of the force field just inside the walls of the grounded box. Finally, we convolve the resulting charge distribution on the walls with a softening kernel to obtain the potential that it generates when vacuum boundary conditions are applied, and subtract this potential from the potential generated by the mass in the grounded box, to get the potential that the originally specified density distribution generates with vacuum boundary conditions. The softening kernel should be the inverse of the discrete Laplacian used in the calculation of \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\)--see James (1977) for details.

The key to the success of this procedure is that the convolution of the wall charge density with the softening kernel is simple because the charge density is hollow--see Appendix G or Magorrian (2007) for details.

This approach to imposing vacuum boundary conditions is very wasteful of computer memory. Box 2.5 describes a clever and much more economical alternative.

Once the potential has been obtained at every node, we use numerical differentiation to obtain the gravitational field \(\mathbf{g_{n}}\) at the nodes: for example, the component parallel to the first axis might be

\[\hat{\mathbf{e}}_{1}\cdot\mathbf{g_{n}}=-\frac{1}{2\Delta}(\Phi_{(n_{1}+1,n_{2},n_{3})}-\Phi_{(n_{1}-1,n_{2},n_{3})}). \tag{2.239}\]

More generally

\[\mathbf{g_{j}}=\sum_{\mathbf{n}}\mathbf{A_{n}}\Phi_{\mathbf{j+n}}, \tag{2.240}\]

where \(\mathbf{A_{n}}=-\mathbf{A_{-n}}\) defines some numerical differentiation scheme. Values of the forces on individual particles are then obtained by interpolation from these values.

In any such scheme, it is desirable that the sum of the forces on all the particles is zero to machine precision, because this is a prerequisite for conservation of the simulation's total momentum; if momentum is not conserved the system is liable to rocket off the grid. Consider therefore the sum of all forces. We let \(W_{\mathbf{p}}(\mathbf{r})\) denote the fraction of the mass of a particle that lies at \(\mathbf{r}\) that is assigned to node \(\mathbf{p}\), so

\[m_{\mathbf{p}}=\sum_{\text{particles }\beta}m_{\beta}W_{\mathbf{p}}(\mathbf{r} _{\beta}). \tag{2.241}\]

We introduce similar functions \(Q_{\mathbf{j}}(\mathbf{r})\) to describe the interpolation scheme used to calculate forces on particles given the field on the mesh: let the gravitational field at \(\mathbf{r}\) be

\[\mathbf{g}(\mathbf{r})=\sum_{\text{nodes }\mathbf{j}}Q_{\mathbf{j}}(\mathbf{r} )\mathbf{g_{j}}. \tag{2.242}\]

Then with equation (2.237), (2.240) and (2.241), the sum of all particle forces is

\[\begin{split}\mathbf{F}_{\text{tot}}&=\sum_{\text{ particles }\alpha}m_{\alpha}\mathbf{g}(\mathbf{r}_{\alpha})=\sum_{\alpha}m_{\alpha}\sum_{ \text{nodes }\mathbf{j}}Q_{\mathbf{j}}(\mathbf{r}_{\alpha})\sum_{\mathbf{n}}\mathbf{A_{n} }\Phi_{\mathbf{j+n}}\\ &=G\sum_{\mathbf{j}\mathbf{p}}\sum_{\alpha\beta}m_{\alpha}m_{ \beta}Q_{\mathbf{j}}(\mathbf{r}_{\alpha})W_{\mathbf{p}}(\mathbf{r}_{\beta}) \sum_{\mathbf{n}}\mathbf{A_{n}}S_{\mathbf{j+n-p}}.\end{split} \tag{2.243}\]

The sum over \(\mathbf{n}\), which is the numerical derivative of the softening kernel, is antisymmetric in \(\mathbf{j}\) and \(\mathbf{p}\), as can seen by replacing the dummy variable \(\mathbf{n}\) by \(-\mathbf{n}\) and exploiting the antisymmetry of \(\mathbf{A_{n}}\) and the symmetry of \(S_{\mathbf{q}}\). In view of this antisymmetry, \(\mathbf{F}_{\text{tot}}\) vanishes if \(Q_{\mathbf{p}}=W_{\mathbf{p}}\), and in fact only this choice of \(Q_{\bf p}\) guarantees symmetry of the sum over \(\alpha\beta\) for all possible particle locations. Therefore, we conclude that net momentum can be conserved if and only if we use the same scheme to interpolate forces from the grid as we use to assign mass to the grid. In particular, if we use the NGP scheme, forces change discontinuously midway between nodes.

**(c) Mesh refinement** Stellar systems, whether galaxies, galactic nuclei, star clusters or clusters of galaxies, tend to develop small, tightly bound condensations. These objects are often of considerable astronomical interest. For example, the visible stars of the Milky Way are a dense condensation in a much larger dark-matter halo. The ideal Poisson solver would determine the gravitational field of a structure no matter how small the structure becomes.

In the CIC and TSC mass-assignment schemes, the force between two particles that are separated by no more than the mesh spacing is significantly smaller than the value predicted by Newton's inverse-square law, regardless of the value of \(\epsilon\) that is used in the softening kernel. Hence the dynamics of structures smaller than a few mesh spacings cannot be faithfully followed.

Stellar systems usually have large volumes in which the density is low, and small volumes in which it is high. Hence achieving higher spatial resolution by subdividing the grid (**mesh refinement**) throughout the volume occupied by a system is undesirable: in low-density regions a fine mesh is both computationally expensive and pointless. If higher resolution is to be attained by mesh refinement, we must refine locally and adaptively--at each timestep, high-density regions must be located and equipped with a finer mesh. Handling an adaptive mesh requires intricate code, and if the mesh has a complex geometry, it will not be possible to use DFTs to evaluate the sum (2.237) efficiently. For a discussion of adaptive-mesh codes see Knebe, Green, & Binney (2001).

**(d) P\({}^{3}\)M codes** The **Particle-particle-particle-mesh** or **P\({}^{3}\)M** technique provides a simpler way of enhancing the spatial resolution of a PM code. The idea behind a P\({}^{3}\)M code is to use the standard PM algorithm to calculate the contribution from distant particles to the force \({\bf F}\) on a particle, while using the direct sum (2.224) to get the contribution to \({\bf F}\) from particles that lie in the same or adjacent cells. The softening kernel \(S_{\rm F}\) used for the direct sum must be carefully chosen to provide only the difference between the Newtonian force and the force already obtained from the grid.

The efficiency of a P\({}^{3}\)M code depends sensitively on the number of particles, \(N_{\rm max}\), in the most densely populated cell, since the cost of evaluating the direct sum scales as \(N_{\rm max}^{2}\) rather than as \(N_{\rm max}\ln(N_{\rm max})\). P\({}^{3}\)M codes have been extensively used for cosmological simulations (Efstathiou et al. 1985). In these simulations, galaxy formation leads gradually to higher and higher densities, so \(N_{\rm max}\) eventually becomes very large and the simulations grind to a halt. This problem can be resolved by using either a tree algorithm (Bode & Ostriker 2003) or a separate P\({}^{3}\)M implementation (Couchman 1991) to handle sums within populous cells.

#### 2.9.4 Spherical-harmonic codes

We saw in SS2.4 and Figure 2.10 that good approximations to the potentials of stellar systems that are not too far from spherical can be obtained from the first few terms of the spherical-harmonic expansion (2.95).

Two rather different approaches to the numerical implementation of equation (2.95) have been widely used. In the first (McGlynn 1984; Bonteko 1988), we cover the computational volume with a spherical mesh centered on the estimated location of the center of the system. We identify the particles that lie within each spherical shell around this center, say between radii \(a_{i}-\Delta/2\) and \(a_{i}+\Delta/2\), and then evaluate the integrals (2.94) up to \(l=l_{\rm max}\), using the formula

\[m_{lm}(a_{i})\simeq\sum_{a_{i}-\Delta/2<r_{\alpha}\leq a_{i}+\Delta/2}\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!

#### 2.9.5 Simulations of planar systems

Studies of the dynamics of thin disks often confine the particles to a plane. In this case the softening length \(\epsilon\) can be interpreted as the characteristic thickness of the disk: if two particles pass at a fixed vertical separation \(\Delta z\) from one another, their mutual interaction potential is given by equation (2.225) with \({\bf r}_{\alpha}\) and \({\bf r}_{\beta}\) two-dimensional vectors, and \(\epsilon\) set equal to \(\Delta z\) in equation (2.226).

A two-dimensional mesh that is \(K\) cells on a side consumes less computer memory and CPU time than the corresponding three-dimensional mesh by a factor \(K\), so PM codes are much more attractive in two dimensions than in three. Both rectangular (Hohl & Hockney 1969) and polar (Sellwood 1983) meshes have been widely used. On going from three dimensions to two, the functional expansion technique yields a similar efficiency gain because the number of subscripts \(n,l\) etc., that need be summed over decreases from three to two (Earn & Sellwood 1995).

**Problems**

**2.1** [1] Show that the gravitational potential energy of a spherical system of finite mass in which the density satisfies \(\lim_{r\to 0}\rho r^{5/2}=0\) can be written

\[W=-{G\over 2}\int_{0}^{\infty}{\rm d}r\,{M^{2}(r)\over r^{2}},\]

where \(M(r)\) is the mass interior to radius \(r\).

**2.2** [1] Prove that the Chandrasekhar potential-energy tensor for any spherical body has the form \(W_{jk}={1\over 3}W\delta_{jk}\), where \(W\) is the potential energy. Hint: start from equation (2.19).

**2.3** [1] Show that the potential of an infinite razor-thin sheet of surface density \(\Sigma\) in the plane \(z=0\) is \(\Phi=2\pi G\Sigma|z|+\it constant\), (a) using Gauss's theorem, and (b) from Poisson's equation.

**2.4** [1] (Suggested by A. Toomre) Show that \(\Phi=\ln[r(1+|\cos(\theta)|)]\) solves Laplace's equation everywhere except when \(r=0\) or \(\theta=\pi/2\). By applying Gauss's theorem near \(\theta=\pi/2\), find the potential of the Mestel disk (2.158) in the limit \(R_{\rm max}\to\infty\).

**2.5** [2] The **finite Mestel disk** is a razor-thin disk with surface density \(\Sigma(R)\) such that (i) \(\Sigma(R)=0\) for all \(R>R_{0}\); (ii) the circular speed is \(v_{\rm c}(R)=v_{0}=\it constant\) for all \(R<R_{0}\). The surface density of the finite Mestel disk was first derived by Mestel (1963) but here we describe a short, elegant derivation due to Brada & Milgrom (1995).

(a) Consider a spherical mass distribution with density \(\rho(r)={1\over 2}Ar^{-2}\) for \(r<R_{0}\) and zero for \(r>R_{0}\), where \(A\) is a constant. Argue that the circular speed is independent of radius and independent of \(R_{0}\) so long as \(r<R_{0}\).

(b) Now squash the sphere along one direction, so that its isodensity surfaces are spheroids with axis ratio \(q\). Argue that the circular speed in the equatorial plane of the squashed system is still independent of radius and independent of \(R_{0}\) so long as the equatorial radius \(R<R_{0}\). Hint: use Newton's third theorem.

(c) By considering the limit \(q\to 0\), show that a disk with surface density

\[\Sigma(R)=\cases{(A/R)\cos^{-1}(R/R_{0})&($R<R_{0}$)\cr 0&($R>R_{0}$)\cr}\]

has a flat circular-speed curve for \(R<R_{0}\).

(d) Show that \(v_{0}^{2}=\pi^{2}GA\). Hint: let \(R_{0}\to\infty\) and compare to the infinite Mestel disk.

**2.6**[1] Defining **prolate spheroidal coordinates**\((u,v)\) by \(R=a\sinh u\sin v\), \(z=a\cosh u\cos v\), where \(a>0\) is a constant, show that \(R^{2}+(a+|z|)^{2}=a^{2}(\cosh u+|\cos v|)^{2}\). Hence show that the potential (2.68a) of the Kuzmin disk can be written

\[\Phi_{\rm K}(u,v)=-\frac{GM}{a}\,\frac{\cosh u-|\cos v|}{\sinh^{2}u+\sin^{2}v}. \tag{2.251}\]

In SS3.5.3 we show that this potential is an example of a Stackel potential, in which orbits admit an extra isolating integral.

**2.7**[2] Astronauts orbiting an unexplored planet find that (i) the surface of the planet is precisely spherical and centered on \(r=0\); and (ii) the potential exterior to the planetary surface is \(\Phi=-GM/r\) exactly, that is, there are no non-zero multipole moments other than the monopole. Can they conclude from these observations that the mass distribution in the interior of the planet is spherically symmetric? If not, give a simple example of a non-spherical mass distribution that would reproduce the observations.

**2.8**[1] (Suggested by L. Ciotti) If a transparent, spherical stellar system has constant mass-to-light ratio \(\Upsilon\), prove that the potential at radius \(r\) is

\[\Phi(r)=-\frac{2G\Upsilon}{r}\int_{0}^{r}{\rm d}x\,S(x), \tag{2.252}\]

where \(S(x)\) is the strip brightness defined in Problem 1.3.

**2.9**[1] If a transparent, spherical stellar system has constant mass-to-light ratio \(\Upsilon\), prove that the central potential is (Ciotti 1991)

\[\Phi(0)=-4G\Upsilon\int_{0}^{\infty}{\rm d}R\,I(R), \tag{2.253}\]

where \(I(R)\) is the surface brightness at projected radius \(R\).

**2.10**[2] Consider an axisymmetric body whose density distribution is \(\rho(R,z)\) and total mass is \(M=\int{\rm d}^{3}{\bf r}\,\rho(R,z)\). Assume that the body has finite extent, \(\rho(R,z)=0\) for \(r^{2}=R^{2}+z^{2}>r_{\rm max}^{2}\), and is symmetric about its equator, that is, \(\rho(R,-z)=\rho(R,z)\).

(a) Show that at distances large compared to \(r_{\rm max}\), the potential arising from this body can be written in the form

\[\Phi(R,z)\simeq-\frac{GM}{r}-\frac{G}{4}\frac{(R^{2}-2z^{2})}{r^{5}}\int{\rm d }^{3}{\bf r^{\prime}}\,\rho(R^{\prime},z^{\prime})({R^{\prime}}^{2}-2{z^{ \prime}}^{2}), \tag{2.254}\]

where the error is of order \((r_{\rm max}/r)^{2}\) smaller than the second term.

(b) Show that at large distances from an exponential disk with surface density \(\Sigma(R)=\Sigma_{0}\exp(-R/R_{\rm d})\), the potential has the form

\[\Phi(R,z)\simeq-\frac{GM}{r}\left[1+\frac{3R_{\rm d}^{2}(R^{2}-2z^{2})}{2r^{4} }+{\rm O}(R_{\rm d}^{4}/r^{4})\right], \tag{2.255}\]

where \(M\) is the mass of the disk.

**2.11**[2] Show that the potential energy of an exponential disk is \(W\simeq-11.627\,G\Sigma_{0}^{2}R_{\rm d}^{3}\). Show further that if all stars move on circular orbits, the disk's angular momentum is \(J\simeq 17.462\,G^{1/2}\Sigma_{0}^{3/2}R_{\rm d}^{7/2}\) and its kinetic energy is \(K\simeq 5.813\,G\Sigma_{0}^{2}R_{\rm d}^{3}\). Hence show that for this disk the dimensionless spin parameter \(\lambda\equiv J|E|^{1/2}/GM^{5/2}\simeq 0.4255\), where \(E=K+W\) is the total energy.

**2.12**[1] The \(r^{-1}\) dependence of the gravitational potential on distance arises because the graviton, which carries the gravitational field, is massless. If the graviton had a mass \(m_{\rm g}\), the gravitational potential due to a body of mass \(M\) would be \(\Phi(r)=-GM{\rm e}^{-\alpha r}/r\), where \(\alpha=m_{\rm g}c/\hbar\) (the **Yukawa potential**), which reduces to the Newtonian potential in the limit \(\alpha\to 0\). What is the analog of Poisson's equation (2.10) for the Yukawa potential?

**2.13**: [2] Prove that the external potentials and gravitational fields of any two confocal spheroids of uniform density and equal mass are everywhere the same.

**2.14**: [2] Use equation (2.140) to show that a prolate body with density \(\rho=\rho_{0}(1+R^{2}/a_{1}^{2}+z^{2}/a_{3}^{2})^{-2}\), where \(a_{3}>a_{1}\), generates the potential

\[\Phi(u,v)=-\pi G\rho_{0}a_{1}^{2}a_{3}\int_{0}^{\infty}\!\mathrm{d}\tau\frac{ \sqrt{a_{3}^{2}+\tau}}{(\tau+a_{3}^{2}+\lambda)(\tau+a_{3}^{2}+\mu)}, \tag{2.256}\]

where \((u,v)\) are oblate spheroidal coordinates defined by equation (2.96) with \(\Delta^{2}=a_{3}^{2}-a_{1}^{2}\), and we have written \(\lambda\equiv\Delta^{2}\sinh^{2}u\), \(\mu\equiv-\Delta^{2}\cos^{2}v\). Decompose the integral in (2.256) into partial fractions to show (without evaluating the integrals) that \(\Phi\) is a Stackel potential

\[\Phi(\lambda,\mu)=\frac{H(\lambda)-H(\mu)}{\lambda-\mu}, \tag{2.257}\]

where \(H\) is a continuous function (de Zeeuw 1985 and SS3.5.3). Finally, show that

\[\Phi(u,v)=-\frac{2\pi Ga_{1}^{2}a_{3}\rho_{0}}{\Delta^{2}}\,\frac{f(\Delta \sinh u)-f(\mathrm{i}\Delta\cos v)}{\sinh^{2}u+\cos^{2}v},\] (2.258a) where \[f(z)\equiv z\tan^{-1}(z/a_{3}). \tag{2.258b}\]

Hint: to ensure convergence of the integrals, you may wish to add \((\tau+a_{3}^{2})^{-\frac{1}{2}}\) to one of the integrands and subtract it from the other. The body with this potential is called the **perfect prolate spheroid**, because it is the only prolate axisymmetric density distribution of constant ellipticity that has a Stackel potential.

**2.15**: [1] Show that the central potential of a thin axisymmetric disk is

\[\Phi(0,0)=-2\pi G\int_{0}^{\infty}\mathrm{d}R\,\Sigma(R). \tag{2.259}\]

Hint: use equation (C.68).

**2.16**: [1] Prove that the potential \(\Phi(r)\) is a non-decreasing function of \(r\) in any spherical system. Does the same conclusion hold in an axisymmetric razor-thin disk? If so, prove it; if not, find a counter-example.

**2.17**: [2] (Suggested by M. Merrifield) An axisymmetric disk is seen edge-on and has projected mass per unit length \(\mu(X)\). Show that its surface density is

\[\Sigma(R)=-\frac{1}{\pi}\int_{R}^{\infty}\,\frac{\mathrm{d}X}{\sqrt{X^{2}-R^{ 2}}}\frac{\mathrm{d}\mu}{\mathrm{d}X}, \tag{2.260}\]

and that its potential is

\[\Phi(R,z)=2G\int_{0}^{\infty}\mathrm{d}X\,\frac{\mathrm{d}\mu}{\mathrm{d}X}\sin ^{-1}\left(\frac{2X}{\sqrt{z^{2}+(R+X)^{2}}+\sqrt{z^{2}+(R-X)^{2}}}\right). \tag{2.261}\]

Hint: use (2.153a).

**2.18**: [1] Use equation (2.190) to show that the razor-thin disk for which the circular speed is given by

\[v_{\mathrm{c}}^{2}=\frac{v_{0}^{2}}{\sqrt{1+R^{2}/a^{2}}}\] (2.262a) has surface density (Toomre 1963) \[\Sigma(R)=\frac{v_{0}^{2}}{2\pi GR}\left(1-\frac{1}{\sqrt{1+a^{2}/R^{2}}}\right). \tag{2.262b}\]

Show that these formulae correspond to the Mestel disk in an appropriate limit. Show that the surface density (2.68b) of the Kuzmin disk is obtained when \(\Sigma(R)\) is differentiated with respect to \(a^{2}\), and hence recover the circular speed of this model.

**2.19**: [3] We have derived relations between the potential and surface density of non-axisymmetric disks by solving Laplace's equation in cylindrical coordinates (SS2.6.2) and oblate spheroidal coordinates (SS2.6.4). Derive a relation of this kind by solving Laplace's equation in spherical coordinates, and show that the result is identical with the formula derived using logarithmic spirals (eq. 2.199). Hint: you may need associated Legendre functions \(P_{\lambda}^{m}(x)\), where \(\lambda\) is a real number. See also equations (C.12) and (C.31).

**2.20**: [2] Show that the circular speed \(v_{c}(R)\) in a thin axisymmetric disk of surface density \(\Sigma(R)\) may be written in the form (Mestel 1963)

\[\begin{split} v_{\rm c}^{2}(R)=\frac{GM(R)}{R}+2G\sum_{k=1}^{ \infty}\alpha_{k}\biggl{[}&\frac{2k+1}{R^{2k+1}}\int_{0}^{R}{ \rm d}R^{\prime}\,\Sigma(R^{\prime}){R^{\prime}}^{2k+1}\\ &-2kR^{2k}\int_{R}^{\infty}{\rm d}R^{\prime}\,\frac{\Sigma(R^{ \prime})}{{R^{\prime}}^{2k}}\biggr{]},\end{split} \tag{2.263}\]

where

\[\alpha_{k}\equiv\int_{0}^{\pi}{\rm d}\theta P_{2k}(\cos\theta)=\pi\left[ \frac{(2k)!}{2^{2k}(k!)^{2}}\right]^{2}. \tag{2.264}\]

Hint: start with equation (2.3) and expand \(|{\bf x}-{\bf x}^{\prime}|^{-1}\) in Legendre polynomials using equation (C.35).

**2.21**: [2] Show that the potential of an axisymmetric disk with surface density \(\Sigma(R)\) is

\[\Phi(R,z)=-\frac{2G}{\sqrt{R}}\int_{0}^{\infty}{\rm d}R^{\prime}\,\Sigma(R^{ \prime})kK(k)\sqrt{R^{\prime}}, \tag{2.265}\]

where \(K(k)\) is a complete elliptic integral (Appendix C.4) and

\[k^{2}\equiv\frac{4RR^{\prime}}{(R+R^{\prime})^{2}+z^{2}}. \tag{2.266}\]

Hint: start with equation (2.3) and show that \(|{\bf x}-{\bf x}^{\prime}|^{2}=4RR^{\prime}k^{-2}\{1-k^{2}\cos^{2}[\frac{1}{ 2}(\phi-\phi^{\prime})]\}\). Note that the integral (2.265) has a logarithmic singularity when \(z=0\) and \(R^{\prime}\to R\), which requires some care when the integral is being evaluated numerically.

**2.22**: [3] (Suggested by H. Dejonghe) Prove that the surface density \(\Sigma(x,y)\) and potential \(\Phi(x,y)\) in a disk occupying the plane \(z=0\) are related by

\[\Sigma(x^{\prime},y^{\prime})=\frac{1}{4\pi^{2}G}\int\!\!\int\frac{{\rm d}x\, {\rm d}y}{|{\bf x}-{\bf x}^{\prime}|}\left(\frac{\partial^{2}\Phi}{\partial x ^{2}}+\frac{\partial^{2}\Phi}{\partial y^{2}}\right). \tag{2.267}\]

**2.23**: [1] Consider the discrete form of Poisson's equation with periodic boundary conditions that is obtained by using the approximation (2.235) for the value of the Laplacian on a grid with \(K\) mesh cells on a side. Write \(\Phi_{lmn}\) and \(\rho_{lmn}\) in terms of their DFTs,

\[\Phi_{\bf r}=\sum_{\bf k}\hat{\Phi}_{\bf k}{\rm e}^{2\pi{\rm i}{\bf k}\cdot{\bf r }/K}\quad;\quad\rho_{\bf r}=\sum_{\bf k}\hat{\rho}_{\bf k}{\rm e}^{2\pi{\rm i }{\bf k}\cdot{\bf r}/K}, \tag{2.268}\]

where \({\bf r}\) and \({\bf k}\) are vectors with integer components in the range \((0,K-1)\). Show that

\[\Phi_{\bf k}=\frac{2\pi G\rho_{\bf k}\Delta^{2}}{\cos(2\pi k_{x}/K)+\cos(2\pi k _{y}/K)+\cos(2\pi k_{z}/K)-3}. \tag{2.269}\]

**2.24**: [2] In some numerical simulations of spherical stellar systems, spherical symmetry is enforced by treating each of the \(N\) stars as a "superstar," that is, a spherical shell containing a large number of stars with randomly oriented orbits but the same radius, radial velocity, and scalar angular momentum. Let \(m_{n}\) and \(r_{n}\) be the mass and radius of the \(n^{\rm th}\) superstar. Assume that the superstars are sorted in order of increasing radius, that is, \(r_{1}\leq r_{2}<\cdots<r_{N}\).

(a) Show that the force on superstar \(n\) is

\[{\bf F}_{n}=-\hat{\bf e}_{r}\,\frac{GM_{n}}{r_{n}^{2}}\quad\mbox{where}\quad M_{n }\equiv\sum_{j=1}^{n-1}m_{j}. \tag{2.270}\]

Thus show that the force on every star can be computed in O\((N)\) steps once the stars are sorted in radius, in contrast to direct summation (SS2.9.1), which requires O\((N^{2})\) steps.

(b) A set of \(N\) superstars can be sorted into increasing order in O\((N\ln N)\) steps (e.g., Press et al. 1986). Thus, the initial calculation of the forces for an unsorted system requires O\((N\ln N)\) steps. Show that force calculations at subsequent timesteps require only O\((N)\) steps.

## 3 The Orbits of Stars

In this chapter we examine the orbits of individual stars in gravitational fields such as those found in stellar systems. Thus we ask the questions, "What kinds of orbits are possible in a spherically symmetric, or an axially symmetric potential? How are these orbits modified if we distort the potential into a bar-like form?" We shall obtain analytic results for the simpler potentials, and use these results to develop an intuitive understanding of how stars move in more general potentials.

In SSSS3.1 to 3.3 we examine orbits of growing complexity in force fields of decreasing symmetry. The less symmetrical a potential is the less likely it is that we can obtain analytic results, so in SS3.4 we review techniques for integrating orbits in both a given gravitational field, and the gravitational field of a system of orbiting masses. Even numerically integrated orbits in gravitational fields of low symmetry often display a high degree of regularity in their phase-space structures. In SS3.5 we study this structure using analytic models, and develop analytic tools of considerable power, including the idea of adiabatic invariance, which we apply to some astronomical problems in SS3.6. In SS3.7 we develop Hamiltonian perturbation theory, and use it to study the phenomenon of orbital resonance and the role it plays in generating orbital chaos. In SS3.8 we draw on techniques developed throughout the chapter to understand how elliptical galaxies are affected by the existence of central stellar cusps and massive black holes at their centers.

All of the work in this chapter is based on a fundamental approximation:although galaxies are composed of stars, we shall neglect the forces from individual stars and consider only the large-scale forces from the overall mass distribution, which is made up of thousands of millions of stars. In other words, we assume that the gravitational fields of galaxies are _smooth_, neglecting small-scale irregularities due to individual stars or larger objects like globular clusters or molecular clouds. As we saw in SS1.2, the gravitational fields of galaxies _are_ sufficiently smooth that these irregularities can affect the orbits of stars only after many crossing times.

Since we are dealing only with gravitational forces, the trajectory of a star in a given field does not depend on its mass. Hence, we examine the dynamics of a particle of unit mass, and quantities such as momentum, angular momentum, and energy, and functions such as the Lagrangian and Hamiltonian, are normally written per unit mass.

### 3.1 Orbits in static spherical potentials

We first consider orbits in a static, spherically symmetric gravitational field. Such fields are appropriate for globular clusters, which are usually nearly spherical, but, more important, the results we obtain provide an indispensable guide to the behavior of orbits in more general fields.

The motion of a star in a centrally directed gravitational field is greatly simplified by the familiar law of conservation of angular momentum (see Appendix D.1). Thus if

\[{\bf r}=r\hat{\bf e}_{r} \tag{3.1}\]

denotes the position vector of the star with respect to the center, and the radial acceleration is

\[{\bf g}=g(r)\hat{\bf e}_{r}, \tag{3.2}\]

the equation of motion of the star is

\[\frac{{\rm d}^{2}{\bf r}}{{\rm d}t^{2}}=g(r)\hat{\bf e}_{r}. \tag{3.3}\]

If we remember that the cross product of any vector with itself is zero, we have

\[\frac{{\rm d}}{{\rm d}t}\left({\bf r}{\times}\frac{{\rm d}{\bf r}}{{\rm d}t} \right)=\frac{{\rm d}{\bf r}}{{\rm d}t}\times\frac{{\rm d}{\bf r}}{{\rm d}t}+{ \bf r}\times\frac{{\rm d}^{2}{\bf r}}{{\rm d}t^{2}}=g(r){\bf r}\times\hat{\bf e }_{r}=0. \tag{3.4}\]

Equation (3.4) says that \({\bf r}\times\hat{\bf r}\) is some constant vector, say \({\bf L}\):

\[{\bf r}\times\frac{{\rm d}{\bf r}}{{\rm d}t}={\bf L}. \tag{3.5}\]

Of course, \({\bf L}\) is simply the angular momentum per unit mass, a vector perpendicular to the plane defined by the star's instantaneous position and velocity vectors. Since this vector is constant, we conclude that the star moves in a plane, the **orbital plane**. This finding greatly simplifies the determination of the star's orbit, for now that we have established that the star moves in a plane, we may simply use plane polar coordinates \((r,\psi)\) in which the center of attraction is at \(r=0\) and \(\psi\) is the azimuthal angle in the orbital plane. In terms of these coordinates, the Lagrangian per unit mass (Appendix D.3) is

\[{\cal L}={{1\over 2}}\bigl{[}\dot{r}^{2}+(r\dot{\psi})^{2}\bigr{]}- \Phi(r), \tag{3.6}\]

where \(\Phi\) is the gravitational potential and \(g(r)=-{\rm d}\Phi/{\rm d}r\). The equations of motion are

\[0 = {{\rm d}\over{\rm d}t}{\partial{\cal L}\over\partial\dot{r}}-{ \partial{\cal L}\over\partial r}=\ddot{r}-r\dot{\psi}^{2}+{{\rm d}\Phi\over{ \rm d}r}, \tag{3.7a}\] \[0 = {{\rm d}\over{\rm d}t}{\partial{\cal L}\over\partial\dot{\psi}}-{ \partial{\cal L}\over\partial\psi}={{\rm d}\over{\rm d}t}\bigl{(}r^{2}\dot{ \psi}\bigr{)}. \tag{3.7b}\]

The second of these equations implies that

\[r^{2}\dot{\psi}={\rm constant}\equiv L. \tag{3.8}\]

It is not hard to show that \(L\) is actually the length of the vector \({\bf r}\times\dot{\bf r}\), and hence that (3.8) is just a restatement of the conservation of angular momentum. Geometrically, \(L\) is equal to twice the rate at which the radius vector sweeps out area.

To proceed further we use equation (3.8) to replace time \(t\) by angle \(\psi\) as the independent variable in equation (3.7a). Since (3.8) implies

\[{{\rm d}\over{\rm d}t}={L\over r^{2}}{{\rm d}\over{\rm d}\psi}, \tag{3.9}\]

equation (3.7a) becomes

\[{L^{2}\over r^{2}}{{\rm d}\over{\rm d}\psi}\left({1\over r^{2}}{{\rm d}r\over{ \rm d}\psi}\right)-{L^{2}\over r^{3}}=-{{\rm d}\Phi\over{\rm d}r}. \tag{3.10}\]

This equation can be simplified by the substitution

\[u\equiv{1\over r},\] (3.11a) which puts (3.10) into the form \[{{\rm d}^{2}u\over{\rm d}\psi^{2}}+u={1\over L^{2}u^{2}}{{\rm d}\Phi\over{\rm d }r}\bigl{(}1/u\bigr{)}. \tag{3.11b}\]The solutions of this equation are of two types: along **unbound** orbits \(r\to\infty\) and hence \(u\to 0\), while on **bound** orbits \(r\) and \(u\) oscillate between finite limits. Thus each bound orbit is associated with a periodic solution of this equation. We give several analytic examples later in this section, but in general the solutions of equation (3.11b) must be obtained numerically.

Some additional insight is gained by deriving a "radial energy" equation from equation (3.11b) in much the same way as we derive the conservation of kinetic plus potential energy in Appendix D; we multiply (3.11b) by \(\mathrm{d}u/\mathrm{d}\psi\) and integrate over \(\psi\) to obtain

\[\left(\frac{\mathrm{d}u}{\mathrm{d}\psi}\right)^{2}+\frac{2\Phi}{L^{2}}+u^{2}= \mathrm{constant}\equiv\frac{2E}{L^{2}}, \tag{3.12}\]

where we have used the relation \(\mathrm{d}\Phi/\mathrm{d}r=-u^{2}(\mathrm{d}\Phi/\mathrm{d}u)\).

This result can also be derived using Hamiltonians (Appendix D.4). From (3.6) we have that the momenta are \(p_{r}=\partial\mathcal{L}/\partial\dot{r}=\dot{r}\) and \(p_{\psi}=\partial\mathcal{L}/\partial\dot{\psi}=r^{2}\dot{\psi}\), so with equation (D.50) we find that the Hamiltonian per unit mass is

\[\begin{split} H(r,p_{r},p_{\psi})&=p_{r}\dot{r}+p_{ \psi}\dot{\psi}-\mathcal{L}\\ &=\tfrac{1}{2}\Big{(}p_{r}^{2}+\frac{p_{\psi}^{2}}{r^{2}}\Big{)}+ \Phi(r)\\ &=\tfrac{1}{2}\left(\frac{\mathrm{d}r}{\mathrm{d}t}\right)^{2}+ \tfrac{1}{2}\left(r\frac{\mathrm{d}\psi}{\mathrm{d}t}\right)^{2}+\Phi(r).\end{split} \tag{3.13}\]

When we multiply (3.12) by \(L^{2}/2\) and exploit (3.9), we find that the constant \(E\) in equation (3.12) is simply the numerical value of the Hamiltonian, which we refer to as the energy of that orbit.

For bound orbits the equation \(\mathrm{d}u/\mathrm{d}\psi=0\) or, from equation (3.12)

\[u^{2}+\frac{2[\Phi(1/u)-E]}{L^{2}}=0 \tag{3.14}\]

will normally have two roots \(u_{1}\) and \(u_{2}\) between which the star oscillates radially as it revolves in \(\psi\) (see Problem 3.7). Thus the orbit is confined between an inner radius \(r_{1}=u_{1}^{-1}\), known as the **pericenter** distance, and an outer radius \(r_{2}=u_{2}^{-1}\), called the **apocenter** distance. The pericenter and apocenter are equal for a circular orbit. When the apocenter is nearly equal to the pericenter, we say that the orbit has small **eccentricity**, while if the apocenter is much larger than the pericenter, the eccentricity is said to be near unity. The term "eccentricity" also has a mathematical definition, but only for Kepler orbits--see equation (3.25a).

The **radial period**\(T_{r}\) is the time required for the star to travel from apocenter to pericenter and back. To determine \(T_{r}\) we use equation (3.8) to eliminate \(\dot{\psi}\) from equation (3.13). We find

\[\left({{\rm d}r\over{\rm d}t}\right)^{2}=2(E-\Phi)-{L^{2}\over r^{2}},\]

which may be rewritten

\[{{\rm d}r\over{\rm d}t}=\pm\sqrt{2[E-\Phi(r)]-{L^{2}\over r^{2}}}.\]

The two possible signs arise because the star moves alternately in and out. Comparing (3.16) with (3.14) we see that \(\dot{r}=0\) at the pericenter and apocenter distances \(r_{1}\) and \(r_{2}\), as of course it must. From equation (3.16) it follows that the radial period is

\[T_{r}=2\int_{r_{1}}^{r_{2}}{{\rm d}r\over\sqrt{2[E-\Phi(r)]-L^{2}/r^{2}}}.\]

In traveling from pericenter to apocenter and back, the azimuthal angle \(\psi\) increases by an amount

\[\Delta\psi=2\int_{r_{1}}^{r_{2}}{{\rm d}\psi\over{\rm d}r}{\rm d}r=2\int_{r_{ 1}}^{r_{2}}{L\over r^{2}}{{\rm d}t\over{\rm d}r}{\rm d}r.\]

Substituting for \({\rm d}t/{\rm d}r\) from (3.16) this becomes

\[\Delta\psi=2L\int_{r_{1}}^{r_{2}}{{\rm d}r\over r^{2}\sqrt{2[E-\Phi(r)]-L^{2}/ r^{2}}}.\]The **azimuthal period** is

\[T_{\psi}=\frac{2\pi}{|\Delta\psi|}T_{r}; \tag{3.19}\]

in other words, the mean angular speed of the particle is \(2\pi/T_{\psi}\). In general \(\Delta\psi/2\pi\) will not be a rational number. Hence the orbit will not be closed: a typical orbit resembles a rosette and eventually passes close to every point in the annulus between the circles of radii \(r_{1}\) and \(r_{2}\) (see Figure 3.1 and Problem 3.13). There are, however, two and only two potentials in which all bound orbits are closed.

**(a) Spherical harmonic oscillator** We call a potential of the form

\[\Phi(r)={{1\over 2}}\Omega^{2}r^{2}+\mbox{constant} \tag{3.20}\]

a spherical harmonic oscillator potential. As we saw in SS2.2.2b, this potential is generated by a homogeneous sphere of matter. Equation (3.11b) could be solved analytically in this case, but it is simpler to use Cartesian coordinates \((x,y)\) defined by \(x=r\cos\psi\), \(y=r\sin\psi\). In these coordinates, the equations of motion are simply

\[\ddot{x}=-\Omega^{2}x\quad;\quad\ddot{y}=-\Omega^{2}y,\] (3.21a) with solutions \[x=X\cos(\Omega t+\epsilon_{x})\quad;\quad y=Y\cos(\Omega t+\epsilon_{y}), \tag{3.21b}\]

where \(X\), \(Y\), \(\epsilon_{x}\), and \(\epsilon_{y}\) are arbitrary constants. Every orbit is closed since the periods of the oscillations in \(x\) and \(y\) are identical. The orbits form ellipses centered on the center of attraction. The azimuthal period is \(T_{\psi}=2\pi/\Omega\) because this is the time required for the star to return to its original azimuth. During this time, the particle completes two in-and-out cycles, so the radial period is

\[T_{r}={{1\over 2}}T_{\psi}=\frac{\pi}{\Omega}. \tag{3.22}\]

**(b) Kepler potential** When the star is acted on by an inverse-square field \(g(r)=-GM/r^{2}\) due to a point mass \(M\), the corresponding potential is \(\Phi=-GM/r=-GMu\). Motion in this potential is often called **Kepler motion**. Equation (3.11b) becomes

\[\frac{\mbox{d}^{2}u}{\mbox{d}\psi^{2}}+u=\frac{GM}{L^{2}}, \tag{3.23}\]

the general solution of which is

\[u(\psi)=C\cos(\psi-\psi_{0})+\frac{GM}{L^{2}}, \tag{3.24}\]where \(C>0\) and \(\psi_{0}\) are arbitrary constants. Defining the orbit's **eccentricity** by

\[e\equiv{CL^{2}\over GM}\]

and its **semi-major axis** by

\[a\equiv{L^{2}\over GM(1-e^{2})},\]

equation equation (3.24) may be rewritten

\[r(\psi)={a(1-e^{2})\over 1+e\cos(\psi-\psi_{0})}.\]

An orbit for which \(e\geq 1\) is unbound, since \(r\to\infty\) as \((\psi-\psi_{0})\to\pm\cos^{-1}(-1/e)\). We discuss unbound orbits in SS3.1d below. Bound orbits have \(e<1\) and along them \(r\) is a periodic function of \(\psi\) with period \(2\pi\), so the star returns to its original radial coordinate after exactly one revolution in \(\psi\). Thus bound Kepler orbits are closed, and one may show that they form ellipses with the attracting center at one focus. The pericenter and apocenter distances are

\[r_{1}=a(1-e)\quad\hbox{and}\quad r_{2}=a(1+e).\]

In many applications, equation (3.26) for \(r\) along a bound Kepler orbit is less convenient than the parameterization

\[r=a(1-e\cos\eta),\]

where the parameter \(\eta\) is called the **eccentric anomaly** to distinguish it from the **true anomaly**, \(\psi-\psi_{0}\). By equating the right sides of equations (3.26) and (3.28a) and using the identity \(\cos\theta=(1-\tan^{2}{1\over 2}\theta)/(1+\tan^{2}{1\over 2}\theta)\), it is straightforward to show that the true and eccentric anomalies are related by

\[\sqrt{1-e}\,\tan{1\over 2}(\psi-\psi_{0})=\sqrt{1+e}\,\tan{1\over 2}\eta.\]

Equation (3.326) gives alternative relations between the two anomalies.

Taking \(t=0\) to occur at pericenter passage, from \(L=r^{2}\dot{\psi}\) we have

\[t=\int_{\psi_{0}}^{\psi}{{\rm d}\psi\over\dot{\psi}}=\int{\rm d}\psi\,{r^{2} \over L}={a^{2}\over L}\int_{0}^{\eta}{\rm d}\eta\,{{\rm d}\psi\over{\rm d} \eta}(1-e\cos\eta)^{2}.\]

Evaluating \({\rm d}\psi/{\rm d}\eta\) from (3.29), integrating, and using trigonometrical identities to simplify the result, we obtain finally

\[t={a^{2}\over L}\sqrt{1-e^{2}}\,(\eta-e\sin\eta)={T_{r}\over 2\pi}(\eta-e\sin \eta),\]where the second equality follows because the bracket on the right increases by \(2\pi\) over an orbital period. This is called **Kepler's equation**, and the quantity \(2\pi t/T_{r}\) is sometimes called the **mean anomaly**. Hence

\[T_{r}=T_{\psi}={a^{2}\over L}\sqrt{1-e^{2}}=2\pi\sqrt{{a^{3}\over GM}},\]

where the second equality uses (3.25b).

From (3.12) the energy per unit mass of a particle on a Kepler orbit is

\[E=-{GM\over 2a}.\]

To unbind the particle, we must add the **binding energy \(-E\)**.

The study of motion in nearly Kepler potentials is central to the dynamics of planetary systems (Murray & Dermott 1999).

We have shown that a star on a Kepler orbit completes a radial oscillation in the time required for \(\psi\) to increase by \(\Delta\psi=2\pi\), whereas a star that orbits in a harmonic-oscillator potential has already completed a radial oscillation by the time \(\psi\) has increased by \(\Delta\psi=\pi\). Since galaxies are more extended than point masses, and less extended than homogeneous spheres, a typical star in a spherical galaxy completes a radial oscillation after its angular coordinate has increased by an amount that lies somewhere in between these two extremes; \(\pi<\Delta\psi<2\pi\) (cf. Problem 3.17). Thus, we expect a star to oscillate from its apocenter through its pericenter and back in a shorter time than is required for one complete azimuthal cycle about the galactic center.

It is sometimes useful to consider that an orbit in a non-Kepler force field forms an approximate ellipse, though one that **precesses** by \(\psi_{\rm p}=\Delta\psi-2\pi\) in the time needed for one radial oscillation. For the orbit shown in Figure 3.1, and most galactic orbits, this precession is in the sense opposite to the rotation of the star itself. The angular velocity \(\Omega_{\rm p}\) of the rotating frame in which the ellipse appears closed is

\[\Omega_{\rm p}={\psi_{\rm p}\over T_{r}}={\Delta\psi-2\pi\over T_{r}}.\]

Hence we say that \(\Omega_{\rm p}\) is the **precession rate** of the ellipse. The concept of closed orbits in a rotating frame of reference is crucial to the theory of spiral structure--see SS6.2.1, particularly Figure 6.12.

**(c) Isochrone potential** The harmonic oscillator and Kepler potentials are both generated by mass distributions that are qualitatively different from the mass distributions of galaxies. The only known potential that could be generated by a realistic stellar system for which all orbits are analytic is the isochrone potential of equation (2.47) (Henon 1959).

### 3.1 Timing the local group

The nearest giant spiral galaxy is the Sb galaxy M31, at a distance of about \((740\pm 40)\,\)kpc (BM SS7.4.1). Our galaxy and M31 are by far the two largest members of the Local Group of galaxies. Beyond these, the next nearest prominent galaxies are in the Sculptor and M81 groups, at a distance of 3 Mpc. Thus the Local Group is an isolated system.

The line-of-sight velocity of the center of M31 relative to the center of the Galaxy is \(-125\,\)km\(\,\)s\({}^{-1}\) (for a solar circular speed \(v_{0}=220\,\)km\(\,\)s\({}^{-1}\), eq. 1.8); it is negative because the two galaxies are approaching one another. It seems that gravity has halted and reversed the original motion of M31 away from the Galaxy. Since M31 and the Galaxy are by far the most luminous members of the Local Group, we can treat them as an isolated system of two point masses, and estimate their total mass (Kahn & Woltjer 1959; Wilkinson & Evans 1999). Moreover, the original Hubble recession corresponded to an orbit of zero angular momentum, so we expect the angular momentum of the current orbit to be negligible. Thus we assume that the eccentricity \(e=1\).

We may now apply equations (3.28) for a Kepler orbit. Taking the log of both equations, differentiating with respect to \(\eta\), and taking the ratio, we obtain

\[{{\rm d}\ln r\over{\rm d}\ln t}={t\over r}{{\rm d}r\over{\rm d}t}={e\sin\eta( \eta-e\sin\eta)\over(1-e\cos\eta)^{2}}. \tag{1}\]

We set \(e=1\), and require that \(r=740\,\)kpc, \({\rm d}r/{\rm d}t=-125\,\)km\(\,\)s\({}^{-1}\), and \(t=13.7\,\)Gyr, the current age of the universe (eq. 77). Inserting these constraints in (1) gives a nonlinear equation for \(\eta\), which is easily solved numerically to yield \(\eta=4.29\). Then equations (3.28) yield \(a=524\,\)kpc and \(T_{r}=16.6\,\)Gyr, and equation (3.31) finally yields \(M=4.6\times 10^{12}\,{\cal M}_{\odot}\) for the total mass of M31 and the Galaxy. The uncertainty in this result, assuming that our model is correct, is probably about a factor of 1.5.

This calculation assumes that the vacuum-energy density \(\rho_{\Lambda}\) is zero. Inclusion of non-zero \(\rho_{\Lambda}\) is simple (Problem 3.5); with parameters from equations (1.52) and (1.73), the required mass \(M\) increases by 15%.

The luminosity of the Galaxy in the \(R\) band is \(3\times 10^{10}\,L_{\odot}\) (Table 1.2) and M31 is about 1.5 times as luminous (BM Table 4.3); thus, if our mass estimate is correct, the mass-to-light ratio for the Local Group is \(\Upsilon_{V}\simeq 60\Upsilon_{\odot}\). This is far larger than expected for any normal stellar population, and the total mass is far larger than the masses within the outer edges of the disks of these galaxies, as measured by circular-speed curves. Thus the Kahn-Woltjer timing argument provided the first direct evidence that most of the mass of the Local Group is composed of dark matter. For a review see Peebles (1996).

**Box 3.2: The eccentricity vector for Kepler orbits**

The orbit of a test particle in the Kepler potential can also be found using vector methods. Since the angular momentum per unit mass \({\bf L}={\bf r}\times{\bf v}\) is constant in any central field \(g(r)\), with the equation of motion (3.3) and the vector identity (B.9) we have

\[{{\rm d}\over{\rm d}t}({\bf v}\times{\bf L})={{\rm d}{\bf v}\over{\rm d}t}\times {\bf L}=g(r)\hat{\bf e}_{r}\times({\bf r}\times{\bf v})=g(r)\left[(\hat{\bf e}_{ r}\cdot{\bf v}){\bf r}-r{\bf v}\right].\]

The time derivative of the unit radial vector is

\[{{\rm d}\hat{\bf e}_{r}\over{\rm d}t}={{\rm d}\over{\rm d}t}\left({{\bf r} \over r}\right)={{\bf v}\over r}-{{\bf r}\cdot{\bf v}\over r^{3}}{\bf r}={1 \over r^{2}}\left[r{\bf v}-(\hat{\bf e}_{r}\cdot{\bf v}){\bf r}\right].\]

Comparing equations (1) and (2) we have

\[{{\rm d}\over{\rm d}t}({\bf v}\times{\bf L})=-g(r)r^{2}{{\rm d}\hat{\bf e}_{r }\over{\rm d}t}.\]

If and only if the field is Kepler, \(g(r)=-GM/r^{2}\), this equation can be integrated to yield

\[{\bf v}\times{\bf L}=GM(\hat{\bf e}_{r}+{\bf e}),\]

where \({\bf e}\) is a vector constant, or integral of motion (see SS3.1.1). Taking the dot product of \({\bf L}\) with equation (4), we find that \({\bf e}\cdot{\bf L}=0\), so \({\bf e}\) lies in the orbital plane. Taking the dot product of \({\bf r}\) with equation (4) and using the vector identity (B.8), we have

\[L^{2}=GM(r+{\bf e}\cdot{\bf r}).\]

If we now define \(\psi\) to be an azimuthal angle in the orbital plane, with \({\bf e}\) at azimuth \(\psi_{0}\), then \({\bf e}\cdot{\bf r}=er\cos(\psi-\psi_{0})\), where \(e=|{\bf e}|\), and equation (5) can be rewritten

\[r={L^{2}\over GM}{1\over 1+e\cos(\psi-\psi_{0})},\]

which is the same as equations (3.25b) and (3.26) for a Kepler orbit if we identify \(e\) with the eccentricity. It is therefore natural to call the vector constant \({\bf e}\) the **eccentricity vector**, also sometimes called the Laplace or Runge-Lenz vector. The eccentricity vector has length equal to the eccentricity and points from the central mass towards the pericenter. The direction of the eccentricity vector is called the **line of apsides**.

Orbits in other central fields have integrals of motion analogous to the scalar eccentricity, but they do not have vector integrals analogous to the eccentricity vector, because orbits in non-Kepler potentials are not closed.

It is convenient to define an auxiliary variable \(s\) by

\[s\equiv-\frac{GM}{b\Phi}=1+\sqrt{1+\frac{r^{2}}{b^{2}}}. \tag{3.34}\]

Solving this equation for \(r\), we find that

\[\frac{r^{2}}{b^{2}}=s^{2}\left(1-\frac{2}{s}\right)\qquad(s\geq 2). \tag{3.35}\]

Given this one-to-one relationship between \(s\) and \(r\), we may employ \(s\) as a radial coordinate in place of \(r\). The integrals (3.17) and (3.18b) for \(T_{r}\) and \(\Delta\psi\) both involve the infinitesimal quantity

\[\mathrm{d}I\equiv\frac{\mathrm{d}r}{\sqrt{2(E-\Phi)-L^{2}/r^{2}}}. \tag{3.36}\]

When we use equation (3.35) to eliminate \(r\) from this expression, we find

\[\mathrm{d}I=\frac{b(s-1)\mathrm{d}s}{\sqrt{2Es^{2}-2(2E-GM/b)s-4GM/b-L^{2}/b^{ 2}}}. \tag{3.37}\]

As the star moves from pericenter \(r_{1}\) to apocenter \(r_{2}\), \(s\) varies from the smaller root \(s_{1}\) of the quadratic expression in the denominator of equation (3.37) to the larger root \(s_{2}\). Thus, combining equations (3.17) and (3.37), the radial period is

\[T_{r}=\frac{2b}{\sqrt{-2E}}\int_{s_{1}}^{s_{2}}\mathrm{d}s\,\frac{(s-1)}{\sqrt {(s_{2}-s)(s-s_{1})}}=\frac{2\pi b}{\sqrt{-2E}}\left[\tfrac{1}{2}(s_{1}+s_{2} )-1\right], \tag{3.38}\]

where we have assumed \(E<0\) since we are dealing with bound orbits. But from the denominator of equation (3.37) it follows that the roots \(s_{1}\) and \(s_{2}\) obey

\[s_{1}+s_{2}=2-\frac{GM}{Eb},\] (3.39a) and so the radial period \[T_{r}=\frac{2\pi GM}{(-2E)^{3/2}}, \tag{3.39b}\]

exactly as in the Kepler case (the limit of the isochrone as \(b\to 0\)). Note that \(T_{r}\) depends on the energy \(E\) but not on the angular momentum \(L\)--it is this unique property that gives the isochrone its name.

Equation (3.18b), for the increment \(\Delta\psi\) in azimuthal angle per cycle in the radial direction, yields

\[\begin{split}\Delta\psi=2L\int_{s_{1}}^{s_{2}}\frac{\mathrm{d}I }{r^{2}}&=\frac{2L}{b\sqrt{-2E}}\int_{s_{1}}^{s_{2}}\mathrm{d}s \,\frac{(s-1)}{s(s-2)\sqrt{(s_{2}-s)(s-s_{1})}}\\ &=\pi\,\mathrm{sgn}(L)\left(1+\frac{|L|}{\sqrt{L^{2}+4GMb}} \right),\end{split} \tag{3.40}\]where \({\rm sgn}(L)=\pm 1\) depending on the sign of \(L\). From this expression we see that

\[\pi<|\Delta\psi|<2\pi. \tag{3.41}\]

The only orbits for which \(|\Delta\psi|\) approaches the value \(2\pi\) characteristic of Kepler motion are those with \(L^{2}\gg 4GMb\). Such orbits never approach the core \(r\lesssim b\) of the potential, and hence always move in a near-Kepler field. In the opposite limit, \(L^{2}\ll 4GMb\), \(|\Delta\psi|\to\pi\); physically this implies that low angular-momentum orbits fly straight through the core of the potential. In fact, the behavior \(|\Delta\psi|\to\pi\) as \(L\to 0\) is characteristic of any spherical potential that is not strongly singular at \(r=0\)--see Problem 3.19.

Inserting equations (3.39b) and (3.40) into equation (3.19), we have that the azimuthal period of an isochrone orbit is

\[T_{\psi}=\frac{4\pi GM}{(-2E)^{3/2}}\frac{\sqrt{L^{2}+4GMb}}{|L|+\sqrt{L^{2}+4 GMb}}. \tag{3.42}\]

##### (d) Hyperbolic encounters

In Chapter 7 we shall find that the dynamical evolution of globular clusters is largely driven by gravitational encounters between stars. These encounters are described by unbound Kepler orbits.

Let \(({\bf x}_{M},{\bf v}_{M})\) and \(({\bf x}_{m},{\bf v}_{m})\) be the positions and velocities of two point masses \(M\) and \(m\), respectively; let \({\bf r}={\bf x}_{M}-{\bf x}_{m}\) and \({\bf V}=\dot{\bf r}\). Then the separation vector \({\bf r}\) obeys equation (D.33),

\[\biggl{(}\frac{mM}{M+m}\biggr{)}\ddot{\bf r}=-\frac{GMm}{r^{2}}\,\hat{\bf e}_ {r}\quad{\rm or}\quad\mu\ddot{\bf r}=-\frac{G(M+m)\mu}{r^{2}}\,\hat{\bf e}_{r}. \tag{3.43}\]

This is the equation of motion of a fictitious particle, called the reduced particle, which has mass \(\mu=Mm/(M+m)\) and travels in the Kepler potential of a fixed body of mass \(M+m\) (see Appendix D.1). If \(\Delta{\bf v}_{m}\) and \(\Delta{\bf v}_{M}\) are the changes in the velocities of \(m\) and \(M\) during the encounter, we have

\[\Delta{\bf v}_{M}-\Delta{\bf v}_{m}=\Delta{\bf V}.\] (3.44a) Furthermore, since the velocity of the center of mass of the two bodies is unaffected by the encounter (eq. D.19), we also have \[M\Delta{\bf v}_{M}+m\Delta{\bf v}_{m}=0.\] (3.44b) Eliminating \[\Delta{\bf v}_{m}\] between equations ( 3.44 ) we obtain \[\Delta{\bf v}_{M}\] as \[\Delta{\bf v}_{M}=\frac{m}{M+m}\Delta{\bf V}. \tag{3.45}\]We now evaluate \(\Delta{\bf V}\).

Let the component of the initial separation vector that is perpendicular to the initial velocity vector \({\bf V}_{0}={\bf V}(t=-\infty)\) have length \(b\) (see Figure 3.2), the **impact parameter** of the encounter. Then the conserved angular momentum per unit mass associated with the motion of the reduced particle is

\[L=bV_{0}. \tag{3.46}\]

Equation (3.24), which relates the radius and azimuthal angle of a particle in a Kepler orbit, reads in this case,

\[\frac{1}{r}=C\cos(\psi-\psi_{0})+\frac{G(M+m)}{b^{2}V_{0}^{2}}, \tag{3.47}\]

where the angle \(\psi\) is shown in Figure 3.2. The constants \(C\) and \(\psi_{0}\) are determined by the initial conditions. Differentiating equation (3.47) with respect to time, we obtain

\[\begin{split}\frac{\mathrm{d}r}{\mathrm{d}t}&=Cr^{2 }\dot{\psi}\sin(\psi-\psi_{0})\\ &=CbV_{0}\sin(\psi-\psi_{0}),\end{split} \tag{3.48}\]

where the second line follows because \(r^{2}\dot{\psi}=L\). If we define the direction \(\psi=0\) to point towards the particle as \(t\to-\infty\), we find on evaluating equation (3.48) at \(t=-\infty\),

\[-V_{0}=CbV_{0}\sin(-\psi_{0}).\] (3.49a) On the other hand, evaluating equation ( 3.47 ) at this time we have \[0=C\cos\psi_{0}+\frac{G(M+m)}{b^{2}V_{0}^{2}}.\] (3.49b) Eliminating \[C\] between these equations, we obtain \[\tan\psi_{0}=-\frac{bV_{0}^{2}}{G(M+m)}. \tag{3.50}\]

Figure 3.2: The motion of the reduced particle during a hyperbolic encounter.

But from either (3.47) or (3.48) we see that the point of closest approach is reached when \(\psi=\psi_{0}\). Since the orbit is symmetrical about this point, the angle through which the reduced particle's velocity is deflected is \(\theta_{\rm defl}=2\psi_{0}-\pi\) (see Figure 3.2). It proves useful to define the \({\bf 90^{\circ}}\)**deflection radius** as the impact parameter at which \(\theta_{\rm defl}=90^{\circ}\):

\[b_{90}\equiv\frac{G(M+m)}{V_{0}^{2}}. \tag{3.51}\]

Thus

\[\theta_{\rm defl}=2\tan^{-1}\left(\frac{G(M+m)}{bV_{0}^{2}}\right)=2\tan^{-1} (b_{90}/b). \tag{3.52}\]

By conservation of energy, the relative speed after the encounter equals the initial speed \(V_{0}\). Hence the components \(\Delta{\bf V}_{\parallel}\) and \(\Delta{\bf V}_{\perp}\) of \(\Delta{\bf V}\) parallel and perpendicular to the original relative velocity vector \({\bf V}_{0}\) are given by

\[|\Delta{\bf V}_{\perp}| = V_{0}\sin\theta_{\rm defl}=V_{0}|\sin 2\psi_{0}|=\frac{2V_{0}| \tan\psi_{0}|}{1+\tan^{2}\psi_{0}} \tag{3.53a}\] \[= \frac{2V_{0}(b/b_{90})}{1+b^{2}/b_{90}^{2}},\] \[|\Delta{\bf V}_{\parallel}| = V_{0}(1-\cos\theta_{\rm defl})=V_{0}(1+\cos 2\psi_{0})=\frac{2V_ {0}}{1+\tan^{2}\psi_{0}}\] (3.53b) \[= \frac{2V_{0}}{1+b^{2}/b_{90}^{2}}.\]

\(\Delta{\bf V}_{\parallel}\) always points in the direction opposite to \({\bf V}_{0}\). By equation (3.45) we obtain the components of \(\Delta{\bf v}_{M}\) as

\[|\Delta{\bf v}_{M\perp}| = \frac{2mV_{0}}{M+m}\frac{b/b_{90}}{1+b^{2}/b_{90}^{2}}, \tag{3.54a}\] \[|\Delta{\bf v}_{M\parallel}| = \frac{2mV_{0}}{M+m}\frac{1}{1+b^{2}/b_{90}^{2}}. \tag{3.54b}\]

\(\Delta{\bf v}_{M\parallel}\) always points in the direction opposite to \({\bf V}_{0}\). Notice that in the limit of large impact parameter \(b\), \(|\Delta{\bf v}_{M\perp}|=2Gm/(bV_{0})\), which agrees with the determination of the same quantity in equation (1.30).

#### 3.1.1 Constants and integrals of the motion

Any stellar orbit traces a path in the six-dimensional space for which the coordinates are the position and velocity \({\bf x},{\bf v}\). This space is called **phase space**.1 A **constant of motion** in a given force field is any function \(C({\bf x},{\bf v};t)\) of the phase-space coordinates and time that is constant along stellar orbits; that is, if the position and velocity along an orbit are given by \({\bf x}(t)\) and \({\bf v}(t)={\rm d}{\bf x}/{\rm d}t\),

\[C[{\bf x}(t_{1}),{\bf v}(t_{1});t_{1}]=C[{\bf x}(t_{2}),{\bf v}(t_{2});t_{2}] \tag{3.55}\]

for any \(t_{1}\) and \(t_{2}\).

An **integral of motion**\(I({\bf x},{\bf v})\) is any function of the phase-space coordinates alone that is constant along an orbit:

\[I[{\bf x}(t_{1}),{\bf v}(t_{1})]=I[{\bf x}(t_{2}),{\bf v}(t_{2})]. \tag{3.56}\]

While every integral is a constant of the motion, the converse is not true. For example, on a circular orbit in a spherical potential the azimuthal coordinate \(\psi\) satisfies \(\psi=\Omega t+\psi_{0}\), where \(\Omega\) is the star's constant angular speed and \(\psi_{0}\) is its azimuth at \(t=0\). Hence \(C(\psi,t)\equiv t-\psi/\Omega\) is a constant of the motion, but it is not an integral because it depends on time as well as the phase-space coordinates.

Any orbit in any force field always has six independent constants of motion. Indeed, since the initial phase-space coordinates \(({\bf x}_{0},{\bf v}_{0})\equiv[{\bf x}(0),{\bf v}(0)]\) can always be determined from \([{\bf x}(t),{\bf v}(t)]\) by integrating the equations of motion backward, \(({\bf x}_{0},{\bf v}_{0})\) can be regarded as six constants of motion.

By contrast, orbits can have from zero to five integrals of motion. In certain important cases, a few of these integrals can be written down easily: in any static potential \(\Phi({\bf x})\), the Hamiltonian \(H({\bf x},{\bf v})={1\over 2}v^{2}+\Phi\) is an integral of motion. If a potential \(\Phi(R,z,t)\) is axisymmetric about the \(z\) axis, the \(z\)-component of the angular momentum is an integral, and in a spherical potential \(\Phi(r,t)\) the three components of the angular-momentum vector \({\bf L}={\bf x}\times{\bf v}\) constitute three integrals of motion. However, we shall find in SS3.2 that even when integrals exist, analytic expressions for them are often not available.

These concepts and their significance for the geometry of orbits in phase space are nicely illustrated by the example of motion in a spherically symmetric potential. In this case the Hamiltonian \(H\) and the three components of the angular momentum per unit mass \({\bf L}={\bf x}\times{\bf v}\) constitute four integrals. However, we shall find it more convenient to use \(|{\bf L}|\) and the two independent components of the unit vector \(\hat{\bf n}={\bf L}/|{\bf L}|\) as integrals in place of \({\bf L}\). We have seen that \(\hat{\bf n}\) defines the orbital plane within which the position vector \({\bf r}\) and the velocity vector \({\bf v}\) must lie. Hence we conclude that the two independent components of \(\hat{\bf n}\) restrict the star's phase point to a four-dimensional region of phase space. Furthermore, the equations \(H({\bf x},{\bf v})=E\) and \(|{\bf L}({\bf x},{\bf v})|=L\), where \(L\) is a constant, restrict the phase point to that two-dimensional surface in this four-dimensional region on which \(v_{r}=\pm\sqrt{2[E-\Phi(r)]-L^{2}/r^{2}}\) and \(v_{\psi}=L/r\). In SS3.5.1 we shall see that this surface is a torus and that the sign ambiguity in \(v_{r}\) is analogous to the sign ambiguity in the \(z\)-coordinateof a point on the sphere \(r^{2}=1\) when one specifies the point through its \(x\) and \(y\) coordinates. Thus, given \(E\), \(L\), and \(\hat{\bf n}\), the star's position and velocity (up to its sign) can be specified by two quantities, for example \(r\) and \(\psi\).

Is there a fifth integral of motion in a spherical potential? To study this question, we examine motion in the potential

\[\Phi(r)=-GM\left({1\over r}+{a\over r^{2}}\right).\]

For this potential, equation (3.11b) becomes

\[{{\rm d}^{2}u\over{\rm d}\psi^{2}}+\left(1-{2GMa\over L^{2}}\right)u={GM\over L ^{2}},\]

the general solution of which is

\[u=C\cos\left({\psi-\psi_{0}\over K}\right)+{GMK^{2}\over L^{2}},\]

where

\[K\equiv\left(1-{2GMa\over L^{2}}\right)^{-1/2}.\]

Hence

\[\psi_{0}=\psi-K\,{\rm Arccos}\,\left[{1\over C}\left({1\over r}-{GMK^{2}\over L ^{2}}\right)\right],\]

where \(t=\,{\rm Arccos}\,x\) is the multiple-valued solution of \(x=\cos t\), and \(C\) can be expressed in terms of \(E\) and \(L\) by

\[E={{1\over 2}}{C^{2}L^{2}\over K^{2}}-{{1\over 2}}\left({GMK \over L}\right)^{2}.\]

If in equations (3.59b), (3.60) and (3.61) we replace \(E\) by \(H({\bf x},{\bf v})\) and \(L\) by \(|{\bf L}({\bf x},{\bf v})|=|{\bf x}\times{\bf v}|\), the quantity \(\psi_{0}\) becomes a function of the phase-space coordinates which is constant as the particle moves along its orbit. Hence \(\psi_{0}\) is a fifth integral of motion. (Since the function \({\rm Arccos}\,x\) is multiple-valued, a judicious choice of solution is necessary to avoid discontinuous jumps in \(\psi_{0}\).) Now suppose that we know the numerical values of \(E\), \(L\), \(\psi_{0}\), and the radial coordinate \(r\). Since we have four numbers--three integrals and one coordinate--it is natural to ask how we might use these numbers to determine the azimuthal coordinate \(\psi\). We rewrite equation (3.60) in the form

\[\psi=\psi_{0}\pm K\cos^{-1}\left[{1\over C}\left({1\over r}-{GMK^{2}\over L^{2 }}\right)\right]+2nK\pi,\]where \(\cos^{-1}(x)\) is defined to be the value of \(\mbox{Arccos}\left(x\right)\) that lies between \(0\) and \(\pi\), and \(n\) is an arbitrary integer. If \(K\) is irrational--as nearly all real numbers are--then by a suitable choice of the integer \(n\), we can make \(\psi\) modulo \(2\pi\) approximate any given number as closely as we please. Thus for any values of \(E\) and \(L\), and any value of \(r\) between the pericenter and apocenter for the given \(E\) and \(L\), an orbit that is known to have a given value of the integral \(\psi_{0}\) can have an azimuthal angle as close as we please to any number between \(0\) and \(2\pi\).

On the other hand, if \(K\) is rational these problems do not arise. The simplest and most important case is that of the Kepler potential, when \(a=0\) and \(K=1\). Equation (3.62) now becomes

\[\psi=\psi_{0}\pm\cos^{-1}\left[\frac{1}{C}\left(\frac{1}{r}-\frac{GM}{L^{2}} \right)\right]+2n\pi, \tag{3.63}\]

which yields only two values of \(\psi\) modulo \(2\pi\) for given \(E\), \(L\) and \(r\).

These arguments can be restated geometrically. The phase space has six dimensions. The equation \(H({\bf x},{\bf v})=E\) confines the orbit to a five-dimensional subspace. The vector equation \({\bf L}({\bf x},{\bf v})=\mbox{\it constant}\) adds three further constraints, thereby restricting the orbit to a two-dimensional surface. Through the equation \(\psi_{0}({\bf x},{\bf v})=\mbox{\it constant}\) the fifth integral confines the orbit to a one-dimensional curve on this surface. Figure 3.1 can be regarded as a projection of this curve. In the Kepler case \(K=1\), the curve closes on itself, and hence does not cover the two-dimensional surface \(H=\mbox{\it constant}\), \({\bf L}=\mbox{\it constant}\). But when \(K\) is irrational, the curve is endless and densely covers the surface of constant \(H\) and \({\bf L}\).

We can make an even stronger statement. Consider any volume of phase space, of any shape or size. Then if \(K\) is irrational, the fraction of the time that an orbit with given values of \(H\) and \({\bf L}\) spends in that volume does not depend on the value that \(\psi_{0}\) takes on this orbit.

Integrals like \(\psi_{0}\) for irrational \(K\) that do not affect the phase-space distribution of an orbit, are called **non-isolating integrals**. All other integrals are called **isolating integrals**. The examples of isolating integrals that we have encountered so far, namely, \(H\), \({\bf L}\), and the function \(\psi_{0}\) when \(K=1\), all confine stars to a five-dimensional region in phase space. However, there can also be isolating integrals that restrict the orbit to a six-dimensional subspace of phase space--see SS3.7.3. Isolating integrals are of great practical and theoretical importance, whereas non-isolating integrals are of essentially no value for galactic dynamics.

### 3.2 Orbits in axisymmetric potentials

Few galaxies are even approximately spherical, but many approximate figures of revolution. Thus in this section we begin to explore the types of orbits that are possible in many real galaxies. As in Chapter 2, we shall usually employ a cylindrical coordinate system \((R,\phi,z)\) with origin at the galactic center, and shall align the \(z\) axis with the galaxy's symmetry axis.

Stars whose motions are confined to the equatorial plane of an axisymmetric galaxy have no way of perceiving that the potential in which they move is not spherically symmetric. Therefore their orbits will be identical with those we discussed in the last section; the radial coordinate \(R\) of a star on such an orbit oscillates between fixed extrema as the star revolves around the center, and the orbit again forms a rosette figure.

#### 3.2.1 Motion in the meridional plane

The situation is much more complex and interesting for stars whose motions carry them out of the equatorial plane of the system. The study of such general orbits in axisymmetric galaxies can be reduced to a two-dimensional problem by exploiting the conservation of the \(z\)-component of angular momentum of any star. Let the potential, which we assume to be symmetric about the plane \(z=0\), be \(\Phi(R,z)\). Then the motion is governed by the Lagrangian

\[{\cal L}={{1\over 2}}\bigl{[}\dot{R}^{2}+\bigl{(}R\dot{\phi} \bigr{)}^{2}+\dot{z}^{2}\bigr{]}-\Phi(R,z). \tag{3.64}\]

The momenta are

\[p_{R}=\dot{R}\quad;\quad p_{\phi}=R^{2}\dot{\phi}\quad;\quad p_{z}=\dot{z}, \tag{3.65}\]

so the Hamiltonian is

\[H={{1\over 2}}\Bigl{(}p_{R}^{2}+{p_{\phi}^{2}\over R^{2}}+p_{z}^{2} \Bigr{)}+\Phi(R,z). \tag{3.66}\]

From Hamilton's equations (D.54) we find that the equations of motion are

\[\dot{p}_{R}=\ddot{R}={p_{\phi}^{2}\over R^{3}}-{\partial\Phi\over \partial R}, \tag{3.67a}\] \[\dot{p}_{\phi}={{\rm d}\over{\rm d}t}\bigl{(}R^{2}\dot{\phi} \bigr{)}=0,\] (3.67b) \[\dot{p}_{z}=\ddot{z}=-{\partial\Phi\over\partial z}. \tag{3.67c}\]

Equation (3.67b) expresses conservation of the component of angular momentum about the \(z\) axis, \(p_{\phi}=L_{z}\) (a constant), while equations (3.67a) and (3.67c) describe the coupled oscillations of the star in the \(R\) and \(z\)-directions.

After replacing \(p_{\phi}\) in (3.67a) by its numerical value \(L_{z}\), the first and last of equations (3.67) can be written

\[\ddot{R}=-\frac{\partial\Phi_{\rm eff}}{\partial R}\quad;\quad\ddot{z}=-\frac{ \partial\Phi_{\rm eff}}{\partial z},\] (3.68a) where \[\Phi_{\rm eff}\equiv\Phi(R,z)+\frac{L_{z}^{2}}{2R^{2}} \tag{3.68b}\]

is called the **effective potential**. Thus the three-dimensional motion of a star in an axisymmetric potential \(\Phi(R,z)\) can be reduced to the two-dimensional motion of the star in the \((R,z)\) plane (the **meridional plane**) under the Hamiltonian

\[H_{\rm eff}={\frac{1}{2}}(p_{R}^{2}+p_{z}^{2})+\Phi_{\rm eff}(R,z). \tag{3.69}\]

Notice that \(H_{\rm eff}\) differs from the full Hamiltonian (3.66) only in the substitution of the constant \(L_{z}\) for the azimuthal momentum \(p_{\phi}\). Consequently, the numerical value of \(H_{\rm eff}\) is simply the orbit's total energy \(E\). The difference \(E-\Phi_{\rm eff}\) is the kinetic energy of motion in the \((R,z)\) plane, equal to \({\frac{1}{2}}(p_{R}^{2}+p_{z}^{2})\). Since kinetic energy is non-negative, the orbit is restricted to the area in the meridional plane satisfying the inequality \(E\geq\Phi_{\rm eff}\). The curve bounding this area is called the **zero-velocity curve**, since the orbit can only reach this curve if its velocity in the \((R,z)\) plane is instantaneously zero.

Figure 3.3 shows contour plots of the effective potential

\[\Phi_{\rm eff}={\frac{1}{2}}v_{0}^{2}\ln\left(R^{2}+\frac{z^{2}}{q^{2}} \right)+\frac{L_{z}^{2}}{2R^{2}}, \tag{3.70}\]

Figure 3.3: Level contours of the effective potential of equation (3.70) when \(v_{0}=1\), \(L_{z}=0.2\). Contours are shown for \(\Phi_{\rm eff}=-1\), \(-0.5\), \(0\), \(0.5\), \(1\), \(1.5\), \(2\), \(3\), \(5\). The axis ratio is \(q=0.9\) in the left panel and \(q=0.5\) in the right.

for \(v_{0}=1\), \(L_{z}=0.2\) and axial ratios \(q=0.9\) and \(0.5\). This resembles the effective potential experienced by a star in an oblate spheroidal galaxy that has a constant circular speed \(v_{0}\) (SS2.3.2). Notice that \(\Phi_{\rm eff}\) rises very steeply near the \(z\) axis, as if the axis of symmetry were protected by a **centrifugal barrier**.

The minimum in \(\Phi_{\rm eff}\) has a simple physical significance. The minimum occurs where

\[0={\partial\Phi_{\rm eff}\over\partial R}={\partial\Phi\over\partial R}-{L_{ z}^{2}\over R^{3}}\quad;\quad 0={\partial\Phi_{\rm eff}\over\partial z}. \tag{3.71}\]

The second of these conditions is satisfied anywhere in the equatorial plane \(z=0\) on account of the assumed symmetry of \(\Phi\) about this place, and the first is satisfied at the **guiding-center radius**\(R_{\rm g}\) where

\[\left({\partial\Phi\over\partial R}\right)_{\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!

#### Surfaces of section

The phase space associated with the motion we are considering has four dimensions, \(R\), \(z\), \(p_{R}\), and \(p_{z}\), and the four-dimensional motion of the phase-space point of an individual star is too complicated to visualize. Nonetheless, we can determine whether orbits in the \((R,z)\) plane admit an additional isolating integral by use of a simple graphical device. Since the Hamiltonian \(H_{\rm eff}(R,z,p_{R},p_{z})\) is constant, we could plot the motion of the representative point in a three-dimensional reduced phase space, say \((R,z,p_{R})\), and then \(p_{z}\) would be determined (to within a sign) by the known value \(E\) of \(H_{\rm eff}\). However, even three-dimensional spaces are difficult to draw, so we simply show the points where the star crosses some plane in the reduced phase space, say the plane \(z=0\); these points are called **consequents**. To remove the sign ambiguity in \(p_{z}\), we plot the \((R,p_{R})\) coordinates only when \(p_{z}>0\). In other words, we plot the values of \(R\) and \(p_{R}\) every time the star crosses the equator going upward. Such plots were first used by Poincare and are called **surfaces of section**.2 The key feature of the surface of section is that, even though it is only two-dimensional, no two distinct orbits at the same energy can occupy the same point. Also, any orbit is restricted to an area in the surface of section defined by the constraint \(H_{\rm eff}\geq\frac{1}{2}\dot{R}^{2}+\Phi_{\rm eff}\); the curve bounding this area is often called the zero-velocity curve of the surface of section, since it can only be reached by an orbit with \(p_{z}=0\).

Footnote 2: A surface of section is defined by some arbitrarily chosen condition, here \(z=0,p_{z}>0\). Good judgment must be used in the choice of this condition lest some important orbits never satisfy it, and hence do not appear on the surface of section.

Figure 3.5 shows the \((R,p_{R})\) surface of section at the energy of the orbits of Figure 3.4: the full curve is the zero-velocity curve, while the dots show the consequents generated by the orbit in the left panel of Figure 3.4. The cross near the center of the surface of section, at \((R=0.26,p_{R}=0)\), is the single consequent of the **shell orbit**, in which the trajectory of the star is restricted to a two-dimensional surface. The shell orbit is the limit of orbits such as those shown in Figure 3.4 in which the distance between the inner and outer boundaries of the orbit shrinks to zero.

In Figure 3.5 the consequents of the orbit of the left panel of Figure 3.4 appear to lie on a smooth curve, called the **invariant curve** of the orbit. The existence of the invariant curve implies that some isolating integral \(I\) is respected by this orbit. The curve arises because the equation \(I=\)_constant_ restricts motion in the two-dimensional surface of section to a one-dimensional curve (or perhaps to a finite number of discrete points in exceptional cases). It is often found that for realistic galactic potentials, orbits do admit an integral of this type. Since \(I\) is in addition to the two classical integrals \(H\) and \(p_{\phi}\), it is called the **third integral**. In general there is no analytic expression for \(I\) as a function of the phase-space variables, so it is called a **non-classical integral**.

We may form an intuitive picture of the nature of the third integral by considering two special cases. If the potential \(\Phi\) is spherical, we know that the total angular momentum \(|{\bf L}|\) is an integral. This suggests that for a nearly spherical potential--this one has axis ratio \(q=0.9\)--the third integral may be approximated by \(|{\bf L}|\). The dashed curve in Figure 3.5 shows the curve

Figure 3.5: Points generated by the orbit of the left panel of Figure 3.4 in the \((R,p_{R})\) surface of section. If the total angular momentum \(L\) of the orbit were conserved, the points would fall on the dashed curve. The full curve is the zero-velocity curve at the energy of this orbit. The \(\times\) marks the consequent of the shell orbit.

Figure 3.6: The total angular momentum is almost constant along the orbit shown in the left panel of Figure 3.5. For clarity \(L(t)\) is plotted only at the beginning and end of a long integration.

on which the points generated by the orbit of the left panel of Figure 3.4 would lie if the third integral were \(|{\bf L}|\), and Figure 3.6 shows the actual time evolution of \(|{\bf L}|\) along that orbit--notice that although \(|{\bf L}|\) oscillates rapidly, its mean value does not change even over hundreds of orbital times. From these two figures we see that \(|{\bf L}|\) is an approximately conserved quantity, even for orbits in potentials that are significantly flattened. We may think of these orbits as approximately planar and with more or less fixed peri- and apocenter radii. The approximate orbital planes have a fixed inclination to the \(z\) axis but precess about this axis, at a rate that gradually tends to zero as the potential becomes more and more nearly spherical.

The second special case is when the potential is separable in \(R\) and \(z\):

\[\Phi(R,z)=\Phi_{R}(R)+\Phi_{z}(z). \tag{3.73}\]

Then the third integral can be taken to be the energy of vertical motion

\[H_{z}={{1\over 2}}p_{z}^{2}+\Phi_{z}(z). \tag{3.74}\]

Along nearly circular orbits in a thin disk, the potential is approximately separable, so equation (3.74) provides a useful expression for the third integral. In SS3.6.2b we discuss a more sophisticated approximation to the third integral for orbits in thin disks.

##### 3.2.3 Nearly circular orbits: epicycles and the velocity ellipsoid

In disk galaxies many stars are on nearly circular orbits, so it is useful to derive approximate solutions to equations (3.68a) that are valid for such orbits. We define

\[x\equiv R-R_{\rm g}, \tag{3.75}\]

where \(R_{\rm g}(L_{z})\) is the guiding-center radius for an orbit of angular momentum \(L_{z}\) (eq. 3.72). Thus \((x,z)=(0,0)\) are the coordinates in the meridional plane of the minimum in \(\Phi_{\rm eff}\). When we expand \(\Phi_{\rm eff}\) in a Taylor series about this point, we obtain

\[\Phi_{\rm eff}=\Phi_{\rm eff}(R_{\rm g},0)+{{1\over 2}}\left({ \partial^{2}\Phi_{\rm eff}\over\partial R^{2}}\right)_{\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!for then equations (3.68a) become

\[\ddot{x}=-\kappa^{2}x, \tag{3.78a}\] \[\ddot{z}=-\nu^{2}z. \tag{3.78b}\]

According to these equations, \(x\) and \(z\) evolve like the displacements of two harmonic oscillators, with frequencies \(\kappa\) and \(\nu\), respectively. The two frequencies \(\kappa\) and \(\nu\) are called the **epicycle** or **radial frequency** and the **vertical frequency**. If we substitute from equation (3.68b) for \(\Phi_{\rm eff}\) we obtain3

Footnote 3: The formula for the ratio \(\kappa^{2}/\Omega^{2}\) from equations (3.79) was already known to Newton; see Proposition 45 of his _Principia_.

\[\kappa^{2}(R_{\rm g})=\left(\frac{\partial^{2}\Phi}{\partial R^{2}}\right)_{ \!\!(R_{\rm g},0)}+\frac{3L_{z}^{2}}{R_{\rm g}^{4}}=\left(\frac{\partial^{2} \Phi}{\partial R^{2}}\right)_{\!\!(R_{\rm g},0)}+\frac{3}{R_{\rm g}}\left( \frac{\partial\Phi}{\partial R}\right)_{\!\!(R_{\rm g},0)}, \tag{3.79a}\] \[\nu^{2}(R_{\rm g})=\left(\frac{\partial^{2}\Phi}{\partial z^{2}}\right)_{\!\! (R_{\rm g},0)}. \tag{3.79b}\]

Since the circular frequency is given by

\[\Omega^{2}(R)=\frac{1}{R}\left(\frac{\partial\Phi}{\partial R}\right)_{\!\!(R,0)}=\frac{L_{z}^{2}}{R^{4}}, \tag{3.79c}\]

equation (3.79a) may be written

\[\kappa^{2}(R_{\rm g})=\left(R\frac{{\rm d}\Omega^{2}}{{\rm d}R}+4\Omega^{2} \right)_{\!\!R_{\rm g}}. \tag{3.80}\]

Note that the radial and azimuthal periods (eqs. 3.17 and 3.19) are simply

\[T_{r}=\frac{2\pi}{\kappa}\quad;\quad T_{\psi}=\frac{2\pi}{\Omega}. \tag{3.81}\]

Very near the center of a galaxy, where the circular speed rises approximately linearly with radius, \(\Omega\) is nearly constant and \(\kappa\simeq 2\Omega\). Elsewhere \(\Omega\) declines with radius, though rarely faster than the Kepler falloff, \(\Omega\propto R^{-3/2}\), which yields \(\kappa=\Omega\). Thus, in general,

\[\Omega\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$} }\kappa\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$} }2\Omega. \tag{3.82}\]

Using equations (3.19) and (3.81), it is easy to show that this range is consistent with the range of \(\Delta\psi\) given by equation (3.41) for the isochrone potential.

It is useful to define two functions

\[\eqalign{A(R)&\equiv{{1\over 2}}\left({v_{\rm c}\over R}-{{\rm d}v_{\rm c }\over{\rm d}R}\right)=-{{1\over 2}}R{{\rm d}\Omega\over{\rm d }R},\cr B(R)&\equiv-{{1\over 2}}\left({v_{\rm c}\over R}+{{\rm d}v_{\rm c }\over{\rm d}R}\right)=-\left(\Omega+{{1\over 2}}R{{\rm d}\Omega \over{\rm d}R}\right),\cr}\]

where \(v_{\rm c}(R)=R\Omega(R)\) is the circular speed at radius \(R\). These functions are related to the circular and epicycle frequencies by

\[\Omega=A-B\quad;\quad\kappa^{2}=-4B(A-B)=-4B\Omega.\]

The values taken by \(A\) and \(B\) at the solar radius can be measured directly from the kinematics of stars in the solar neighborhood (BM SS10.3.3) and are called the **Oort constants**.4 Taking values for these constants from Table 1.2, we find that the epicycle frequency at the Sun is \(\kappa_{0}=(37\pm 3)\,{\rm km\,s^{-1}\,kpc^{-1}}\), and that the ratio \(\kappa_{0}/\Omega_{0}\) at the Sun is

Footnote 4: Jan Hendrik Oort (1900–1992) was Director of Leiden Observatory in the Netherlands from 1945 to 1970. In 1927 Oort confirmed Bertil Lindblad’s hypothesis of galactic rotation with an analysis of the motions of nearby stars that established the mathematical framework for studying Galactic rotation. With his student H. van de Hulst, he predicted the 21-cm line of neutral hydrogen. Oort also established the Netherlands as a world leader in radio astronomy, and showed that many comets originate in a cloud surrounding the Sun at a distance \(\sim 0.1\,{\rm pc}\), now called the Oort cloud.

\[{\kappa_{0}\over\Omega_{0}}=2\sqrt{-B\over A-B}=1.35\pm 0.05.\]

Consequently the Sun makes about 1.3 oscillations in the radial direction in the time it takes to complete an orbit around the galactic center. Hence its orbit does not close on itself in an inertial frame, but forms a rosette figure like those discussed above for stars in spherically symmetric potentials.

The equations of motion (3.78) lead to two integrals, namely, the one-dimensional Hamiltonians

\[H_{R}\equiv{{1\over 2}}(\dot{x}^{2}+\kappa^{2}x^{2})\quad;\quad H_{z} \equiv{{1\over 2}}(\dot{z}^{2}+\nu^{2}z^{2})\]

of the two oscillators. Thus if the star's orbit is sufficiently nearly circular that our truncation of the series for \(\Phi_{\rm eff}\) (eq. 3.76) is justified, then the orbit admits three integrals of motion: \(H_{R}\), \(H_{z}\), and \(p_{\phi}\). These are all isolating integrals.

From equations (3.75), (3.77), (3.78), and (3.86) we see that the Hamiltonian of such a star is made up of three parts:

\[H=H_{R}(R,p_{R})+H_{z}(z,p_{z})+\Phi_{\rm eff}(R_{\rm g},0).\]Thus the three integrals of motion can equally be chosen as \((H_{R},H_{z},p_{\phi})\) or \((H,H_{z},p_{\phi})\), and in the latter case \(H_{z}\), which is a classical integral, is playing the role of the third integral.

We now investigate what the ratios of the frequencies \(\kappa\), \(\Omega\) and \(\nu\) tell us about the properties of the Galaxy. At most points in a typical galactic disk (including the solar neighborhood) \(v_{\rm c}\simeq\)_constant_, and from (3.80) it is easy to show that in this case \(\kappa^{2}=2\Omega^{2}\). In cylindrical coordinates Poisson's equation for an axisymmetric galaxy reads

\[\eqalign{4\pi G\rho&={1\over R}{\partial\over\partial R}\Bigl{(}R{\partial \Phi\over\partial R}\Bigr{)}+{\partial^{2}\Phi\over\partial z^{2}}\cr&\simeq{1 \over R}{{\rm d}v_{\rm c}^{2}\over{\rm d}R}+\nu^{2},}\]

where in the second line we have approximated the right side by its value in the equatorial plane and used equation (3.79b). If the mass distribution were spherical, we would have \(\Omega^{2}\simeq GM/R^{3}={4\over 3}\pi G\overline{\rho}\), where \(M\) is the mass and \(\overline{\rho}\) is the mean density within the sphere of radius \(R\) about the galactic center. From the plot of the circular speed of an exponential disk shown in Figure 2.17, we know that this relation is not far from correct even for a flat disk. Hence, at a typical point in a galaxy such as the Milky Way

\[{\nu^{2}\over\kappa^{2}}\simeq{3\over 2}\rho/\overline{\rho}.\]

That is, the ratio \(\nu^{2}/\kappa^{2}\) is a measure of the degree to which the galactic material is concentrated towards the plane, and will be significantly greater than unity for a disk galaxy. From Table 1 we see that at the Sun \(\rho\simeq 0.1\,{\cal M}_{\odot}\,{\rm pc}^{-3}\), so the Sun's vertical period of small oscillations is \(2\pi/\nu\simeq 87\,{\rm Myr}\). For \(v_{\rm c}=220\,{\rm km\,s^{-1}}\) and \(R_{0}=8\,{\rm kpc}\) (Table 1.2) we find \(\overline{\rho}=0.039\,{\cal M}_{\odot}\,{\rm pc}^{-3}\). Equation (3.89) then yields \(\nu/\kappa\simeq 2.0\) for the Sun.

From equation (3.88) it is clear that we expect \(\Phi_{\rm eff}\propto z^{2}\) only for values of \(z\) small enough that \(\rho_{\rm disk}(z)\simeq\)_constant_, i.e., for \(z\ll 300\,{\rm pc}\) at \(R_{0}\). For stars that do not rise above this height, equation (3.78b) yields

\[z=Z\cos(\nu t+\zeta),\]

where \(Z\) and \(\zeta\) are arbitrary constants. However, the orbits of the majority of disk stars carry these stars further above the plane than \(300\,{\rm pc}\) (Problem 4.23). Therefore the epicycle approximation does not provide a reliable guide to the motion of the majority of disk stars in the direction perpendicular to the disk. The great value of this approximation lies rather in its ability to describe the motions of stars _in_ the disk plane. So far we have described only the radial component of this motion, so we now turn to the azimuthal motion.

Equation (3.78a), which governs the radial motion, has the general solution

\[x(t)=X\cos(\kappa t+\alpha), \tag{3.91}\]

where \(X\geq 0\) and \(\alpha\) are arbitrary constants. Now let \(\Omega_{\rm g}=L_{z}/R_{\rm g}^{2}\) be the angular speed of the circular orbit with angular momentum \(L_{z}\). Since \(p_{\phi}=L_{z}\) is constant, we have

\[\eqalign{\dot{\phi}&={p_{\phi}\over R^{2}}={L_{z}\over R_{\rm g}^{2}}\left(1+{x \over R_{\rm g}}\right)^{-2}\cr&\simeq\Omega_{\rm g}\left(1-{2x\over R_{\rm g}} \right).\cr} \tag{3.92}\]

Substituting for \(x\) from (3.91) and integrating, we obtain

\[\phi=\Omega_{\rm g}t+\phi_{0}-\gamma{X\over R_{\rm g}}\sin(\kappa t+\alpha),\] (3.93a) where \[\gamma\equiv{2\Omega_{\rm g}\over\kappa}=-{\kappa\over 2B}, \tag{3.93b}\]

where the second equality is derived using (3.84). The nature of the motion described by these equations can be clarified by erecting Cartesian axes \((x,y,z)\) with origin at the **guiding center**, \((R,\phi)=(R_{\rm g},\Omega_{\rm g}t+\phi_{0})\). The \(x\) and \(z\) coordinates have already been defined, and the \(y\) coordinate is perpendicular to both and points in the direction of rotation.5 To first order in the small parameter \(X/R_{\rm g}\) we have

Footnote 5: In applications to the Milky Way, which rotates clockwise when viewed from the north Galactic pole, either \(\hat{\bf e}_{z}\) is directed towards the south Galactic pole, or \((x,y,z)\) is a left-handed coordinate system; we make the second choice in this book.

\[\eqalign{y&=-\gamma X\sin(\kappa t+\alpha)\cr&\equiv-Y\sin(\kappa t+\alpha).\cr} \tag{3.94}\]

Equations (3.91) and (3.94) are the complete solution for an equatorial orbit in the epicycle approximation. The motion in the \(z\)-direction is independent of the motion in \(x\) and \(y\). In the \((x,y)\) plane the star moves on an ellipse called the **epicycle** around the guiding center (see Figure 3.7). The lengths of the semi-axes of the epicycle are in the ratio

\[{X\over Y}=\gamma^{-1}. \tag{3.95}\]

For a harmonic oscillator potential \(X/Y=1\) and for a Kepler potential \(X/Y={1\over 2}\); the inequality (3.82) shows that in most galactic potentials\(Y>X\), so the epicycle is elongated in the tangential direction.6 From equation (3.85), \(X/Y\simeq 0.7\) in the solar neighborhood. The motion around the epicycle is in the opposite sense to the rotation of the guiding center around the galactic center, and the period of the epicycle motion is \(2\pi/\kappa\), while the period of the guiding-center motion is \(2\pi/\Omega_{\rm g}\).

Footnote 6: Epicycles were invented by the Greek astronomer Hipparchus (190–120 BC) to describe the motion of the planets about the Sun. Hipparchus also measured the distance to the Moon and discovered the precession of the Earth’s spin axis. Epicycles—the first known perturbation expansion—were not very successful, largely because Hipparchus used circular epicycles with \(X/Y=1\). If only he had used epicycles with the proper axis ratio \(X/Y=\frac{1}{2}\)!

Consider the motion of a star on an epicyclic orbit, as viewed by an astronomer who sits at the guiding center of the star's orbit. At different times in the orbit the astronomer's distance measurements range from a maximum value \(Y\) down to \(X\). Since by equation (3.95), \(X/Y=\kappa/(2\Omega_{\rm g})\), these measurements yield important information about the galactic potential. Of course, the epicycle period is much longer than an astronomer's lifetime, so we cannot in practice measure the distance to a given star as it moves around its epicycle. Moreover, in general we do not know the location of the guiding center of any given star. But we can measure \(v_{R}\) and \(v_{\phi}(R_{0})-v_{\rm c}(R_{0})\) for a group of stars, each of which has its own guiding-center radius \(R_{\rm g}\), as they pass near the Sun at radius \(R_{0}\). We now show that from these measurements we can determine the ratio \(2\Omega/\kappa\). We have

\[\eqalign{v_{\phi}(R_{0})-v_{\rm c}(R_{0})&=R_{0}(\dot{\phi}-\Omega_{0})=R_{0} (\dot{\phi}-\Omega_{\rm g}+\Omega_{\rm g}-\Omega_{0})\cr&\simeq R_{0}\biggl{[} (\dot{\phi}-\Omega_{\rm g})-\biggl{(}\frac{{\rm d}\Omega}{{\rm d}R}\biggr{)} _{\!\!\!R_{\rm g}}x\biggr{]}.}\]

With equation (3.92) this becomes

\[v_{\phi}(R_{0})-v_{\rm c}(R_{0})\simeq-R_{0}x\left(\frac{2\Omega}{R}+\frac{{ \rm d}\Omega}{{\rm d}R}\right)_{\!\!\!R_{\rm g}}.\]If we evaluate the coefficient of the small quantity \(x\) at \(R_{0}\) rather than \(R_{\rm g}\), we introduce an additional error in \(v_{\phi}(R_{0})\) which is of order \(x^{2}\) and therefore negligible. Making this approximation we find

\[v_{\phi}(R_{0})-v_{\rm c}(R_{0})\simeq-x\left(2\Omega+R{{\rm d}\Omega\over{\rm d }R}\right)_{\!\!R_{0}}.\]

Finally using equations (3.83) to introduce Oort's constants, we obtain

\[v_{\phi}(R_{0})-v_{\rm c}(R_{0})\simeq 2Bx={\kappa\over\gamma}x={\kappa\over \gamma}X\cos(\kappa t+\alpha).\]

Averaging over the phases \(\alpha\) of stars near the Sun, we find

\[{\overline{[v_{\phi}-v_{\rm c}(R_{0})]^{2}}}={\kappa^{2}X^{2}\over 2\gamma^{2} }=2B^{2}X^{2}.\]

Similarly, we may neglect the dependence of \(\kappa\) on \(R_{\rm g}\) to obtain with equation (3.84)

\[{\overline{v_{R}^{2}}}={{1\over 2}}\kappa^{2}X^{2}=-2B(A-B)X^{2}.\]

Taking the ratio of the last two equations we have

\[{\overline{[v_{\phi}-v_{\rm c}(R_{0})]^{2}}\over{\overline{v_{R}^{2}}}}\simeq {-B\over A-B}=-{B\over\Omega_{0}}={\kappa_{0}^{2}\over 4\Omega_{0}^{2}}= \gamma^{-2}\simeq 0.46.\]

In SS4.4.3 we shall re-derive this equation from a rather different point of view and compare its predictions with observational data.

Note that the ratio in equation (3.100) is the _inverse_ of the ratio of the mean-square azimuthal and radial velocities relative to the guiding center: by (3.95)

\[{\overline{\dot{y}^{2}}\over\dot{x}^{2}}={{1\over 2}(\kappa Y)^{2}\over{1 \over 2}(\kappa X)^{2}}=\gamma^{2}.\]

This counter-intuitive result arises because one measure of the rms tangential velocity (eq. 3.101) is taken with respect to the guiding center of a single star, while the other (eq. 3.100) is taken with respect to the circular speed at the star's instantaneous radius.

This analysis also leads to an alternative expression for the integral of motion \(H_{R}\) defined in equation (3.86). Eliminating \(x\) using equation (3.97), we have

\[H_{R}={{1\over 2}}\dot{x}^{2}+{{1\over 2}}\gamma^{2}[v_{\phi}(R_{0})-v_{ \rm c}(R_{0})]^{2}.\]

### 3.3 Orbits in planar non-axisymmetric potentials

Many, possibly most, galaxies have non-axisymmetric structures. These are evident near the centers of many disk galaxies, where one finds a luminous stellar bar--the Milky Way possesses just such a bar (BM SS10.3). Non-axisymmetry is harder to detect in an elliptical galaxy, but we believe that many elliptical galaxies, especially the more luminous ones, are triaxial rather than axisymmetric (BM SS4.2). Evidently we need to understand how stars orbit in a non-axisymmetric potential if we are to model galaxies successfully.

We start with the simplest possible problem, namely, planar motion in a non-rotating potential.7 Towards the end of this section we generalize the discussion to two-dimensional motion in potentials whose figures rotate steadily, and in the next section we show how an understanding of two-dimensional motion can be exploited in problems involving three-dimensional potentials.

Footnote 7: This problem is equivalent to that of motion in the meridional plane of an axisymmetric potential when \(L_{z}=0\).

#### 3.3.1 Two-dimensional non-rotating potential

Consider the logarithmic potential (cf. SS2.3.2)

\[\Phi_{\rm L}(x,y)={{1\over 2}}v_{0}^{2}\ln\left(R_{\rm c}^{2}+x^{2}+{y^{2} \over q^{2}}\right)\quad(0<q\leq 1). \tag{3.103}\]

This potential has the following useful properties:

1. The equipotentials have constant axial ratio \(q\), so the influence of the non-axisymmetry is similar at all radii. Since \(q\leq 1\), the \(y\) axis is the minor axis.
2. For \(R=\sqrt{x^{2}+y^{2}}\ll R_{\rm c}\), we may expand \(\Phi_{\rm L}\) in powers of \(R/R_{\rm c}\) and find \[\Phi_{\rm L}(x,y)\simeq{v_{0}^{2}\over 2R_{\rm c}^{2}}\left(x^{2}+{y^{2} \over q^{2}}\right)+{\rm constant}\quad(R\ll R_{\rm c}),\] (3.104) which is just the potential of the two-dimensional harmonic oscillator. In SS2.5 we saw that gravitational potentials of this form are generated by homogeneous ellipsoids. Thus for \(R\mathrel{\raise 1.29pt\hbox{$<$\kern-7.5pt\lower 4.3pt\hbox{$\sim$}}}R_{ \rm c}\), \(\Phi_{\rm L}\) approximates the potential of a homogeneous density distribution.
3. For \(R\gg R_{\rm c}\) and \(q=1\), \(\Phi_{\rm L}\simeq v_{0}^{2}\ln R\), which yields a circular speed \(v_{\rm c}\simeq v_{0}\) that is nearly constant. Thus the radial component of the force generated by \(\Phi_{\rm L}\) with \(q\simeq 1\) is consistent with the flat circular-speed curves of many disk galaxies.

The simplest orbits in \(\Phi_{\rm L}\) are those that are confined to \(R\ll R_{\rm c}\); when \(\Phi_{\rm L}\) is of the form (3.104), the orbit is the sum of independent harmonic motionsparallel to the \(x\) and \(y\) axes. The frequencies of these motions are \(\omega_{x}=v_{0}/R_{\rm c}\) and \(\omega_{y}=v_{0}/qR_{\rm c}\), and unless these frequencies are **commensurable** (i.e., unless \(\omega_{x}/\omega_{y}=n/m\) for some integers \(n\) and \(m\)), the star eventually passes close to every point inside a rectangular box. These orbits are therefore known as **box orbits**.8 Such orbits have no particular sense of circulation about the center and thus their time-averaged angular momentum is zero. They respect two integrals of the motion, which we may take to be the Hamiltonians of the independent oscillations parallel to the coordinate axes,

Footnote 8: The curve traced by a box orbit is sometimes called a **Lissajous figure** and is easily displayed on an oscilloscope.

\[H_{x}={{1\over 2}}v_{x}^{2}+{{1\over 2}}v_{0}^{2}{x^{2}\over R_{\rm c}^{2}} \qquad;\qquad H_{y}={{1\over 2}}v_{y}^{2}+{{1\over 2}}v_{0}^{2}{y^{2} \over q^{2}R_{\rm c}^{2}}. \tag{3.105}\]

To investigate orbits at larger radii \(R\gtrsim R_{\rm c}\), we must use numerical integrations. Two examples are shown in Figure 3.8. Neither orbit fills the elliptical zero-velocity curve \(\Phi_{\rm L}=E\), so both orbits must respect a second integral in addition to the energy. The upper orbit is still called a box orbit because it can be thought of as a distorted form of a box orbit in the two-dimensional harmonic oscillator. Within the core the orbit's envelope runs approximately parallel to the long axis of the potential, while for \(R\gg R_{\rm c}\) the envelope approximately follows curves of constant azimuth or radius.

In the lower orbit of Figure 3.8, the star circulates in a fixed sense about the center of the potential, while oscillating in radius. Orbits of this type are called **loop orbits**. Any star launched from \(R\gg R_{\rm c}\) in the tangential direction with a speed of order \(v_{0}\) will follow a loop orbit. If the star is launched at speed \(\sim v_{0}\) at a large angle to the tangential direction, the annulus occupied by the orbit will be wide, while if the launch angle is small, the annulus is narrow. This dependence is analogous to the way in which

Figure 3.8: Two orbits of a common energy in the potential \(\Phi_{\rm L}\) of equation (3.103) when \(v_{0}=1\), \(q=0.9\) and \(R_{\rm c}=0.14\): top, a box orbit; bottom, a loop orbit. The closed parent of the loop orbit is also shown. The energy, \(E=-0.337\), is that of the isopotential surface that cuts the long axis at \(x=5R_{c}\).

the thickness of the rosette formed by an orbit of given energy in a planar axisymmetric potential depends on its angular momentum. This analogy suggests that stars on loop orbits in \(\Phi_{\rm L}\) may respect an integral that is some sort of generalization of the angular momentum \(p_{\phi}\).

We may investigate these orbits further by generating a surface of section. Figure 3.9 is the surface of section \(y=0,\,\dot{y}>0\) generated by orbits in \(\Phi_{\rm L}\) of the same energy as the orbits shown in Figure 3.8. The boundary curve in this figure arises from the energy constraint

\[{{1\over 2}}\dot{x}^{2}+\Phi_{L}(x,0)\leq{{1\over 2}}(\dot{x}^{2}+ \dot{y}^{2})+\Phi_{L}(x,0)=H_{y=0}. \tag{3.106}\]

Each closed curve in this figure corresponds to a different orbit. All these orbits respect an integral \(I_{2}\) in addition to the energy because each orbit is confined to a curve.

There are two types of closed curve in Figure 3.9, corresponding to the two basic types of orbit that we have identified. The lower panel of Figure 3.8 shows the spatial form of the loop orbit that generates the curve marked 1 in Figure 3.9. At a given energy there is a whole family of such orbits that differ in the width of the elliptical annuli within which they are confined--see Figure 3.10. The unique orbit of this family that circulates in

Figure 3.9: The \((x,\dot{x})\) surface of section formed by orbits in \(\Phi_{\rm L}\) of the same energy as the orbits depicted in Figure 3.8. The isopotential surface of this energy cuts the long axis at \(x=0.7\). The curves marked 4 and 1 correspond to the box and loop orbits shown in the top and bottom panels of Figure 3.8.

an anti-clockwise sense and closes on itself after one revolution is the **closed loop orbit**, which is also shown at the bottom of Figure 3.8. In the surface of section this orbit generates the single point 3. Orbits with non-zero annular widths generate the curves that loop around the point 3. Naturally, there are loop orbits that circulate in a clockwise sense in addition to the anti-clockwise orbits; in the surface of section their representative curves loop around the point 2.

The second type of closed curve in Figure 3.9 corresponds to box orbits. The box orbit shown at the top of Figure 3.8 generates the curve marked 4. All the curves in the surface of section that are symmetric about the origin, rather than centered on one of the points 2 or 3, correspond to box orbits. These orbits differ from loop orbits in two major ways: (i) in the course of time a star on any of them passes arbitrarily close to the center of the potential (in the surface of section their curves cross \(x=0\)), and (ii) stars on these orbits have no unique sense of rotation about the center (in the surface of section their curves are symmetric about \(x=0\)). The outermost curve in Figure 3.9 (the zero-velocity curve) corresponds to the orbit on which \(y=\dot{y}=0\); on this orbit the star simply oscillates back and forth along the \(x\) axis. We call this the **closed long-axis orbit**. The curves interior to this bounding curve that also center on the origin correspond to less and less elongated box orbits. The bottom row of Figure 3.10 shows this progression from left to right. Notice the strong resemblance of the most eccentric loop

Figure 3.10: A selection of loop (top row) and box (bottom row) orbits in the potential \(\Phi_{\rm L}(q=0.9,R_{c}=0.14)\) at the energy of Figures 3.8 and 3.9.

orbit in the top right panel to the least elongated box orbit shown below it. The big difference between these orbits is that the loop orbit has a fixed sense of circulation about the center, while the box orbit does not.

It is instructive to compare the curves of Figure 3.9 with the curves generated by the integrals that we encountered earlier in this chapter. For example, if the angular momentum \(p_{\phi}\) were an integral, the curves on the surface of section \(y=0\), \(\dot{y}>0\) would be given by the relation

\[\left(p_{\phi}\right)_{y=0}=x\dot{y}=x\sqrt{2[E-\Phi_{\rm L}(x,0)]-\dot{x}^{2}}. \tag{3.107}\]

These curves are shown as dashed curves in Figure 3.11. They resemble the curves in Figure 3.9 near the closed loop orbits 2 and 3, thus supporting our suspicion that the integral respected by loop orbits is some generalization of angular momentum. However, the dashed curves do not reproduce the curves generated by box orbits. If the extra integral were the Hamiltonian \(H_{x}\) of the \(x\)-component of motion in the harmonic potential (3.105), the curves in Figure 3.9 would be the dotted ellipses near the center of Figure 3.11. They resemble the curves in Figure 3.9 that are generated by the box orbits only in that they are symmetrical about the \(x\) axis. Figure 3.11 shows that a better approximation to the invariant curves of box orbits is provided by contours

Figure 3.11: The appearance of the surface of section Figure 3.9 if orbits conserved (a) angular momentum (eq. 3.107; dashed curves), or (b) \(H_{x}\) (eq. 3.105; inner dotted curves), or (c) \(H_{x}^{\prime}\) (eq. 3.108; outer dot-dashed curves).

of constant

\[H^{\prime}_{x}\equiv{{1\over 2}}\dot{x}^{2}+\Phi(x,0). \tag{3.108}\]

\(H^{\prime}_{x}\) may be thought of as the Hamiltonian associated with motion parallel to the potential's long axis. In a sense the integrals respected by box and loop orbits are analogous to \(H^{\prime}_{x}\) and \(p_{\phi}\), respectively.

Figures 3.8 and 3.9 suggest an intimate connection between **closed orbits** and **families of non-closed orbits**. We say that the clockwise closed loop orbit is the **parent** of the family of clockwise loop orbits. Similarly, the closed long-axis orbit \(y=0\) is the parent of the box orbits.

The closed orbits that are the parents of orbit families are all **stable**, since members of their families that are initially close to them remain close at all times. In fact, we may think of any member of the family as engaged in stable oscillations about the parent closed orbit. A simple example of this state of affairs is provided by orbits in an axisymmetric potential. In a two-dimensional axisymmetric potential there are only two stable closed orbits at each energy--the clockwise and the anti-clockwise circular orbits.9 All other orbits, having non-zero eccentricity, belong to families whose parents are these two orbits. The epicycle frequency (3.80) is simply the frequency of small oscillations around the parent closed orbit.

Footnote 9: Special potentials such as the Kepler potential, in which all orbits are closed, must be excepted from this statement.

The relationship between stable closed orbits and families of non-closed orbits enables us to trace the evolution of the orbital structure of a potential as the energy of the orbits or the shape of the potential is altered, simply by tracing the evolution of the stable closed orbits. For example, consider how the orbital structure supported by \(\Phi_{\rm L}\) (eq. 3.103) evolves as we pass from the axisymmetric potential that is obtained when \(q=1\) to the barred potentials that are obtained when \(q<1\). When \(q=1\), \(p_{\phi}\) is an integral, so the surface of section is qualitatively similar to the dashed curves in Figure 3.11. The only stable closed orbits are circular, and all orbits are loop orbits. When we make \(q\) slightly smaller than unity, the long-axis orbit becomes stable and parents a family of elongated box orbits that oscillate about the axial orbit. As \(q\) is diminished more and more below unity, a larger and larger portion of phase space comes to be occupied by box rather than loop orbits. Comparison of Figures 3.9 and 3.12 shows that this evolution manifests itself in the surface of section by the growth of the band of box orbits that runs around the outside of Figure 3.12 at the expense of the two bull's-eyes in that figure that are associated with the loop orbits. In real space the closed loop orbits become more and more elongated, with the result that less and less epicyclic motion needs to be added to one of these closed orbits to fill in the hole at its center and thus terminate the sequence of loop orbits. The erosion of the bull's-eyes in the surface of section is associated with this process.

The appearance of the surface of section also depends on the energy of its orbits. Figure 3.13 shows a surface of section for motion in \(0.9\), \(R_{\rm c}=0.14\)) at a lower energy than that of Figure 3.9. The changes in the surface of section are closely related to changes in the size and shape of the box and loop orbits. Box orbits that reach radii much greater than the core radius \(R_{\rm c}\) have rather narrow waists (see Figure 3.10), and closed loop orbits of the same energy are nearly circular. If we consider box orbits and closed loop orbits of progressively smaller dimensions, the waists of the box orbits become steadily less narrow, and the closed orbits become progressively more eccentric as the dimensions of the orbits approach \(R_{\rm c}\). Eventually, at an energy \(E_{\rm c}\), the closed loop orbit degenerates into a line parallel to the short axis of the potential. Loop orbits do not exist at energies less than \(E_{\rm c}\). At \(E<E_{\rm c}\), all orbits are box orbits. The absence of loop orbits at \(E<E_{\rm c}\) is not unexpected since we saw above (eq. 3.105) that when \(x^{2}+y^{2}\ll R_{\rm c}^{2}\), the potential is essentially that of the two-dimensional harmonic oscillator, none of whose orbits are loops. At these energies the only closed orbits are the short- and the long-axis closed orbits, and we expect both of these orbits to be stable. In fact, the short-axis orbit becomes unstable at the energy \(E_{\rm c}\) at which the loop orbits first appear. One says that the stable short-axis orbit of the low-energy regime **bifurcates** into the stable clockwise and anti-clockwise loop orbits at \(E_{\rm c}\). Stable closed orbits often appear in pairs like this.

Figure 3.12: When the potential \(\Phi_{\rm L}\) is made more strongly barred by diminishing \(q\), the proportion of orbits that are boxes grows at the expense of the loops: the figure shows the same surface of section as Figure 3.9 but for \(q=0.8\) rather than \(q=0.9\).

Many two-dimensional barred potentials have orbital structures that resemble that of \(\Phi_{\rm L}\). In particular:

1. Most orbits in these potentials respect a second integral in addition to energy.
2. The majority of orbits in these potentials can be classified as either loop orbits or box orbits. The loop orbits have a fixed sense of rotation and never carry the star near the center, while the box orbits have no fixed sense of rotation and allow the star to pass arbitrarily close to the center.
3. When the axial ratio of the isopotential curves is close to unity, most of the phase space is filled with loop orbits, but as the axial ratio changes away from unity, box orbits fill a bigger fraction of phase space.

Although these properties are fairly general, in SS3.7.3 we shall see that certain barred potentials have considerably more complex orbital structures.

#### Two-dimensional rotating potential

The figures of many non-axisymmetric galaxies rotate with respect to inertial space, so we now study orbits in rotating potentials. Let the frame of reference in which the potential \(\Phi\) is static rotate steadily at angular velocity \({\bf\Omega}_{\rm b}\), often called the **pattern speed**. In this frame the velocity is

Figure 3.13: At low energies in a barred potential a large fraction of all orbits are boxes: the figure shows the same surface of section as Figure 3.9 but for the energy whose isopotential surface cuts the \(x\) axis at \(x=0.35\) rather than at \(x=0.7\) as in Figure 3.9.

and the corresponding velocity in an inertial frame is \(\dot{\bf x}+{\bf\Omega}_{\rm b}\times{\bf x}\). Thus the Lagrangian is

\[{\cal L}={{\frac{1}{2}}}\big{|}\dot{\bf x}+{\bf\Omega}_{\rm b}\times{\bf x }\big{|}^{2}-\Phi({\bf x}). \tag{3.109}\]

Consequently, the momentum is

\[{\bf p}=\frac{\partial{\cal L}}{\partial\dot{\bf x}}=\dot{\bf x}+{\bf\Omega}_{ \rm b}\times{\bf x}, \tag{3.110}\]

which is just the momentum in the underlying inertial frame. The Hamiltonian is

\[\eqalign{H_{\rm J}&={\bf p}\cdot\dot{\bf x}-{\cal L}\cr&={\bf p}\cdot({\bf p}-{ \bf\Omega}_{\rm b}\times{\bf x})-{{\frac{1}{2}}}p^{2}+\Phi\cr&={ {\frac{1}{2}}}p^{2}+\Phi-{\bf\Omega}_{\rm b}\cdot({\bf x}\times{\bf p}),\cr}\]

where we have used the vector identity (B.8). Since \({\bf p}\) coincides with the momentum in an inertial frame, \({\bf x}\times{\bf p}={\bf L}\) is the angular momentum and \({{\frac{1}{2}}}p^{2}+\Phi\) is the Hamiltonian \(H\) that governs the motion in the inertial frame. Hence, (3.111) can be written

\[H_{\rm J}=H-{\bf\Omega}_{\rm b}\cdot{\bf L}. \tag{3.112}\]

Since \(\Phi({\bf x})\) is constant in the rotating frame, \(H_{\rm J}\) has no explicit time dependence, and its derivative along any orbit \({\rm d}H_{\rm J}/{\rm d}t=\partial H_{\rm J}/\partial t\) vanishes (eq. D.56). Thus \(H_{\rm J}\) is an integral, called the **Jacobi integral**: in a rotating non-axisymmetric potential, neither \(H\) nor \({\bf L}\) is conserved, but the combination \(H-{\bf\Omega}_{\rm b}\cdot{\bf L}\)_is_ conserved. From (3.111) it is easy to show that the constant value of \(H_{\rm J}\) may be written as

\[\eqalign{E_{\rm J}&={{\frac{1}{2}}}|\dot{\bf x}|^{2}+\Phi-{ {\frac{1}{2}}}|{\bf\Omega}_{\rm b}\times{\bf x}|^{2}\cr&={{\frac{1}{2}}}| \dot{\bf x}|^{2}+\Phi_{\rm eff},\cr}\]

where the effective potential

\[\eqalign{\Phi_{\rm eff}({\bf x})&\equiv\Phi({\bf x})-{{\frac{1}{2}}}|{\bf \Omega}_{\rm b}\times{\bf x}|^{2}\cr&=\Phi({\bf x})-{{\frac{1}{2}}}\big{[}|{\bf \Omega}_{\rm b}|^{2}|{\bf x}|^{2}-({\bf\Omega}_{\rm b}\cdot{\bf x})^{2}\big{]}.\cr}\]

In deriving the second line we have used the identity (B.10). The effective potential is the sum of the gravitational potential and a repulsive **centrifugal potential**. For \({\bf\Omega}_{\rm b}=\Omega_{\rm b}\hat{\bf e}_{z}\), this additional term is simply \(-{{\frac{1}{2}}}\Omega^{2}R^{2}\) in cylindrical coordinates.

With equation (3.111) Hamilton's equations become

\[\eqalign{\dot{\bf p}&=-\frac{\partial H_{\rm J}}{\partial{\bf x}}=-{\bf\nabla} \Phi-{\bf\Omega}_{\rm b}\times{\bf p}\cr\dot{\bf x}&=\frac{\partial H_{\rm J}} {\partial{\bf p}}={\bf p}-{\bf\Omega}_{\rm b}\times{\bf x},\cr}\]where we have used the identity (B.40). Eliminating \({\bf p}\) between these equations we find

\[\begin{split}\ddot{\bf x}&=-\boldsymbol{\nabla}\Phi-2 \boldsymbol{\Omega}_{\rm b}\times\dot{\bf x}-\boldsymbol{\Omega}_{\rm b}\times( \boldsymbol{\Omega}_{\rm b}\times{\bf x})\\ &=-\boldsymbol{\nabla}\Phi-2\boldsymbol{\Omega}_{\rm b}\times \dot{\bf x}+|\boldsymbol{\Omega}_{\rm b}|^{2}{\bf x}-\boldsymbol{\Omega}_{\rm b }(\boldsymbol{\Omega}_{\rm b}\cdot{\bf x}).\end{split} \tag{3.116}\]

Here \(-2\boldsymbol{\Omega}_{\rm b}\times\dot{\bf x}\) is known as the **Coriolis force** and \(-\boldsymbol{\Omega}_{\rm b}\times(\boldsymbol{\Omega}_{\rm b}\times{\bf x})\) is the **centrifugal force**. Taking the gradient of the last line of equation (3.114), we see that (3.116) can be written in the simpler form

\[\ddot{\bf x}=-\boldsymbol{\nabla}\Phi_{\rm eff}-2\boldsymbol{\Omega}_{\rm b} \times\dot{\bf x}. \tag{3.117}\]

The surface \(\Phi_{\rm eff}=E_{\rm J}\) is often called the **zero-velocity surface**. All regions in which \(\Phi_{\rm eff}>E_{\rm J}\) are forbidden to the star. Thus, although the solution of the differential equations for the orbit in a rotating potential may be difficult, we can at least define forbidden regions into which the star cannot penetrate.

Figure 3.14 shows contours of \(\Phi_{\rm eff}\) for the potential \(\Phi_{\rm L}\) of equation (3.103). \(\Phi_{\rm eff}\) is characterized by five stationary points, marked \(L_{1}\) to \(L_{5}\)

Figure 3.14: Contours of constant effective potential \(\Phi_{\rm eff}\) when the potential is given by equation (3.103) with \(v_{0}=1\), \(q=0.8\), \(R_{\rm c}=0.1\), and \(\Omega_{\rm b}=1\). The point marked \(L_{3}\) is a minimum of \(\Phi_{\rm eff}\), while those marked \(L_{4}\) and \(L_{5}\) are maxima. \(\Phi_{\rm eff}\) has saddle points at \(L_{1}\) and \(L_{2}\).

at which \(\mathbf{\nabla}\Phi_{\rm eff}=0\). These points are sometimes called **Lagrange points** after similar points in the restricted three-body problem (Figure 8.6). The central stationary point \(L_{3}\) in Figure 3.14 is a minimum of the potential and is surrounded by a region in which the centrifugal potential \(-\frac{1}{2}\Omega_{\rm b}^{2}R^{2}\) makes only a small contribution to \(\Phi_{\rm eff}\). At each of the four points \(L_{1}\), \(L_{2}\), \(L_{4}\), and \(L_{5}\), it is possible for a star to travel on a circular orbit while appearing to be stationary in the rotating frame, because the gravitational and centrifugal forces precisely balance. Such orbits are said to **corotate** with the potential. The stationary points \(L_{1}\) and \(L_{2}\) on the \(x\) axis (the long axis of the potential) are saddle points, while the stationary points \(L_{4}\) and \(L_{5}\) along the \(y\) axis are maxima of the effective potential. Stars with values of \(E_{\rm J}\) smaller than the value \(\Phi_{\rm c}\) taken by \(\Phi_{\rm eff}\) at \(L_{1}\) and \(L_{2}\) cannot move from the center of the potential to infinity, or indeed anywhere outside the inner equipotential contour that runs through \(L_{1}\) and \(L_{2}\). By contrast, a star for which \(E_{\rm J}\) exceeds \(\Phi_{\rm c}\), or any star that is initially outside the contour through \(L_{1}\) and \(L_{2}\), can _in principle_ escape to infinity. However, it cannot be assumed that a star of the latter class will _necessarily_ escape, because the Coriolis force prevents stars from accelerating steadily in the direction of \(-\mathbf{\nabla}\Phi_{\rm eff}\).

We now consider motion near each of the Lagrange points \(L_{1}\) to \(L_{5}\). These are stationary points of \(\Phi_{\rm eff}\), so when we expand \(\Phi_{\rm eff}\) around one of these points \({\bf x}_{\rm L}=(x_{\rm L},y_{\rm L})\) in powers of \((x-x_{\rm L})\) and \((y-y_{\rm L})\), we have

\[\Phi_{\rm eff}(x,y)=\Phi_{\rm eff}(x_{\rm L},y_{\rm L})+{{ 1\over 2}}\biggl{(}\frac{\partial^{2}\Phi_{\rm eff}}{\partial x^{2}}\biggr{)}_ {{\bf x}_{\rm L}}(x-x_{\rm L})^{2} \tag{3.118}\] \[\quad+\biggl{(}\frac{\partial^{2}\Phi_{\rm eff}}{\partial x \partial y}\biggr{)}_{{\bf x}_{\rm L}}(x-x_{\rm L})(y-y_{\rm L})+{{ 1\over 2}}\biggl{(}\frac{\partial^{2}\Phi_{\rm eff}}{\partial y^{2}}\biggr{)} _{{\bf x}_{\rm L}}(y-y_{\rm L})^{2}+\cdots\.\]

Furthermore, for any bar-like potential whose principal axes lie along the coordinate axes, \(\partial^{2}\Phi_{\rm eff}/\partial x\partial y=0\) at \({\bf x}_{\rm L}\) by symmetry. Hence, if we retain only quadratic terms in equation (3.118) and define

\[\xi\equiv x-x_{\rm L}\quad;\quad\eta\equiv y-y_{\rm L}, \tag{3.119}\]

and

\[\Phi_{xx}\equiv\biggl{(}\frac{\partial^{2}\Phi_{\rm eff}}{\partial x^{2}} \biggr{)}_{{\bf x}_{\rm L}}\quad;\quad\Phi_{yy}\equiv\biggl{(}\frac{\partial^ {2}\Phi_{\rm eff}}{\partial y^{2}}\biggr{)}_{{\bf x}_{\rm L}}, \tag{3.120}\]

the equations of motion (3.117) become for a star near \({\bf x}_{\rm L}\),

\[\ddot{\xi}=2\Omega_{\rm b}\dot{\eta}-\Phi_{xx}\xi\quad;\quad\ddot{\eta}=-2 \Omega_{\rm b}\dot{\xi}-\Phi_{yy}\eta. \tag{3.121}\]

This is a pair of linear differential equations with constant coefficients. The general solution can be found by substituting \(\xi=X\exp(\lambda t)\), \(\eta=Y\exp(\lambda t)\)where \(X\), \(Y\), and \(\lambda\) are complex constants. With these substitutions, equations (3.121) become

\[(\lambda^{2}+\Phi_{xx})X-2\lambda\Omega_{\rm b}Y=0\ \ ;\ \ 2\lambda\Omega_{\rm b}X+( \lambda^{2}+\Phi_{yy})Y=0. \tag{3.122}\]

These simultaneous equations have a non-trivial solution for \(X\) and \(Y\) only if the determinant

\[\left|\begin{array}{cc}\lambda^{2}+\Phi_{xx}&-2\lambda\Omega_{\rm b}\\ 2\lambda\Omega_{\rm b}&\lambda^{2}+\Phi_{yy}\end{array}\right|=0. \tag{3.123}\]

Thus we require

\[\lambda^{4}+\lambda^{2}\left(\Phi_{xx}+\Phi_{yy}+4\Omega_{\rm b}^{2}\right)+ \Phi_{xx}\Phi_{yy}=0. \tag{3.124}\]

This is the **characteristic equation** for \(\lambda\). It has four roots, which may be either real or complex. If \(\lambda\) is a root, \(-\lambda\) is also a root, so if there is any root that has non-zero real part \({\rm Re}(\lambda)=\gamma\), the general solution to equations (3.121) will contain terms that cause \(|\xi|\) and \(|\eta|\) to grow exponentially in time; \(|\xi|\propto\exp(|\gamma|t)\) and \(|\eta|\propto\exp(|\gamma|t)\). Under these circumstances essentially all orbits rapidly flee from the Lagrange point, and the approximation on which equations (3.121) rest breaks down. In this case the Lagrange point is said to be **unstable**.

When all the roots of equation (3.124) are pure imaginary, say \(\lambda=\pm{\rm i}\alpha\) or \(\pm{\rm i}\beta\), with \(0\leq\alpha\leq\beta\) real, the general solution to equations (3.121) is

\[\begin{array}{l}\xi=X_{1}\cos(\alpha t+\phi_{1})+X_{2}\cos(\beta t+\phi_{2}), \\ \eta=Y_{1}\sin(\alpha t+\phi_{1})+Y_{2}\sin(\beta t+\phi_{2}),\end{array} \tag{3.125}\]

and the Lagrange point is stable, since the perturbations \(\xi\) and \(\eta\) oscillate rather than growing. Substituting these equations into the differential equations (3.121), we find that \(X_{1}\) and \(Y_{1}\) and \(X_{2}\) and \(Y_{2}\) are related by

\[Y_{1}=\frac{\Phi_{xx}-\alpha^{2}}{2\Omega_{\rm b}\alpha}X_{1}=\frac{2\Omega_{ \rm b}\alpha}{\Phi_{yy}-\alpha^{2}}X_{1},\] (3.126a) and \[Y_{2}=\frac{\Phi_{xx}-\beta^{2}}{2\Omega_{\rm b}\beta}X_{2}=\frac{2\Omega_{ \rm b}\beta}{\Phi_{yy}-\beta^{2}}X_{2}. \tag{3.126b}\]

The following three conditions are necessary and sufficient for both roots \(\lambda^{2}\) of the quadratic equation (3.124) in \(\lambda^{2}\) to be real and negative, and hence for the Lagrange point to be stable:

\[\begin{array}{l}\mbox{(i)}\hskip 28.452756pt\lambda_{1}^{2}\lambda_{2}^{2}= \Phi_{xx}\Phi_{yy}>0,\\ \mbox{(ii)}\hskip 28.452756pt\lambda_{1}^{2}+\lambda_{2}^{2}=-\left(\Phi_{xx}+ \Phi_{yy}+4\Omega_{\rm b}^{2}\right)<0,\\ \mbox{(iii)}\hskip 28.452756pt\lambda^{2}\mbox{ real }\Rightarrow(\Phi_{xx}+\Phi_{yy}+4\Omega_{\rm b}^{2})^{2}>4\Phi_{xx}\Phi_{yy}. \end{array} \tag{3.127}\]At saddle points of \(\Phi_{\rm eff}\) such as \(L_{1}\) and \(L_{2}\), \(\Phi_{xx}\) and \(\Phi_{yy}\) have opposite signs, so these Lagrange points violate condition (i) and are always unstable. At a minimum of \(\Phi_{\rm eff}\), such as \(L_{3}\), \(\Phi_{xx}\) and \(\Phi_{yy}\) are both positive, so conditions (i) and (ii) are satisfied. Condition (iii) is also satisfied because it can be rewritten in the form

\[(\Phi_{xx}-\Phi_{yy})^{2}+8\Omega_{\rm b}^{2}\left(\Phi_{xx}+\Phi_{yy}\right)+ 16\Omega_{\rm b}^{4}>0, \tag{3.128}\]

which is satisfied whenever both \(\Phi_{xx}\) and \(\Phi_{yy}\) are positive. Hence \(L_{3}\) is stable.

For future use we note that when \(\Phi_{xx}\) and \(\Phi_{yy}\) are positive, we may assume \(\Phi_{xx}<\Phi_{yy}\) (since the \(x\) axis is the major axis of the potential) and we have already assumed that \(\alpha<\beta\), so we can show from (3.124) that

\[\alpha^{2}<\Phi_{xx}<\Phi_{yy}<\beta^{2}. \tag{3.129}\]

Also, when \(\Omega_{\rm b}^{2}\to 0\), \(\alpha^{2}\) tends to \(\Phi_{xx}\), and \(\beta^{2}\) tends to \(\Phi_{yy}\).

The stability of the Lagrange points at maxima of \(\Phi_{\rm eff}\), such as \(L_{4}\) and \(L_{5}\), depends on the details of the potential. For the potential \(\Phi_{\rm L}\) of equation (3.103) we have

\[\Phi_{\rm eff}={{1\over 2}}v_{0}^{2}\ln\left(R_{\rm c}^{2}+x^{2}+{y^{2} \over q^{2}}\right)-{{1\over 2}}\Omega_{\rm b}^{2}(x^{2}+y^{2}), \tag{3.130}\]

so \(L_{4}\) and \(L_{5}\) occur at \((0,\pm y_{\rm L})\), where

\[y_{\rm L}\equiv\sqrt{v_{0}^{2}\over\Omega_{\rm b}^{2}}-q^{2}R_{\rm c}^{2}, \tag{3.131}\]

and we see that \(L_{4}\), \(L_{5}\) are present only if \(\Omega_{\rm b}<v_{0}/(qR_{\rm c})\). Differentiating the effective potential again we find

\[\eqalign{\Phi_{xx}(0,y_{\rm L})&=-\Omega_{\rm b}^{2}(1-q^{2})\cr\Phi_{yy}(0,y_{ \rm L})&=-2\Omega_{\rm b}^{2}\biggl{[}1-q^{2}\left({\Omega_{\rm b}R_{\rm c} \over v_{0}}\right)^{2}\biggl{]}.} \tag{3.132}\]

Hence \(\Phi_{xx}\Phi_{yy}\) is positive if the Lagrange points exist, and stability condition (i) of (3.127) is satisfied. Deciding whether the other stability conditions hold is tedious in the general case, but straightforward in the limit of negligible core radius, \(\Omega_{\rm b}R_{\rm c}/v_{0}\ll 1\) (which applies, for example, to Figure 3.14). Then \(\Phi_{xx}+\Phi_{yy}+4\Omega_{\rm b}^{2}=\Omega_{\rm b}^{2}(1+q^{2})\), so condition (ii) is satisfied. A straightforward calculation shows that condition (iii) holds--and thus that \(L_{4}\) and \(L_{5}\) are stable--providing \(q^{2}>\sqrt{32}-5\simeq(0.810)^{2}\). For future use we note that for small \(R_{\rm c}\), and to leading order in the ellipticity \(\epsilon=1-q\), we have

\[\alpha^{2}=2\epsilon\Omega_{\rm b}^{2}=-\Phi_{xx}\quad;\quad\beta^{2}=2(1-2 \epsilon)\Omega_{\rm b}^{2}=2\Omega_{\rm b}^{2}+{\rm O}(\epsilon). \tag{3.133}\]Equations (3.125) describing the motion about a stable Lagrange point show that each orbit is a superposition of motion at frequencies \(\alpha\) and \(\beta\) around two ellipses. The shapes of these ellipses and the sense of the star's motion on them are determined by equations (3.126). For example, in the case of small \(R_{\rm c}\) and \(\epsilon\), the \(\alpha\)-ellipse around the point \(L_{4}\) is highly elongated in the \(x\)- or \(\xi\)-direction (the tangential direction), while the \(\beta\)-ellipse has \(Y_{2}=-X_{2}/\surd 2\). The star therefore moves around the \(\beta\)-ellipse in the sense opposite to that of the rotation of the potential. The \(\beta\)-ellipse is simply the familiar epicycle from SS3.2.3, while the \(\alpha\)-ellipse represents a slow tangential wallowing in the weak non-axisymmetric component of \(\Phi_{\rm L}\).

Now consider motion about the central Lagrange point \(L_{3}\). From equations (3.126) and the inequality (3.129), it follows that \(Y_{1}/X_{1}>0\). Thus the star's motion around the \(\alpha\)-ellipse has the same sense as the rotation of the potential; such an orbit is said to be **prograde** or **direct**. When \(\Omega_{\rm b}^{2}\ll|\Phi_{xx}|\), it is straightforward to show from equations (3.124) and (3.126) that \(X_{1}\gg Y_{1}\) and hence that this prograde motion runs almost parallel to the long axis of the potential--this is the long-axis orbit familiar to us from our study of non-rotating bars. Conversely the star moves around the \(\beta\)-ellipse in the sense opposite to that of the rotation of the potential (the motion is **retrograde**), and \(|X_{2}|<|Y_{2}|\). When \(\Omega_{\rm b}^{2}/|\Phi_{xx}|\) is small, the \(\beta\)-ellipse goes over into the short-axis orbit of a non-rotating potential. A general prograde orbit around \(L_{3}\) is made up of motion on the \(\beta\)-ellipse around a guiding center that moves around the \(\alpha\)-ellipse, and conversely for retrograde orbits.

We now turn to a numerical study of orbits in rotating potentials that are not confined to the vicinity of a Lagrange point. We adopt the logarithmic potential (3.103) with \(q=0.8\), \(R_{\rm c}=0.03\), \(v_{0}=1\), and \(\Omega_{\rm b}=1\). This choice places the corotation annulus near \(R_{\rm CR}=30R_{\rm c}\). The Jacobi integral (eq. 3.112) now plays the role that energy played in our similar investigation of orbits in non-rotating potentials, and by a slight abuse of language we shall refer to its value \(E_{\rm J}\) as the "energy." At radii \(R\lesssim R_{\rm c}\) the two important sequences of stable closed orbits in the non-rotating case are the long- and the short-axis orbits. Figure 3.15 confirms the prediction of our analytic treatment that in the presence of rotation these become oval in shape. Orbits of both sequences are stable and therefore parent families of non-closed orbits.

Consider now the evolution of the orbital structure as we leave the core region. At an energy \(E_{1}\), similar to that at which loop orbits first appeared in the non-rotating case, pairs of prograde orbits like those shown in Figure 3.16 appear. Only one member of the pair is stable. When it first appears, the stable orbit is highly elongated parallel to the short axis, but as the energy is increased it becomes more round. Eventually the decrease in the elongation of this orbit with increasing energy is reversed, the orbit again becomes highly elongated parallel to the short axis and finally disappearsFigure 3.16: Closed orbits at two energies higher than those shown in Figure 3.15. Just outside the potential’s near-harmonic core there are at each energy two prograde closed orbits aligned parallel to the potential’s short axis. One of these orbits (the less elongated) is stable, while the other is unstable.

Figure 3.15: In the near-harmonic core of a rotating potential, the closed orbits are elongated ellipses. Stars on the orbits shown as full curves circulate about the center in the same sense as the potential’s figure rotates. On the dashed orbits, stars circulate in the opposite sense. The \(x\) axis is the long axis of the potential.

along with its unstable companion orbit at an energy \(E_{2}\).10 In the notation of Contopoulos & Papayannopoulos (1980) these stable orbits are said to belong to the **sequence**\({\bf x}_{2}\), while their unstable companions are of the **sequence**\({\bf x}_{3}\).

Footnote 10: In the theory of weak bars, the energies \(E_{1}\) and \(E_{2}\) at which these prograde orbits appear and disappear are associated with the first and second inner Lindblad radii, respectively (eq. 3.150).

The sequence of long-axis orbits (often called the **sequence**\({\bf x}_{1}\)) suffers a significant transition near \(E_{2}\). On the low-energy side of the transition the long-axis orbits are extremely elongated and lens shaped (smaller orbit in Figure 3.17a). On the high-energy side the orbits are self-intersecting (larger orbit in Figure 3.17a). As the energy continues to increase, the orbit's ears become first more prominent and then less prominent, vanishing to form a cusped orbit (Figure 3.17b). At still higher energies the orbits become approximately elliptical (largest orbit in Figure 3.17b), first growing rounder and then adopt progressively more complex shapes as they approach

Figure 3.17: Near the energy at which the orbit pairs shown in Figure 3.16 appear, the closed long-axis orbits develop ears. Panel (a) shows orbits at energies just below and above this transition. Panel (b) shows the evolution of the closed long-axis orbits at higher energies. Notice that in panel (a) the \(x\)- and \(y\)-scales are different. The smallest orbit in panel (b) is the larger of the two orbits in panel (a).

the corotation region in which the Lagrange points \(L_{1}\), \(L_{2}\), \(L_{4}\), and \(L_{5}\) are located.

In the vicinity of the corotation annulus, there are important sequences of closed orbits on which stars move around one of the Lagrange points \(L_{4}\) or \(L_{5}\), rather than about the center.

Essentially all closed orbits that carry stars well outside the corotation region are nearly circular. In fact, the potential's figure spins much more rapidly than these stars circulate on their orbits, so the non-axisymmetric forces on such stars tend to be averaged out. One finds that at large radii prograde orbits tend to align with the bar, while retrograde orbits align perpendicular to the bar.

These results are summarized in Figure 3.18. In this figure we plot against the value of \(E_{\rm J}\) for each closed orbit the distance \(y\) at which it crosses the short axis of the potential. Each sequence of closed orbits generates a continuous curve in this diagram known as the **characteristic curve** of that sequence.

The stable closed orbits we have described are all associated with substantial families of non-closed orbits. Figure 3.19 shows two of these. As in the non-rotating case, a star on one of these non-closed orbits may be considered to be executing stable oscillations about one of the fundamental closed orbits. In potentials of the form (3.103) essentially all orbits belong to one of these families. This is not always true, however, as we explain in SS3.7.

It is important to distinguish between orbits that enhance the elongation of the potential and those that oppose it. The overall mass distribution of a

Figure 3.18: A plot of the Jacobi constant \(E_{\rm J}\) of closed orbits in \(\Phi_{\rm L}(q=0.8,R_{\rm c}=0.03,\Omega_{\rm b}=1)\) against the value of \(y\) at which the orbit cuts the potential’s short axis. The dotted curve shows the relation \(\Phi_{\rm eff}(0,y)=E_{\rm J}\). The families of orbits x\({}_{1}\)–x\({}_{4}\) are marked.

galaxy must be elongated in the same sense as the potential, which suggests that most stars are on orbits on which they spend the majority of their time nearer to the potential's long axis than to its short axis. Interior to the corotation radius, the only orbits that satisfy this criterion are orbits of the family parented by the long-axis orbits, which therefore must be the most heavily populated orbits in any bar that is confined by its own gravity. The shapes of these orbits range from butterfly-like at radii comparable to the core radius \(R_{\rm c}\), to nearly rectangular between \(R_{\rm c}\) and the **inner Lindblad radius** (see below), to oval between this radius and corotation.

To an observer in an inertial frame of reference, stars on orbits belonging to the long-axis family circulate about the center of the potential in the same sense as the potential rotates. One part of the circulation seen by such an observer is due to the rotation of the frame of reference in which the potential is static. A second component of circulation is due to the mean streaming motion of such stars when referred to the rotating frame of the potential. Both components of circulation diminish towards zero if the angular velocity of the potential is reduced to zero. Near corotation the dominant component arises from the rotation of the frame of reference of the potential, while at small radii the more important component is the mean streaming motion of the stars through the rotating frame of reference.

#### Weak bars

Before we leave the subject of orbits in planar non-axisymmetric potentials, we derive an analytic description of loop orbits in weak bars.

**(a) Lindblad resonances** We assume that the figure of the potential rotates at some steady pattern speed \(\Omega_{\rm b}\), and we seek to represent a general loop orbit as a superposition of the circular motion of a guiding center and small oscillations around this guiding center. Hence our treatment of orbits

Figure 3.19: Two non-closed orbits of a common energy in the rotating potential \(\Phi_{\rm L}\).

in weak non-axisymmetric potentials will be closely related to the epicycle theory of nearly circular orbits in an axisymmetric potential (SS3.2.3).

Let \((R,\varphi)\) be polar coordinates in the frame that rotates with the potential, such that the line \(\varphi=0\) coincides with the long axis of the potential. Then the Lagrangian is

\[{\cal L}={{1\over 2}}\dot{R}^{2}+{{1\over 2}}[R(\dot{\varphi}+\Omega_{ \rm b})]^{2}-\Phi(R,\varphi), \tag{3.134}\]

so the equations of motion are

\[\ddot{R}=R(\dot{\varphi}+\Omega_{\rm b})^{2}-{\partial\Phi\over \partial R}, \tag{3.135a}\] \[{{\rm d}\over{\rm d}t}[R^{2}(\dot{\varphi}+\Omega_{\rm b})]=-{\partial\Phi\over \partial\varphi}. \tag{3.135b}\]

Since we assume that the bar is weak, we may write

\[\Phi(R,\varphi)=\Phi_{0}(R)+\Phi_{1}(R,\varphi), \tag{3.136}\]

where \(|\Phi_{1}/\Phi_{0}|\ll 1\). We divide \(R\) and \(\varphi\) into zeroth- and first-order parts

\[R(t)=R_{0}+R_{1}(t)\quad;\quad\varphi(t)=\varphi_{0}(t)+\varphi_{1}(t) \tag{3.137}\]

by substituting these expressions into equation (3.135) and requiring that the zeroth-order terms should sum to zero. Thus

\[R_{0}\left(\dot{\varphi}_{0}+\Omega_{\rm b}\right)^{2}=\left({{\rm d}\Phi_{0 }\over{\rm d}R}\right)_{R_{0}}\quad{\rm and}\quad\dot{\varphi}_{0}={\rm constant}. \tag{3.138}\]

This is the usual equation for centrifugal equilibrium at \(R_{0}\). If we define \(\Omega_{0}\equiv\Omega(R_{0})\), where

\[\Omega(R)\equiv\pm\sqrt{1\over R}{{\rm d}\Phi_{0}\over{\rm d}R} \tag{3.139}\]

is the circular frequency at \(R\) in the potential \(\Phi_{0}\), equation (3.138) for the angular speed of the guiding center \((R_{0},\varphi_{0})\) becomes

\[\dot{\varphi}_{0}=\Omega_{0}-\Omega_{\rm b}, \tag{3.140}\]

where \(\Omega_{0}>0\) for prograde orbits and \(\Omega_{0}<0\) for retrograde ones. We choose the origin of time such that

\[\varphi_{0}(t)=(\Omega_{0}-\Omega_{\rm b})t. \tag{3.141}\]

The first-order terms in the equations of motion (3.135) now yield

\[\ddot{R}_{1}+\left({{\rm d}^{2}\Phi_{0}\over{\rm d}R^{2}}-\Omega^{2}\right)_{ R_{0}}\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\[\ddot{\varphi}_{1}+2\Omega_{0}\frac{\dot{R}_{1}}{R_{0}}=-\frac{1}{R_{0}^{2}} \left(\frac{\partial\Phi_{1}}{\partial\varphi}\right)_{R_{0}}. \tag{3.142b}\]

To proceed further we must choose a specific form of \(\Phi_{1}\); we set

\[\Phi_{1}(R,\varphi)=\Phi_{\rm b}(R)\cos(m\varphi), \tag{3.143}\]

where \(m\) is a positive integer, since any potential that is an even function of \(\varphi\) can be expanded as a sum of terms of this form. In practice we are mostly concerned with the case \(m=2\) since the potential is then barred. If \(\varphi=0\) is to coincide with the long axis of the potential, we must have \(\Phi_{\rm b}<0\).

So far we have assumed only that the angular velocity \(\dot{\varphi}_{1}\) is small, not that \(\varphi_{1}\) is itself small. Allowing for large excursions in \(\varphi_{1}\) will be important when we consider what happens at resonances in part (b) of this section, but for the moment we assume that \(\varphi_{1}\ll 1\) and hence that \(\varphi(t)\) always remains close to \((\Omega_{0}-\Omega_{\rm b})t\). With this assumption we may replace \(\varphi\) by \(\varphi_{0}\) in the expressions for \(\partial\Phi_{1}/\partial R\) and \(\partial\Phi_{1}/\partial\varphi\) to yield

\[\ddot{R}_{1}+\left(\frac{{\rm d}^{2}\Phi_{0}}{{\rm d}R^{2}}-\Omega^{2}\right) _{R_{0}}\!\!R_{1}-2R_{0}\Omega_{0}\dot{\varphi}_{1}=-\left(\frac{{\rm d}\Phi_{ \rm b}}{{\rm d}R}\right)_{R_{0}}\!\!\!\cos\left[m(\Omega_{0}-\Omega_{\rm b})t \right], \tag{3.144a}\] \[\ddot{\varphi}_{1}+2\Omega_{0}\frac{\dot{R}_{1}}{R_{0}}=\frac{m\Phi_{\rm b}( R_{0})}{R_{0}^{2}}\sin\left[m(\Omega_{0}-\Omega_{\rm b})t\right]. \tag{3.144b}\]

Integrating the second of these equations, we obtain

\[\dot{\varphi}_{1}=-2\Omega_{0}\frac{R_{1}}{R_{0}}-\frac{\Phi_{\rm b}(R_{0})}{ R_{0}^{2}(\Omega_{0}-\Omega_{\rm b})}\cos\left[m(\Omega_{0}-\Omega_{\rm b})t \right]+\mbox{constant}. \tag{3.145}\]

We now eliminate \(\dot{\varphi}_{1}\) from equation (3.144a) to find

\[\ddot{R}_{1}+\kappa_{0}^{2}R_{1}=-\left[\frac{{\rm d}\Phi_{\rm b}}{{\rm d}R}+ \frac{2\Omega\Phi_{\rm b}}{R(\Omega-\Omega_{\rm b})}\right]_{R_{0}}\!\!\cos \left[m(\Omega_{0}-\Omega_{\rm b})t\right]+\mbox{constant},\] (3.146a) where \[\kappa_{0}^{2}\equiv\left(\frac{{\rm d}^{2}\Phi_{0}}{{\rm d}R^{2}}+3\Omega^{2} \right)_{R_{0}}=\left(R\frac{{\rm d}\Omega^{2}}{{\rm d}R}+4\Omega^{2}\right)_{ R_{0}} \tag{3.146b}\]

is the usual epicycle frequency (eq. 3.80). The constant in equation (3.146a) is unimportant since it can be absorbed by a shift \(R_{1}\to R_{1}+\mbox{\it constant}\).

Equation (3.146a) is the equation of motion of a harmonic oscillator of natural frequency \(\kappa_{0}\) that is driven at frequency \(m(\Omega_{0}-\Omega_{\rm b})\). The general solution to this equation is

\[R_{1}(t)=C_{1}\cos(\kappa_{0}t+\alpha)-\left[\frac{{\rm d}\Phi_{\rm b}}{{\rm d }R}+\frac{2\Omega\Phi_{\rm b}}{R(\Omega-\Omega_{\rm b})}\right]_{R_{0}}\!\! \frac{\cos\left[m(\Omega_{0}-\Omega_{\rm b})t\right]}{\Delta}, \tag{3.147a}\]where \(C_{1}\) and \(\alpha\) are arbitrary constants, and

\[\Delta\equiv\kappa_{0}^{2}-m^{2}(\Omega_{0}-\Omega_{\rm b})^{2}. \tag{3.147b}\]

If we use equation (3.141) to eliminate \(t\) from equation (3.147a), we find

\[R_{1}(\varphi_{0})=C_{1}\cos\left(\frac{\kappa_{0}\varphi_{0}}{\Omega_{0}- \Omega_{\rm b}}+\alpha\right)+C_{2}\cos(m\varphi_{0}),\] (3.148a) where \[C_{2}\equiv-\frac{1}{\Delta}\left[\frac{{\rm d}\Phi_{\rm b}}{{\rm d}R}+\frac{2 \Omega\Phi_{\rm b}}{R(\Omega-\Omega_{\rm b})}\right]_{R_{0}}. \tag{3.148b}\]

If \(C_{1}=0\), \(R_{1}(\varphi_{0})\) becomes periodic in \(\varphi_{0}\) with period \(2\pi/m\), and thus the orbit that corresponds to \(C_{1}=0\) is a closed loop orbit. The orbits with \(C_{1}\neq 0\) are the non-closed loop orbits that are parented by this closed loop orbit. In the following we set \(C_{1}=0\) so that we may study the closed loop orbits.

The right side of equation (3.148a) for \(R_{1}\) becomes singular at a number of values of \(R_{0}\):

* **Corotation resonance**. When \[\Omega_{0}=\Omega_{\rm b},\] (3.149) \(\dot{\varphi}_{0}=0\), and the guiding center corotates with the potential.
* **Lindblad resonances**. When \[m(\Omega_{0}-\Omega_{\rm b})=\pm\kappa_{0},\] (3.150) the star encounters successive crests of the potential at a frequency that coincides with the frequency of its natural radial oscillations. Radii at which such resonances occur are called **Lindblad radii** after the Swedish astronomer Bertil Lindblad (1895-1965). The plus sign in equation (3.150) corresponds to the case in which the star overtakes the potential, encountering its crests at the resonant frequency \(\kappa_{0}\); this is called an **inner Lindblad resonance**. In the case of a minus sign, the crests of the potential sweep by the more slowly rotating star, and \(R_{0}\) is said to be the radius of the **outer Lindblad resonance**.

There is a simple connection between these two types of resonance. A circular orbit has two natural frequencies. If the star is displaced radially, it oscillates at the epicycle frequency \(\kappa_{0}\). On the other hand, if the star is displaced azimuthally in such a way that it is still on a circular orbit, then it will continue on a circular orbit displaced from the original one. Thus the star is neutrally stable to displacements of this form; in other words, its natural azimuthal frequency is zero. The two types of resonance arise when the forcing frequency seen by the star, \(m(\Omega_{0}-\Omega_{\rm b})\), equals one of the natural frequencies \(\pm\kappa_{0}\) and 0.

Figure 6.11 shows plots of \(\Omega\), \(\Omega+\frac{1}{2}\kappa\) and \(\Omega-\frac{1}{2}\kappa\) for two circular-speed curves typical of galaxies. A galaxy may have 0, 1, 2, or more Lindblad resonances. The Lindblad and corotation resonances play a central role in the study of bars and spiral structure, and we shall encounter them again Chapter 6.

From equation (3.148a) it follows that for \(m=2\) the closed loop orbit is aligned with the bar whenever \(C_{2}>0\), and is aligned perpendicular to the bar when \(C_{2}<0\). When \(R_{0}\) passes through a Lindblad or corotation resonance, the sign of \(C_{2}\), and therefore the orientation of the closed loop orbits, changes.

It is interesting to relate the results of this analytic treatment to the orbital structure of a strong bar that we obtained numerically in the last subsection. In this connection it is helpful to compare Figure 3.18, which shows data for a barred potential, with Figure 3.20, which describes orbits in an axisymmetric potential viewed from a rotating frame. The full curves in Figure 3.20 show the relationship between the Jacobi constant \(E_{\rm J}\) and the radii of prograde and retrograde circular orbits in the isochrone potential (2.47). As in Figure 3.18, the dotted curve marks the relation \(\Phi_{\rm eff}(0,y)=E_{\rm J}\). There are no orbits in the region to the right of this curve, which touches the curve of the prograde circular orbits at the corotation resonance, marked CR in the figure. If in the given frame we were to add a small

Figure 3.20: The full curves are the characteristic curves of the prograde (upper) and retrograde (lower) circular orbits in the isochrone potential (2.47) when a rotating frame of reference is employed. The dashed curve shows the relation \(\Phi_{\rm eff}(0,y)=E_{\rm J}\), and the dots mark the positions of the Lindblad resonances when a small non-axisymmetric component is added to the potential.

non-axisymmetric component to the potential, the orbits marked by large dots would lie at the Lindblad resonances (from right to left, the first and second inner Lindblad resonances and the outer Lindblad resonance marked OL). We call the radius of the first inner Lindblad resonance11\(R_{\rm IL1}\), and similarly \(R_{\rm IL2}\), \(R_{\rm OL}\), and \(R_{\rm CR}\) for the radii of the other Lindblad resonances and of corotation. Equations (3.148) with \(C_{1}=0\) describe nearly circular orbits in a weakly barred potential. Comparing Figure 3.20 with Figure 3.18, we see that nearly circular retrograde orbits belong to the family \(\rm x_{4}\). Nearly circular prograde orbits belong to different families depending on their radius. Orbits that lie within \(R_{\rm IL1}\) belong to the family \(\rm x_{1}\). In the radius range \(R_{\rm IL1}<R<R_{\rm IL2}\) the families \(\rm x_{2}\) and \(\rm x_{3}\) exist and contain orbits that are more circular than those of \(\rm x_{1}\). We identify the orbits described by (3.148) with orbits of the family \(\rm x_{2}\) as indicated in Figure 3.20, since the family \(\rm x_{3}\) is unstable. In the radius range \(R>R_{\rm IL2}\), equations (3.148) with \(C_{1}=0\) describe orbits of the family \(\rm x_{1}\). Thus equations (3.148) describe only the families of orbits in a barred potential that are parented by a nearly circular orbit. However, when the non-axisymmetric component of the potential is very weak, most of phase space is occupied by such orbits. As the non-axisymmetry of the potential becomes stronger, families of orbits that are not described by equations (3.148) become more important.

Footnote 11: Also called the **inner inner Lindblad resonance.**

**(b) Orbits trapped at resonance** When \(R_{0}\) approaches the radius of either a Lindblad resonance or the corotation resonance, the value of \(R_{1}\) that is predicted by equations (3.148) becomes large, and our linearized treatment of the equations of motion breaks down. However, one can modify the analysis to cope with these resonances. We now discuss the necessary modifications for the case of the corotation resonance. The case of the Lindblad resonances is described in Goldreich & Tremaine (1981).

The appropriate modification is suggested by our investigation of orbits near the Lagrange points \(L_{4}\) and \(L_{5}\) in the potential \(\Phi_{\rm L}\) (eq. 3.103), when the radius is large compared to the core radius \(R_{\rm c}\) and the ellipticity \(\epsilon=1-q\) approaches zero. In this limit the non-axisymmetric part of the potential is proportional to \(\epsilon\), so we have an example of a weak bar when \(\epsilon\to 0\). We found in SS3.3.2 that a star's orbit was a superposition of motion at frequencies \(\alpha\) and \(\beta\) around two ellipses. In the limit \(\epsilon\to 0\), the \(\beta\)-ellipse represents the familiar epicyclic motion and will not be considered further. The \(\alpha\)-ellipse is highly elongated in the azimuthal direction, with axis ratio \(|Y_{1}/X_{1}|=\sqrt{2\epsilon}\), and its frequency is small, \(\alpha=\sqrt{2\epsilon}\Omega_{\rm b}\).

These results suggest we consider the approximation in which \(R_{1}\), \(\dot{R}_{1}\), and \(\dot{\varphi}_{1}\) are small but \(\varphi_{1}\) is not. Specifically, if the bar strength \(\Phi_{1}\) is proportional to some small parameter that we may call \(\epsilon\), we assume that \(\varphi_{1}\) is of order unity, \(R_{1}\) is of order \(\epsilon^{1/2}\), and the time derivative of any quantity is smaller than that quantity by of order \(\epsilon^{1/2}\). Let us place the guiding

### 3.3 The donkey effect

An orbiting particle that is subject to weak tangential forces can exhibit unusual behavior. To illustrate this, suppose that the particle has mass \(m\) and is in a circular orbit of radius \(r\), with angular speed \(\dot{\phi}=\Omega(r)\) given by \(r\Omega^{2}(r)={\rm d}\Phi/{\rm d}r\) (eq. 3.7a). Now let us imagine that the particle experiences a small force, \(F\), directed parallel to its velocity vector. Since the force is small, the particle remains on a circular orbit, which slowly changes in radius in response to the force. To determine the rate of change of radius, we note that the angular momentum is \(L(r)=mr^{2}\Omega\) and the torque is \(N=rF=\dot{L}\). Thus

\[\dot{r}=\frac{{\rm d}r}{{\rm d}L}\dot{L}=\frac{F/m}{2\Omega+r\,{\rm d}\Omega/{ \rm d}r}=-\frac{F}{2mB}; \tag{1}\]

where \(B(r)=-\Omega-\frac{1}{2}r\,{\rm d}\Omega/{\rm d}r\) is the function defined by equation (3.83). The azimuthal angle accelerates at a rate

\[\ddot{\phi}=\frac{{\rm d}\Omega}{{\rm d}r}\dot{r}=-\frac{2A\dot{r}}{r}, \tag{2}\]

where \(A(r)=-\frac{1}{2}r{\rm d}\Omega/{\rm d}r\) (eq. 3.83). Combining these results,

\[r\ddot{\phi}=\frac{A}{mB}F. \tag{3}\]

This acceleration in azimuthal angle can be contrasted to the acceleration of a free particle under the same force, \(\ddot{x}=F/m\). Thus the particle behaves as if it had an inertial mass \(mB/A\), which is negative whenever

\[-2<\frac{{\rm d}\ln\Omega}{{\rm d}\ln R}<0. \tag{4}\]

Almost all galactic potentials satisfy this inequality. Thus the orbiting particle behaves as if it had negative inertial mass, accelerating in the opposite direction to the applied force.

There are many examples of this phenomenon in galactic dynamics, which has come to be called the **donkey effect**: to quote Lynden-Bell & Kalnajs (1972), who introduced the term, "in azimuth stars behave like donkeys, slowing down when pulled forwards and speeding up when held back."

The simplest example of the donkey effect is an Earth satellite subjected to atmospheric drag: the satellite sinks gradually into a lower orbit with a larger circular speed and shorter orbital period, so the drag force speeds up the angular passage of the satellite across the sky.

center at \(L_{5}\) [\(\Omega(R_{0})=\Omega_{\rm b}\); \(\varphi_{0}=\pi/2\)] and use equation (3.146b) to write the equations of motion (3.142) as

\[\ddot{R}_{1}+\left(\kappa_{0}^{2}-4\Omega_{0}^{2}\right)R_{1}-2R_{ 0}\Omega_{0}\dot{\varphi}_{1} =-\frac{\partial\Phi_{1}}{\partial R}, \tag{3.151a}\] \[\ddot{\varphi}_{1}+2\Omega_{0}\frac{\dot{R}_{1}}{R_{0}} =-\frac{1}{R_{0}^{2}}\frac{\partial\Phi_{1}}{\partial\varphi}. \tag{3.151b}\]

According to our ordering, the terms on the left side of the first line are of order \(\epsilon^{3/2}\), \(\epsilon^{1/2}\), and \(\epsilon^{1/2}\), respectively, while the term on the right side is of order \(\epsilon\). All the terms on the second line are of order \(\epsilon\). Hence we may simplify the first line by keeping only the terms of order \(\epsilon^{1/2}\):

\[\left(\kappa_{0}^{2}-4\Omega_{0}^{2}\right)R_{1}-2R_{0}\Omega_{0}\dot{\varphi }_{1}=0. \tag{3.152}\]

Substituting equation (3.152) into equation (3.151b) to eliminate \(R_{1}\), we find

\[\ddot{\varphi}_{1}\left(\frac{\kappa_{0}^{2}}{\kappa_{0}^{2}-4\Omega_{0}^{2} }\right)=-\frac{1}{R_{0}^{2}}\frac{\partial\Phi_{1}}{\partial\varphi}\bigg{|} _{(R_{0},\varphi_{0}+\varphi_{1})}. \tag{3.153}\]

Substituting from equation (3.143) for \(\Phi_{1}\) we obtain with \(m=2\)

\[\ddot{\varphi}_{1}=-\frac{2\Phi_{\rm b}}{R_{0}^{2}}\left(\frac{4\Omega_{0}^{2 }-\kappa_{0}^{2}}{\kappa_{0}^{2}}\right)\sin\left[2(\varphi_{0}+\varphi_{1}) \right]. \tag{3.154}\]

By inequality (3.82) we have that \(4\Omega_{0}^{2}>\kappa_{0}^{2}\). Also we have \(\Phi_{\rm b}<0\) and \(\varphi_{0}=\pi/2\), and so equation (3.154) becomes

\[\frac{{\rm d}^{2}\psi}{{\rm d}t^{2}}=-p^{2}\sin\psi,\] (3.155a) where \[\psi\equiv 2\varphi_{1}\quad\mbox{and}\quad p^{2}\equiv\frac{4}{R_{0}^{2}} \left|\Phi_{\rm b}(R_{0})\right|\frac{4\Omega_{0}^{2}-\kappa_{0}^{2}}{\kappa_ {0}^{2}}. \tag{3.155b}\]

Equation (3.155a) is simply the equation of a pendulum. Notice that the singularity in \(R_{1}\) that appeared at corotation in equations (3.148) has disappeared in this more careful analysis. Notice also the interesting fact that the stable equilibrium point of the pendulum, \(\varphi_{1}=0\), is at the _maximum_, not the minimum, of the potential \(\Phi_{1}\) (Box 3.3). If the integral of motion

\[E_{\rm p}={\frac{1}{2}}\dot{\psi}^{2}-p^{2}\cos\psi \tag{3.156}\]

is less than \(p^{2}\), the star oscillates slowly or **librates** about the Lagrange point, whereas if \(E_{\rm p}>p^{2}\), the star is not trapped by the bar but **circulatesabout the center of the galaxy. For small-amplitude librations, the libration frequency is \(p\), consistent with our assumption that the oscillation frequency is of order \(\epsilon^{1/2}\) when \(\Phi_{\rm b}\) is of order \(\epsilon\). Large-amplitude librations of this kind may account for the rings of material often seen in barred galaxies (page 538).

We may obtain the shape of the orbit from equation (3.152) by using equation (3.156) to eliminate \(\dot{\varphi}_{1}={1\over 2}\dot{\psi}\):

\[R_{1}=-{2R_{0}\Omega_{0}\dot{\varphi}_{1}\over 4\Omega_{0}^{2}-\kappa_{0}^{2}}= \pm{2^{1/2}R_{0}\Omega_{0}\over 4\Omega_{0}^{2}-\kappa_{0}^{2}}\sqrt{E_{\rm p }+p^{2}\cos(2\varphi_{1})}.\]

We leave as an exercise the demonstration that when \(E_{\rm p}\gg p^{2}\), equation (3.157) describes the same orbits as are obtained from (3.148a) with \(C_{1}=0\) and \(\Omega\neq\Omega_{\rm b}\).

The analysis of this subsection complements the analysis of motion near the Lagrange points in SS3.3.2. The earlier analysis is valid for small oscillations around a Lagrange point of an arbitrary two-dimensional rotating potential, while the present analysis is valid for excursions of any amplitude in azimuth around the Lagrange points \(L_{4}\) and \(L_{5}\), but only if the potential is nearly axisymmetric.

### 3.4 Numerical orbit integration

In most stellar systems, orbits cannot be computed analytically, so effective algorithms for numerical orbit integration are among the most important tools for stellar dynamics. The orbit-integration problems we have to address vary in complexity from following a single particle in a given, smooth galactic potential, to tens of thousands of interacting stars in a globular cluster, to billions of dark-matter particles in a simulation of cosmological clustering. In each of these cases, the dynamics is that of a Hamiltonian system: with \(N\) particles there are \(3N\) coordinates that form the components of a vector \({\bf q}(t)\), and \(3N\) components of the corresponding momentum \({\bf p}(t)\). These vectors satisfy Hamilton's equations,

\[\dot{\bf q}={\partial H\over\partial{\bf p}}\quad;\quad\dot{\bf p}=-{\partial H \over\partial{\bf q}},\]

which can be written as

\[{{\rm d}{\bf w}\over{\rm d}t}={\bf f}({\bf w},t),\]

where \({\bf w}\equiv({\bf q},{\bf p})\) and \({\bf f}\equiv(\partial H/\partial{\bf p},-\partial H/\partial{\bf q})\). For simplicity we shall assume in this section that the Hamiltonian has the form \(H({\bf q},{\bf p})={1\over 2}p^{2}+\Phi({\bf q})\), although many of our results can be applied to more general Hamiltonians. Given a phase-space position \({\bf w}\) at time \(t\), and a **timestep**\(h\), we require an algorithm--an **integrator**--that generates a new position \({\bf w^{\prime}}\) that approximates the true position at time \(t^{\prime}=t+h\). Formally, the problem to be solved is the same whether we are following the motion of a single star in a given potential, or the motion of \(10^{10}\) particles under their mutual gravitational attraction.

The best integrator to use for a given problem is determined by several factors:

* How smooth is the potential? The exploration of orbits in an analytic model of a galaxy potential places fewer demands on the integrator than following orbits in an open cluster, where the stars are buffeted by close encounters with their neighbors.
* How cheaply can we evaluate the gravitational field? At one extreme, evaluating the field by direct summation in simulations of globular cluster with \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$>$}}10^{5}\) particles requires O(\(N^{2}\)) operations, and thus is quite expensive compared to the O(\(N\)) cost of orbit integrations. At the other extreme, tree codes, spherical-harmonic expansions, or particle-mesh codes require O(\(N\ln N\)) operations and thus are comparable in cost to the integration. So the integrator used in an N-body simulation of a star cluster should make the best possible use of each expensive but accurate force evaluation, while in a cosmological simulation it is better to use a simple integrator and evaluate the field more frequently.
* How much memory is available? The most accurate integrators use the position and velocity of a particle at several previous timesteps to help predict its future position. When simulating a star cluster, the number of particles is small enough (\(N\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}10^{5}\)) that plenty of memory should be available to store this information. In a simulation of galaxy dynamics or a cosmological simulation, however, it is important to use as many particles as possible, so memory is an important constraint. Thus for such simulations the optimal integrator predicts the future phase-space position using only the current position and gravitational field.
* How long will the integration run? The answer can range from a few crossing times for the simulation of a galaxy merger to \(10^{5}\) crossing times in the core of a globular cluster. Long integrations require that the integrator does not introduce any systematic drift in the energy or other integrals of motion.

Useful references include Press et al. (1986), Hairer, Lubich, & Wanner (2002), and Aarseth (2003).

#### 3.4.1 Symplectic integrators

**(a) Modified Euler integrator** Let us replace the original Hamiltonian \(H({\bf q},{\bf p})={1\over 2}p^{2}+\Phi({\bf q})\) by the time-dependent Hamiltonian

\[H_{h}({\bf q},{\bf p},t)={{1\over 2}}p^{2}+\Phi({\bf q}) \delta_{h}(t),\quad\hbox{where}\quad\delta_{h}(t)\equiv h\sum_{j=-\infty}^{ \infty}\delta(t-jh) \tag{3.160}\]is an infinite series of delta functions (Appendix C.1). Averaged over a time interval that is long compared to,, so the trajectories determined by should approach those determined by as.

Hamilton's equations for read

(3.161)

We now integrate these equations from to, where. Let the system have coordinates at time, and first ask for its coordinates at. During this short interval changes by a negligible amount, and suffers a kick governed by the second of equations (3.161). Integrating this equation from to is trivial since is fixed, and we find

(3.162a) this is called a **kick step** because the momentum changes but the position does not. Next, between and, the value of the delta function is zero, so the system has constant momentum, and Hamilton's equations yield for the coordinates at (b)

(3.162b)

this is called a **drift step** because the position changes but the momentum does not. Combining these results, we find that over a timestep starting at the Hamiltonian generates a map given by

(3.163a) Similarly, starting at yields the map

(3.163b)

These maps define the "kick-drift" or "drift-kick" **modified Euler integrator**. The performance of this integrator in a simple galactic potential is shown in Figure 3.21.

The map induced by any Hamiltonian is a canonical or symplectic map (page 803), so it can be derived from a generating function. It is simple to confirm using equations (D.93) that the generating function yields the kick-drift modified Euler integrator (3.163a).

According to the modified Euler integrator, the position after timestep is

(3.164)

while the exact result may be written as a Taylor series,

(3.165)The error after a single step of the modified Euler integrator is seen to be \(\mathrm{O}(h^{2})\), so it is said to be a **first-order** integrator.

Since the mappings (3.163) are derived from the Hamiltonian (3.160), they are symplectic, so either flavor of the modified Euler integrator is a **symplectic integrator**. Symplectic integrators conserve phase-space volume and Poincare invariants (Appendix D.4.2). Consequently, if the integrator is used to advance a series of particles that initially lie on a closed curve in the \((q_{i},p_{i})\) phase plane, the curve onto which it moves the particles has the same line integral \(\oint p_{i}\mathrm{d}q_{i}\) around it as the original curve. This conservation property turns out to constrain the allowed motions in phase space so strongly that the usual tendency of numerical orbit integrations to drift in energy (sometimes called **numerical dissipation**, even through the energy can either decay or grow) is absent in symplectic integrators (Hairer,

Figure 3.21: Fractional energy error as a function of time for several integrators, following a particle orbiting in the logarithmic potential \(\Phi(r)=\ln r\). The orbit is moderately eccentric (apocenter twice as big as pericenter). The timesteps are fixed, and chosen so that there are 300 evaluations of the force or its derivatives per period for all of the integrators. The integrators shown are kick-drift modified Euler (3.163a), leapfrog (3.166a), Runge–Kutta (3.168), and Hermite (3.172a–d). Note that (i) over moderate time intervals, the errors are smallest for the fourth-order integrators (Runge–Kutta and Hermite), intermediate for the second-order integrator (leapfrog), and largest for the first-order integrator (modified Euler); (ii) the energy error of the symplectic integrators does not grow with time.

Lubich, & Wanner 2002).

**Leapfrog integrator** By alternating kick and drift steps in more elaborate sequences, we can construct higher-order integrators (Yoshida 1993); these are automatically symplectic since they are the composition of maps (the kick and drift steps) that are symplectic. The simplest and most widely used of these is the **leapfrog** or **Verlet** integrator in which we drift for \(\frac{1}{2}h\), kick for \(h\) and then drift for \(\frac{1}{2}h\):

\[{\bf q}_{1/2}={\bf q}+\tfrac{1}{2}h{\bf p}\ ;\ {\bf p}^{\prime}={\bf p}-h{ \boldsymbol{\nabla}}\Phi({\bf q}_{1/2})\ ;\ {\bf q}^{\prime}={\bf q}+\tfrac{1}{2}h{\bf p}^{\prime}. \tag{3.166a}\]

This algorithm is sometimes called "drift-kick-drift" leapfrog; an equally good form is "kick-drift-kick" leapfrog:

\[{\bf p}_{1/2}={\bf p}-\tfrac{1}{2}h{\boldsymbol{\nabla}}\Phi({\bf q})\ ;\ {\bf q }^{\prime}={\bf q}+h{\bf p}_{1/2}\ ;\ {\bf p}^{\prime}={\bf p}-\tfrac{1}{2}h{ \boldsymbol{\nabla}}\Phi({\bf q}^{\prime}). \tag{3.166b}\]

Drift-kick-drift leapfrog can also be derived by considering motion in the Hamiltonian (3.160) from \(t=-\frac{1}{2}h\) to \(t=\frac{1}{2}h\).

The leapfrog integrator has many appealing features: (i) In contrast to the modified Euler integrator, it is second- rather than first-order accurate, in that the error in phase-space position after a single timestep is O(\(h^{3}\)) (Problem 3.26). (ii) Leapfrog is **time reversible** in the sense that if leapfrog advances the system from \(({\bf q},{\bf p})\) to \(({\bf q}^{\prime},{\bf p}^{\prime})\) in a given time, it will also advance it from \(({\bf q}^{\prime},-{\bf p}^{\prime})\) to \(({\bf q},-{\bf p})\) in the same time. Time-reversibility is a constraint on the phase-space flow that, like symplecticity, suppresses numerical dissipation, since dissipation is not a time-reversible phenomenon (Roberts & Quispel 1992; Hairer, Lubich, & Wanner 2002). (iii) A sequence of \(n\) leapfrog steps can be regarded as a drift step for \(\frac{1}{2}h\), then \(n\) kick-drift steps of the modified Euler integrator, then a drift step for \(-\frac{1}{2}h\); thus if \(n\gg 1\) the leapfrog integrator requires negligibly more work than the same number of steps of the modified Euler integrator. (iv) Leapfrog also needs no storage of previous timesteps, so is economical of memory.

Because of all these advantages, most codes for simulating collisionless stellar systems use the leapfrog integrator. Time-reversible, symplectic integrators of fourth and higher orders, derived by combining multiple kick and drift steps, are described in Problem 3.27 and Yoshida (1993).

One serious limitation of symplectic integrators is that they work well only with fixed timesteps, for the following reason. Consider an integrator with fixed timestep \(h\) that maps phase-space coordinates \({\bf w}\) to \({\bf w}^{\prime}={\bf W}({\bf w},h)\). The integrator is symplectic if the function \({\bf W}\) satisfies the symplectic condition (D.78), which involves the Jacobian matrix \(g_{\alpha\beta}=\partial W_{\alpha}/\partial w_{\beta}\). Now suppose that the timestep is varied, by choosing it to be some function \(h({\bf w})\) of location in phase space, so \({\bf w}^{\prime}={\bf W}[{\bf w},h({\bf w})]\equiv\widetilde{{\bf W}}({\bf w})\). The Jacobian matrix of \(\widetilde{{\bf W}}\) is not equal to the Jacobian matrix of \({\bf W}\), and in general will not satisfy the symplectic condition; in words, a symplectic integrator with fixed timestep is generally no longer symplectic once the timestep is varied.

Fortunately, the geometric constraints on phase-space flow imposed by time-reversibility are also strong, so the leapfrog integrator retains its good behavior if the timestep is adjusted in a time-reversible manner, even though the resulting integrator is no longer symplectic. Here is one way to do this: suppose that the appropriate timestep \(h\) is given by some function \(\tau({\bf w})\) of the phase-space coordinates. Then we modify equations (3.166a) to

\[\eqalign{{\bf q}_{1/2}={\bf q}+{{1\over 2}}h{\bf p}&; \quad{\bf p}_{1/2}={\bf p}-{{1\over 2}}h\mathbf{\nabla}\Phi({\bf q}_{1/2}),\cr t^{\prime}=t+{{1\over 2}}(h+h^{ \prime}),&(3.167)\cr{\bf p}^{\prime}={\bf p}_{1/2}-{{1\over 2}}h^{ \prime}\mathbf{\nabla}\Phi({\bf q}_{1/2})&;\quad{\bf q}^{\prime}={ \bf q}_{1/2}+{{1\over 2}}h^{\prime}{\bf p}^{\prime}.\cr}\]

Here \(h^{\prime}\) is determined from \(h\) by solving the equation \(u(h,h^{\prime})=\tau({\bf q}_{1/2},{\bf p}_{1/2})\), where \(\tau({\bf q},{\bf p})\) is the desired timestep at \(({\bf q},{\bf p})\) and \(u(h,h^{\prime})\) is any symmetric function of \(h\) and \(h^{\prime}\) such that \(u(h,h)=h\); for example, \(u(h,h^{\prime})={{1\over 2}}(h+h^{\prime})\) or \(u(h,h^{\prime})=2hh^{\prime}/(h+h^{\prime})\).

**3.4.2 Runge-Kutta and Bulirsch-Stoer integrators**

To follow the motion of particles in a given smooth gravitational potential \(\Phi({\bf q})\) for up to a few hundred crossing times, the fourth-order Runge-Kutta integrator provides reliable transportation. The algorithm is

\[\eqalign{{\bf k}_{1}=h{\bf f}({\bf w},t)&;\quad{\bf k}_{2}=h{\bf f}({\bf w}+{ {1\over 2}}{\bf k}_{1},t+{{1\over 2}}h),\cr{\bf k}_{3}=h{\bf f}({\bf w}+{ {1\over 2}}{\bf k}_{2},t+{{1\over 2}}h)&;\quad{\bf k}_{4}=h{\bf f}({\bf w}+{ \bf k}_{3},t+h),\cr{\bf w}^{\prime}={\bf w}+{{1\over 6}}({\bf k}_{1}+2{\bf k}_{2}+2{ \bf k}_{3}+{\bf k}_{4})&;\quad t^{\prime}=t+h.\cr}\]

The Runge-Kutta integrator is neither symplectic nor reversible, and it requires considerably more memory than the leapfrog integrator because memory has to be allocated to \({\bf k}_{1},\ldots,{\bf k}_{4}\). However, it is easy to use and provides fourth-order accuracy.

The **Bulirsch-Stoer** integrator is used for the same purposes as the Runge-Kutta integrator; although more complicated to code, it often surpasses the Runge-Kutta integrator in performance. The idea behind this integrator is to estimate \({\bf w}(t+h)\) from \({\bf w}(t)\) using first one step of length \(h\), then two steps of length \(h/2\), then four steps of length \(h/4\), etc., up to \(2^{K}\) steps of length \(h/2^{K}\) for some predetermined number \(K\). Then one extrapolates this sequence of results to the coordinates that would be obtained in the limit \(K\to\infty\). Like the Runge-Kutta integrator, this integrator achieves speed and accuracy at the cost of the memory required to hold intermediate results. Like all high-order integrators, the Runge-Kutta and Bulirsch-Stoer integrators work best when following motion in smooth gravitational fields.

#### 3.4.3 Multistep predictor-corrector integrators

We now discuss more complex integrators that are widely used in simulations of star clusters. We have a trajectory that has arrived at some phase-space position \({\bf w}_{0}\) at time \(t_{0}\), and we wish to predict its position \({\bf w}_{1}\) at \(t_{1}\). The general idea is to assume that the trajectory \({\bf w}(t)\) is a polynomial function of time \({\bf w}^{\rm poly}(t)\), called the **interpolating polynomial**. The interpolating polynomial is determined by fitting to some combination of the present position \({\bf w}_{0}\), the past positions, \({\bf w}_{-1},{\bf w}_{-2},\ldots\) at times \(t_{-1},t_{-2},\ldots\), and the present and past phase-space velocities, which are known through \(\dot{\bf w}_{j}={\bf f}({\bf w}_{j},t_{j})\). There is no requirement that \({\bf f}\) is derived from Hamilton's equations, so these methods can be applied to any first-order differential equations; on the other hand they are not symplectic.

If the interpolating polynomial has order \(k\), then the error after a small time interval \(h\) is given by the first term in the Taylor series for \({\bf w}(t)\) not represented in the polynomial, which is \({\rm O}(h^{k+1})\). Thus the order of the integrator is \(k\).12

Footnote 12: Unfortunately, the term “order” is used both for the highest power retained in the Taylor series for \({\bf w}(t)\), \(t^{k}\), and the dependence of the one-step error on the timestep, \(h^{k+1}\); fortunately, both orders are the same.

The **Adams-Bashforth** multistep integrator takes \({\bf w}^{\rm poly}\) to be the unique \(k\)th-order polynomial that passes through \({\bf w}_{0}\) at \(t_{0}\) and through the \(k\) points \((t_{-k+1},\dot{\bf w}_{-k+1}),\ldots,(t_{0},\dot{\bf w}_{0})\).

Explicit formulae for the Adams-Bashforth integrators are easy to find by computer algebra; however, the formulae are too cumbersome to write here except in the special case of equal timesteps, \(t_{j+1}-t_{j}=h\) for all \(j\). Then the first few Adams-Bashforth integrators are

\[{\bf w}_{1}={\bf w}_{0}+h\cases{\dot{\bf w}_{0}&$(k=1)$\cr\frac{3}{2}\dot{\bf w }_{0}-\frac{1}{2}\dot{\bf w}_{-1}&$(k=2)$\cr\frac{23}{12}\dot{\bf w}_{0}-\frac {4}{3}\dot{\bf w}_{-1}+\frac{5}{12}\dot{\bf w}_{-2}&$(k=3)$\cr\frac{55}{24} \dot{\bf w}_{0}-\frac{59}{24}\dot{\bf w}_{-1}+\frac{37}{24}\dot{\bf w}_{-2}- \frac{3}{8}\dot{\bf w}_{-3}&$(k=4)$.} \tag{3.169}\]

The case \(k=1\) is called **Euler's integrator**, and usually works rather badly.

The **Adams-Moulton** integrator differs from Adams-Bashforth only in that it computes the interpolating polynomial from the position \({\bf w}_{0}\) and the phase-space velocities \(\dot{\bf w}_{-k+2},\ldots,\dot{\bf w}_{1}\). For equal timesteps, the first few Adams-Moulton integrators are

\[{\bf w}_{1}={\bf w}_{0}+h\cases{\dot{\bf w}_{1}&$(k=1)$\cr\frac{1}{2}\dot{\bf w }_{1}+\frac{1}{2}\dot{\bf w}_{0}&$(k=2)$\cr\frac{5}{12}\dot{\bf w}_{1}+\frac{2 }{3}\dot{\bf w}_{0}-\frac{1}{12}\dot{\bf w}_{-1}&$(k=3)$\cr\frac{3}{8}\dot{\bf w }_{1}+\frac{19}{24}\dot{\bf w}_{0}-\frac{5}{24}\dot{\bf w}_{-1}+\frac{1}{24} \dot{\bf w}_{-2}&$(k=4)$.} \tag{3.170}\]Since \(\dot{\bf w}_{1}\) is determined by the unknown phase-space position \({\bf w}_{1}\) through \(\dot{\bf w}_{1}={\bf f}({\bf w}_{1},t_{1})\), equations (3.170) are nonlinear equations for \({\bf w}_{1}\) that must be solved iteratively. The Adams-Moulton integrator is therefore said to be **implicit**, in contrast to Adams-Bashforth, which is **explicit**.

The strength of the Adams-Moulton integrator is that it determines \({\bf w}_{1}\) by _interpolating_ the phase-space velocities, rather than by extrapolating them, as with Adams-Bashforth. This feature makes it a more reliable and stable integrator; the cost is that a nonlinear equation must be solved at every timestep.

In practice the Adams-Bashforth and Adams-Moulton integrators are used together as a **predictor-corrector** integrator. Adams-Bashforth is used to generate a preliminary value \({\bf w}_{1}\) (the prediction or P step), which is then used to generate \(\dot{\bf w}_{1}={\bf f}({\bf w}_{1},t_{1})\) (the evaluation or E step), which is used in the Adams-Moulton integrator (the corrector or C step). This three-step sequence is abbreviated as PEC. In principle one can then iterate the Adams-Moulton integrator to convergence through the sequence PECEC\(\cdots\); however, this is not cost-effective, since the Adams-Moulton formula, even if solved exactly, is only an approximate representation of the differential equation we are trying to solve. Thus one usually stops with PEC (stop the iteration after evaluating \({\bf w}_{1}\) twice) or PECE (stop the iteration after evaluating \(\dot{\bf w}_{1}\) twice).

When these methods are used in orbit integrations, the equations of motion usually have the form \(\dot{\bf x}={\bf v}\), \(\dot{\bf v}=-\mathbf{\nabla}\Phi({\bf x},t)\). In this case it is best to apply the integrator only to the second equation, and to generate the new position \({\bf x}_{1}\) by analytically integrating the interpolating polynomial for \({\bf v}(t)\)--this gives a formula for \({\bf x}_{1}\) that is more accurate by one power of \(h\).

Analytic estimates (Makino 1991) suggest that the one-step error in the Adams-Bashforth-Moulton predictor-corrector integrator is smaller than the error in the Adams-Bashforth integrator by a factor of 5 for \(k=2\), 9 for \(k=3\), 13 for \(k=4\), etc. These analytic results, or the difference between the predicted and corrected values of \({\bf w}_{1}\), can be used to determine the longest timestep that is compatible with a prescribed target accuracy--see SS3.4.5.

Because multistep integrators require information from the present time and \(k-1\) past times, a separate startup integrator, such as Runge-Kutta, must be used to generate the first \(k-1\) timesteps. Multistep integrators are not economical of memory because they store the coefficients of the entire interpolating polynomial rather than just the present phase-space position.

#### 3.4.4 Multivalue integrators

By differentiating the equations of motion \(\dot{\bf w}={\bf f}({\bf w})\) with respect to time, we obtain an expression for \(\ddot{\bf w}\), which involves second derivatives of the potential, \(\partial^{2}\Phi/\partial q_{i}\partial q_{j}\). If our Poisson solver delivers reliable values for these second derivatives, it can be advantageous to use \(\ddot{\bf w}\) or even higher time derivatives of \({\bf w}\) to determine the interpolating polynomial \({\bf w}^{\rm poly}(t)\). Algorithms that employ the second and higher derivatives of \({\bf w}\) are called **multivalue integrators**.

In the simplest case we set \({\bf w}^{\rm poly}(t)\) to the \(k\)th-order polynomial that matches \({\bf w}\) and its first \(k\) time derivatives at \(t_{0}\); this provides \(k+1\) constraints for the \(k+1\) polynomial coefficients and corresponds to predicting \({\bf w}(t)\) by its Taylor series expansion around \(t_{0}\). A more satisfactory approach is to determine \({\bf w}^{\rm poly}(t)\) from the values taken by \({\bf w}\), \(\dot{\bf w}\), \(\ddot{\bf w}\), etc., at both \(t_{0}\) and \(t_{1}\). Specifically, for even \(k\) only, we make \({\bf w}^{\rm poly}(t)\) the \(k\)th-order polynomial that matches \({\bf w}\) at \(t_{0}\) and its first \(\frac{1}{2}k\) time derivatives at both \(t_{0}\) and \(t_{1}\)--once again this provides \(1+2\times\frac{1}{2}k=k+1\) constraints and hence determines the \(k+1\) coefficients of the interpolating polynomial. The first few integrators of this type are

\[{\bf w}_{1}={\bf w}_{0}+\cases{{\frac{1}{2}h(\dot{\bf w}_{0}+\dot{\bf w}_{1}) }&($k=2$)\cr{\frac{1}{2}h(\dot{\bf w}_{0}+\dot{\bf w}_{1})+\frac{1}{12}h^{2}( \ddot{\bf w}_{0}-\ddot{\bf w}_{1})}&($k=4$)\cr{\frac{1}{2}h(\dot{\bf w}_{0}+ \dot{\bf w}_{1})+\frac{1}{10}h^{2}(\ddot{\bf w}_{0}-\ddot{\bf w}_{1})}&\cr \qquad\qquad\qquad+\frac{1}{120}h^{3}(\ddot{\bf w}_{0}+\ddot{\bf w}_{1})&($k= 6$).}\]

Like the Adams-Moulton integrator, all of these integrators are implicit, and in fact the first of these formulae is the same as the second-order Adams-Moulton integrator in equation (3.170). Because these integrators employ information from only \(t_{0}\) and \(t_{1}\), there are two significant simplifications compared to multistep integrators: no separate startup procedure is needed, and the formulae look the same even if the timestep is variable.

Multivalue integrators are sometimes called **Obreshkov** (or Obrechkoff) or **Hermite** integrators, the latter name arising because they are based on Hermite interpolation, which finds a polynomial that fits specified values of a function and its derivatives (Butcher 1987).

Makino & Aarseth (1992) and Makino (2001) recommend a fourth-order multivalue predictor-corrector integrator for star-cluster simulations. Their predictor is a single-step, second-order multivalue integrator, that is, a Taylor series including terms of order \(h^{2}\). Writing \({\rm d}{\bf v}/{\rm d}t={\bf g}\), where \({\bf g}\) is the gravitational field, their predicted velocity is

\[{\bf v}_{{\rm p},1}={\bf v}_{0}+h{\bf g}_{0}+{\frac{1}{2}}h^{2} \dot{\bf g}_{0}.\]

The predicted position is obtained by analytically integrating the interpolating polynomial for \({\bf v}\),

\[{\bf x}_{{\rm p},1}={\bf x}_{0}+h{\bf v}_{0}+{\frac{1}{2}}h^{2}{ \bf g}_{0}+{\frac{1}{6}}h^{3}\dot{\bf g}_{0}.\]

The predicted position and velocity are used to compute the gravitational field and its time derivative at time \(t_{1}\), \({\bf g}_{1}\) and \(\dot{\bf g}_{1}\). These are used to correct the velocity using the fourth-order formula (3.171):

\[{\bf v}_{1}={\bf v}_{0}+{\frac{1}{2}}h({\bf g}_{0}+{\bf g}_{1})+ {\frac{1}{12}}h^{2}(\dot{\bf g}_{0}-\dot{\bf g}_{1});\]in words, \({\bf v}_{1}\) is determined by the fourth-order interpolating polynomial \({\bf v}^{\rm poly}(t)\) that satisfies the five constraints \({\bf v}^{\rm poly}(t_{0})={\bf v}_{0}\), \(\dot{\bf v}^{\rm poly}(t_{i})={\bf g}_{i}\), \(\ddot{\bf v}^{\rm poly}(t_{i})=\dot{\bf g}_{i}\) for \(i=0,1\).

To compute the corrected position, the most accurate procedure is to integrate analytically the interpolating polynomial for \({\bf v}\), which yields:

\[{\bf x}_{1}={\bf x}_{0}+h{\bf v}_{0}+{{1\over 20}}h^{2}(7{\bf g}_{0}+3{\bf g }_{1})+{{1\over 60}}h^{3}(3\dot{\bf g}_{0}-2\dot{\bf g}_{1}). \tag{3.172d}\]

The performance of this integrator, often simply called the Hermite integrator, is illustrated in Figure 3.21.

#### 3.4.5 Adaptive timesteps

Except for the simplest problems, any integrator should have an **adaptive timestep**, that is, an automatic procedure that continually adjusts the timestep to achieve some target level of accuracy. Choosing the right timestep is one of the most challenging tasks in designing a numerical integration scheme. Many sophisticated procedures are described in publicly available integration packages and numerical analysis textbooks. Here we outline a simple approach.

Let us assume that our goal is that the error in \({\bf w}\) after some short time \(\tau\) should be less than \(\epsilon|{\bf w}_{0}|\), where \(\epsilon\ll 1\) and \({\bf w}_{0}\) is some reference phase-space position. We first move from \({\bf w}\) to \({\bf w}_{2}\) by taking two timesteps of length \(h\ll\tau\). Then we return to \({\bf w}\) and take one step of length \(2h\) to reach \({\bf w}_{1}\). Suppose that the correct position after an interval \(2h\) is \({\bf w}^{\prime}\), and that our integrator has order \(k\). Then the errors in \({\bf w}_{1}\) and \({\bf w}_{2}\) may be written

\[{\bf w}_{1}-{\bf w}^{\prime}\simeq(2h)^{k+1}{\bf E}\quad;\quad{\bf w}_{2}-{ \bf w}^{\prime}\simeq 2h^{k+1}{\bf E}, \tag{3.173}\]

where \({\bf E}\) is an unknown error vector. Subtracting these equations to eliminate \({\bf w}^{\prime}\), we find \({\bf E}\simeq({\bf w}_{1}-{\bf w}_{2})/[2(2^{k}-1)h^{k+1}]\). Now if we advance for a time \(\tau\), using \(n\equiv\tau/h^{\prime}\) timesteps of length \(h^{\prime}\), the error will be

\[{\bf\Delta}={nh^{\prime}}^{k+1}{\bf E}=({\bf w}_{1}-{\bf w}_{2}){\tau h^{ \prime}}^{k}\over 2(2^{k}-1)h^{k+1}}. \tag{3.174}\]

Our goal that will be satisfied if

\[h^{\prime}<h_{\rm max}\equiv\left(2(2^{k}-1){h\over\tau}{\epsilon|{\bf w}_{0} |\over|{\bf w}_{1}-{\bf w}_{2}|}\right)^{1/k}h. \tag{3.175}\]

If we are using a predictor-corrector scheme, a similar analysis can be used to deduce \(h_{\rm max}\) from the difference of the phase-space positions returned by the predictor and the corrector, without repeating the entire predictor-corrector sequence.

#### 3.4.6 Individual timesteps

The density in many stellar systems varies by several orders of magnitude between the center and the outer parts, and as a result the crossing time of orbits near the center is much smaller than the crossing time in the outer envelope. For example, in a typical globular cluster the crossing time at the center is Myr, while the crossing time near the tidal radius is \(\sim 100\,\)Myr. Consequently, the timestep that can be safely used to integrate the orbits of stars is much smaller at the center than the edge. It is extremely inefficient to integrate _all_ of the cluster stars with the shortest timestep needed for _any_ star, so integrators must allow individual timesteps for each star.

If the integrator employs an interpolating polynomial, the introduction of individual timesteps is in principle fairly straightforward. To advance a given particle, one uses the most recent interpolating polynomials of all the other particles to predict their locations at whatever times the integrator requires, and then evaluates the forces between the given particle and the other particles.

This procedure makes sense if the Poisson solver uses direct summation (SS2.9.1). However, with other Poisson solvers there is a much more efficient approach. Suppose, for example, that we are using a tree code (SS2.9.2). Then before a single force can be evaluated, _all_ particles have to be sorted into a tree. Once that has been done, it is comparatively inexpensive to evaluate large numbers of forces; hence to minimize the computational work done by the Poisson solver, it is important to evaluate the forces on many particles simultaneously. A **block timestep** scheme makes this possible whilst allowing different timesteps for different particles, by quantizing the timesteps. We now describe how one version of this scheme works with the leapfrog integrator.

We assign each particle to one of \(K+1\) classes, such that particles in class \(k\) are to be advanced with timestep \(h_{k}\equiv 2^{k}h\) for \(k=0,1,2,\ldots,K\). Thus \(h\) is the shortest timestep (class 0) and \(2^{K}h\) is the longest (class \(K\)). The Poisson solver is used to evaluate the gravitational field at the initial time \(t_{0}\), and each particle is kicked by the impulse \(-\frac{1}{2}h_{k}\mathbf{\nabla}\Phi\), corresponding to the first part of the kick-drift-kick leapfrog step (3.166b). In Figure 3.22 the filled semicircles on the left edge of the diagram symbolize these kicks; they are larger at the top of the diagram to indicate that the strength of the kicks increases as \(2^{k}\). Then every particle is drifted through time \(h\), and the Poisson solver is used only to find the forces on the particles in class 0, so these particles can be kicked by \(-h\mathbf{\nabla}\Phi\), which is the sum of the kicks at the end of their first leapfrog step and the start of their second.

Next we drift all particles through \(h\) a second time, and use the Poisson solver to find the forces on the particles in both class 0 and class 1. The particles of class 0 are kicked by \(-h\mathbf{\nabla}\Phi\), and the particles of class 1 are kicked by \(-h_{1}\mathbf{\nabla}\Phi=-2h\mathbf{\nabla}\Phi\). After an interval \(3h\) the particles in class 0 are kicked, after \(4h\) the particles in classes 0, 1 and 2 are kicked, etc. Thisprocess continues until all particles are due for a kick, after a time \(h_{\rm K}=2^{K}h\). The final kick for particles in class \(k\) is \(-\frac{1}{2}h_{k}\mathbf{\nabla}\Phi\), which completes \(2^{K-k}\) leapfrog steps for each particle. At this point it is prudent to reconsider how the particles are assigned to classes in case some need smaller or larger timesteps.

A slightly different block timestep scheme works well with a particle-mesh Poisson solver (SS2.9.3) when parts of the computational domain are covered by finer meshes than others, with each level of refinement being by a factor of two in the number of mesh points per unit length (Knebe, Green, & Binney 2001). Then particles are assigned timesteps according to the fineness of the mesh they are in: particles in the finest mesh have timestep \(\Delta t=h\), while particles in the next coarser mesh have \(\Delta t=2h\), and so on. Particles on the finest mesh are drifted through time \(\frac{1}{2}h\) before the density is determined on this mesh, and the Poisson solver is invoked to determine the forces on this mesh. Then the particles on this mesh are kicked through time \(h\) and drifted through time \(\frac{1}{2}h\). Then the same drift-kick-drift sequence is used to advance particles on the next coarser mesh through time \(2h\). Now these particles are ahead in time of the particles on the finest mesh. This situation is remedied by again advancing the particles on the finest mesh by \(h\) with the drift-kick-drift sequence. Once the particles on the two finest

Figure 3.22: Schematic of the block timestep scheme, for a system with 5 classes of particles, having timestep \(h\) (class \(k=0\)), \(2h,\ldots,16h\) (class \(k=K=4\)). The particles are integrated for a total time of \(16h\). Each filled circle or half-circle marks the time at which particles in a given class are kicked. Each vertical bar marks a time at which particles in a class are paused in their drift step, without being kicked, in order to calculate their contribution to the kick given to particles in lower classes. The kicks at the start and end of the integration, \(t=0\) and \(t=16h\), are half as strong as the other kicks, and so are denoted by half-circles.

meshes have been advanced through time \(2h\), we are ready to advance by \(\Delta t=4h\) the particles that are the next coarser mesh, followed by a repeat of the operations that were used to advance the particles on the two finest meshes by \(2h\). The key point about this algorithm is that at each level \(k\), particles are first advanced ahead of particles on the next coarser mesh, and then the latter particles jump ahead of the particles on level \(k\) so the next time the particles on level \(k\) are advanced, they are catching up with the particles of the coarser mesh. Errors arising from moving particles in a gravitational field from the surroundings that is out-of-date are substantially canceled by errors arising from moving particles in an ambient field that has run ahead of itself.

##### 3.4.7 Regularization

In any simulation of a star cluster, sooner or later two particles will suffer an encounter having a very small impact parameter. In the limiting case in which the impact parameter is exactly zero (a **collision orbit**), the equation of motion for the distance \(r\) between the two particles is (eq. D.33)

\[\ddot{r}=-GM/r^{2}, \tag{3.176}\]

where \(M\) is the sum of the masses of the two particles. This equation is singular at \(r=0\), and a conscientious integrator will attempt to deal with the singularity by taking smaller and smaller timesteps as \(r\) diminishes, thereby bringing the entire N-body integration grinding to a halt. Even in a near-collision orbit, the integration through pericenter will be painfully slow. This problem is circumvented by transforming to a coordinate system in which the two-body problem has no singularity--this procedure is called **regularization**(Stiefel & Schiefele, 1971; Mikkola, 1997; Heggie & Hut, 2003; Aarseth, 2003). Standard integrators can then be used to solve the equations of motion in the regularized coordinates.

**(a) Burdet-Heggie regularization** The simplest approach to regularization is time transformation. We write the equations of motion for the two-body problem as

\[\ddot{\mathbf{r}}=-GM\frac{\mathbf{r}}{r^{3}}+\mathbf{g}, \tag{3.177}\]

where \(\mathbf{g}\) is the gravitational field from the other \(N-2\) bodies in the simulation, and change to a fictitious time \(\tau\) that is defined by

\[\mathrm{d}t=r\,\mathrm{d}\tau. \tag{3.178}\]

Denoting derivatives with respect to \(\tau\) by a prime we find

\[\dot{\mathbf{r}}=\frac{\mathrm{d}\tau}{\mathrm{d}t}\frac{\mathrm{d}\mathbf{r} }{\mathrm{d}\tau}=\frac{1}{r}\mathbf{r}^{\prime}\quad;\quad\ddot{\mathbf{r}}= \frac{\mathrm{d}\tau}{\mathrm{d}t}\frac{\mathrm{d}}{\mathrm{d}\tau}\frac{1}{r }\mathbf{r}^{\prime}=\frac{1}{r^{2}}\mathbf{r}^{\prime\prime}-\frac{r^{ \prime}}{r^{3}}\mathbf{r}^{\prime}. \tag{3.179}\]Substituting these results into the equation of motion, we obtain

\[{\bf r}^{\prime\prime}=\frac{r^{\prime}}{r}{\bf r}^{\prime}-GM\frac{{\bf r}}{r}+r^ {2}{\bf g}. \tag{3.180}\]

The eccentricity vector \({\bf e}\) (eq. 4 of Box 3.2) helps us to simplify this equation. We have

\[\begin{array}{l}{\bf e}={\bf v}\times({\bf r}\times{\bf v})-GM\hat{{\bf e}}_ {r}\\ \\ =|{\bf r}^{\prime}|^{2}\frac{{\bf r}}{r^{2}}-\frac{r^{\prime}}{r}{\bf r}^{ \prime}-GM\frac{{\bf r}}{r},\end{array} \tag{3.181}\]

where we have used \({\bf v}=\dot{{\bf r}}={\bf r}^{\prime}/r\) and the vector identity (B.9). Thus equation (3.180) can be written

\[{\bf r}^{\prime\prime}=|{\bf r}^{\prime}|^{2}\frac{{\bf r}}{r^{2}}-2GM\frac{{ \bf r}}{r}-{\bf e}+r^{2}{\bf g}. \tag{3.182}\]

Figure 3.23: Fractional energy error from integrating one pericenter passage of a highly eccentric orbit in a Keplerian potential, as a function of the number of force evaluations. The orbit has semi-major axis \(a=1\) and eccentricity \(e=0.99\), and is integrated from \(r=1,\dot{r}<0\) to \(r=1,\dot{r}>0\). Curves labeled by “RK” are followed using a fourth-order Runge–Kutta integrator (3.168) with adaptive timestep control as described by Press et al. (1986). The curve labeled “U” for “unregularized” is integrated in Cartesian coordinates, the curve “BH” uses Burdet–Heggie regularization, and the curve “KS” uses Kustaanheimo–Stiefel regularization. The curve labeled “U,LF” is followed in Cartesian coordinates using a leapfrog integrator with timestep proportional to radius (eq. 3.167). The horizontal axis is the number of force evaluations used in the integration.

The energy of the two-body orbit is

\[E_{2}={{1\over 2}}v^{2}-{GM\over r}={|{\bf r}^{\prime}|^{2}\over 2r^{2}}-{GM\over r},\]

so we arrive at the regularized equation of motion

\[{\bf r}^{\prime\prime}-2E_{2}{\bf r}=-{\bf e}+r^{2}{\bf g},\]

in which the singularity at the origin has disappeared. This must be supplemented by equations for the rates of change of \(E_{2}\), \({\bf e}\), and \(t\) with fictitious time \(\tau\),

\[E_{2}^{\prime}={\bf g}\cdot{\bf r}^{\prime}\quad;\quad{\bf e}^{\prime}=2{\bf r }({\bf r}^{\prime}\cdot{\bf g})-{\bf r}^{\prime}({\bf r}\cdot{\bf g})-{\bf g}( {\bf r}\cdot{\bf r}^{\prime})\quad;\quad t^{\prime}=r.\]

When the external field \({\bf g}\) vanishes, the energy \(E_{2}\) and eccentricity vector \({\bf e}\) are constants, the equation of motion (3.184) is that of a harmonic oscillator that is subject to a constant force \(-{\bf e}\), and the fictitious time \(\tau\) is proportional to the eccentric anomaly (Problem 3.29).

Figure 3.23 shows the fractional energy error that arises in the integration of one pericenter passage of an orbit in a Kepler potential with eccentricity \(e=0.99\). The error is plotted as a function of the number of force evaluations; this is the correct economic model if force evaluations dominate the computational cost, as is true for N-body integrations with \(N\gg 1\). Note that even with \(\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$>$}}1000\) force evaluations per orbit, a fourth-order Runge-Kutta integrator with adaptive timestep is sometimes unable to follow the orbit. Using the same integrator, Burdet-Heggie regularization reduces the energy error by almost five orders of magnitude.

This figure also shows the energy error that arises when integrating the same orbit using leapfrog with adaptive timestep (eq. 3.167) in unregularized coordinates. Even though leapfrog is only second-order, it achieves an accuracy that substantially exceeds that of the fourth-order Runge-Kutta integrator in unregularized coordinates, and approaches the accuracy of Burdet-Heggie regularization. Thus a time-symmetric leapfrog integrator provides much of the advantage of regularization without coordinate or time transformations.

**(b) Kustaanheimo-Stiefel (KS) regularization** An alternative regularization procedure, which involves the transformation of the coordinates in addition to time, can be derived using the symmetry group of the Kepler problem, the theory of quaternions and spinors, or several other methods (Stiefel & Schiefele 1971; Yoshida 1982; Heggie & Hut 2003). Once again we use the fictitious time \(\tau\) defined by equation (3.178). We also define a four-vector \({\bf u}=(u_{1},u_{2},u_{3},u_{4})\) that is related to the position \({\bf r}=(x,y,z)\) by

\[\eqalign{u_{1}^{2}={{1\over 2}}(x+r)\cos^{2}\psi\qquad\quad u_{2}={yu_{1}+zu_{4} \over x+r}\cr u_{4}^{2}={{1\over 2}}(x+r)\sin^{2}\psi\qquad\quad u_{3}={zu_{1}-yu_{4} \over x+r},\cr}\]where \(\psi\) is an arbitrary parameter. The inverse relations are

\[x=u_{1}^{2}-u_{2}^{2}-u_{3}^{2}+u_{4}^{2}\ ;\ y=2(u_{1}u_{2}-u_{3}u_{4})\ ;\ z=2(u_{1}u_{3}+u_{2}u_{4}). \tag{3.187}\]

Note that \(r=u_{1}^{2}+u_{2}^{2}+u_{3}^{2}+u_{4}^{2}\). Let \(\Phi_{\rm e}\) be the potential that generates the external field \({\bf g}=-\mathbf{\nabla}\Phi_{\rm e}\). Then in terms of the new variables the equation of motion (3.177) reads

\[{\bf u}^{\prime\prime}-{{1\over 2}}E{\bf u} =-{{1\over 4}}{\partial\over\partial{\bf u}}\left(|{\bf u }|^{2}\Phi_{\rm e}\right),\] \[E ={{1\over 2}}v^{2}-{GM\over r}+\Phi_{\rm e} =2{|{\bf u}^{\prime}|^{2}\over|{\bf u}|^{2}}-{GM\over|{\bf u}|^{2}}+ \Phi_{\rm e}, \tag{3.188}\] \[E^{\prime} =|{\bf u}|^{2}{\partial\Phi_{\rm e}\over\partial t}\qquad;\qquad t ^{\prime}=|{\bf u}|^{2},\]

When the external force vanishes, the first of equations (3.188) is the equation of motion for a four-dimensional harmonic oscillator.

Figure 3.23 shows the fractional energy error that arises in the integration of an orbit with eccentricity \(e=0.99\) using KS regularization. Using the same integrator, the energy error is more than an order of magnitude smaller than the error using Burdet-Heggie regularization.

### 3.5 Angle-action variables

In SS3.1 we introduced the concept of an integral of motion and we saw that every spherical potential admitted at least four integrals \(I_{i}\), namely, the Hamiltonian and the three components of angular momentum. Later we found that orbits in flattened axisymmetric potentials frequently admit three integrals, the classical integrals \(H\) and \(p_{\phi}\), and the non-classical third integral. Finally in SS3.3 we found that many orbits in planar non-axisymmetric potentials admitted a non-classical integral in addition to the Hamiltonian.

In this section we explore the advantages of using integrals as coordinates for phase space. Since elementary Newtonian or Lagrangian mechanics restricts our choice of coordinates to ones that are rarely integrals, we work in the more general framework of Hamiltonian mechanics (Appendix D). For definiteness, we shall assume that there are three independent coordinates (so phase space is six-dimensional) and that we have three analytic isolating integrals \(I_{i}({\bf x},{\bf v})\). We shall focus on a particular set of canonical coordinates, called **angle-action** variables; the three momenta are integrals, called "actions," and the conjugate coordinates are called "angles." An orbit fortunate enough to possess angle-action variables is called a **regular orbit**.

We start with a number of general results that apply to any system of angle-action variables. Then in a series of subsections we obtain explicit expressions for these variables in terms of ordinary phase-space coordinates for spherical potentials, flattened axisymmetric potentials and planar, non-axisymmetric potentials. The section ends with a description of how actions enable us to solve problems in which the gravitational potential evolves slowly.

Angle-action variables cannot be defined for many potentials of practical importance for galactic dynamics. Nonetheless, the conceptual framework of angle-action variables proves extremely useful for understanding the complex phenomena that arise in potentials that do not admit them.

The discussion below is heuristic and non-rigorous; for a precise and elegant account see Arnold (1989).

#### 3.5.1 Orbital tori

Let us denote the angle-action variables by \((\boldsymbol{\theta},\mathbf{J})\). We assume that the momenta \(\mathbf{J}=(J_{1},J_{2},J_{3})\) are integrals of motion. Then Hamilton's equations (D.54) for the motion of the \(J_{i}\) read

\[0=\dot{J_{i}}=-\frac{\partial H}{\partial\theta_{i}}. \tag{3.189}\]

Therefore, the Hamiltonian must be independent of the coordinates \(\boldsymbol{\theta}\), that is \(H=H(\mathbf{J})\). Consequently, we can trivially solve Hamilton's equations for the \(\theta_{i}\) as functions of time:

\[\dot{\theta}_{i}=\frac{\partial H}{\partial J_{i}}\equiv\Omega_{i}(\mathbf{J} ),\quad\text{a constant}\quad\Rightarrow\quad\theta_{i}(t)=\theta_{i}(0)+ \Omega_{i}t. \tag{3.190}\]

So everything lies at our feet if we can install three integrals of motion as the momenta of a system of canonical coordinates.13

Footnote 13: To be able to use the \(J_{i}\) as a set of momenta, they must satisfy the canonical commutation relations (D.71), so we require \([J_{i},J_{j}]=0\); functions satisfying this condition are said to be **in involution**. For example, the components of angular momenta are not in involution: \([L_{x},L_{y}]=L_{z}\), etc.

We restrict our attention to bound orbits. In this case, the Cartesian coordinates \(x_{i}\) cannot increase without limit as the \(\theta_{i}\) do (eq. 3.190). From this we infer that the \(x_{i}\) are periodic functions of the \(\theta_{i}\). We can scale \(\theta_{i}\) so that \(\mathbf{x}\) returns to its original value after \(\theta_{i}\) has increased by \(2\pi\). Then we can expand \(\mathbf{x}\) in a Fourier series (Appendix B.4)

\[\mathbf{x}(\boldsymbol{\theta},\mathbf{J})=\sum_{\mathbf{n}}\mathbf{X}_{ \mathbf{n}}(\mathbf{J})\mathrm{e}^{\mathbf{i}\mathbf{n}\cdot\boldsymbol{\theta }}, \tag{3.191}\]

where the sum is over all vectors \(\mathbf{n}\) with integer components. When we eliminate the \(\theta_{i}\) using equation (3.190), we find that the spatial coordinates are 

### 3.5 Angle-action variables

Fourier series in time, in which every frequency is a sum of integer multiples of the three **fundamental frequencies**\(\Omega_{i}({\bf J})\) that are defined by equation (3.190). Such a time series is said to be **conditionally periodic** or **quasiperiodic**.14 For example, in spherical potentials (SS3.1) the periods \(T_{r}\) and \(T_{\psi}\) are inverses of such fundamental frequencies: \(T_{i}=2\pi/\Omega_{i}\). The third fundamental frequency is zero because the orbital plane is fixed in space--see SS3.5.2.

Footnote 14: Observers of binary stars use the term quasiperiod more loosely. Our usage is equivalent to what is meant by a quasicrystal: a structure whose Fourier transform is discrete, but in which there are more fundamental frequencies than independent variables (in our case one, \(t\), in a quasicrystal three \(x,y,z\)).

An orbit is said to be **resonant** when its fundamental frequencies satisfy a relation of the form \({\bf n}\cdot{\bf\Omega}=0\) for some integer triple \({\bf n}\neq{\bf 0}\). Usually this implies that two of the frequencies are commensurable, that is the ratio \(\Omega_{i}/\Omega_{j}\) is a rational number \((-n_{j}/n_{i})\).

Consider the three-surface (i.e., volume) of fixed \({\bf J}\) and varying \(\theta\). This is a cube of side-length \(2\pi\), and points on opposite sides must be identified since we have seen that incrementing, say, \(\theta_{1}\) by \(2\pi\) while leaving \(\theta_{2},\theta_{3}\) fixed brings one back to the same point in phase space. A cube with faces identified in this way is called a three-torus by analogy with the connection between a rectangle and a two-torus: if we sew together opposite edges of a rectangular sheet of rubber, we generate the doughnut-shaped inner tube of a bicycle tire.

We shall find that these three-tori are in many respects identical with orbits, so it is important to have a good scheme for labeling them. The best set of labels proves to be the Poincare invariants (Appendix D.4.2)

\[J^{\prime}_{i}\equiv\frac{1}{2\pi}\int\!\!\int{\rm d}{\bf q}\cdot{\rm d}{\bf p }=\frac{1}{2\pi}\int\!\!\int\sum_{j=1,3}{\rm d}q_{j}{\rm d}p_{j}, \tag{3.192}\]

where the integral is over any surface that is bounded by the path \(\gamma_{i}\) on which \(\theta_{i}\) increases from \(0\) to \(2\pi\) while everything else is held constant (Figure 3.24). Since angle-action variables are canonical, \({\rm d}{\bf q}\cdot{\rm d}{\bf p}={\rm d}{\bf\theta}\cdot{\rm d}{\bf J}\) (eq. D.84), so

\[J^{\prime}_{i}=\frac{1}{2\pi}\int\!\!\int_{\rm interior\ of\ \gamma_{i}}{\rm d}{\bf \theta}\cdot{\rm d}{\bf J}=\frac{1}{2\pi}\int\!\!\int_{\rm interior\ of\ \gamma_{i}}{\rm d}\theta_{i}{\rm d}J_{i}. \tag{3.193}\]

Figure 3.24: Two closed paths on a torus that cannot be deformed into one another, nor contracted to single points.

**Box 3.4: Angle-action variables as polar coordinates**

The figure shows the intersection with a coordinate plane of some of the nested orbital tori of a two-dimensional harmonic oscillator. The coordinates \(q_{i},p_{i}\) have been scaled such that the tori appear as circles. The values of the action \(J_{i}\) on successive tori are chosen to be \(0,1,2\ldots\) (in some suitable units), so, by equation (3.192), the areas inside successive tori are \(0\), \(2\pi\), \(4\pi,\ldots\). Hence, the radii \(r=(q_{i}^{2}+p_{i}^{2})^{1/2}\) of successive circles are \(\surd 2\times(0,1,\surd 2,\surd 3,\ldots)\). In general the radius of

the circle associated with the torus on which \(J_{i}\) takes the value \(J^{\prime}\) is

\(r=\surd 2J^{\prime}\). In this plane, the angle variable \(\theta_{i}\) is closely analogous to the usual azimuthal angle. Hence, angle-action variables are closely analogous to plane polar coordinates, the major difference being that coordinate circles are labeled not by radius but by \(\surd 2\) times the area they enclose. The generating function for the transformation

from \((\theta_{i},J_{i})\) to \((q_{i},p_{i})\) is given in

Problem 3.31.

As Box 3.4 explains, angle-action variables are a kind of polar coordinates for phase space, and have a coordinate singularity within the domain of integration. We must exclude this from the domain of integration before we use Green's theorem to convert the surface integral in (3.193) into a line integral. The value of our surface integral is unchanged by excluding this point, but when we use Green's theorem (eq. B.61) on the original domain less the excluded point, we obtain two line integrals, one along the curve \(\gamma_{i}\) and one along the boundary that surrounds the excluded point--along this second boundary, \(J_{i}\) takes some definite value, \(J_{i}^{c}\), say, and \(\theta_{i}\) takes all values in the range \((0,2\pi)\). Thus we have

\[J_{i}^{\prime}=\frac{1}{2\pi}\bigg{(}\oint_{\gamma_{i}}J_{i}\mathrm{d}\theta_{ i}-\oint_{J_{i}=J_{i}^{c}}J_{i}\mathrm{d}\theta_{i}\bigg{)}=J_{i}-J_{i}^{c}. \tag{3.194}\]

This equation shows that the label \(J_{i}^{\prime}\) defined by equation (3.192) will be identical with our original action coordinate \(J_{i}\) providing we set \(J_{i}=0\) at the coordinate singularity that marks the center of the angle-action coordinate system. We shall henceforth assume that this choice has been made.

In practical applications we often evaluate the integral of equation (3.192) using phase-space coordinates that have no singularity within thedomain of integration. Then we can replace the surface integral with a line integral that is easier to evaluate:

\[J_{i}=\frac{1}{2\pi}\oint_{\gamma_{i}}{\bf p}\cdot{\rm d}{\bf q}. \tag{3.195}\]

**(a) Time averages theorem** In Chapter 4 we shall make extensive use a result that we can now prove.

**Time averages theorem**_When a regular orbit is non-resonant, the average time that the phase point of a star on that orbit spends in any region \(D\) of its torus is proportional to the integral \(V(D)=\int_{D}{\rm d}^{3}\mathbf{\theta}\)._

_Proof_: Let \(f_{D}\) be the function such that \(f_{D}(\mathbf{\theta})=1\) when the point \(\theta\) lies in \(D\), and is zero otherwise. We may expand \(f_{D}\) in a Fourier series (cf. eq. 3.191)

\[f_{D}(\mathbf{\theta})=\sum_{{\bf n}=-\infty}^{\infty}F_{{\bf n}}\exp ({\rm i}{\bf n}\cdot\mathbf{\theta}). \tag{3.196}\]

Now

\[\int_{\rm torus}\!\!{\rm d}^{3}\mathbf{\theta}\,f_{D}(\mathbf{\theta})=\int_{D}{\rm d}^{3}\mathbf{\theta}=V(D). \tag{3.197a}\]

With equation (3.196) we therefore have

\[V(D)=\int_{\rm torus}\!\!{\rm d}^{3}\mathbf{\theta}\,f_{D}(\mathbf{\theta})=\sum_{{\bf n}=-\infty}^{\infty}F_{{\bf n}}\prod_{k=1}^{3} \int_{0}^{2\pi}{\rm d}\psi\,\exp({\rm i}n_{k}\psi)=(2\pi)^{3}F_{{\bf 0}}. \tag{3.197b}\]

On the other hand, the fraction of the interval \((0,T)\) during which the star's phase point lies in \(D\) is

\[\tau_{T}(D)=\frac{1}{T}\int_{0}^{T}{\rm d}t\,f_{D}[\mathbf{\theta}(t)], \tag{3.198}\]

where \(\mathbf{\theta}(t)\) is the position of the star's phase point at time \(t\). With equations (3.190) and (3.196), equation (3.198) becomes

\[\begin{split}\tau_{T}(D)&=\frac{1}{T}\sum_{{\bf n}} {\rm e}^{{\rm i}{\bf n}\cdot\mathbf{\theta}(0)}\int_{0}^{T}{\rm d}t \,F_{{\bf n}}{\rm e}^{{\rm i}({\bf n}\cdot\mathbf{\Omega})t}\\ &=F_{{\bf 0}}+\frac{1}{T}\sum_{{\bf n}\neq 0}{\rm e}^{{\rm i}{\bf n} \cdot\mathbf{\theta}(0)}F_{{\bf n}}\frac{{\rm e}^{{\rm i}({\bf n} \cdot\mathbf{\Omega})T}-1}{{\rm i}{\bf n}\cdot\mathbf{ \Omega}}.\end{split} \tag{3.199}\]

Thus

\[\lim_{T\to\infty}\tau_{T}(D)=F_{{\bf 0}}=\frac{V(D)}{(2\pi)^{3}}, \tag{3.200}\]which completes the proof.\(\triangleleft\)

Note that if the orbit is resonant, \({\bf n}\cdot{\bf\Omega}\) vanishes for some \({\bf n}\neq 0\) and the second equality in (3.199) becomes invalid, so the theorem cannot be proved. In fact, if \(\Omega_{i}:\Omega_{j}=m:n\), say, then by equations (3.190) \(I_{4}\equiv n\theta_{i}-m\theta_{j}\) becomes an isolating integral that confines the star to a spiral on the torus. We shall see below that motion in a spherical potential provides an important example of this phenomenon.

**(b) Action space**  In Chapter 4 we shall develop the idea that galaxies are made up of orbits, and we shall find it helpful to think of whole orbits as single points in an abstract space. Any isolating integrals can serve as coordinates for such a representation, but the most advantageous coordinates are the actions. We define **action space** to be the imaginary space whose Cartesian coordinates are the actions. Figure 3.25 shows the action space of an axisymmetric potential, when the actions can be taken to be generalizations of the actions for spherical potentials listed in Table 3.1 below. Points on the axes represent orbits for which only one of the integrals (3.192) is non-zero. These are the closed orbits. The origin represents the orbit of a star that just sits at the center of the potential. In each octant, surfaces of constant energy are approximate planes; by equation (3.190) the local normal to this surface is parallel to the vector \({\bf\Omega}\). Every point in the positive quadrant \(J_{r},J_{\theta}\geq 0\), all the way to infinity, represents a bound orbit.

A region \(R_{3}\) in action space represents a group of orbits. Let the volume of \(R_{3}\) be \(V_{3}\). The volume of six-dimensional phase space occupied by the orbits is

\[V_{6}=\int_{R_{6}}{\rm d}^{3}{\bf x}\,{\rm d}^{3}{\bf v}, \tag{3.201}\]

Figure 3.25: The action space of an axisymmetric potential. Two constant-energy surfaces are shown for the spherical isochrone potential (2.47). The surfaces \(H=-0.5(GM/2b)\) and \(H=-0.03(GM/2b)\) are shown (eq. 3.226) with the axes all scaled to length \(5\sqrt{GMb}\).

where \(R_{6}\) is the region of phase space visited by stars on the orbits of \(R_{3}\). Since the coordinate set \(({\bf J},{\mathbf{\theta}})\) is canonical, \({\rm d}^{3}{\bf x}{\rm d}^{3}{\bf v}={\rm d}^{3}{\bf J}{\rm d}^{3}{\mathbf{\theta}}\) (see eq. D.81) and thus

\[V_{6}=\int_{R_{6}}{\rm d}^{3}{\bf J}{\rm d}^{3}{\mathbf{\theta}}. \tag{3.202}\]

But for any orbit the angle variables cover the range \((0,2\pi)\), so we may immediately integrate over the angles to find

\[V_{6}=(2\pi)^{3}\int_{R_{3}}{\rm d}^{3}{\bf J}=(2\pi)^{3}V_{3}. \tag{3.203}\]

Thus the volume of a region of action space is directly proportional to the volume of phase space occupied by its orbits.

**(c) Hamilton-Jacobi equation** The transformation between any two sets of canonical coordinates can be effected with a generating function (Appendix D.4.6). Let \(S({\bf q},{\bf J})\) be the (unknown) generating function of the transformation between angle-action variables and ordinary phase space coordinates \(({\bf q},{\bf p})\) such as \({\bf q}={\bf x}\), \({\bf p}={\bf v}\). Then (eq. D.93)

\[{\mathbf{\theta}}=\frac{\partial S}{\partial{\bf J}}\quad;\quad{\bf p }=\frac{\partial S}{\partial{\bf q}}, \tag{3.204}\]

where \({\bf p}\) and \(\theta\) are now to be considered functions of \({\bf q}\) and \({\bf J}\). We can use \(S({\bf q},{\bf J})\) to eliminate \({\bf p}\) from the usual Hamiltonian function \(H({\bf q},{\bf p})\) and thus express \(H\) as a function

\[H\Big{(}{\bf q},\frac{\partial S}{\partial{\bf q}}({\bf q},{\bf J})\Big{)}.\]

of \(({\bf q},{\bf J})\). By moving along an orbit, we can vary the \(q_{i}\) while holding constant the \(J_{i}\). As we vary the \(q_{i}\) in this way, \(H\) must remain constant at the energy \(E\) of the orbit in question. This suggests that we investigate the partial differential equation

\[H\Big{(}{\bf q},\frac{\partial S}{\partial{\bf q}}\Big{)}=E\quad\mbox{at fixed ${\bf J}$}. \tag{3.205}\]

If we can solve this **Hamilton-Jacobi equation**, our solution should contain some arbitrary constants \(K_{i}\)--we shall see below that we usually solve the equation by the method of separation of variables (e.g., SS2.4) and the constants are separation constants. We identify the \(K_{i}\) with functions of the actions as follows. Eliminating \({\bf p}\) from equation (3.195) we have

\[J_{i}=\frac{1}{2\pi}\oint_{\gamma_{i}}\frac{\partial S}{\partial{\bf q}}\cdot {\rm d}{\bf q}=\frac{\Delta S({\bf K})}{2\pi}. \tag{3.206}\]This equation states that \(J_{i}\) is proportional to the increment in the generating function when one passes once around the torus on the \(i\)th path--\(S\), like the magnetic scalar potential around a current-carrying wire, is a multivalued function. The increment in \(S\), and therefore \(J_{i}\), depends on the integration constants that appear in \(S\), so these are functions of the actions.

Once the Hamilton-Jacobi equation has been solved and the integrals in (3.206) have been evaluated, \(S\) becomes a known function \(S({\bf q},{\bf J})\) and we can henceforth use equations (3.204) to transform between angle-action variables and ordinary phase-space coordinates. In particular, we can integrate orbits trivially by transforming the initial conditions into angle-action variables, incrementing the angles, and transforming back to ordinary phase-space coordinates.

Let us see how this process works in a simple example. The Hamiltonian of a two-dimensional harmonic oscillator is

\[H({\bf x},{\bf p})={{1\over 2}}(p_{x}^{2}+p_{y}^{2}+\omega_{x}^{2}x^{2}+ \omega_{y}^{2}y^{2}). \tag{3.207}\]

Substituting in \(p_{x}=\partial S/\partial x\), \(p_{y}=\partial S/\partial y\) (eq. 3.204), the Hamilton-Jacobi equation reads

\[\Big{(}{\partial S\over\partial x}\Big{)}^{2}+\Big{(}{\partial S\over\partial y }\Big{)}^{2}+\omega_{x}^{2}x^{2}+\omega_{y}^{2}y^{2}=2E, \tag{3.208}\]

where \(S\) is a function of \(x,y\) and \({\bf J}\). We solve this partial differential equation by the method of separation of variables.15 We write \(S(x,y,{\bf J})=S_{x}(x,{\bf J})+S_{y}(y,{\bf J})\) and rearrange the equation to

Footnote 15: When this method is applied in quantum mechanics and in potential theory (e.g., §2.4) one usually assumes that the dependent variable is a _product_ of functions of one variable, rather than a sum of such functions as here.

\[\Big{(}{\partial S_{x}\over\partial x}\Big{)}^{2}+\omega_{x}^{2}x^{2}=2E- \Big{(}{\partial S_{y}\over\partial y}\Big{)}^{2}-\omega_{y}^{2}y^{2}. \tag{3.209}\]

The left side does not depend on \(y\) and the right side does not depend on \(x\). Consequently, each side can only be a function of \({\bf J}\), which we call \(K^{2}({\bf J})\) because it is evidently non-negative:

\[K^{2}\equiv\Big{(}{\partial S_{x}\over\partial x}\Big{)}^{2}+\omega_{x}^{2}x^ {2}. \tag{3.210}\]

It follows that

\[S_{x}(x,{\bf J})=K\int^{x}{\rm d}x^{\prime}\;\epsilon\sqrt{1-{\omega_{x}^{2}x ^{\prime 2}\over K^{2}}},\]where \(\epsilon\) is chosen to be \(\pm 1\) so that \(S_{x}(x,{\bf J})\) increases continuously along a path over the orbital torus. Changing the variable of integration, we have

\[\eqalign{S_{x}(x,{\bf J})&={K^{2}\over\omega_{x}}\int{\rm d}\psi^{\prime}\,\sin^{ 2}\psi^{\prime}\quad{\rm where}\quad x=-{K\over\omega_{x}}\cos\psi\cr&={K^{2} \over 2\omega_{x}}\big{(}\psi-{{1\over 2}}\sin 2\psi\big{)}.}\]

Moreover, \(p_{x}=\partial S/\partial x=\epsilon K\sqrt{1-\omega_{x}^{2}x^{2}/K^{2}}=K\sin\psi\), so both \(x\) and \(p_{x}\) return to their old values when \(\psi\) is incremented by \(2\pi\). We infer that incrementing \(\psi\) by \(2\pi\) carries us around the path \(\gamma_{x}\) that is associated with \(J_{x}\) through equation (3.192). Thus equation (3.206) now yields

\[J_{x}={\Delta S\over 2\pi}={\Delta S_{x}\over 2\pi}.\]

Equation (3.211) tells us that when \(\psi\) is incremented by \(2\pi\), \(S_{x}\) increases by \(K^{2}\pi/\omega_{x}\). Hence,

\[J_{x}(x,p_{x})={K^{2}\over 2\omega_{x}}={p_{x}^{2}+\omega_{x}^{2}x^{2}\over 2 \omega_{x}},\]

where the last equality follows from (3.210) with \(\partial S_{x}/\partial x\) replaced by \(p_{x}\). The solution for \(J_{y}(y,p_{y})\) proceeds analogously and yields

\[J_{y}(y,p_{y})={2E-K^{2}\over 2\omega_{y}}={p_{y}^{2}+\omega_{y}^{2}y^{2}\over 2 \omega_{y}}.\]

Comparing with equation (3.207), we find that

\[H({\bf J})=\omega_{x}J_{x}+\omega_{y}J_{y}.\]

Notice from (3.215) that \(\Omega_{x}\equiv\partial H/\partial J_{x}=\omega_{x}\) and similarly for \(\Omega_{y}\).

Finally we determine the angle variables from the second of equations (3.204). The obvious procedure is to eliminate both \(K\) and \(\psi\) from equation (3.211) in favor of \(J_{x}\) and \(x\). In practice it is expedient to leave \(\psi\) in and treat it as a function of \(J_{x}\) and \(x\):

\[S_{x}(x,{\bf J})=J_{x}(\psi-{{1\over 2}}\sin 2\psi)\quad{\rm where} \quad\cos\psi=-\sqrt{{\omega_{x}\over 2J_{x}}}x,\]

so

\[\eqalign{\theta_{x}&={\partial S\over\partial J_{x}}=\psi-{{1\over 2}} \sin 2\psi+J_{x}(1-\cos 2\psi){\partial\psi\over\partial J_{x}}\cr&=\psi-{ {1\over 2}}\sin 2\psi+\sin^{2}\psi\cot\psi\cr&=\psi.}\]

Thus the variable \(\psi\) that we introduced for convenience in doing an integral is, in fact, the angle variable conjugate to \(J_{x}\). Problem 3.33 explains an alternative, and sometimes simpler, route to the angle variables.

#### 3.5.2 Angle-action variables for spherical potentials

We now derive angle-action variables for any spherical potential. These are useful not only for strictly spherical systems, but also for axisymmetric disks, and serve as the starting point for perturbative analyses of mildly aspherical potentials. To minimize confusion between ordinary spherical polar coordinates and angle variables, in this section we reserve \(\vartheta\) for the usual polar angle, and continue to use \(\theta_{i}\) for the variable conjugate to \(J_{i}\).

The Hamilton-Jacobi equation (3.205) for the potential \(\Phi(r)\) is

\[\eqalign{E&={{1\over 2}}|{\bf\nabla}S|^{2}+\Phi(r)\cr&={{1 \over 2}}\biggl{[}\Bigl{(}{\partial S\over\partial r}\Bigr{)}^{2}+\Bigl{(}{1 \over r}{\partial S\over\partial\vartheta}\Bigr{)}^{2}+\Bigl{(}{1\over r\sin \vartheta}{\partial S\over\partial\phi}\Bigr{)}^{2}\biggr{]}+\Phi(r),}\]

where we have used equation (B.38) for the gradient operator in spherical polar coordinates. We write the generating function as \(S({\bf x},{\bf J})=S_{r}(r,{\bf J})+S_{\vartheta}(\vartheta,{\bf J})+S_{ \phi}(\phi,{\bf J})\) and solve (3.218) by separation of variables. With the help of equation (3.204) we find

\[\eqalignno{L_{z}^{2}&=\biggl{(}{\partial S_{\phi}\over\partial\phi}\biggr{)}^{ 2}=p_{\phi}^{2},&(3.219{\rm a})\cr L^{2}-{L_{z}^{2}\over\sin^{2}\vartheta}&= \biggl{(}{\partial S_{\vartheta}\over\partial\vartheta}\biggr{)}^{2}=p_{ \phi}^{2},&(3.219{\rm b})\cr 2E-2\Phi(r)-{L^{2}\over r^{2}}&=\biggl{(}{\partial S_{r} \over\partial r}\biggr{)}^{2}=p_{r}^{2}.&(3.219{\rm c})}\]

Here we have introduced two separation constants, \(L\) and \(L_{z}\). We assume that \(L>0\) and choose the sign of \(L_{z}\) so that \(L_{z}=p_{\phi}\); with these conventions \(L\) and \(L_{z}\) prove to be the magnitude and \(z\)-component of the angular-momentum vector (Problem 3.20). Taking the square root of each equation and integrating, we obtain a formula for \(S\):

\[\eqalign{S({\bf x},{\bf J})=\int_{0}^{\phi}{\rm d}\phi\,L_{z}&+\int_{\pi/2}^{ \vartheta}\!{\rm d}\vartheta\,\epsilon_{\vartheta}\sqrt{L^{2}-{L_{z}^{2} \over\sin^{2}\vartheta}}\cr&+\int_{r_{\rm min}}^{r}\!{\rm d}r\,\epsilon_{r} \sqrt{2E-2\Phi(r)-{L^{2}\over r^{2}}},}\]

where \(\epsilon_{\vartheta}\) and \(\epsilon_{r}\) are chosen to be \(\pm 1\) such that the integrals in which they appear increase monotonically along a path over the orbital torus. The lower limits of these integrals specify some point on the orbital torus, and are arbitrary. It is convenient to take \(r_{\rm min}\) to be the orbit's pericenter radius.

To obtain the actions from equation (3.206) we have to evaluate the change in \(S\) as we go round the orbital torus along curves on which only oneof the coordinates is incremented. The case of changing \(\phi\) is easy: on the relevant curve, \(\phi\) increases by \(2\pi\), so (3.220) states that \(\Delta S=2\pi L_{z}\) and

\[J_{\phi}=L_{z}. \tag{3.221}\]

We call \(J_{\phi}\) the **azimuthal action**. Consider next the case of changing \(\vartheta\). Let \(\vartheta_{\rm min}\) be the smallest value that \(\vartheta\) attains on the orbit, given by

\[\sin\vartheta_{\rm min}=\frac{|L_{z}|}{L}, \tag{3.222}\]

\(\vartheta_{\rm min}\leq\pi/2\). Then we start at \(\pi/2\), where the integrand peaks, and integrate to \(\pi-\vartheta_{\rm min}\), where it vanishes. We have now integrated over a quarter period of the integrand, so the whole integral is four times the value from this leg,

\[J_{\vartheta}=\frac{2}{\pi}\int_{\pi/2}^{\pi-\vartheta_{\rm min}}{\rm d} \vartheta\,\sqrt{L^{2}-\frac{L_{z}^{2}}{\sin^{2}\vartheta}}=L-|L_{z}|. \tag{3.223}\]

We call \(J_{\vartheta}\) the **latitudinal action**. The evaluation of \(J_{r}\) from equations (3.206) and (3.220) proceeds similarly and yields

\[J_{r}=\frac{1}{\pi}\int_{r_{\rm min}}^{r_{\rm max}}{\rm d}r\,\sqrt{2E-2\Phi(r )-\frac{L^{2}}{r^{2}}}, \tag{3.224}\]

where \(r_{\rm max}\) is the radius of the apocenter--\(r_{\rm min}\) and \(r_{\rm max}\) are the two roots of the radical--and \(J_{r}\) is the **radial action**.

An important example is that of the isochrone potential (2.47), which encompasses both the Kepler and spherical harmonic potentials as limiting cases. One finds that (Problem 3.41)

\[J_{r}=\frac{GM}{\sqrt{-2E}}-\tfrac{1}{2}\left(L+\tfrac{1}{2}\sqrt{L^{2}-4GMb} \,\right). \tag{3.225}\]

If we rewrite this expression as an equation for the Hamiltonian \(H_{\rm I}=E\) as a function of the actions, we obtain

\[H_{\rm I}({\bf J})=-\frac{(GM)^{2}}{2\left[J_{r}+\tfrac{1}{2}\left(L+\sqrt{L^ {2}+4GMb}\,\right)\right]^{2}}\qquad(L=J_{\theta}+|J_{\phi}|).\] (3.226a) Differentiating this expression with respect to the actions, we find the frequencies (eq. 3.190): \[\begin{array}{l}\Omega_{r}=\frac{(GM)^{2}}{\left[J_{r}+\tfrac{1}{2}(L+ \sqrt{L^{2}+4GMb}\,)\right]^{3}}\\ \Omega_{\vartheta}=\tfrac{1}{2}\biggl{(}1+\frac{L}{\sqrt{L^{2}+4GMb}}\biggr{)} \Omega_{r}\quad;\quad\Omega_{\phi}={\rm sgn}(J_{\phi})\Omega_{\vartheta}.\end{array} \tag{3.226b}\]It is straightforward to check that these results are consistent with the radial and azimuthal periods determined in SS3.1c.16 In the limit \(b\to 0\), the isochrone potential becomes the Kepler potential and all three frequencies become equal. The corresponding results for the spherical harmonic oscillator are obtained by examining the limit \(b\to\infty\) (Problem 3.36).

Footnote 16: A minor difference is that in the analysis of §3.1c, the angular momentum \(L\) could have either sign. Here \(L=|{\bf L}|\) is always non-negative, while \(L_{z}\) can have either sign.

\(J_{\theta}\) and \(J_{\phi}\) occur in equations (3.226) only in the combination \(L=J_{\theta}+|J_{\phi}|\), and in fact, the Hamiltonian for any spherical potential is a function \(H(J_{r},L)\). Therefore we elevate \(L\) to the status of an action by making the canonical transformation that is defined by the generating function (eq. D.93)

\[S^{\prime}=\theta_{\phi}J_{1}+\theta_{\vartheta}(J_{2}-|J_{1}|)+\theta_{r}J_{3}, \tag{3.227}\]

where \((J_{1},J_{2},J_{3})\) are new angle-action coordinates. Differentiating with respect to the old angles, we discover the connection between the new and old actions:

\[\eqalign{J_{\phi}&={\partial S^{\prime}\over\partial\theta_{\phi}}=J_{1}\quad \Rightarrow\quad J_{1}=L_{z},\cr J_{\vartheta}&={\partial S^{\prime}\over \partial\theta_{\vartheta}}=J_{2}-|J_{1}|\quad\Rightarrow\quad J_{2}=J_{ \vartheta}+|J_{\phi}|=L,\cr J_{r}&={\partial S^{\prime}\over\partial\theta_{r} }=J_{3}.\cr} \tag{3.228}\]

Thus the new action \(J_{2}\) is \(L\) as desired. Differentiating \(S^{\prime}\) with respect to the new actions we find that the new angles are

\[\theta_{1}=\theta_{\phi}-{\rm sgn}(J_{1})\theta_{\vartheta}\quad;\quad\theta_ {2}=\theta_{\vartheta}\quad;\quad\theta_{3}=\theta_{r}. \tag{3.229}\]

Equation (3.224) can be regarded as an implicit equation for the Hamiltonian \(H({\bf J})=E\) in terms of \(J_{3}=J_{r}\) and \(J_{2}=L\). Since \(J_{1}\) does not appear in this equation, the Hamiltonian of any spherical potential must be of the form \(H(J_{2},J_{3})\). Thus \(\Omega_{1}=\partial H/\partial J_{1}=0\) for all spherical potentials, and the corresponding angle \(\theta_{1}\) is an integral of motion. In SS3.1 we saw that any spherical potential admits four isolating integrals. Here we have recovered this result from a different point of view: three of the integrals are the actions \((J_{1},J_{2},J_{3})\), and the fourth is the angle \(\theta_{1}\).

From Figure 3.26 we see that for orbits with \(L_{z}>0\) the inclination of the orbital plane \(i={1\over 2}\pi-\vartheta_{\rm min}\), while when \(L_{z}<0\), \(i={1\over 2}\pi+\vartheta_{\rm min}\). Combining these equations with (3.222) we find that

\[i=\cos^{-1}(L_{z}/L)=\cos^{-1}(J_{1}/J_{2}). \tag{3.230}\]

### 3.5 Angle-action variables

We now obtain explicit expressions for the angle variables of any spherical potential by evaluating \(\partial S/\partial J_{i}=\theta_{i}\), where \(S\) is derived from equation (3.220) by replacing \(E\) with \(H(J_{2},J_{3})\), \(L\) with \(J_{2}\), and \(L_{z}\) with \(J_{1}\). We have

\[S=\phi J_{1}+\int_{\pi/2}^{\vartheta}\!\!\mathrm{d}\vartheta\,\epsilon_{ \vartheta}\sqrt{J_{2}^{2}-\frac{J_{1}^{2}}{\sin^{2}\vartheta}}+\int_{r_{\min} }^{r}\!\!\mathrm{d}r\,\epsilon_{r}\sqrt{2H(J_{2},J_{3})-2\Phi(r)-\frac{J_{2}^{ 2}}{r^{2}}}. \tag{3.231}\]

Figure 3.26 helps us to interpret our final result. It depicts the star after it has passed the line of nodes, moving upward. At this instant, \(\dot{\vartheta}<0\), and we must choose \(\epsilon_{\vartheta}=-1\) to make the first integral of equation (3.231) increasing. We therefore specialize to this case, and using (3.230) find

\[\theta_{1}=\frac{\partial S}{\partial J_{1}} =\phi+\mathrm{sgn}(J_{1})\int_{\pi/2}^{\vartheta}\frac{\mathrm{ d}\vartheta}{\sin\vartheta\sqrt{\sin^{2}\vartheta\sec^{2}i-1}} \tag{3.232a}\] \[=\phi-u,\] where 17 \[\sin u\equiv\cot i\cot\vartheta. \tag{3.232b}\]

Figure 3.26 demonstrates that the new variable \(u\) is actually \(\phi-\Omega\) and thus that \(\theta_{1}=\Omega\), the **longitude of the ascending node**.18

Footnote 17: This follows because

\[\begin{split}\mathrm{d}[\sin^{-1}(\cot i\cot\vartheta)]& =-\csc^{2}\vartheta\cot i\,\mathrm{d}\vartheta/\sqrt{1-\cot^{2}i \cot^{2}\vartheta}\\ &=\mathrm{sgn}(\cos i)/(\sin\vartheta\sqrt{\sin^{2}\vartheta\sec^ {2}i-1}).\end{split} \tag{3.233}\]

 Thus \(\theta_{1}\) is constant because the line of nodes is fixed. If the potential were not spherical, butmerely axisymmetric, \(\theta_{1}\) would not be constant and the orbital plane would precess.

Next we differentiate equation (3.231) to obtain \(\theta_{3}\). Only the third term, which is equal to \(S_{r}\), depends on \(J_{3}\). Thus we have

\[\theta_{3}=\Bigl{(}{\partial S_{r}\over\partial J_{3}}\Bigr{)}_{J_{2}}=\Bigl{(} {\partial S_{r}\over\partial H}\Bigr{)}_{J_{2}}\Bigl{(}{\partial H\over \partial J_{3}}\Bigr{)}_{J_{2}}=\Bigl{(}{\partial S_{r}\over\partial H}\Bigr{)} _{J_{2}}\Omega_{3}, \tag{3.234}\]

where the last step follows from equation (3.190). Similarly,

\[\theta_{2}=\Bigl{(}{\partial S\over\partial J_{2}}\Bigr{)}_{J_{3}}=\Bigl{(}{ \partial S_{\vartheta}\over\partial J_{2}}\Bigr{)}_{J_{3}}+\Bigl{(}{\partial S _{r}\over\partial H}\Bigr{)}_{J_{2}}\Bigl{(}{\partial H\over\partial J_{2}} \Bigr{)}_{J_{3}}+\Bigl{(}{\partial S_{r}\over\partial J_{2}}\Bigr{)}_{H}. \tag{3.235}\]

We eliminate \(\partial S_{r}/\partial H\) using equation (3.234),

\[\theta_{2}=\Bigl{(}{\partial S_{\vartheta}\over\partial J_{2}}\Bigr{)}_{J_{3} }+{\Omega_{2}\over\Omega_{3}}\theta_{3}+\Bigl{(}{\partial S_{r}\over\partial J _{2}}\Bigr{)}_{H}. \tag{3.236}\]

From equation (3.231) with \(\epsilon_{\vartheta}=-1\), it is straightforward to show that

\[\Bigl{(}{\partial S_{\vartheta}\over\partial J_{2}}\Bigr{)}_{J_{1}}=\sin^{-1} \left({\cos\vartheta\over\sin i}\right)\!. \tag{3.237}\]

Now let \(\psi\) be the angle measured in the orbital plane from the line of nodes to the current position of the star. From Figure 3.26 it is easy to see that \(\cos\vartheta=\sin i\sin\psi\); thus

\[\Bigl{(}{\partial S_{\vartheta}\over\partial J_{2}}\Bigr{)}_{J_{1}}=\psi. \tag{3.238}\]

\begin{table}
\begin{tabular}{l c c c c} \hline actions & \(J_{\phi}=L_{z}\) & ; & \(J_{\vartheta}=L-|L_{z}|\) & ; & \(J_{r}\) \\ angles & \(\theta_{\phi}=\Omega+{\rm sgn}(L_{z})\theta_{\vartheta}\) & ; & \(\theta_{\vartheta}\) & ; & \(\theta_{r}\) \\ Hamiltonian & & \(H(J_{\vartheta}+|J_{\phi}|,J_{r})\) & & \\ frequencies & \(\Omega_{\phi}={\rm sgn}(L_{z})\Omega_{\vartheta}\) & ; & \(\Omega_{\vartheta}\) & ; & \(\Omega_{r}\) \\ \hline actions & \(J_{1}=L_{z}\) & ; & \(J_{2}=L\) & ; & \(J_{3}=J_{r}\) \\ angles & \(\theta_{1}=\Omega\) & ; & \(\theta_{2}=\theta_{\vartheta}\) & ; & \(\theta_{3}=\theta_{r}\) \\ Hamiltonian & & & \(H(J_{2},J_{3})\) & & \\ frequencies & \(\Omega_{1}=0\) & ; & \(\Omega_{2}=\Omega_{\vartheta}\) & ; & \(\Omega_{3}=\Omega_{r}\) \\ \hline actions & \(J_{a}=L_{z}\) & ; & \(J_{b}=L\) & ; & \(J_{c}=J_{r}+L\) \\ angles & \(\theta_{a}=\Omega\) & ; & \(\theta_{b}=\theta_{\vartheta}-\theta_{r}\) & ; & \(\theta_{c}=\theta_{r}\) \\ Hamiltonian & & & \(H(J_{b},J_{c}-J_{b})\) & & \\ frequencies & \(\Omega_{a}=0\) & ; & \(\Omega_{b}=\Omega_{\vartheta}-\Omega_{r}\) & ; & \(\Omega_{c}=\Omega_{r}\) \\ \hline \end{tabular}

Notes: The Delaunay variables \((J_{a},J_{b},J_{c})\) are defined in Appendix E. When possible, actions and angles are expressed in terms of the total angular momentum \(L\), the \(z\)-component of angular momentum \(L_{z}\), the radial action \(J_{r}\), and the longitude of the ascending node \(\Omega\) (Figure 3.26). Unfortunately, \(\Omega\) is also used for the frequency corresponding to a given action, but in this case it is always accompanied by a subscript. The Hamiltonian is \(H(L,J_{r})\).

\end{table}
Table 3.1: Angle-action variables in a spherical potential The other two partial derivatives in equations (3.234) and (3.235) can only be evaluated once \(\Phi(r)\) has been chosen. In the case of the isochrone potential (2.47), we have

\[\Big{(}\frac{\partial S_{r}}{\partial H}\Big{)}_{J_{2}}=\int_{r_{\rm min}}^{r} {\rm d}I\quad;\quad\Big{(}\frac{\partial S_{r}}{\partial J_{2}}\Big{)}_{H}=-J_ {2}\int_{r_{\rm min}}^{r}\frac{{\rm d}I}{r^{2}} \tag{3.239}\]

where \({\rm d}I\) is defined by (3.36). Hence the integrals to be performed are just indefinite versions of the definite integrals that yielded \(T_{r}\) and \(\Delta\psi\) in SS3.1c. The final answers are most conveniently expressed in terms of an auxiliary variable \(\eta\) that is defined by (cf. eqs. 3.28, 3.32 and 3.34)

\[s=2+\frac{c}{b}(1-e\cos\eta)\quad\mbox{where}\quad\left\{\begin{array}{l}c \equiv\frac{GM}{-2H}-b,\\ e^{2}\equiv 1-\frac{J_{2}^{2}}{GMc}\Big{(}1+\frac{b}{c}\Big{)},\\ s\equiv 1+\sqrt{1+r^{2}/b^{2}}.\end{array}\right. \tag{3.240}\]

Then one has19

Footnote 19: In numerical work, care must be taken to ensure that the branch of the inverse trigonometric functions is chosen so that the angle variables increase continuously.

\[\begin{split}\theta_{3}&=\eta-\frac{ec}{c+b}\sin\eta\\ \theta_{2}&=\psi+\frac{\Omega_{2}}{\Omega_{3}}\theta_{3}- \tan^{-1}\left(\sqrt{\frac{1+e}{1-e}}\tan(\frac{1}{2}\eta)\right)\\ &\qquad-\frac{1}{\sqrt{1+4GMb/J_{2}^{2}}}\tan^{-1}\left(\sqrt{ \frac{1+e+2b/c}{1-e+2b/c}}\tan(\frac{1}{2}\eta)\right).\end{split} \tag{3.241}\]

Thus in the case of the isochrone potential we can analytically evaluate all three angle variables from ordinary phase-space coordinates \(({\bf x},{\bf v})\).

To summarize, in an arbitrary spherical potential two of the actions can be taken to be the total angular momentum \(L\) and its \(z\)-component \(L_{z}\), and one angle can be taken to be the longitude of the ascending node \(\Omega\). The remaining action and angles can easily be determined by numerical evaluation of the integral (3.224) and integrals analogous to those of equation (3.239). In the isochrone potential, all angle-action variables can be obtained analytically from the ordinary phase-space coordinates \(({\bf x},{\bf v})\). The analytic relations among angle-action variables in spherical potentials are summarized in Table 3.1.

#### 3.5.3 Angle-action variables for flattened axisymmetric potentials

In SS3.2 we used numerical integrations to show that most orbits in flattened axisymmetric potentials admit three isolating integrals, only two of which were identified analytically. Now we take up the challenge of identifying the missing "third integral" analytically, and deriving angle-action variables from it and the classical integrals. It proves possible to do this only for special potentials, and we start by examining the potentials for which we _have_ obtained action integrals for clues as to what a promising potential might be.

**(a) Stackel potentials** In SS3.3 we remarked that box orbits in a planar non-rotating bar potential resemble Lissajous figures generated by two-dimensional harmonic motion, while loop orbits have many features in common with orbits in axisymmetric potentials. Let us examine these parallels more closely. The orbits of a two-dimensional harmonic oscillator admit two independent isolating integrals, \(H_{x}=\frac{1}{2}(p_{x}^{2}+\omega_{x}^{2}x^{2})\) and \(H_{y}=\frac{1}{2}(p_{y}^{2}+\omega_{y}^{2}y^{2})\) (eq. 3.207). At each point in the portion of the \((x,y)\) plane visited by the orbit, the particle can have one of four momentum vectors. These momenta arise from the ambiguity in the signs of \(p_{x}\) and \(p_{y}\) when we are given only \(E_{x}\) and \(E_{y}\), the values of \(H_{x}\) and \(H_{y}\): \(p_{x}(x)=\pm\sqrt{2E_{x}-\omega_{x}^{2}x^{2}}\); \(p_{y}(y)=\pm\sqrt{2E_{y}-\omega_{y}^{2}y^{2}}\). The boundaries of the orbit are the lines on which \(p_{x}=0\) or \(p_{y}=0\).

Consider now planar orbits in a axisymmetric potential \(\Phi(r)\). These orbits fill annuli. At each point in the allowed annulus two momenta are possible: \(p_{r}(r)=\pm\sqrt{2(E-\Phi)-L_{z}^{2}/r^{2}}\), \(p_{\phi}=L_{z}\). The boundaries of the orbit are the curves on which \(p_{r}=0\).

These examples have a number of important points in common:

1. The boundaries of orbits are found by equating to zero one canonical momentum in a coordinate system that reflects the symmetry of the potential.
2. The momenta in this privileged coordinate system can be written as functions of only one variable: \(p_{x}(x)\) and \(p_{y}(y)\) in the case of the harmonic oscillator; and \(p_{r}(r)\) and \(p_{\phi}=L_{z}\) (which depends on neither coordinate) in the case of motion in a axisymmetric potential.
3. These expressions for the momenta are found by splitting the Hamilton-Jacobi equation \(H-E=0\) (eq. 3.205) into two parts, each of which is a function of only one coordinate and its conjugate momentum. In the case of the harmonic oscillator, \(0=H-E=\frac{1}{2}|{\bf p}|^{2}+\frac{1}{2}(\omega_{x}^{2}x^{2}+\omega_{y}^{2} y^{2})-E=H_{x}(p_{x},x)+H_{y}(p_{y},y)-E\). In the case of motion in an axisymmetric potential, \(0=r^{2}(H-E)=r^{2}\bigl{[}\frac{1}{2}p_{r}^{2}+\Phi(r)\bigr{]}-r^{2}E+\frac{1 }{2}p_{\phi}^{2}\).

The first of these observations suggests that we look for a curvilinear coordinate system whose coordinate curves run parallel to the edges of numerically integrated orbits, such as those plotted in Figure 3.4. Figure 3.27 shows thatthe \((u,v)\) coordinate system defined by

\[R=\Delta\sinh u\sin v\quad;\quad z=\Delta\cosh u\cos v \tag{3.242}\]

achieves this goal to high accuracy: the orbits of Figure 3.4 can be approximately bounded top and bottom by curves of constant \(v\) and right and left by curves of constant \(u\).20

Footnote 20: Note that _prolate_ spheroidal coordinates are used to fit the boundaries of orbits in _oblate_ potentials.

Now that we have chosen a coordinate system, item (iii) above suggests that we next write the Hamiltonian function in terms of \(u\), \(v\), and their conjugate momenta. The first step is to write the Lagrangian as a function of the new coordinates and their time derivatives. By an analysis that closely parallels the derivation of equations (2.99) we may show that

\[|\dot{\bf x}|^{2}=\Delta^{2}\left(\sinh^{2}u+\sin^{2}v\right)\left(\dot{u}^{2} +\dot{v}^{2}\right)+\Delta^{2}\sinh^{2}u\sin^{2}v\,\dot{\phi}^{2}, \tag{3.243}\]

and the Lagrangian is

\[{\cal L}={{1\over 2}}\Delta^{2}\left[\left(\sinh^{2}u+\sin^{2}v\right) \left(\dot{u}^{2}+\dot{v}^{2}\right)+\sinh^{2}u\sin^{2}v\,\dot{\phi}^{2}\right] -\Phi(u,v). \tag{3.244}\]

The momenta are (eq. D.49)

\[\begin{array}{c}p_{u}=\Delta^{2}\left(\sinh^{2}u+\sin^{2}v\right)\dot{u}\quad ;\quad p_{v}=\Delta^{2}\left(\sinh^{2}u+\sin^{2}v\right)\dot{v}\\ p_{\phi}=\Delta^{2}\sinh^{2}\!u\sin^{2}v\,\dot{\phi},\end{array} \tag{3.245}\]

Figure 3.27: The boundaries of orbits in the meridional plane approximately coincide with the coordinate curves of a system of spheroidal coordinates. The dotted lines are the coordinate curves of the system defined by (3.242) and the full curves show the same orbits as Figure 3.4.

so the Hamiltonian is

\[H(u,v,p_{u},p_{v},p_{\phi})=\frac{p_{u}^{2}+p_{v}^{2}}{2\Delta^{2}(\sinh^{2}u+ \sin^{2}v)}+\frac{p_{\phi}^{2}}{2\Delta^{2}\sinh^{2}u\sin^{2}v}+\Phi(u,v). \tag{3.246}\]

Since \(H\) has no explicit dependence on time, it is equal to some constant \(E\). Likewise, since \(H\) is independent of \(\phi\), the azimuthal momentum \(p_{\phi}\) is constant at some value \(L_{z}\).

The examples of motion in harmonic and circular potentials suggest that we seek a form of \(\Phi(u,v)\) that will enable us to split a multiple of the equation \(H(u,v,p_{u},p_{v},L_{z})=E\) into a part involving only \(u\) and \(p_{u}\) and a part that involves only \(v\) and \(p_{v}\). Evidently we require that \((\sinh^{2}u+\sin^{2}v)\Phi\) be of the form \(U(u)-V(v)\), i.e., that21

Footnote 21: The denominator of equation (3.247) vanishes when \(u=0\), \(v=0\). However, we may avoid an unphysical singularity in \(\Phi\) at this point by choosing \(U\) and \(V\) such that \(U(0)=V(0)\).

\[\Phi(u,v)=\frac{U(u)-V(v)}{\sinh^{2}u+\sin^{2}v}, \tag{3.247}\]

for then we may rewrite \(H=E\) as

\[2\Delta^{2}\left[E\sinh^{2}u-U(u)\right]-p_{u}^{2}-\frac{L_{z}^{2}}{\sinh^{2} u}=\frac{L_{z}^{2}}{\sin^{2}v}+p_{v}^{2}-2\Delta^{2}\left[E\sin^{2}v+V(v) \right]. \tag{3.248}\]

It can be shown that potentials of the form (3.247) are generated by bodies resembling real galaxies (see Problems 2.6 and 2.14), so there are interesting physical systems for which (3.248) is approximately valid. Potentials of this form are called **Stackel potentials** after the German mathematician P. Stackel.22 Our treatment of these potentials will be restricted; much more detail, including the generalization to triaxial potentials, can be found in de Zeeuw (1985).

Footnote 22: Stackel showed that the _only_ coordinate system in which the Hamilton–Jacobi equation for \(H=\frac{1}{2}p^{2}+\Phi(\mathbf{x})\) separates is confocal ellipsoidal coordinates. The usual Cartesian, spherical and cylindrical coordinate systems are limiting cases of these coordinates, as is the \((u,v,\phi)\) system.

If the analogy with the harmonic oscillator holds, \(p_{u}\) will be a function only of \(u\), and similarly for \(p_{v}\). Under these circumstances, the left side of equation (3.248) does not depend on \(v\), and the right side does not depend on \(u\), so both sides must equal some constant, say \(2\Delta^{2}I_{3}\). Hence we would then have

\[p_{u} =\pm\sqrt{2\Delta^{2}\left[E\sinh^{2}u-I_{3}-U(u)\right]-\frac{L_ {z}^{2}}{\sinh^{2}u}}, \tag{3.249a}\] \[p_{v} =\pm\sqrt{2\Delta^{2}\left[E\sin^{2}v+I_{3}+V(v)\right]-\frac{L_ {z}^{2}}{\sin^{2}v}}. \tag{3.249b}\]It is a straightforward exercise to show that the analogy with the harmonic oscillator _does_ hold, by direct time differentiation of both sides of equations (3.249), followed by elimination of \(\dot{u}\) and \(\dot{p}_{u}\) with Hamilton's equations (Problem 3.37). Thus the quantity \(I_{3}\) defined by equations (3.249) _is_ an integral. Moreover, we can display \(I_{3}\) as an explicit function of the phase-space coordinates by eliminating \(E\) between equations (3.249) (Problem 3.39).

Equations (3.249) enable us to obtain expressions for the actions \(J_{u}\) and \(J_{v}\) in terms of the integrals \(E\), \(I_{3}\) and \(L_{z}\), the last of which is equal to \(J_{\phi}\) as in the spherical case. Specifically

\[\eqalign{J_{u}&={1\over\pi}\int_{u_{\rm min}}^{u_{\rm max}}{\rm d}u\,\sqrt{2 \Delta^{2}\left[E\sinh^{2}u-I_{3}-U(u)\right]-{L_{z}^{2}\over\sinh^{2}u}},\cr J _{v}&={1\over\pi}\int_{v_{\rm min}}^{v_{\rm max}}{\rm d}v\,\sqrt{2\Delta^{2} \left[E\sin^{2}v+I_{3}+V(v)\right]-{L_{z}^{2}\over\sin^{2}v}},\cr J_{\phi}&=L_ {z},}\]

where \(u_{\rm min}\) and \(u_{\rm max}\) are the smallest and largest values of \(u\) at which the integrand vanishes, and similarly for \(v_{\rm min}\) and \(v_{\rm max}\).

As in the spherical case, we obtain expressions for the angle variables by differentiating the generating function \(S(u,v,\phi,J_{u},J_{v},J_{\phi})\) of the canonical transformation between angle-action variables and the \((u,v,\phi)\) system. We take \(S\) to be the sum of three parts \(S_{u}\), \(S_{v}\) and \(S_{\phi}\), each of which depends on only one of the three coordinate variables. The gradient of \(S_{u}\) with respect to \(u\) is just \(p_{u}\), so \(S_{u}\) is just the indefinite integral with respect to \(u\) of (3.249a). After evaluating \(S_{v}\) and \(S_{\phi}\) analogously, we use the chain rule to differentiate \(S=\sum_{i}S_{i}\) with respect to the actions (cf. the derivation of eq. 3.234):

\[\eqalign{\theta_{u}&={\partial S\over\partial J_{u}}=\sum_{i=u,v}\bigg{(}{ \partial S_{i}\over\partial H}\Omega_{u}+{\partial S_{i}\over\partial I_{3}}{ \partial I_{3}\over\partial J_{u}}\bigg{)},\cr\theta_{v}&=\sum_{i=u,v}\bigg{(}{ \partial S_{i}\over\partial H}\Omega_{v}+{\partial S_{i}\over\partial I_{3}}{ \partial I_{3}\over\partial J_{v}}\bigg{)},\cr\theta_{\phi}&=\sum_{i=u,v}\bigg{(} {\partial S_{i}\over\partial H}\Omega_{\phi}+{\partial S_{i}\over\partial I_ {3}}{\partial I_{3}\over\partial L_{z}}\bigg{)}+\phi.}\]

The partial derivatives in these expressions are all one-dimensional integrals that must in general be done numerically.

The condition (3.247) that must be satisfied by an axisymmetric Stackel potential is very restrictive because it requires that a function of two variables can be written in terms of two functions of one variable. Most potentials that admit a third integral do not satisfy this condition. In particular the logarithmic potential \(\Phi_{\rm L}\) (2.71a) that motivated our discussion is not of Stackel form: we can find a system of spheroidal coordinates that approximately boundsany given orbit, but in general different orbits require different coordinate systems.

As an example of the use of equations (3.249) we investigate the shapes they predict for orbits in the potential obtained by choosing in (3.247)

\[\eqalign{U(u)&=-W\sinh u\tan^{-1}\left({\Delta\sinh u\over a_{3}}\right)\cr V(v)& =W\sin v\tanh^{-1}\left({\Delta\sin v\over a_{3}}\right),}\]

where \(W\), \(\Delta\), and \(a_{3}\) are constants.23 An orbit of specified \(E\) and \(I_{3}\) can explore all values of \(u\) and \(v\) for which equations (3.249) predict positive \(p_{u}^{2}\) and \(p_{v}^{2}\). This they will do providing \(E\) is larger than the largest of the "effective potentials"

Footnote 23: With these choices for \(U\) and \(V\), the potential (3.247) becomes the potential of the perfect prolate spheroid introduced in Problem 2.14.

\[\eqalignno{U_{\rm eff}(u)&\equiv{L_{z}^{2}\over 2\Delta^{2}\sinh^{4}u}+{I_{3}+ U(u)\over\sinh^{2}u},&(3.253{\rm a})\cr V_{\rm eff}(v)&\equiv{L_{z}^{2}\over 2\Delta^{2} \sin^{4}v}-{I_{3}+V(v)\over\sin^{2}v}.&(3.253{\rm b})\cr}\]

Figure 3.28 shows these potentials for two values of \(I_{3}\) and all other parameters fixed. Consider the case in which the energy takes the value \(-0.453W\)

Figure 3.28: Plots of the effective potentials \(U_{\rm eff}\) (left) and \(V_{\rm eff}\) (right) that are defined by equations (3.252) and (3.253) for \(\Delta=0.6a_{3}\) and \(L_{z}=0.05a_{3}\sqrt{W}\). Curves are shown for \(I_{3}=-0.1W\) (full) and \(I_{3}=0.1W\) (dotted).

#### Angle-action variables

In SS3.2.1 we saw that motion in the meridional plane is governed by a Hamiltonian \(H(R,z,p_{R},p_{z})\) in which \(L_{z}\) occurs as a parameter and the phase space is four-dimensional. In this space the orbital tori are ordinary two-dimensional doughnuts, and a surface of section is simply a cross-section through a nested sequence of such tori: each invariant curve marks the intersection of a two-dimensional doughnut with the two-dimensional surface of section.

**(b) Epicycle approximation** In SS3.2.3 we used the epicycle approximation to obtain solutions to the equations of motion that are approximately valid for nearly circular orbits in an axisymmetric potential. Here we obtain the corresponding approximate angle-action variables. In cylindrical coordinates the Hamilton-Jacobi equation (3.205) is

\[{{{1\over 2}}}\Bigl{(}{\partial S\over\partial R}\Bigr{)}^{2}+{1\over 2R^{2}}\Bigl{(}{ \partial S\over\partial\phi}\Bigr{)}^{2}+{{{1\over 2}}}\Bigl{(}{ \partial S\over\partial z}\Bigr{)}^{2}+\Phi(R,z)=E.\]

As in equation (2.75a) we assume that \(\Phi\) is of the form \(\Phi_{R}(R)+\Phi_{z}(z)\); the radial dependence of \(\Phi_{z}(z)\) is suppressed because the radial motion is small in the epicycle approximation. We further assume that \(S\) is of the form \(S({\bf J},R,\phi,z)=S_{R}({\bf J},R)+S_{\phi}({\bf J},\phi)+S_{z}({\bf J},z)\). Now we use the method of separation of variables to split equation (3.254) up into three parts:

\[\eqalign{E_{z}=&\ {{{1\over 2}}}\Bigl{(}{\partial S_{z}\over \partial z}\Bigr{)}^{2}+\Phi_{z}(z)\quad;\quad L_{z}^{2}=\Bigl{(}{\partial S _{\phi}\over\partial\phi}\Bigr{)}^{2}\cr E-E_{z}=&\ {{{1\over 2}}}\Bigl{(}{\partial S_{R}\over \partial R}\Bigr{)}^{2}+\Phi_{R}(R)+{L_{z}^{2}\over 2R^{2}},}\]

where \(E_{z}\) and \(L_{z}\) are the two constants of separation. The first equation of this set leads immediately to an integral for \(S_{z}(z)\)

\[S_{z}(z)=\int_{0}^{z}{\rm d}z^{\prime}\,\epsilon_{z}\sqrt{2[E_{z}-\Phi_{z}(z^{ \prime})]},\]

where \(\epsilon_{z}\) is chosen to be \(\pm 1\) such that the integral increases monotonically along the path. If, as in SS3.2.3, we assume that \(\Phi_{z}={1\over 2}\nu^{2}z^{2}\), where \(\nu\) is a constant, then our equation for \(S_{z}\) becomes essentially the same as the first of equations (3.211), and by analogy with equations (3.213) and (3.216), we have

\[J_{z}={E_{z}\over\nu}\quad;\quad z=-\sqrt{2J_{z}\over\nu}\cos\theta_{z}.\]

The second of equations (3.255) trivially yields

\[S_{\phi}({\bf J},\phi)=L_{z}\phi,\]

and it immediately follows that \(J_{\phi}=L_{z}\). The last of equations (3.255) yields

\[2(E-E_{z})=\Bigl{(}{\partial S_{R}\over\partial R}\Bigr{)}^{2}+2\Phi_{\rm eff }(R),\]

where (cf. eq. 3.68b)

\[\Phi_{\rm eff}(R)\equiv\Phi_{R}(R)+{J_{\phi}^{2}\over 2R^{2}}.\]The epicycle approximation involves expanding \(\Phi_{\rm eff}\) about its minimum, which occurs at the radius \(R_{\rm g}(J_{\phi})\) of the circular orbit of angular momentum \(J_{\phi}\); with \(x\) defined by \(R=R_{\rm g}+x\), the expansion is \(\Phi(R)=E_{\rm c}(J_{\phi})+\frac{1}{2}\kappa^{2}x^{2}\), where \(E_{\rm c}(J_{\phi})\) is the energy of the circular orbit of angular momentum \(J_{\phi}\) and \(\kappa\) is the epicycle frequency defined in equation (3.77). Inserting this expansion into (3.259a) and defining \(E_{R}\equiv E-E_{z}-E_{\rm c}\), we have

\[2E_{R}=\left(\frac{\partial S_{R}}{\partial R}\right)^{2}+\kappa^{2}x^{2}, \tag{3.260}\]

which is the same as equation (3.210) with \(K^{2}\) replaced by \(2E_{R}\), \(x\) by \(R\), and \(\omega_{x}\) by \(\kappa\). It follows from equations (3.213), (3.216) and (3.217) that

\[J_{R}=\frac{E_{R}}{\kappa}\quad;\quad S_{R}({\bf J},R)=J_{R}(\theta_{R}- \tfrac{1}{2}\sin 2\theta_{R})\quad;\quad R=R_{\rm g}-\sqrt{\frac{2J_{R}}{ \kappa}}\cos\theta_{R}. \tag{3.261}\]

The last of these equations is equivalent to equation (3.91) if we set \(\theta_{R}=\kappa t+\alpha\) and \(X=-(2J_{R}/\kappa)^{1/2}\).

Finally, we find an expression for \(\theta_{\phi}\). With equations (3.258) and (3.261) we have

\[\begin{split}\theta_{\phi}&=\frac{\partial S}{ \partial J_{\phi}}=\frac{\partial S_{\phi}}{\partial J_{\phi}}+\frac{\partial S _{R}}{\partial J_{\phi}}=\phi+J_{R}(1-\cos 2\theta_{R})\frac{\partial \theta_{R}}{\partial J_{\phi}}\\ &=\phi+2J_{R}\sin^{2}\theta_{R}\frac{\partial\theta_{R}}{ \partial J_{\phi}}.\end{split} \tag{3.262}\]

The derivative of \(\theta_{R}\) has to be taken at constant \(J_{R},J_{z},R,\phi\), and \(z\). We differentiate the last of equations (3.261) bearing in mind that both \(R_{\rm g}\) and \(\kappa\) are functions of \(J_{\phi}\):

\[0=\frac{{\rm d}R_{\rm g}}{{\rm d}J_{\phi}}+\frac{1}{2\kappa}\frac{{\rm d} \kappa}{{\rm d}J_{\phi}}\sqrt{\frac{2J_{R}}{\kappa}}\cos\theta_{R}+\sqrt{ \frac{2J_{R}}{\kappa}}\sin\theta_{R}\frac{\partial\theta_{R}}{\partial J_{ \phi}}. \tag{3.263}\]

By differentiating \(R_{\rm g}^{2}\Omega_{\rm g}=J_{\phi}\) with respect to \(R_{\rm g}\) we may show with equation (3.80) that

\[\frac{{\rm d}R_{\rm g}}{{\rm d}J_{\phi}}=\frac{\gamma}{\kappa R_{\rm g}}, \tag{3.264}\]

where \(\gamma=2\Omega_{\rm g}/\kappa\) is defined by equation (3.93b). Inserting this relation into (3.263) and using the result to eliminate \(\partial\theta_{R}/\partial J_{\phi}\) from (3.262), we have finally

\[\theta_{\phi}=\phi-\frac{\gamma}{R_{\rm g}}\sqrt{\frac{2J_{R}}{\kappa}}\sin \theta_{R}-\frac{J_{R}}{2}\frac{{\rm d}\ln\kappa}{{\rm d}J_{\phi}}\sin 2\theta_{R}. \tag{3.265}\]

This expression should be compared with equation (3.93a). If we set \(\theta_{\phi}=\Omega_{\rm g}t+\phi_{0}\), \(\theta_{R}=\kappa t+\alpha+\pi\), and \(X=(2J_{R}/\kappa)^{1/2}\) as before, the only difference between the two equations is the presence of a term proportional to \(\sin 2\theta_{R}\) in equation (3.265). For nearly circular orbits, this term is smaller than the term proportional to \(\sin\theta_{R}\) by \(\sqrt{J_{R}/J_{\phi}}\) and represents a correction to equation (3.92) that makes the \((\theta_{R},\theta_{\phi},J_{R},J_{\phi})\) coordinates canonical (Dehnen 1999a).

It is worth noting that when \(J_{R}\neq 0\), the frequency associated with \(\phi\) is not the circular frequency, \(\Omega_{\rm g}\). To see this, recall that the Hamiltonian \(H=E_{R}+E_{\rm c}+E_{z}\), and \(E_{R}=\kappa J_{R}\), while \({\rm d}E_{\rm c}/{\rm d}J_{\phi}=\Omega_{\rm g}\), so

\[\Omega_{\phi}={\partial H\over\partial J_{\phi}}={{\rm d}\kappa\over{\rm d}J_ {\phi}}J_{R}+\Omega_{\rm g}.\]

**3.5.4 Angle-action variables for a non-rotating bar**

The \((u,v)\) coordinate system that allowed us to recover angle-action variables for flattened axisymmetric potentials enables us to do the same for a planar, non-rotating bar. This fact is remarkable, because we saw in SS3.3 that these systems support two completely different types of orbit, loops and boxes. Figure 3.30 makes it plausible that the \((u,v)\) system can provide analytic solutions for both loops and boxes, by showing that the orbits plotted in Figure 3.8 have boundaries that may be approximated by curves of constant \(u\) and \(v\) (cf. the discussion on page 226). We can explore this idea quantitatively by defining

\[x=\Delta\sinh u\sin v\quad;\quad y=\Delta\cosh u\cos v\]

and then replacing \(R\) by \(x\) and \(z\) by \(y\) in the formulae of the previous subsection. Further setting \(\dot{\phi}=L_{z}=0\) we find by analogy with equations (3.249) that

\[p_{u}=\pm\Delta\sinh u\sqrt{2[E-U_{\rm eff}(u)]}\quad;\quad p_{v}=\pm\Delta \sin v\sqrt{2[E-V_{\rm eff}(v)]}\]where

\[U_{\rm eff}(u)=\frac{I_{2}+U(u)}{\sinh^{2}u}\quad;\quad V_{\rm eff}(v)=-\frac{I_{ 2}+V(v)}{\sin^{2}v}. \tag{3.268b}\]

Here \(U\) and \(V\) are connected to the gravitational potential by equation (3.247) as before and \(I_{2}\) is the constant of separation analogous to \(I_{3}\).

An orbit of specified \(E\) and \(I_{2}\) is confined to values of \(u\) and \(v\) at which both \(E\geq U_{\rm eff}\) and \(E\geq V_{\rm eff}\). Figure 3.31 shows the effective potentials as functions of their coordinates for several values of \(I_{2}\) when \(U\) and \(V\) are chosen to be the functions specified by equations (3.252). In each panel the thick curve is for \(I_{2}=0\), with curves for \(I_{2}>0\) lying above this in the left panel, and below it on the right. Since the curves of \(U_{\rm eff}\) have minima only when \(I_{2}>0\), there is a lower limit on the star's \(u\) coordinate only in this case. Consequently, stars with \(I_{2}\leq 0\) can reach the center, while stars with \(I_{2}>0\) cannot reach the center. This suggests that when \(I_{2}\leq 0\) the orbit is a box orbit, while when \(I_{2}>0\) it is a loop orbit. Comparison of the right and left panels confirms this conjecture by showing that when \(I_{2}>0\) (upper curves on left and lower curves on right), the minimum value of \(U_{\rm eff}\) is greater than the maximum of \(V_{\rm eff}\). Hence when \(I_{2}>0\) the condition \(E>V_{\rm eff}(v)\) imposes no constraint on \(v\) and the boundaries of the orbit are the ellipses \(u=u_{\rm min}\) and \(u=u_{\rm max}\) on which \(E=U_{\rm eff}\). When \(I_{2}\leq 0\), by contrast, the curves on the right tend to \(\infty\) as \(v\to 0\), so sufficiently small values of \(v\) are excluded and the boundaries of the orbit are the ellipse \(u=u_{\rm max}\) on which \(E=U_{\rm eff}(u)\) and the hyperbola \(|v|=v_{\rm min}\) on which \(E=V_{\rm eff}(v)\).

Figure 3.31: The effective potentials defined by equations (3.268b) when \(U\) and \(V\) are given by equations (3.252). The curves are for \(I_{2}=1,0.25,0.01,0,-0.01,-0.25\) and \(-1\), with the largest values coming on top in the left panel and on the bottom in the right panel. The thick curves are for \(I_{2}=0\).

Figure 3.32 shows the \((u,p_{u})\) surface of section, which is in practice nothing more than a contour plot of the integral \(I_{2}(E,u,p_{u})\) with \(E\) fixed (eq. 3.268a). Each contour shows the curve in which an orbital torus is sliced by the surface of section. As in Figure 3.9, for example, there are two different types of contour, namely those generated by the tori of loop orbits (which come in pairs, because there are both clockwise and anti-clockwise circulating loops), and those generated by the tori of box orbits, which envelop all the tori of the loop orbits.

#### Summary

We have made a considerable investment in the theory of angle-action variables, which is repaid by the power of these variables in investigations of a wide variety of dynamical problems. This power arises from the following features:

1. Angle-action variables are canonical. In particular, the phase-space volume \({\rm d}^{3}{\boldsymbol{\theta}}{\rm d}^{3}{\bf J}\) is the same as the phase-space volume \({\rm d}^{3}{\bf q}{\rm d}^{3}{\bf p}\) for any other set of canonical variables \(({\bf q},{\bf p})\), including the usual Cartesian coordinates \(({\bf x},{\bf v})\).
2. Every set of angle-action variables \(({\boldsymbol{\theta}},{\bf J})\) is associated with a Hamiltonian24\(H({\bf J})\), and orbits in this Hamiltonian have the simple form

Figure 3.32: The \((u,p_{u})\), \(v=0\) surface of section for motion at \(E=-0.25\) in the Stäckel potential defined by equations (3.247) and (3.252) with \(\Delta=0.6\) and \(a_{3}=1\). Each curve is a contour of constant \(I_{2}\) (eqs. 3.268). The invariant curves of box orbits (\(I_{2}=-0.6,-0.4,\ldots\)) run round the outside of the figure, while the bull’s-eyes at right are the invariant curves of anti-clockwise loop orbits. Temporarily suspending the convention that loops always have \(u>0\), we show the invariant curves of clockwise loops as the bull’s-eyes at left.

\({\bf J}=\mbox{\it constant}\), \(\mathbf{\theta}=\mathbf{\Omega}t+\mbox{\it constant}\). A Hamiltonian that admits angle-action variables is said to be **integrable**. The simplicity of angle-action variables makes them indispensable for investigating motion in non-integrable Hamiltonians by using perturbation theory. This technique will be used to explore chaotic orbits in SS3.7, and the stability of stellar systems in Chapter 5.
3. In the next section we shall see that actions are usually invariant during slow changes in the Hamiltonian.

Footnote 3: The _same_\(\mathbf{\theta}=\mathbf{\Omega}t+\mbox{\it constant}\) is not the case for \(\mathbf{\theta}=\mathbf{\Omega}t+\mbox{\it constant}\).

### 3.6 Slowly varying potentials

So far we have been concerned with motion in potentials that are time-independent in either an inertial or a rotating frame. It is sometimes necessary to consider how stars move in potentials that are time-dependent. The nature of the problem posed by a time-varying potential depends on the speed with which the potential evolves. In this section we shall confine ourselves to potentials that evolve slowly, in which case angle-action variables enable us to predict how a stellar system will respond to changes in the gravitational field that confines it. Such changes occur when:

1. Encounters between the individual stars at the core of a dense stellar system (such as a globular cluster or galaxy center) cause the core to evolve on a timescale of order the relaxation time (1.38), which is much longer than the orbital times of individual stars (SS7.5).
2. Stars of galaxies and globular clusters lose substantial quantities of mass as they gradually evolve and shed their envelopes into interstellar or intergalactic space (Box 7.2).
3. Gas settles into the equatorial plane of a pre-existing dark halo to form a spiral galaxy. In this case the orbits of the halo's dark-matter particles will undergo a slow evolution as the gravitational potential of the disk gains in strength.

Potential variations that are slow compared to a typical orbital frequency are called **adiabatic**. We now show that the actions of stars are constant during such adiabatic changes of the potential. For this reason actions are often called **adiabatic invariants**.

#### 3.6.1 Adiabatic invariance of actions

Suppose we have a sequence of potentials \(\Phi_{\lambda}({\bf x})\) that depend continuously on the parameter \(\lambda\). For each fixed \(\lambda\) we assume that angle-action variables could be constructed for \(\Phi_{\lambda}\). That is, we assume that at all times phase space is filled by arrays of nested tori on which the phase points of individual starstravel. We consider what happens when \(\lambda\) is changed from its initial value, say \(\lambda=\lambda_{0}\), to a new value \(\lambda_{1}\). After this change has occurred, each star's phase point will start to move on a torus of the set that belongs to \(\Phi_{\lambda_{1}}\). In general, two stellar phase points that started out on the same torus of \(\Phi_{\lambda_{0}}\) will end up on two different tori of \(\Phi_{\lambda_{1}}\). But if \(\lambda\) is changed very slowly compared to all the characteristic times \(2\pi/\Omega_{k}\) associated with motion on each torus, all phase points that are initially on a given torus of \(\Phi_{\lambda_{0}}\) will be equally affected by the variation of \(\lambda\). This statement follows from the time averages theorem of SS3.5.1a, which shows that all stars spend the same fraction of their time in each portion of the torus; hence, all stars are affected by slow changes in \(\Phi_{\lambda}\) in the same way. Thus all phase points that start on the same torus of \(\Phi_{\lambda_{0}}\) will end on a single torus of \(\Phi_{\lambda_{1}}\). Said in other language, any two stars that are initially on a common orbit (but at different phases) will still be on a common orbit after the slow variation of \(\lambda\) is complete.

Suppose the variation of \(\lambda\) starts at time \(t=0\) and is complete by time \(\tau\), and let \({\bf H}_{t}\) be the time-evolution operator defined in equation (D.55). Then we have just seen that \({\bf H}_{\tau}\), which is a canonical map (see Appendix D.4.4), maps tori of \(\Phi_{\lambda_{0}}\) onto tori of \(\Phi_{\lambda_{1}}\). These facts guarantee that actions are adiabatically invariant, for the following reason. Choose three closed curves \(\gamma_{i}\), on any torus \(M\) of \(\Phi_{\lambda_{0}}\) that through the integrals (3.195) generate the actions \(J_{i}\) of this torus. Then, since \({\bf H}_{\tau}\) is the endpoint of a continuous deformation of phase space into itself, the images \({\bf H}_{\tau}(\gamma_{i})\) of these curves are suitable curves along which to evaluate the actions \(J_{i}^{\prime}\) of \({\bf H}_{\tau}(M)\), the torus to which \(M\) is mapped by \({\bf H}_{\tau}\). But by a corollary to the Poincare invariant theorem (Appendix D.4.2), we have that if \(\gamma\) is any closed curve and \({\bf H}_{\tau}(\gamma)\) is its image under the canonical map \({\bf H}_{\tau}\), then

\[\oint_{{\bf H}_{\tau}(\gamma)}{\bf p}\cdot{\rm d}{\bf q}=\oint_{\gamma}{\bf p }\cdot{\rm d}{\bf q}. \tag{3.269}\]

Hence \(J_{i}^{\prime}=J_{i}\), and the actions of stars do not change if the potential evolves sufficiently slowly.

It should be stressed that any action \(J_{i}\) with fundamental frequency \(\Omega_{i}=0\) is not an adiabatic invariant. For example, in a spherical potential, \(J_{2}\) and \(J_{3}\) are normally adiabatic invariants, but \(J_{1}\) is not (Table 3.1).

#### Applications

We illustrate these ideas with a number of simple examples. Other applications of adiabatic invariants will be found in Binney & May (1986), Lichtenberg & Lieberman (1992), and SS4.6.1.

**(a) Harmonic oscillator** We first consider the one-dimensional harmonic oscillator whose potential is

\[\Phi={{1\over 2}}\omega^{2}x^{2}. \tag{3.270}\]By equation (3.213) the action is

\[J=\frac{1}{2\omega}\left[p^{2}+(\omega x)^{2}\right]=\frac{H}{\omega}, \tag{3.271}\]

where \(H(x,p)=\frac{1}{2}p^{2}+\frac{1}{2}\omega^{2}x^{2}\). The general solution of the equations of motion is \(x(t)=X\cos(\omega t+\phi)\). In terms of the amplitude of oscillation \(X\) we have

\[J=\tfrac{1}{2}\omega X^{2}. \tag{3.272}\]

Now suppose that the oscillator's spring is slowly stiffened by a factor \(s^{2}>1\), so the natural frequency increases to

\[\omega^{\prime}=s\omega. \tag{3.273}\]

By the adiabatic invariance of \(J\), the new amplitude \(X^{\prime}\) satisfies

\[\tfrac{1}{2}\omega^{\prime}X^{\prime 2}=J=\tfrac{1}{2}\omega X^{2}. \tag{3.274}\]

Thus the amplitude is diminished to

\[X^{\prime}=\frac{X}{\sqrt{s}}, \tag{3.275}\]

while the energy, \(E=\omega J\), has increased to25

Footnote 25: The simplest proof of this result uses quantum mechanics. The energy of a harmonic oscillator is \(E=(n+\tfrac{1}{2})\hbar\omega\) where \(n\) is an integer. When \(\omega\) is slowly varied, \(n\) cannot change discontinuously and hence must remain constant. Therefore \(E/\omega=E^{\prime}/\omega^{\prime}\). Of course, for galaxies \(n\) is rather large.

\[E^{\prime}=\omega^{\prime}J=s\omega J=sE. \tag{3.276}\]

Figure 3.33: Checking the invariance of the action (3.271) when the natural frequency of a harmonic oscillator is varied according to equation (3.277). \(\Delta J\) is the rms change in the action on integrating the oscillator’s equation of motion from \(t=-20T\) to \(t=20T\), using eight equally spaced phases. The rms change in \(J\) declines approximately as \(\Delta J\propto\exp(-2.8\omega_{0}T)\).

We now ask how rapidly we can change the frequency \(\omega\) without destroying the invariance of \(J\). Let \(\omega\) vary with time according to

\[\omega(t)=\pi\sqrt{3+{\rm erf}(t/T)}\,. \tag{3.277}\]

Thus the frequency changes from \(\omega=\omega_{0}\equiv\sqrt{2}\pi\) at \(t\ll-T\) to \(\omega=2\pi=\sqrt{2}\omega_{0}\) at \(t\gg T\). In Figure 3.33 we show the results of numerically integrating the oscillator's equation of motion with \(\omega(t)\) given by equation (3.277). We plot the rms difference \(\Delta J\) between the initial and final values of \(J\) for eight different phases of the oscillator at \(t=-20T\). For \(\omega_{0}T\mathrel{\raise 1.29pt\hbox{$>$}\mskip-14.0mu \lower 2.58pt\hbox{$ \sim$}}2\), \(J\) changes by less than half a percent, and for \(\omega_{0}T\mathrel{\raise 1.29pt\hbox{$>$}\mskip-14.0mu \lower 2.58pt\hbox{$ \sim$}}4\), \(J\) changes by less than \(3\times 10^{-5}\). We conclude that the potential does not have to change very slowly for \(J\) to be well conserved. In fact, one can show that the fractional change in \(J\) is in general less than \(\exp(-\omega T)\) for \(\omega T\gg 1\) (Lichtenberg & Lieberman 1992).

**(b) Eccentric orbits in a disk** Consider the shapes shown in Figure 3.4 of the orbits in the meridional plane of an axisymmetric galaxy. On page 167 we remarked that disk stars in the solar neighborhood oscillate perpendicular to the galactic plane considerably more rapidly than they oscillate in the radial direction. Therefore, if we take the radial coordinate \(R(t)\) of a disk star to be a known function of time, we may consider the equation of motion (3.67c) of the \(z\)-coordinate to describe motion in a slowly varying potential. If the amplitude of the \(z\)-oscillations is small, we may expand \(\partial\Phi/\partial z\) about \(z=0\) to find

\[\ddot{z}\simeq-\omega^{2}z\quad{\rm where}\quad\omega(t)\equiv\left(\frac{ \partial^{2}\Phi}{\partial z^{2}}\right)_{[R(t),0]}^{1/2}\equiv\sqrt{\Phi_{zz} [R(t),0]}. \tag{3.278}\]

If the action integral of this harmonic oscillator is conserved, we expect the amplitude \(Z(R)\) to satisfy (see eqs. 3.273 and 3.275)

\[Z(R)=Z(R_{0})\left(\frac{\Phi_{zz}(R_{0},0)}{\Phi_{zz}(R,0)}\right)^{1/4}. \tag{3.279}\]

Figure 3.34 compares the prediction of (3.279) with the true shape of an orbit in the effective potential (3.70). Evidently the behavior of such orbits can be accurately understood in terms of adiabatic invariants.

**(c) Transient perturbations** Consider the motion of a star on a loop

Figure 3.34: The envelope of an orbit in the effective potential (3.70) with \(q=0.5\) (light curve) is well modeled by equation (3.279) (heavy curves).

orbit in a slowly varying planar potential \(\Phi(R,\phi)\). The relevant action is

\[J_{\phi}={1\over 2\pi}\int_{0}^{2\pi}{\rm d}\phi\,p_{\phi}.\]

We now conduct the following thought experiment. Initially the potential \(\Phi\) is axisymmetric. Then \(p_{\phi}=L_{z}\) is an integral, and we can trivially evaluate the integral in (3.280) to obtain \(J_{\phi}=L_{z}\). We now slowly distort the potential in some arbitrary fashion into a new axisymmetric configuration. At the end of this operation, the azimuthal action, being adiabatically invariant, still has value \(J_{\phi}\) and is again equal to the angular momentum \(L_{z}\). Thus the star finishes the experiment with the same angular momentum with which it started,26 even though its instantaneous angular momentum, \(p_{\phi}\), was changing during most of the experiment. Of course, if the potential remains axisymmetric throughout, \(p_{\phi}\) remains an integral at all times and is exactly conserved no matter how rapidly the potential is varied.

Footnote 26: This statement does not apply for stars that switch from loop to box orbits and back again as the potential is varied (Binney & Spergel 1983; Evans & Collett 1994). These stars will generally be on highly eccentric orbits initially.

A closely related example is a slowly varying external perturbation of a stellar system, perhaps from the gravitational field of an object passing at a low angular velocity. If the passage is slow enough, the actions are adiabatically invariant, so the distribution of actions in the perturbed system will be unchanged by the encounter. In other words, adiabatic encounters, even strong ones, have no lasting effect on a stellar system (SS8.2c).

**(d) Slow growth of a central black hole** As our final application of the adiabatic invariance of actions, we consider the evolution of the orbit of a star near the center of a spherical galaxy, as a massive black hole grows by slowly accreting matter (Goodman & Binney 1984). A more complete treatment of the problem is given in SS4.6.1d. We assume that prior to the formation of the hole, the density of material interior to the orbit can be taken to be a constant, so the potential is that of the spherical harmonic oscillator. It is then easy to show that the star's Hamiltonian can be written (Problem 3.36)

\[H=\Omega_{r}J_{r}+\Omega_{\phi}J_{\phi}=2\Omega J_{r}+\Omega J_{\phi},\]

where \(\Omega=\Omega_{\phi}={1\over 2}\Omega_{r}\) is the circular frequency, and \(J_{\phi}=L\) is the magnitude of the angular-momentum vector. The radii \(r_{\rm min}\) and \(r_{\rm max}\) of peri- and apocenter are the roots of

\[0={J_{\phi}^{2}\over 2r^{2}}+{{1\over 2}}\Omega^{2}r^{2}-H\quad \Rightarrow\quad 0=r^{4}-{2H\over\Omega^{2}}r^{2}+{J_{\phi}^{2}\over \Omega^{2}}.\]Hence, the axis ratio of the orbit is

\[\begin{split} q_{\rm H}=\frac{r_{\rm min}}{r_{\rm max}}& =\left(\frac{H/\Omega^{2}-\left[(H/\Omega^{2})^{2}-(J_{\phi}/\Omega)^{2}\right] ^{1/2}}{H/\Omega^{2}+\left[(H/\Omega^{2})^{2}-(J_{\phi}/\Omega)^{2}\right]^{1/ 2}}\right)^{1/2}\\ &=\left(\frac{2J_{r}+J_{\phi}-2[J_{r}(J_{r}+J_{\phi})]^{1/2}}{2J_ {r}+J_{\phi}+2[J_{r}(J_{r}+J_{\phi})]^{1/2}}\right)^{1/2}.\end{split} \tag{3.283}\]

Multiplying top and bottom of the fraction by the top, this last expression reduces to

\[q_{\rm H}=\frac{1}{J_{\phi}}\bigl{[}2J_{r}+J_{\phi}-2\sqrt{J_{r}(J_{r}+J_{\phi })}\,\bigr{]}. \tag{3.284}\]

When the hole has become sufficiently massive, the Hamiltonian may be taken to be that for Kepler motion (eq. E.6) and the orbit becomes an ellipse with the black hole at the focus rather than the center of the ellipse. A similar calculation yields for the axis ratio of this ellipse

\[q_{\rm K}=\left[1-\left(\frac{r_{\rm max}-r_{\rm min}}{r_{\rm max}+r_{\rm min}} \right)^{2}\right]^{1/2}=\frac{J_{\phi}}{J_{r}+J_{\phi}}. \tag{3.285}\]

When \(J_{r}/J_{\phi}\) is eliminated between equations (3.284) and (3.285), we find

\[q_{\rm K}=\frac{4q_{\rm H}}{(1+q_{\rm H})^{2}}. \tag{3.286}\]

For example, if \(q_{\rm H}=0.5\) is the original axis ratio, the final one is \(q_{\rm K}=0.889\), and if initially \(q_{\rm H}=0.75\), then finally \(q_{\rm K}=0.980\). Physically, an elongated ellipse that is centered on the black hole distorts into a much rounder orbit with the black hole at one focus.

For any orbit in a spherical potential the mean-square radial speed is

\[\overline{v_{r}^{2}}=\frac{\Omega_{r}}{\pi}\int_{0}^{\pi/\Omega_{r}}{\rm d}t\, v_{r}^{2}=\frac{\Omega_{r}}{\pi}\int_{r_{\rm min}}^{r_{\rm max}}{\rm d}r\,v_{r}= \Omega_{r}J_{r}.\] (3.287a) Similarly, the mean-square tangential speed is \[\overline{v_{\rm t}^{2}}=\frac{\Omega_{\phi}}{2\pi}\int_{0}^{2\pi/\Omega_{ \phi}}{\rm d}t\,(R\dot{\phi})^{2}=\frac{\Omega_{\phi}}{2\pi}\int_{0}^{2\pi}{ \rm d}\phi\,p_{\phi}=\Omega_{\phi}J_{\phi}. \tag{3.287b}\]

Since the actions do not change as the hole grows, the change in the ratio of the mean-square speeds is given by

\[\frac{\left(\overline{v_{r}^{2}}/\overline{v_{\rm t}^{2}}\right)_{\rm K}}{ \left(\overline{v_{r}^{2}}/\overline{v_{\rm t}^{2}}\right)_{\rm H}}=\frac{( \Omega_{r}/\Omega_{\phi})_{\rm K}}{(\Omega_{r}/\Omega_{\phi})_{\rm H}}=\frac{1 }{2}. \tag{3.288}\]

Consequently, the growth of the black hole increases the star's tangential velocity much more than it does the radial velocity, irrespective of the original eccentricity of the orbit. In SS4.6.1a we shall investigate the implications of this result for measurements of the stellar velocity dispersion near a black hole, and show how the growth of the black hole enhances the density of stars in its vicinity.

### 3.7 Perturbations and chaos

Analytic solutions to a star's equations of motion exist for only a few simple potentials \(\Phi({\bf x})\). If we want to know how stars will move in a more complex potential, for example one estimated from observational data, two strategies are open to us: either solve the equations of motion numerically, or obtain an approximate analytic solution by invoking perturbation theory, which involves expressing the given potential as a sum of a potential for which we can solve the equations of motion analytically and a (one hopes) small additional term.

Even in the age of fast, cheap and convenient numerical computation, perturbative solutions to the equations of motion are useful in two ways. First, they can be used to investigate the stability of stellar systems (SS5.3). Second, they give physical insight into the dynamics of orbits. We start this section by developing perturbation theory and sketching some of its astronomical applications; then we describe the phenomenon of orbital chaos, and show that Hamiltonian perturbation theory helps us to understand the physics of this phenomenon.

#### 3.7.1 Hamiltonian perturbation theory

In SS3.3.3 we derived approximate orbits in the potential of a weak bar, by treating the potential as a superposition of a small non-axisymmetric potential and a much larger axisymmetric one. Our approach involved writing the orbit \({\bf x}(t)\) as a sum of two parts, one of which described the circular orbit of a guiding center, while the other described epicyclic motion. We worked directly with the equations of motion. Angle-action variables enable us to develop a more powerful perturbative scheme, in which we work with scalar functions rather than coordinates, and think of the orbit as a torus in phase space rather than a time-ordered series of points along a trajectory. For more detail see Lichtenberg & Lieberman (1992).

Let \(H^{0}\) be an integrable Hamiltonian, and consider the one-parameter family of Hamiltonians

\[H^{\beta}\equiv H^{0}+\beta h, \tag{3.289}\]

where \(\beta\ll 1\) and \(h\) is a Hamiltonian with gradients that are comparable in magnitude to those of \(H^{0}\). Let \(({\mathbf{\theta}}^{\beta},{\bf J}^{\beta})\) be angle-action variables for \(H^{\beta}\). These coordinates are related to the angle-action variables of \(H^{0}\) by a canonical transformation. As \(\beta\to 0\) the generating function \(S\) (Appendix D.4.6) of this transformation will tend to the generating function of the identity transformation, so we may write

\[S({\mathbf{\theta}}^{\beta},{\bf J}^{0})={\mathbf{\theta}}^ {\beta}\cdot{\bf J}^{0}+s^{\beta}({\mathbf{\theta}}^{\beta},{\bf J}^ {0}), \tag{3.290}\]

where \(s^{\beta}\) is O(\(\beta\)), and (eq. D.94)

\[{\bf J}^{\beta}=\frac{\partial S}{\partial{\mathbf{\theta}}^{\beta }}={\bf J}^{0}+\frac{\partial s^{\beta}}{\partial{\mathbf{\theta}}^ {\beta}}\quad;\quad{\mathbf{\theta}}^{0}={\mathbf{\theta}}^ {\beta}+\frac{\partial s^{\beta}}{\partial{\bf J}^{0}}. \tag{3.291}\]Substituting these equations into (3.289), we have

\[\eqalign{H^{\beta}({\bf J}^{\beta})&=H^{0}({\bf J}^{0})+\beta h({\boldsymbol{ \theta}}^{0},{\bf J}^{0})\cr&=H^{0}\Big{(}{\bf J}^{\beta}-{\partial s^{\beta} \over\partial{\boldsymbol{\theta}}^{\beta}}\Big{)}+\beta h\Big{(}{\boldsymbol {\theta}}^{\beta}+{\partial s^{\beta}\over\partial{\bf J}^{0}},{\bf J}^{\beta} -{\partial s^{\beta}\over\partial{\boldsymbol{\theta}}^{\beta}}\Big{)}\cr&=H^{0} ({\bf J}^{\beta})-{\boldsymbol{\Omega}}^{0}({\bf J}^{\beta})\cdot{\partial s^{ \beta}\over\partial{\boldsymbol{\theta}}^{\beta}}+\beta h({\boldsymbol{\theta }}^{\beta},{\bf J}^{\beta})+{\rm O}(\beta^{2}),}\]

where \({\boldsymbol{\Omega}}^{0}\) is the derivative of \(H^{0}\) with respect to its argument. We next expand \(h\) and \(s^{\beta}\) as Fourier series in the periodic angle variables (Appendix B.4):

\[h({\boldsymbol{\theta}}^{\beta},{\bf J}^{\beta})=\sum_{\bf n}h_{\bf n}({\bf J }^{\beta})\,{\rm e}^{{\rm i}{\bf n}\cdot{\boldsymbol{\theta}}^{\beta}}\ ;\ s^{\beta}({ \boldsymbol{\theta}}^{\beta},{\bf J}^{0})={\rm i}\sum_{\bf n}s^{\beta}_{\bf n }({\bf J}^{0})\,{\rm e}^{{\rm i}{\bf n}\cdot{\boldsymbol{\theta}}^{\beta}},\]

where \({\bf n}=(n_{1},n_{2},n_{3})\) is a triple of integers. Substituting these expressions into (3.292) we find

\[H^{\beta}({\bf J}^{\beta})=H^{0}({\bf J}^{\beta})+\beta h_{0}+\sum_{\bf n \neq 0}\Big{(}\beta h_{\bf n}+{\bf n}\cdot{\boldsymbol{\Omega}}^{0}s^{\beta}_{ \bf n}\Big{)}\,{\rm e}^{{\rm i}{\bf n}\cdot{\boldsymbol{\theta}}^{\beta}}+{ \rm O}(\beta^{2}).\]

In this equation \({\boldsymbol{\Omega}}^{0}\) and \(h_{\bf n}\) are functions of \({\bf J}^{\beta}\), while \(s_{\bf n}\) is a function of \({\bf J}^{0}\), but to the required order in \(\beta\), \({\bf J}^{0}\) can be replaced by \({\bf J}^{\beta}\).

Since the left side of equation (3.294) does not depend on \({\boldsymbol{\theta}}^{\beta}\), on the right the coefficient of \(\exp({\rm i}{\bf n}\cdot{\boldsymbol{\theta}}^{\beta})\) must vanish for all \({\bf n}\neq 0\). Hence the Fourier coefficients of \(S\) are given by

\[s^{\beta}_{\bf n}({\bf J})=-{\beta h_{\bf n}({\bf J})\over{\bf n}\cdot{ \boldsymbol{\Omega}}^{0}({\bf J})}+{\rm O}(\beta^{2})\quad({\bf n}\neq 0).\]

The \({\rm O}(\beta)\) part of equation (3.295) defines the generating function of a canonical transformation. Let \(({\boldsymbol{\theta}}^{\prime},{\bf J}^{\prime})\) be the images of \(({\boldsymbol{\theta}}^{0},{\bf J}^{0})\) under this transformation. Then we have shown that

\[H^{\beta}({\bf J}^{\beta})=H^{\prime}({\bf J}^{\prime})+\beta^{2}h^{\prime}({ \boldsymbol{\theta}}^{\prime},{\bf J}^{\prime}),\]

where

\[H^{\prime}({\bf J}^{\prime})\equiv H^{0}({\bf J}^{\prime})+\beta h_{0}({\bf J }^{\prime})\]

and \(h^{\prime}\) is a function involving second derivatives of \(H^{0}\) and first derivatives of \(h\).

The analysis we have developed can be used to approximate orbits in a given potential. As we saw in SS3.2.2, if we know an integral other than the Hamiltonian of a system with two degrees of freedom, we can calculate the curve in a surface of section on which the consequents of a numerically integrated orbit should lie. Since \({\bf J}^{\prime}\) differs from the true action by only \({\rm O}(\beta^{2})\) it should provide an approximate integral of motion, and it is interesting to compare the invariant curve that it yields with the consequents of a numerically integrated orbit. Figure 3.35 is a surface of section for orbits in a flattened isochrone potential. The density distribution that generates this potential is obtained by replacing \(r\) by \(\sqrt{R^{2}+z^{2}/q^{2}}\) and \(M\) by \(M/q\) in equations (2.48b) and (2.49). The axis ratio \(q\) has been set equal to 0.7. The dots show the consequents of numerically integrated orbits. The dotted curves show the corresponding invariant curves for the spherical isochrone. The full curves show the results of applying first-order perturbation theory to the spherical isochrone to obtain better approximations to invariant curves.

The full curves in Figure 3.35 fit the numerical consequents much better than the dotted curves, but the fit is not perfect. An obvious strategy for systematically improving our approximation to the true angle-action variables is to use our existing machinery to derive from (3.296a) a second canonical transformation that would enable us to write \(H\) as a sum of a Hamiltonian \(H^{\prime\prime}({\bf J}^{\prime\prime})\) that is a function of new actions \({\bf J}^{\prime\prime}\) and a yet smaller perturbation \(\beta^{4}h^{\prime\prime}\). After we have performed \(k\) transformations, the angle-dependent part of \(H^{\beta}\) will be of order \(\beta^{2^{k}}\). In practice this procedure is unlikely to work because after each application the "unperturbed" frequencies of the orbit change from \(\mathbf{\Omega}^{\prime}=\partial H^{\prime}/\partial{\bf J}^{\prime}\) to \(\mathbf{\Omega}^{\prime\prime}=\partial H^{\prime\prime}/\partial{ \bf J}^{\prime\prime}\), and sooner or later we will find that \({\bf n}\cdot\mathbf{\Omega}^{\prime\prime}\) is very close to zero for some \({\bf n}\), with the consequence that the corresponding term in the generating function (3.295) becomes large.

Figure 3.35: A surface of section for orbits in a flattened isochrone potential. The density distribution generating the potential has axis ratio \(q=0.7\). The points are the consequents of numerically calculated orbits. The dotted curves show the orbital tori for the spherical isochrone potential that have the same actions as the numerically integrated orbits. The full curves show the result of using first-order Hamiltonian perturbation theory to deform these tori.

This is the problem of **small divisors**. Fortunately, in many applications the coefficients \(h_{\bf n}\) in the numerators of (3.295) decline sufficiently quickly as \(|{\bf n}|\) increases that for most orbits \(|\beta^{2^{k}}h_{\bf n}/{\bf n}\cdot{\bf\Omega}|\) is small for all \({\bf n}\).

Box 3.5 outlines how the so-called **KAM theory** enables one to overcome the problem of small divisors for most tori, and for them construct a convergent series of canonical transformations that yield the angle-action variables of \(H^{\beta}\) to arbitrarily high accuracy for sufficiently small \(\beta\).

#### 3.7.2 Trapping by resonances

Figure 3.36, like Figure 3.35, is a surface of section for motion in a flattened isochrone potential, but the axis ratio of the mass distribution that generates the potential is now \(q=0.4\) rather than \(q=0.7\). The consequents of two orbits are shown together with the approximations to the invariant curves of these orbits that one obtains from the angle-action variables of the spherical isochrone potential with (full curves) and without (dotted curves) first-order perturbation theory. The inner full invariant curve is not very far removed from the inner loop of orbital consequents, but the outer full invariant curve does not even have the same shape as the crescent of consequents that is generated by the second orbit. The deviation between the outer full invariant curve and the consequents is an example of **resonant trapping**, a phenomenon intimately connected with the problem of small divisors that was described above.

To understand this connection, consider how the frequencies of orbits in the flattened isochrone potential are changed by first-order perturbation theory. We obtain the new frequencies by differentiating equation (3.296b) with respect to the actions. Figure 3.37 shows the resulting ratio \(\Omega_{r}/\Omega_{\vartheta}\) as a function of \(J_{\vartheta}\) at the energy of Figure 3.36. Whereas \(\Omega_{r}>\Omega_{\vartheta}\) for all unperturbed orbits, for some perturbed orbit the resonant condition \(\Omega_{r}-\Omega_{\vartheta}=0\) is satisfied. Consequently, if we attempt to use equation (3.295) to refine the tori that generate the full curves in Figure 3.36, small divisors will lead to large distortions in the neighborhood of the resonant torus. These distortions will be unphysical, but they are symptomatic of a real physical effect, namely a complete change in the way in which orbital tori are embedded in phase space. The numerical consequents in Figure 3.36, which mark cross-sections through two tori, one before and one after the change in the embedding, make the change apparent: one torus encloses the shell orbit whose single consequent lies along \(p_{R}=0\), while the other torus encloses the resonant orbit whose single consequent lies near \((R,p_{R})=(2.2,0.38)\).

Small divisors are important physically because they indicate that a perturbation is acting with one sign for a long time. If the effects of a perturbation can accumulate for long enough, they can become important, even if the perturbation is weak. So if \({\bf N}\cdot{\bf\Omega}\) is small for some \({\bf N}\), then the term \(h_{\bf N}\) in the Hamiltonian can have big effects even if it is very small.

### 3.5: KAM theory

Over the period 1954-1967 Kolmogorov, Arnold and Moser demonstrated that, notwithstanding the problem of small divisors, convergent perturbation series _can_ be constructed for Hamiltonians of the form (3.289). The key ideas are (i) to focus on a single invariant torus rather than a complete foliation of phase space by invariant tori, and (ii) to determine at the outset the frequencies \(\mathbf{\Omega}\) of the torus to be constructed (Lichtenberg & Lieberman 1992). In particular, we specify that the frequency ratios are far from resonances in the sense that \(|\mathbf{n}\cdot\mathbf{\Omega}|>\alpha|\mathbf{n}|^{-\gamma}\) for all \(\mathbf{n}\) and some fixed, non-negative numbers \(\alpha\) and \(\gamma\). We map an invariant torus of \(H^{0}\) with frequencies \(\mathbf{\Omega}\) into an invariant torus of \(H^{\beta}\) by means of the generating function

\[S(\mathbf{\theta}^{\beta},\mathbf{J}^{0})=\mathbf{\theta}^{\beta}\cdot( \mathbf{J}^{0}+\mathbf{j})+s^{\beta}(\mathbf{\theta}^{\beta},\mathbf{J}^{0}). \tag{1}\]

This differs from (3.290) by the addition of a term \(\mathbf{\theta}^{\beta}\cdot\mathbf{j}\), where \(\mathbf{j}\) is a constant of order \(\beta\). Proceeding in strict analogy with the derivation of equations (3.295) and (3.296b), we find that if the Fourier coefficients of \(s^{\beta}\) are chosen to be

\[s^{\beta}_{\mathbf{n}}=-\frac{\beta h_{\mathbf{n}}}{\mathbf{n}\cdot\mathbf{ \Omega}}\quad(\mathbf{n}\neq 0), \tag{2}\]

then we obtain a canonical transformation to new coordinates \((\mathbf{\theta}^{\prime},\mathbf{J}^{\prime})\) in terms of which \(H^{\beta}\) takes the form (3.296a) with

\[H^{\prime}(\mathbf{J}^{\prime})=H^{0}(\mathbf{J}^{\prime})+\beta h_{0}( \mathbf{J}^{\prime})-\mathbf{j}\cdot\mathbf{\Omega}. \tag{3}\]

We now choose the parameter \(\mathbf{j}\) such that the frequencies of \(H^{\prime}\) are still the old frequencies \(\mathbf{\Omega}\), which were far from any resonance. That is, we choose \(\mathbf{j}\) to be the solution of

\[\beta\frac{\partial h_{0}}{\partial J_{j}}=\mathbf{j}\cdot\frac{\partial \mathbf{\Omega}}{\partial J_{j}}=\sum_{i}j_{i}\cdot\frac{\partial^{2}H^{0}}{ \partial J_{i}\partial J_{j}}. \tag{4}\]

This linear algebraic equation will be soluble provided the matrix of second derivatives of \(H^{0}\) is non-degenerate. With \(\mathbf{j}\) the solution to this equation, the problem posed by \(H^{\beta}\) in the \((\mathbf{\theta}^{\prime},\mathbf{J}^{\prime})\) coordinates differs from our original problem only in that the perturbation is now \(\mathrm{O}(\beta^{2})\). Consequently, a further canonical transformation will reduce the perturbation to \(\mathrm{O}(\beta^{4})\) and so on indefinitely. From the condition \(|\mathbf{n}\cdot\mathbf{\Omega}|>\alpha|\mathbf{n}|^{-\gamma}\) one may show that the series of transformations converges.

We now use this idea to obtain an analytic model of orbits near resonances. Our working will be a generalization of the discussion of orbital trapping at Lindblad resonances in SS3.3.3b. For definiteness we shall assumethat there are three actions and three angles. The resonance of \(H^{0}\) is characterized by the equation \({\bf N}\cdot{\bf\Omega}=0\), and \(({\bf\theta},{\bf J})\) are angle-action variables for the unperturbed Hamiltonian. Then in the neighborhood of the resonant orbit the linear combination of angle variables \(\phi_{\rm s}\equiv{\bf N}\cdot{\bf\theta}\) will evolve slowly, and we start by transforming to a set of angle-action variables that includes the **slow angle**\(\phi_{\rm s}\). To do so, we introduce new action variables \(I_{\rm s}\), \(I_{\rm f1}\), and \(I_{\rm f2}\) through the generating function

\[S=({\bf N}\cdot{\bf\theta})I_{\rm s}+\theta_{1}I_{\rm f1}+\theta_{2}I_{\rm f2}. \tag{3.297}\]

Then (eq. D.93)

\[\begin{array}{ll}\phi_{\rm s}=\frac{\partial S}{\partial I_{\rm s}}={\bf N} \cdot{\bf\theta}&J_{1}=\frac{\partial S}{\partial\theta_{1}}=N_{1}I_{\rm s}+I _{\rm f1}\\ \phi_{\rm f1}=\theta_{1}&J_{2}=N_{2}I_{\rm s}+I_{\rm f2}\\ \phi_{\rm f2}=\theta_{2}&J_{3}=N_{3}I_{\rm s}.\end{array} \tag{3.298}\]

Figure 3.36: The same as Figure 3.35 except that the density distribution generating the potential now has axis ratio \(q=0.4\).

Figure 3.37: The ratio of the frequencies in first-order perturbation theory for a star that moves in a flattened isochrone potential.

Since the old actions are functions only of the new ones, \(H^{0}\) does not acquire any angle dependence when we make the canonical transformation, and the Hamiltonian is of the form

\[H(\mathbf{\phi},{\bf I})=H^{0}({\bf I})+\beta\sum_{\bf n}h_{\bf n}({\bf I }){\rm e}^{{\rm i}{\bf n}\cdot\mathbf{\phi}}, \tag{3.299}\]

where it is to be understood that \(H^{0}\) is a different function of \({\bf I}\) than it was of \({\bf J}\) and similarly for the dependence on \({\bf I}\) of \(h_{\bf n}\). We now argue that any term in the sum that contains either of the **fast angles**\(\phi_{\rm f1}\) and \(\phi_{\rm f2}\) has a negligible effect on the dynamics--these terms give rise to forces that rapidly average to zero. We therefore drop all terms except those with indices that are multiples of \({\bf n}=\pm(1,0,0)\), including \({\bf n}={\bf 0}\). Then our approximate Hamiltonian reduces to

\[H(\mathbf{\phi},{\bf I})=H^{0}({\bf I})+\beta{\sum_{k}}h_{k}({\bf I}) \,{\rm e}^{{\rm i}k\phi_{\rm s}}. \tag{3.300}\]

Hamilton's equations now read

\[\begin{array}{c}\dot{I}_{\rm s}=-{\rm i}\beta\sum_{k}kh_{k}({\bf I})\,{\rm e }^{{\rm i}k\phi_{\rm s}}\quad;\quad\dot{\phi}_{\rm s}=\Omega_{\rm s}+\beta\sum _{k}\frac{\partial h_{k}}{\partial I_{\rm s}}\,{\rm e}^{{\rm i}k\phi_{\rm s}} \\ \dot{I}_{\rm f1}=0\quad;\quad\dot{I}_{\rm f2}=0,\end{array} \tag{3.301}\]

where \(\Omega_{\rm s}\equiv\partial H^{0}/\partial I_{\rm s}\). So \(I_{\rm f1}\) and \(I_{\rm f2}\) are two constants of motion and we have reduced our problem to one of motion in the \((\phi_{\rm s},I_{\rm s})\) plane. Eliminating \({\bf I}\) between equations (3.298) and (3.301) we find that although all the old actions vary, two linear combinations of them are constant:

\[N_{2}J_{1}-N_{1}J_{2}={\rm constant}\quad;\quad N_{3}J_{2}-N_{2}J_{3}={\rm constant}. \tag{3.302}\]

We next take the time derivative of the equation of motion (3.301) for \(\phi_{\rm s}\). We note that \(\Omega_{\rm s}\), but not its derivative with respect to \(I_{\rm s}\), is small because it vanishes on the resonant torus. Dropping all terms smaller than O(\(\beta\)),

\[\ddot{\phi}_{\rm s}\simeq\frac{\partial\Omega_{\rm s}}{\partial I_{\rm s}} \dot{I}_{\rm s}=-{\rm i}\beta\frac{\partial\Omega_{\rm s}}{\partial I_{\rm s} }\sum_{k}kh_{k}{\rm e}^{{\rm i}k\phi_{\rm s}}. \tag{3.303}\]

If we define

\[V(\phi_{\rm s})\equiv\beta\frac{\partial\Omega_{\rm s}}{\partial I_{\rm s}}{ \sum_{k}}h_{k}({\bf I})\,{\rm e}^{{\rm i}k\phi_{\rm s}}, \tag{3.304}\]

where \({\bf I}\) is evaluated on the resonant torus, then we can rewrite (3.303) as

\[\ddot{\phi}_{\rm s}=-\frac{{\rm d}V}{{\rm d}\phi_{\rm s}}. \tag{3.305}\]This is the equation of motion of an oscillator. If \(V\) were proportional to \(\phi_{\rm s}^{2}\), the oscillator would be harmonic. In general it is an anharmonic oscillator, such as a pendulum, for which \(V\propto\cos\phi_{\rm s}\). The oscillator's energy invariant is

\[E_{\rm p}\equiv{{1\over 2}}\dot{\phi}_{\rm s}^{2}+V(\phi_{\rm s}).\]

\(V\) is a periodic function of \(\phi_{\rm s}\), so it will have some maximum value \(V_{\rm max}\), and if \(E_{\rm p}>V_{\rm max}\), \(\phi_{\rm s}\) circulates because equation (3.306) does not permit \(\phi_{\rm s}\) to vanish. In this case the orbit is not resonantly trapped and the torus is like the ones shown in Figure 3.36 from first-order perturbation theory. If \(E_{\rm p}<V_{\rm max}\), the angle variable is confined to the range in which \(V\leq E_{\rm p}\); the orbit has been trapped by the resonance. On trapped orbits \(\phi_{\rm s}\) librates with an amplitude that can be of order unity, and at a frequency of order \(\surd\beta\), while \(I_{\rm s}\) oscillates with an amplitude that cannot be bigger than order \(\surd\beta\). Such orbits generate the kind of torus that is delineated by the crescent of numerical consequents in Figure 3.36. We obtain an explicit expression for the resonantly induced change \(\Delta I_{\rm s}\) by integrating the equation of motion (3.301) for \(I_{\rm s}\):

\[\eqalign{\Delta I_{\rm s}&=-\Bigl{(}{\partial\Omega_{\rm s}\over\partial I_{ \rm s}}\Bigr{)}^{-1}\int{\rm d}\phi_{\rm s}{\partial V/\partial\phi_{\rm s} \over\dot{\phi}_{\rm s}}\cr&=\pm\Bigl{(}{\partial\Omega_{\rm s}\over\partial I_ {\rm s}}\Bigr{)}^{-1}\sqrt{2[E_{\rm p}-V(\phi_{\rm s})]}\,,}\]

where (3.306) has been used to eliminate \(\dot{\phi}_{\rm s}\).

The full curve in Figure 3.38 shows the result of applying this model of a resonantly trapped orbit to the data depicted in Figure 3.36. Since the model successfully reproduces the gross form of the invariant curve on which the consequents of the trapped orbit lie, we infer that the model has captured the essential physics of resonant trapping. The discrepancies between the full curve and the numerical consequents are attributable to the approximations inherent in the model.

**Levitation** We now describe one example of an astronomical phenomena that may be caused by resonant trapping of stellar orbits. Other examples are discussed by Tremaine & Yu (2000). In our discussion we shall employ \(J_{r}\), \(J_{\vartheta}\) and \(J_{\phi}\) to denote the actions of a mildly non-spherical potential that are the natural extensions of the corresponding actions for spherical systems that were introduced in SS3.5.2.

The disk of the Milky Way seems to be a composite of two chemically distinct disks, namely the thin disk, to which the Sun belongs, and a thicker, more metal-poor disk (page 13). Sridhar & Touma (1996) have suggested that resonant trapping of the orbits of disk stars may have converted the Galaxy's original thin disk into the thick disk. The theory of hierarchical galaxy formation described in Chapter 9 predicts that the Galaxy was originally dominated by collisionless dark matter, which is not highly concentrated towards the plane. Consequently, the frequency \(\Omega_{\vartheta}\) at which a star oscillated perpendicular to the plane was originally smaller than the frequency \(\Omega_{r}\) of radial oscillations--see equation (3.82). As more and more baryonic material accumulated near the Galaxy's equatorial plane, the ratio \(\Omega_{\vartheta}/\Omega_{r}\) rose slowly from a value less than unity to its present value. For stars such as the Sun that are on nearly circular orbits within the plane, \(\Omega_{r}\) and \(\Omega_{\vartheta}\) are equal to the current epicycle and vertical frequencies \(\kappa\) and \(\nu\), respectively, so now \(\Omega_{\vartheta}/\Omega_{r}\simeq 2\) (page 167). It follows that the resonant condition \(\Omega_{r}=\Omega_{\vartheta}\) has at some stage been satisfied for many stars that formed when the inner Galaxy was dark-matter dominated.

Let us ask what happens to a star in the disk as the disk slowly grows and \(\Omega_{\vartheta}/\Omega_{r}\) slowly increases. At any energy, the first stars to satisfy the resonant condition \(\Omega_{r}=\Omega_{\vartheta}\) will have been those with the largest values of \(\Omega_{\vartheta}\), that is, stars that orbit close to the plane, and have \(J_{\vartheta}\simeq 0\). In an \((R,p_{R})\) surface of section, such orbits lie near the zero-velocity curve that bounds the figure (SS3.2.2) because \(J_{\vartheta}\) increases as one moves in towards the central fixed point on \(p_{R}=0\). Hence, the resonant condition will first have been satisfied on the zero-velocity curve, and it is here that the resonant island seen in Figure 3.38 first emerged as the potential flattened. As mass accumulated in the disk, the island moved inwards, and, depending on the values of \(E\) and \(L_{z}\), finally disappeared near the central fixed point.

Figure 3.38: Perturbation theory applied to resonant trapping in the flattened isochrone potential. The points are the consequents shown in Figure 3.36, while the full curves in that figure are shown dotted here. The full curve shows the result of using (3.307) to model the resonantly trapped orbit.

When the advancing edge of a resonant island reaches the star's phase-space location, there are two possibilities: either (a) the star is trapped by the resonance and its phase-space point subsequently moves within the island, or (b) its phase-space point suddenly jumps to the other side of the island. Which of (a) or (b) occurs in a particular case depends on the precise phase of the star's orbit at which the edge reaches it. In practice it is most useful to discard phase information and to consider that either (a) or (b) occurs with appropriate probabilities \(P_{\rm a}\) and \(P_{\rm b}=1-P_{\rm a}\). The value of \(P_{\rm a}\) depends on the speed with which the island is growing relative to the speed with which its center is moving (Problem 3.43); it is zero if the island is shrinking.

We have seen that the resonant island associated with \(\Omega_{r}=\Omega_{\vartheta}\) first emerged on the zero-velocity curve, which in a thin disk is highly populated by stars. Most of these stars were trapped as the island grew. They then moved with the island as the latter moved in towards the central fixed point. The stars were finally released as the island shrank somewhere near that point. The net effect of the island's transitory existence is to convert radial action to latitudinal action, thereby shifting stars from eccentric, planar orbits to rather circular but highly inclined ones. Hence, a hot thin disk could have been transformed into a thick disk.

Figure 3.39: A surface of section for motion in \(\Phi_{\rm L}\) (eq. 3.103) with \(q=0.6\).

#### From order to chaos

Figure 3.39 is a surface of section for motion in the planar barred potential \(\Phi_{\rm L}\) that is defined by equation (3.103) with \(q=0.6\) and \(R_{\rm c}=0.14\). It should be compared with Figures 3.9 and 3.12, which are surfaces of section for motion in \(\Phi_{\rm L}\) for more nearly spherical cases, with \(q=0.9\) and \(0.8\). In Figure 3.39 one sees not only the invariant curves of loop and box orbits that fill the other two figures, but also a number of "islands": a set of four large islands occupies much of the outer region, while a set of six islands of varying sizes is seen further in. In the light of our discussion of resonant trapping, it is natural to refer to the orbits that generate these islands as resonantly trapped box orbits. Figure 3.40 shows what these orbits look like in real space. We see that the outer islands are generated by "banana" orbits in which the \(x\)- and \(y\)-oscillations are trapped in a \(\Omega_{x}\):\(\Omega_{y}=1\):\(2\) resonance (the star oscillates through one cycle left to right while oscillating through two cycles up and down). Similarly, the inner chain of six islands is associated with a "fish" orbit that satisfies the resonance condition \(\Omega_{x}\):\(\Omega_{y}=2\):\(3\).

The islands in Figure 3.39 can be thought of as orbits in some underlying integrable Hamiltonian \(H^{0}\) that are trapped by a resonance arising from a perturbation. This concept lacks precision because we do not know what \(H^{0}\) actually is. In particular, Hamiltonians of the form \(H_{q}({\bf x},{\bf v})=\frac{1}{2}v^{2}+\Phi_{\rm L}({\bf x})\) are probably not integrable for any value of the axis ratio \(q\) other than unity. Therefore, we cannot simply assume that \(H^{0}=H_{0.8}\), say. On the other hand, Figure 3.12, which shows the surface of section for \(q=0.8\), contains no resonant islands--all orbits are either boxes or loops--which we know from our study of Stackel potentials in SS3.5.4 is compatible with an integrable potential. So we can _define_ an integrable Hamiltonian \(H^{0}\) that differs very little from \(H_{0.8}\) as follows. On each of the invariant tori that

Figure 3.40: The appearance in real space of a banana orbit (top) and a fish orbit (bottom). In the upper panel the cross marks the center of the potential. Resonant box orbits of these types are responsible for the chains of islands in Figure 3.39. The banana orbits generate the outer chain of four islands, and the fish orbits the chain of six islands further in.

appears in Figure 3.12 we set \(H^{0}=H_{0.8}\), and at a general phase-space point we obtain the value of \(H^{0}\) by a suitable interpolation scheme from nearby points at which \(H^{0}=H_{0.8}\).

The procedure we have just described for defining \(H^{0}\) (and thus the perturbation \(h=H-H^{0}\)) suffers from the defect that it is arbitrary: why start from the invariant tori of \(H_{0.8}\) rather than \(H_{0.81}\) or some other Hamiltonian? A numerical procedure that might be considered less arbitrary has been described by Kaasalainen & Binney (1994). In any event, it is worth bearing in mind in the discussion that follows that \(H^{0}\) and \(h\) are not uniquely defined, and one really ought to demonstrate that for a given \(H\) the islands that are predicted by perturbation theory are reasonably independent of \(H^{0}\). As far as we know, no such demonstration is available.

If we accept that the island chains in Figure 3.39 arise from box orbits that are resonantly trapped by some perturbation \(h\) on a Stackel-like Hamiltonian \(H^{0}\), two questions arise. First, "are box orbits trapped around resonances other than the 1:2 and 2:3 resonances that generate the banana and fish orbits of Figure 3.40?" Certainly infinitely many resonances are available to trap orbits because as one moves along the sequence of box orbits from thin ones to fat ones, the period of the \(y\)-oscillations is steadily growing in parallel with their amplitude, while the period of the \(x\)-oscillations is diminishing for the same reason.27 In fact, the transition to loop orbits can be associated with resonant trapping by the 1:1 resonance, so between the banana orbits and the loop orbits there is not only the 2:3 resonance that generates the fishes, but also the 4:5, 5:6,..., resonances. In the potential \(\Phi_{\rm L}\) on which our example is based, the width of the region in phase space in which orbits are trapped by the \(m\):\(n\) resonance diminishes rapidly with \(|m+n|\) and the higher-order resonances are hard to trace in the surface of section--but the 4:5 resonance can be seen in Figure 3.39.

Footnote 27: The period of a nonlinear oscillator almost always increases with amplitude.

The second question is "do resonances occur within resonant islands?" Consider the case of the banana orbits shown in Figure 3.40 as an example. Motion along this orbit is quasiperiodic with two independent frequencies. One independent frequency \(\Omega_{\rm b}\) is associated with motion along the bow-shaped closed orbit that runs through the heart of the banana, while the other is the frequency of libration \(\Omega_{l}\) about this closed orbit. The libration frequency decreases as one proceeds along the sequence of banana orbits from thin ones to fat ones, so infinitely many resonant conditions \(\Omega_{\rm b}\):\(\Omega_{l}=m\):\(n\) will be satisfied within an island of banana orbits. In the case of \(\Phi_{\rm L}\) there is no evidence that any of these resonances traps orbits, but in another case we might expect trapping to occur also within families of resonantly trapped orbits.

This discussion is rather disquieting because it implies that the degree to which resonant trapping causes the regular structure of phase space inherited from the underlying integral potential \(H^{0}\) to break up into islands dependson the detailed structure of the perturbation \(h\). Since we have no unique way of defining \(h\) we cannot compute its Fourier coefficients and cannot predict how important islands will be.

We illustrate this point by examining motion in a potential that is closely related to \(\Phi_{\rm L}\) in which resonant trapping is _much_ more important (Binney 1982). In polar coordinates equation (3.103) for \(\Phi_{\rm L}\) reads

\[\Phi_{L}(R,\phi)={{1\over 2}}v_{0}^{2}\ln\left[R_{\rm c}^{2}+{ {1\over 2}}R^{2}(q^{-2}+1)-{{1\over 2}}R^{2}(q^{-2}-1)\cos 2\phi \right]. \tag{3.308}\]

The potential

\[\eqalign{\Phi_{\rm N}(R,\phi)={{1\over 2}}v_{0}^{2}\ln\left[R_{\rm c}^{2}+{ {1\over 2}}R^{2}(q^{-2}+1)-&{{1\over 2}}R^{2}(q^{-2}-1)\cos 2\phi\right.\cr& \left.-{R^{3}\over R_{\rm e}}\cos 2\phi\right],} \tag{3.309}\]

where \(R_{\rm e}\) is a constant, differs from \(\Phi_{\rm L}\) only by the addition of \((R^{3}/R_{\rm e})\cos 2\phi\) to the logarithm's argument. For \(R\ll R_{\rm e}\) this term is unimportant, but as \(R\) grows it makes the isopotential curves more elongated. Let us set \(R_{\rm e}=3\), \(R_{\rm c}=0.14\), and \(q=0.9\), and study the surface of section generated by orbits

Figure 3.41: Surface of section for motion in the potential \(\Phi_{\rm N}\) of equation (3.309) with \(R_{\rm e}=3\). The inner region has been blanked out and is shown in expanded form in Figure 3.42.

in \(\Phi_{\rm N}\) that is most nearly equivalent to the surface of section for \(\Phi_{L}\) with the same values of \(R_{\rm c}\) and \(q\) that is shown in Figure 3.9. Figure 3.41 shows the outer part of this surface of section. Unlike Figure 3.9 it shows several chains of islands generated by resonantly trapped box orbits. The individual islands are smaller than those in Figure 3.39, and the regions of untrapped orbits between chains of islands are very thin. Figure 3.42 shows the inner part of the same surface of section. In the gap between the region of regular box orbits that is shown in Figure 3.41 and the two bull's-eyes associated with loop orbits, there is an irregular fuzz of consequents. These consequents belong to just two orbits but they do not lie on smooth curves; they appear to be randomly scattered over a two-dimensional region. Since the gap within which these consequents fall lies just on the boundary of the loop-dominated region, we know that it contains infinitely many resonant box orbits. Hence, it is natural to conclude that the breakdown of orbital regularity, which the random scattering of consequents betrays, is somehow caused by more than one resonance simultaneously trying to trap an individual orbit. One says that the orbits have been made irregular by **resonance overlap**.

**(a) Irregular orbits**  We now consider in more detail orbits whose consequents in a surface of section do not lie on a smooth curve, but appear to be irregularly sprinkled through a two-dimensional region. If we take the

Figure 3.42: The inner part of the surface of section shown in Figure 3.41—the chain of eight islands around the edge is the innermost chain in Figure 3.41. In the gap between this chain and the bull’s-eyes are the consequents of two irregular orbits.

Fourier transform of the time dependence of some coordinate, for example \(x(t)\), along such an orbit, we will find that the orbit is not quasiperiodic; the Fourier transform \(X(\omega)\) (eq. B.69) has contributions from frequencies that are not integer linear combinations of two or three fundamental frequencies. Figure 3.43 shows the appearance in real space of an orbit that is not quasiperiodic (left) and one that is (right). The lack of quasiperiodicity gives the orbit a scruffy, irregular appearance, so orbits that are not quasiperiodic are called **chaotic** or **irregular orbits**.

There are generally some irregular orbits at the edge of a family of resonantly trapped orbits. Figure 3.44 is a sketch of a surface of section through such a region of phase-space when all orbits are quasiperiodic. The islands formed by the trapped orbits touch at their pointed ends and there are invariant curves of orbits that circulate rather than librate coming right up to these points. The points at which the islands touch are called **hyperbolic fixed points** and the invariant curves that pass through these points are generated by **homoclinic orbits**. In the presence of irregular orbits, the

Figure 3.43: Two orbits from the surface of section of Figure 3.42. The left orbit is not quasiperiodic, while the right one is.

Figure 3.44: Trapped and circulating orbits in a phase plane. The homoclinic orbit, shown by the heavy curve, divides the trapped orbits, which form a chain of islands, from the circulating orbits, whose consequents lie on the wavy lines at top and bottom.

islands of trapped orbits do not quite touch and the invariant curves of the circulating orbits do not reach right into the hyperbolic fixed point. Consequently there is space between the resonant islands and the region of the circulating orbits. Irregular orbits fill this space.

A typical irregular orbit alternates periods when it is resonantly trapped with periods of circulation. Consequently, if one Fourier transforms \(x(t)\) over an appropriate time interval, the orbit may appear quasiperiodic, but the fundamental frequencies that would be obtained from the transform by the method of Box 3.6 would depend on the time interval chosen for Fourier transformation.

If the islands in a chain are individually small, it can be very hard to decide whether an orbit is librating or circulating, or doing both on an irregular pattern.

When it is available, a surface of section is the most effective way of diagnosing the presence of resonantly trapped and irregular orbits. Unfortunately, surfaces of section can be used to study three-dimensional orbits only when an analytic integral other than the Hamiltonian is known, as in the case of orbits in an axisymmetric potential (SS3.2). Two other methods are available to detect irregular orbits when a surface of section cannot be used.

**(b) Frequency analysis** By numerically integrating the equations of motion from some initial conditions, we obtain time series \(x(t)\), \(y(t)\), etc., for each of the phase-space coordinates. If the orbit is regular, these time series are equivalent to those obtained by substituting \(\mathbf{\theta}=\mathbf{\theta}_{0}+\mathbf{\Omega}t\) in the Fourier expansions (3.191) of the coordinates. Hence, the frequencies \(\Omega_{i}\) may be obtained by Fourier transforming the time series and identifying the various linear combinations \({\bf n}\cdot\mathbf{\Omega}\) of the fundamental frequencies that occur in the Fourier transform (Box 3.6; Binney & Spergel 1982). If a single system of angle-action variables covers the entire phase space (as in the case of Stackel potentials), the actions \(J_{i}\) of the orbit that one obtains from a given initial condition \({\bf w}\) are continuous functions \(J({\bf w})\) of \({\bf w}\), so the frequencies \(\Omega_{i}=\partial H/\partial J_{i}\) are also continuous functions of \({\bf w}\). Consequently, if we choose initial conditions \({\bf w}_{\alpha}\) at the nodes of some regular two-dimensional grid in phase space, the frequencies will vary smoothly from point to point on the grid. If, by contrast, resonant trapping is important, the actions of orbits will sometimes change discontinuously between adjacent grid points, because one orbit will be trapped, while the next is not. Discontinuities in \({\bf J}\) give rise to discontinuities in \(\Omega\). Moreover, the resonance that is entrapping orbits will be apparent from the ratios \(r_{a}\equiv\Omega_{2}/\Omega_{1}\) and \(r_{b}\equiv\Omega_{3}/\Omega_{1}\). Hence a valuable way of probing the structure of phase space is to plot a dot at \((r_{a},r_{b})\) for each orbit obtained by integrating from a regular grid of initial conditions \({\bf w}_{\alpha}\) (Laskar 1990; Dumas & Laskar 1993).

Figure 3.45 shows an example of such a plot of frequency ratios. The orbits plotted were integrated in the potential

\[\Phi({\bf x})={{1\over 2}}\ln[x^{2}+(y/0.9)^{2}+(z/0.7)^{2}+0.1].\]
### 3.6 Numerical determination of orbital frequencies

The determination of orbital frequencies \(\Omega_{i}\) from a numerically integrated orbit is not entirely straightforward because (i) the orbit is integrated for only a finite time interval \((0,T)\), and (ii) the function \(x(t)\) is sampled only at discrete times \(t_{0}=0,\ldots,t_{K-1}=T\), which we shall assume to be equally spaced. Let \(\Delta=t_{i+1}-t_{i}\). Then a "line" \(X\mathrm{e}^{\mathrm{i}\omega t}\) in \(x(t)\) contributes to the discrete Fourier transform (Appendix G) an amount

\[\begin{split}\hat{x}_{p}&=X\sum_{k=0}^{K-1} \mathrm{e}^{\mathrm{i}k\Delta(\omega-\omega_{p})}\\ &=X\mathrm{e}^{\mathrm{i}\alpha u}\frac{\sin\pi u}{\sin(\pi u/K)},\end{split}\quad\text{where}\quad\left\{\begin{array}{l}\omega_{ p}\equiv\frac{2\pi p}{K\Delta},\\ u\equiv K\Delta(\omega-\omega_{p})/(2\pi),\\ \alpha\equiv\pi(K-1)/K.\end{array}\right.\end{split} \tag{1}\]

\(|\hat{x}_{p}|\) is large whenever the sine in the denominator vanishes, which occurs when \(\omega_{p}\simeq\omega+2\pi m/\Delta\), where \(m\) is any integer. Thus peaks can arise at frequencies far from \(\omega\); a peak in \(|\hat{x}_{p}|\) that is due to a spectral line far removed from \(\omega\) is called an **alias** of the line. Near to a peak we can make the approximation \(\sin(\pi u/K)\simeq\pi u/K\), so \(|\hat{x}_{p}|\) declines with distance \(u\) from the peak only as \(u^{-1}\).

Orbital frequencies can be estimated by fitting equation (1) to the data and thus determining \(\omega\). The main difficulty with this procedure is confusion between spectral lines--this confusion can arise either because two lines are nearby, or because a line has a nearby alias. One way to reduce this confusion is to ensure a steeper falloff than \(u^{-1}\) by multiplying the original time sequence by a "window" function \(w(t)\) that goes smoothly to zero at the beginning and end of the integration period (Press et al., 1986; Laskar, 1990). Alternatively, one can identify peaks in the second difference of the spectrum, defined by \(\hat{x}_{p}^{\prime\prime}=\hat{x}_{p+1}+\hat{x}_{p-1}-2\hat{x}_{p}\). One can show that for \(u/K\ll 1\) the contribution to \(\hat{x}_{p}^{\prime\prime}\) of a line is

\[\hat{x}_{p}^{\prime\prime}=\frac{2XK}{\pi}\frac{\mathrm{e}^{\mathrm{i}\alpha u }\sin\pi u}{u(u^{2}-1)}, \tag{2}\]

which falls off as \(u^{-3}\). The frequency, etc., of the line can be estimated from the ratio of the \(\hat{x}_{p}^{\prime\prime}\) on either side of the line's frequency.

\(\Omega_{i}\) was defined to be the non-zero frequency with the largest amplitude in the spectrum of the \(i\)th coordinate, and \(10\,000\) orbits were obtained by dropping particles from a grid of points on the surface \(\Phi(\mathbf{x})=0.5\). Above and to the right of the center of the figure, the points are organized into regular ranks that reproduce the grid of initial conditions in slightly distorted form.

We infer that resonant trapping is unimportant in the phase-space region sampled by these initial conditions. Running through the ranks we see several depopulated lines, while both within the ranks and beyond other lines are conspicuously heavily populated: orbits that have been resonantly trapped produce points that lie along these lines. The integers \(n_{i}\) in the relevant resonant condition \({\bf n}\cdot{\bf\Omega}=0\) are indicated for some of the lines.

In some parts of Figure 3.45, for example the lower left region, the grid of initial conditions has become essentially untraceable. The disappearance of the grid indicates that irregular motion is important. In fact, the frequencies \(\Omega_{i}\) are not well defined for an irregular orbit, because its time series, \(x(t)\), \(y(t)\), etc., are not quasiperiodic. When software designed to extract the frequencies of regular orbits is used on a time series that is not quasiperiodic, the frequencies returned vary erratically from one initial condition to the next and the resulting points in the plane of frequency ratios scatter irregularly.

**(c) Liapunov exponents** If we integrate Hamilton's equations for some time \(t\), we obtain a mapping \({\bf H}_{t}\) of phase space onto itself. Let \({\bf H}_{t}\) map the phase space point \({\bf w}_{0}\) into the point \({\bf w}_{t}\). Points near \({\bf w}_{0}\) will be mapped to points that lie near \({\bf w}_{t}\), and if we confine our attention to a sufficiently small region around \({\bf w}_{0}\), we may approximate \({\bf H}_{t}\) by a linear map of the neighborhood of \({\bf w}_{0}\) into a neighborhood of \({\bf w}_{t}\). We now determine this map. Let \({\bf w}^{\prime}_{0}\) be a point near \({\bf w}_{0}\), and \(\delta{\bf w}(t)={\bf H}_{t}{\bf w}^{\prime}_{0}-{\bf H}_{t}{\bf w}_{0}\) be the difference

Figure 3.45: The ratios of orbital frequencies for orbits integrated in a three-dimensional non-rotating bar potential.

between the phase-space coordinates of the points reached by integrating Hamilton's equations for time \(t\) from the initial conditions \({\bf w}_{0}^{\prime}\) and \({\bf w}_{0}\). Then the equations of motion of the components of \(\delta{\bf w}\) are

\[\begin{split}\dot{\delta{\bf x}}&=\Big{(}\frac{ \partial H}{\partial{\bf v}}\Big{)}_{{\bf w}_{t}^{\prime}}-\Big{(}\frac{ \partial H}{\partial{\bf v}}\Big{)}_{{\bf w}_{t}}\simeq\Big{(}\frac{\partial^ {2}H}{\partial{\bf w}\partial{\bf v}}\Big{)}_{{\bf w}_{t}}\cdot\delta{\bf w}\\ \dot{\delta{\bf v}}&=-\Big{(}\frac{\partial H}{ \partial{\bf x}}\Big{)}_{{\bf w}_{t}^{\prime}}+\Big{(}\frac{\partial H}{ \partial{\bf x}}\Big{)}_{{\bf w}_{t}}\simeq-\Big{(}\frac{\partial^{2}H}{ \partial{\bf w}\partial{\bf x}}\Big{)}_{{\bf w}_{t}}\cdot\delta{\bf w},\end{split} \tag{3.311}\]

where the approximate equality in each line involves approximating the first derivatives of \(H\) by the leading terms in their Taylor series expansions. Equations (3.311) are of the form

\[\frac{{\rm d}\delta{\bf w}}{{\rm d}t}={\bf M}_{t}\cdot\delta{\bf w}\quad \mbox{where}\quad{\bf M}_{t}\equiv\left(\begin{array}{cc}\frac{ \partial^{2}H}{\partial{\bf x}\partial{\bf v}}&\frac{\partial^{2}H}{ \partial{\bf v}\partial{\bf v}}\\ -\frac{\partial^{2}H}{\partial{\bf x}\partial{\bf x}}&-\frac{ \partial^{2}H}{\partial{\bf v}\partial{\bf x}}\end{array}\right). \tag{3.312}\]

For any initial vector \(\delta{\bf w}_{0}\) these equations are solved by \(\delta{\bf w}_{t}={\bf U}_{t}\cdot\delta{\bf w}_{0}\), where \({\bf U}_{t}\) is the matrix that solves

\[\frac{{\rm d}{\bf U}_{t}}{{\rm d}t}={\bf M}_{t}\cdot{\bf U}_{t}. \tag{3.313}\]

We integrate this set of ordinary coupled linear differential equations from \({\bf U}_{0}={\bf I}\) in parallel with Hamilton's equations of motion for the orbit. Then we are in possession of the matrix \({\bf U}_{t}\) that describes the desired linear map of a neighborhood of \({\bf w}_{0}\) into a neighborhood of \({\bf w}_{t}\). We perform a "singular-value decomposition" of \({\bf U}_{t}\) (Press et al. 1986), that is we write it as a product \({\bf U}_{t}={\bf R}_{2}\cdot{\bf S}\cdot{\bf R}_{1}\) of two orthogonal matrices \({\bf R}_{i}\) and a diagonal matrix \({\bf S}\).28\({\bf U}_{t}\) conserves phase-space volume (page 803), so it never maps any vector to zero and the diagonal elements of \({\bf S}\) are all non-zero. In fact they are all positive because \({\bf U}_{t}\) evolves continuously from the identity, and their product is unity. A useful measure of the amount by which \({\bf U}_{t}\) shears phase space is the magnitude \(s\) of the largest element of \({\bf S}\). The **Liapunov exponent** of the orbit along which (3.313) has been integrated is defined to be

Footnote 28: Any linear transformation of an \(N\)-dimensional vector space can be decomposed into a rotation, a rescaling in \(N\) perpendicular directions, and another rotation. \({\bf R}_{1}\) rotates axes to the frame in which the coordinate directions coincide with the scaling directions. \({\bf S}\) effects the rescaling. \({\bf R}_{2}\) first rotates the coordinate directions back to their old values and then effects whatever overall rotation is required.

\[\lambda=\lim_{t\to\infty}\frac{\ln s}{t}. \tag{3.314}\]Since the scaling \(s\) is dimensionless, the Liapunov exponent \(\lambda\) has dimensions of a frequency. In practice one avoids integrating (3.313) for long times because numerical difficulties would be encountered once the ratio of the largest and smallest numbers on the diagonal of \({\bf S}\) became large. Instead one integrates along the orbit for some time \(t_{1}\) to obtain a value \(s_{1}\), and then sets \({\bf U}_{t}\) back to the identity and continues integrating for a further time \(t_{2}\) to obtain \(s_{2}\), after which \({\bf U}_{t}\) is again set to the identity before the integration is continued. After \(N\) such steps one estimates \(\lambda\) from

\[\lambda\simeq{\sum_{i}^{N}\ln s_{i}\over\sum_{i}^{N}t_{i}}. \tag{3.315}\]

Using this procedure one finds that along a regular orbit \(\lambda\to 0\), while along an irregular orbit \(\lambda\) is non-zero.

Angle-action variables enable us to understand why \(\lambda\) is zero for a regular orbit. A point near \({\bf w}_{0}\) will have angles and actions that differ from those of \({\bf w}_{0}\) by small amounts \(\delta\theta_{i}\), \(\delta J_{i}\). The action differences are invariant as we move along the orbit, while the angle differences increase linearly in time due to differences in the frequencies \(\Omega_{i}\) of the orbits on which our initial point and \({\bf w}_{0}\) lie. Consequently, the scalings \(s_{i}\) associated with angle differences increase linearly in time, and, by (3.314), the Liapunov exponent is \(\lambda=\lim_{t\to\infty}t^{-1}\ln t=0\).

If the Liapunov exponent of an orbit is non-zero, the largest scaling factor \(s\) must increase exponentially in time. Thus in this case initially neighboring orbits diverge exponentially in time. It should be noted, however, that this exponential divergence holds only so long as the orbits remain close in phase space: the definition of the Liapunov exponent is in terms of the linearized equations for orbital perturbations. The approximations involved in deriving these equations will soon be violated if the solutions to the equations are exponentially growing. Hence, we cannot conclude from the fact that an orbit's Liapunov exponent is non-zero that an initially neighboring orbit will necessarily stray far from the original orbit.

### 3.8 Orbits in elliptical galaxies

Elliptical galaxies nearly always have cusps in their central density profiles in which \(\rho\sim r^{-\alpha}\) with \(0.3\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}} \alpha\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}2\) (BM SS4.3.1). Black holes with masses \(\sim 0.2\%\) of the mass of the visible galaxy are believed to reside at the centers of these cusps (SS1.1.6 and BM SS11.2.2). Further out the mass distributions of many elliptical galaxies are thought to be triaxial (BM SS4.3.3). These features make the orbital dynamics of elliptical dynamics especially rich, and illustrate aspects of galaxy dynamics that we have already discussed in this chapter (Merritt & Fridman 1996; Merritt & Valluri 1999).

#### The perfect ellipsoid

A useful basic model of the orbital dynamics of a triaxial elliptical galaxy is provided by extensions to three dimensions of the two-dimensional Stackel potentials of SS3.5.4 (de Zeeuw 1985). The simplest three-dimensional system that generates a Stackel potential through Poisson's equation is the **perfect ellipsoid**, in which the density is given by

\[\rho({\bf x})=\frac{\rho_{0}}{(1+m^{2})^{2}}\quad\mbox{where}\quad m^{2}\equiv \frac{x^{2}+(y/q_{1})^{2}+(z/q_{2})^{2}}{a_{0}^{2}}. \tag{3.316}\]

In this formula \(q_{1}\) and \(q_{2}\) are the axis ratios of the ellipsoidal surfaces of constant density, and \(a_{0}\) is a scale length. At radii significantly smaller than \(a_{0}\), the density is approximately constant, while at \(r\gg a_{0}\) the density falls off \(\propto r^{-4}\). Since these asymptotic forms differ from those characteristic of elliptical galaxies, we have to expect the orbital structures of real galaxies to differ in detail from that of the perfect ellipsoid, but nevertheless the model exhibits much of the orbital structure seen in real elliptical galaxies.

By an analysis similar to that used in SS3.5.4 to explore the potential of a planar bar, one can show that the perfect ellipsoid supports four types of orbit. Figure 3.46 depicts an orbit of each type. At top left we have a box orbit. The key feature of a box orbit is that it touches the isopotential surface for its energy at its eight corners. Consequently, the star comes to rest for an instant at these points; a box orbit is conveniently generated numerically by releasing a star from rest on the equipotential surface. The potential's longest axis emerges from the orbit's convex face. The other three orbits are all **tube orbits**: stars on these orbits circulate in a fixed sense around the hole through the orbit's center, and are never at rest. The most important tube orbits are the short-axis loops shown at top right, which circulate around the potential's shortest axis. These orbits are mildly distorted versions of the orbits that dominate the phase space of a flattened axisymmetric potential. The tube orbits at the bottom of Figure 3.46 are called outer (left) and inner long-axis tube orbits, and circulate around the longest axis of the potential. Tube orbits around the intermediate axis are unstable. All these orbits can be quantified by a single system of angle-action coordinates \((J_{\lambda},J_{\mu},J_{\nu})\) that are generalizations of the angle-action coordinates for spherical potentials \((J_{r},J_{\vartheta},J_{\phi})\) of Table 3.1 (de Zeeuw 1985).

#### Dynamical effects of cusps

The most important differences between a real galactic potential and the best-fitting Stackel potential are at small radii. Box orbits, which alone penetrate to arbitrarily small radii, are be most affected by these differences. The box orbits of a given energy form a two-parameter family: the parameters can be taken to be an orbit's axis ratios. Resonant relations \({\bf n}\cdot{\bf\Omega}=0\) between the fundamental frequencies of an orbit are satisfied at various pointsin parameter space, but in a Stackel potential none of these resonances traps other orbits. We expect perturbations to cause some resonances to become trapping. Hence it is no surprise to find that in potentials generated by slightly cusped mass distributions, significant numbers of orbits are trapped by resonances. (In Figure 3.45 we have already encountered extensive resonant trapping of box orbits in a triaxial potential that differs from a Stackel potential.)

Figure 3.46: Orbits in a non-rotating triaxial potential. Clockwise from top left: (a) box orbit; (b) short-axis tube orbit; (c) inner long-axis tube orbit; (d) outer long-axis tube orbit. From Statler (1987), by permission of the AAS.

A regular orbit on which the three angle variables satisfy the condition \({\bf n}\cdot{\bf\Omega}=0\) is a two-dimensional object since its three actions are fixed, and one of its angles is determined by the other two. Consequently, the orbit occupies a surface in real space. A generic resonantly trapped orbit is a three-dimensional structure because it has a finite libration amplitude around the resonant orbit. In practice the amplitude of the libration is usually small, with the result that the orbit forms a sheet of small but finite thickness around the resonant orbit. It is found that stable resonant box orbits are **centrophobic**, that is, they avoid the galactic center (Merritt & Valluri 1999).

Steepening the cusp in the galaxy's central density profile enhances the difference between the galactic potential and the best-fitting Stackel model and thus the importance of resonances. More and more resonances overlap (SS3.7.3) and the fraction of irregular orbits increases.

The existence of large numbers of irregular orbits in elliptical galaxies is likely to have important but imperfectly understood astronomical implications because irregular orbits display a kind of creep or diffusion. To understand this phenomenon, imagine that there is a clean distinction between regular and irregular regions of \(2N\)-dimensional phase space. The regular region is occupied by regular orbits and is strictly off-limits to any irregular orbit, while the irregular region is off-limits to regular orbits. However, while each regular orbit is strictly confined to its \(N\)-dimensional torus and never trespasses on the territory of a different regular orbit, over time an irregular orbit explores at least some of the irregular region of phase space. In fact, the principal barrier to an irregular orbit's ability to wander is walls formed by regular orbits. In the case \(N=2\) of two-dimensional motion, the energetically accessible part of phase space is three-dimensional, while the walls formed by regular orbits are two-dimensional. Hence such a wall can completely bound some portion of irregular phase space, and forever exclude an irregular orbit from part of irregular phase space. In the case \(N=3\) that is relevant for elliptical galaxies, the energetically accessible region of phase space is five-dimensional while the wall formed by a regular orbit is three-dimensional. Since the boundary of a five-dimensional volume is a four-dimensional region, it is clear that no regular orbit can divide the irregular region of phase space into two. Hence, it is believed that given enough time an irregular orbit with \(N\geq 3\) degrees of freedom will eventually visit every part of the irregular region of phase space.

The process by which irregular orbits wander through phase space is called **Arnold diffusion** and is inadequately understood. Physically, it probably involves repeated trapping by a multitude of high-order resonances. In elliptical galaxies and the bars of barred disk galaxies, the rate of Arnold diffusion may be comparable to the Hubble time and could be a major factor in determining the rate of galactic evolution.

If the timescale associated with Arnold diffusion were short enough, galaxy models would need to include only one irregular orbit. The phase space density \(f_{\rm irr}\) contributed by this orbit would be the same at all points on the energy hypersurface \(H({\bf x},{\bf v})=E\) except in the regular region of phase space, where \(f_{\rm irr}\) would vanish.29 It is not yet clear how galaxy modeling is best done when the timescale for Arnold diffusion is comparable to the Hubble time.

Footnote 29: See Häfner et al. (2000) for a method of exploiting the uniformity of \(f_{\rm irr}\) in galaxy modeling.

#### 3.8.3 Dynamical effects of black holes

Introducing even a small black hole at the center of a triaxial galaxy that has a largely regular phase space destroys much of that regularity. There is a simple physical explanation of this phenomenon (Gerhard & Binney 1985; Merritt & Quinlan 1998).

Consider a star on the box orbit shown at top left in Figure 3.46. Each crossing time the star passes through the orbit's waist on an approximately rectilinear trajectory, and is deflected through some angle \(\theta_{\rm defl}\) by the black hole's gravitational field. If \(M\) is the mass of the hole, and \(v\) and \(b\) are, respectively, the speed and the distance from the galactic center at which the star would have passed the waist had the hole not deflected it, then from equation (3.52) we have that

\[\theta_{\rm defl}=2\tan^{-1}\left(\frac{GM}{bv^{2}}\right). \tag{3.317}\]

The speed \(v\) will be similar for all passages, but the impact parameter \(b\) will span a wide range of values over a series of passages. For any value of \(M\), no matter how small, there is a chance that \(b\) will be small enough for the star to be scattered onto a significantly different box orbit.

The tensor virial theorem (SS4.8.3) requires that the velocity dispersion be larger parallel to the longest axis of a triaxial system than in the perpendicular directions. Repeated scattering of stars by a nuclear black hole will tend to make the velocity dispersion isotropic, and thus undermine the orbital support for the triaxiality of the potential. If the potential loses its triaxiality, angular momentum will become a conserved quantity, and every star will have a non-zero pericentric distance. Hence stars will no longer be exposed to the risk of coming arbitrarily close to the black hole, and stars will disappear from the black hole's menu.

Let us assume that the distribution of a star's crossing points is uniform within the waist and calculate the expectation value of the smallest value taken by \(r\) in \(N\) passages. Let the area of the waist be \(\pi R^{2}\). Then the probability of there being \(n\) crossing points in a circle of radius \(r\) is given by the Poisson distribution (Appendix B.8) as

\[P(n|r)=\frac{(Nr^{2}/R^{2})^{n}}{n!}{\rm e}^{-Nr^{2}/R^{2}}. \tag{3.318}\]The probability that the closest passage lies in \((r,r+{\rm d}r)\) is the probability that there are zero passages inside \(r\) and a non-zero number of passages in the surrounding annulus, has area \(2\pi r{\rm d}r\). Thus this probability is

\[{\rm d}P=\bigl{(}1-{\rm e}^{-2Nr{\rm d}r/R^{2}}\bigr{)}{\rm e}^{-Nr^{2}/R^{2}} \simeq\frac{2Nr{\rm d}r}{R^{2}}{\rm e}^{-Nr^{2}/R^{2}}. \tag{3.319}\]

The required expectation value of \(r_{1}\) is now easily calculated:

\[\langle r_{1}\rangle=\int{\rm d}r\,\frac{2Nr^{2}}{R^{2}}{\rm e}^{-Nr^{2}/R^{2} }=\sqrt{\frac{\pi}{N}}\frac{R}{2}. \tag{3.320}\]

From equation (3.317) the deflection that corresponds to \(\langle r_{1}\rangle\) is

\[\theta_{\rm def,max}=2\tan^{-1}\left(\frac{2\sqrt{N}GM}{\sqrt{\pi}v^{2}R} \right). \tag{3.321}\]

Two empirical correlations between galactic parameters enable us to estimate \(\theta_{\rm def,max}\) for a star that reaches maximum radius \(R_{\rm max}\) in an elliptical galaxy with measured line-of-sight velocity dispersion \(\sigma_{\parallel}\). First we take the black hole's mass \(M\) from the empirical relation (1.27). In the galaxy's lifetime \(\tau\) we have \(N\simeq\sigma_{\parallel}\tau/2R_{\rm max}\), and we relate \(R_{\rm max}\) to \(D_{n}\), the diameter within which the mean surface brightness of an elliptical galaxy is \(20.75\,{\rm mag}\,{\rm arcsec}^{-2}\) in the \(B\) band: \(D_{n}\) is correlated with \(\sigma_{\parallel}\) such that (BM eq. 4.43)

\[D_{n}=5.2\Bigl{(}\frac{\sigma_{\parallel}}{200\,{\rm km}\,{\rm s}^{-1}} \Bigr{)}^{1.33}\,{\rm kpc}. \tag{3.322}\]

With these relations, (3.321) becomes

\[\theta_{\rm def,max}\simeq 2\tan^{-1}\left[0.08\frac{D_{n}^{3/2}}{R_{\rm max}^{ 3/2}}\frac{R_{\rm max}}{R}\frac{\sigma_{\parallel}^{2}}{v^{2}}\Bigl{(}\frac{ \sigma_{\parallel}}{200\,{\rm km}\,{\rm s}^{-1}}\Bigr{)}^{0.5}\Bigl{(}\frac{ \tau}{10\,{\rm Gyr}}\Bigr{)}^{1/2}\right]. \tag{3.323}\]

For the moderately luminous elliptical galaxies that are of interest here, \(D_{n}\) is comparable to, or slightly larger than, the effective radius (Dressler et al. 1987), and thus similar to the half-mass radius \(r_{\rm h}=1.3R_{\rm e}\) for the \(R^{1/4}\) profile. Thus for the majority of stars \(D_{n}/R_{\rm max}\simeq 1\). From Figure 3.46 we estimate \(R_{\rm max}/R\simeq 10\). To estimate the ratio \(\sigma_{\parallel}/v\) we deduce from equations (2.66) and (2.67) that for a Hernquist model with scale radius \(a\) the potential drop \(\Delta\Phi=\Phi(a)-\Phi(0)\) between \(r_{\rm h}=2.41a\) and the center is \(0.71GM_{\rm gal}/a\), so \(v^{2}=2\Delta\Phi=1.4GM_{\rm gal}/a\). From Figure 4.4 we see that \(\sigma_{\parallel}\simeq 0.2\sqrt{GM_{\rm gal}/a}\), so \((\sigma_{\parallel}/v)^{2}\simeq 35\). Inserting these values into equation (3.323) we find \(\theta_{\rm def,max}\simeq 2.6^{\circ}\). Scattering by such a small angle will probably not undermine a galaxy's triaxiality, but stars with smaller apocenter distances \(R_{\rm max}\) will be deflected through significant angles, so it is likely that the black hole will erode triaxiality in the galaxy's inner parts (Norman, May, & van Albada 1985; Merritt & Quinlan 1998).

## Problems

**3.1**: [1] Show that the radial velocity along a Kepler orbit is

\[\dot{r}=\frac{GMe}{L}\sin(\psi-\psi_{0}), \tag{3.324}\]

where \(L\) is the angular momentum. By considering this expression in the limit \(r\to\infty\) show that the eccentricity \(e\) of an unbound Kepler orbit is related to its speed at infinity by

\[e^{2}=1+\left(\frac{Lv_{\infty}}{GM}\right)^{2}. \tag{3.325}\]

**3.2**: [1] Show that for a Kepler orbit the eccentric anomaly \(\eta\) and the true anomaly \(\psi-\psi_{0}\) are related by

\[\cos(\psi-\psi_{0})=\frac{\cos\eta-e}{1-e\cos\eta}\quad;\quad\sin(\psi-\psi_{0 })=\sqrt{1-e^{2}}\frac{\sin\eta}{1-e\cos\eta}. \tag{3.326}\]

**3.3**: [1] Show that the energy of a circular orbit in the isochrone potential (2.47) is \(E=-GM/(2a)\), where \(a=\sqrt{b^{2}+r^{2}}\). Let the angular momentum of this orbit be \(L_{\rm c}(E)\). Show that

\[L_{\rm c}=\sqrt{GMb}\left(x^{-1/2}-x^{1/2}\right),\qquad\mbox{where}\qquad x \equiv-\frac{2Eb}{GM}. \tag{3.327}\]

**3.4**: [1] Prove that if a homogeneous sphere of a pressureless fluid with density \(\rho\) is released from rest, it will collapse to a point in time \(t_{\rm ff}=\frac{1}{4}\sqrt{3\pi/(2G\rho)}\). The time \(t_{\rm ff}\) is called the **free-fall time** of a system of density \(\rho\).

**3.5**: [3] Generalize the timing argument in Box 3.1 to a universe with non-zero vacuum-energy density. Evaluate the required mass of the Local Group for a universe of age \(t_{0}=13.7\,\mbox{Gyr}\) with (a) \(\Omega_{\Lambda 0}=0\); (b) \(\Omega_{\Lambda 0}=0.76\), \(h_{7}=1.05\). Hints: the energy density in radiation can be neglected. The solution requires evaluation of an integral similar to (1.62).

**3.6**: [1] A star orbiting in a spherical potential suffers an arbitrary instantaneous velocity change while it is at pericenter. Show that the pericenter distance of the ensuing orbit cannot be larger than the initial pericenter distance.

**3.7**: [2] In a spherically symmetric system, the apocenter and pericenter distances are given by the roots of equation (3.14). Show that if \(E<0\) and the potential \(\Phi(r)\) is generated by a non-negative density distribution, this equation has either no root, a repeated root, or two roots (Contopoulos 1954). Thus there is at most one apocenter and pericenter for a given energy and angular momentum. Hint: take the second derivative of \(E-\Phi\) with respect to \(u=1/r\) and use Poisson's equation.

**3.8**: [1] Prove that circular orbits in a given potential are unstable if the angular momentum per unit mass on a circular orbit decreases outward. Hint: evaluate the epicycle frequency.

**3.9**: [2] Compute the time-averaged moments of the radius, \(\langle r^{n}\rangle\), in a Kepler orbit of semi-major axis \(a\) and eccentricity \(e\), for \(n=1,2\) and \(n=-1,-2,-3\).

**3.10**: [2]\(\Delta\psi\) denotes the increment in azimuthal angle during one complete radial cycle of an orbit.

(a) Show that in the potential (3.57)

\[\Delta\psi=\frac{2\pi L}{\sqrt{-2Er_{\rm a}r_{\rm p}}}, \tag{3.328}\]

where \(r_{\rm a}\) and \(r_{\rm p}\) are the apo- and pericentric radii of an orbit of energy \(E\) and angular momentum \(L\). Hint: by contour integration one can show that for \(A>1\), \(\int_{-\pi/2}^{\pi/2}{\rm d}\theta/(A+\sin\theta)=\pi/\sqrt{A^{2}-1}\).

(b) Prove in the epicycle approximation that along orbits in a potential with circular frequency \(\Omega(R)\),

\[\Delta\psi=2\pi\left(4+\frac{{\rm d}\ln\Omega^{2}}{{\rm d}\ln R}\right)^{-1/2}. \tag{3.329}\]

(c) Show that the exact expression (3.328) reduces for orbits of small eccentricity to (3.329).

**3.11**: [1] For what spherically symmetric potential is a possible trajectory \(r=ae^{b\psi}\)?

**3.12**: [2] Prove that the mean-square velocity is on a bound orbit in a spherical potential \(\Phi(r)\) is

\[\langle v^{2}\rangle=\left\langle r\frac{{\rm d}\Phi}{{\rm d}r}\right\rangle, \tag{3.330}\]

where \(\langle\cdot\rangle\) denotes a time average.

**3.13**: [2] Let \({\bf r}(s)\) be a plane curve depending on the parameter \(s\). Then the **curvature** is

\[K=\frac{|{\bf r}^{\prime}\times{\bf r}^{\prime\prime}|}{|{\bf r}^{\prime}|^{3 }}, \tag{3.331}\]

where \({\bf r}^{\prime}\equiv{\rm d}{\bf r}/{\rm d}s\). The local radius of curvature is \(K^{-1}\). Prove that the curvature of an orbit with energy \(E\) and angular momentum \(L\) in the spherical potential \(\Phi(r)\) is

\[K=\frac{L\,{\rm d}\Phi/{\rm d}r}{2^{3/2}r[E-\Phi(r)]^{3/2}}. \tag{3.332}\]

Hence prove that no orbit in any spherical mass distribution can have an inflection point (in contrast to the cover illustration of Goldstein, Safko, & Poole 2002).

**3.14**: [1] Show that in a spherical potential the vertical and circular frequencies \(\nu\) and \(\Omega\) (eqs. 3.79) are equal.

**3.15**: [1] Prove that at any point in an axisymmetric system at which the local density is negligible, the epicycle, vertical, and circular frequencies \(\kappa\), \(\nu\), and \(\Omega\) (eqs. 3.79) are related by \(\kappa^{2}+\nu^{2}=2\Omega^{2}\).

**3.16**: [1] Using the epicycle approximation, prove that the azimuthal angle \(\Delta\psi\) between successive pericenters lies in the range \(\pi\leq\Delta\psi\leq 2\pi\) in the gravitational field arising from any spherical mass distribution in which the density decreases outwards.

**3.17**: [3] The goal of this problem is to prove the results of Problem 3.16 without using the epicycle approximation (Contopoulos 1954).

(a) Using the notation of SS3.1, show that

\[E-\Phi-\frac{L^{2}}{2r^{2}}=(u_{1}-u)(u-u_{2})\left\{\frac{1}{2}L^{2}+\Phi[u, u_{1},u_{2}]\right\}, \tag{3.333}\]

where \(u_{1}=1/r_{1}\) and \(u_{2}=1/r_{2}\) are the reciprocals of the pericenter and apocenter distances of the orbit respectively, \(u=1/r\), and

\[\Phi[u,u_{1},u_{2}]=\frac{1}{u_{1}-u_{2}}\left[\frac{\Phi(u_{1})-\Phi(u)}{u_{1 }-u}-\frac{\Phi(u)-\Phi(u_{2})}{u-u_{2}}\right]. \tag{3.334}\]

This expression is a second-order divided difference of the potential \(\Phi\) regarded as a function of \(u\), and a variant of the mean-value theorem of calculus shows that \(\Phi[u,u_{1},u_{2}]=\frac{1}{2}\Phi^{\prime\prime}(\bar{u})\) where \(\bar{u}\) is some value of \(u\) in the interval \((u_{1},u_{2})\). Then use the hint in Problem 3.7 and equation (3.18b) to deduce that \(\Delta\psi\leq 2\pi\) when the potential \(\Phi\) is generated by a non-negative, spherically symmetric density distribution.

(b) A lower bound on \(\Delta\psi\) can be obtained from working in a similar manner with the function

\[\chi(\omega)=\frac{2\omega\Phi}{L},\quad\mbox{where}\quad\omega\equiv\frac{L}{r^{ 2}}. \tag{3.335}\]

Show that

\[\frac{2\omega E}{L}-\chi(\omega)-\omega^{2}=(\omega_{1}-\omega)(\omega-\omega_{2 })\left\{1+\chi[\omega,\omega_{1},\omega_{2}]\right\}, \tag{3.336}\]

where \(\omega_{1}=L/r_{1}^{2}\), \(\omega_{2}=L/r_{2}^{2}\) and \(\chi[\omega,\omega_{1},\omega_{2}]\) is a second-order divided difference of \(\chi(\omega)\). Now deduce that \(\Delta\psi\geq\pi\) for any potential in which the circular frequency \(\Omega(r)\) decreases outwards.

**3.18**: [1] Let \(\Phi(R,z)\) be the Galactic potential. At the solar location, \((R,z)=(R_{0},0)\), prove that

\[\frac{\partial^{2}\Phi}{\partial z^{2}}=4\pi G\rho_{0}+2(A^{2}-B^{2}), \tag{3.337}\]

where \(\rho_{0}\) is the density in the solar neighborhood and \(A\) and \(B\) are the Oort constants. Hint: use equation (2.73).

**3.19**: [3] Consider an attractive power-law potential, \(\Phi(r)=Cr^{\alpha}\), where \(-1\leq\alpha\leq 2\) and \(C>0\) for \(\alpha>0\), \(C<0\) for \(\alpha<0\). Prove that the ratio of radial and azimuthal periods is

\[\frac{T_{r}}{T_{\psi}}=\cases{1/\sqrt{2+\alpha}&for nearly circular orbits\cr 1/2,&for $\alpha>0\cr 1/(2+\alpha),&for $\alpha<0$}\quad for nearly radial orbits.\cr} \tag{3.338}\]

What do these results imply for harmonic and Kepler potentials?

Hint: depending on the sign of \(\alpha\) use a different approximation in the radical for \(v_{r}\). For \(b>0\), \(\int_{1}^{\infty}{\rm d}x/(x\sqrt{x^{b}-1})=\pi/b\) (see Touma & Tremaine 1997).

**3.20**: [1] Show that in spherical polar coordinates the Lagrangian for motion in the potential \(\Phi({\bf x})\) is

\[{\cal L}={{1\over 2}}[\dot{r}^{2}+(r\dot{\theta})^{2}+(r\sin\theta \dot{\phi})^{2}]-\Phi({\bf x}). \tag{3.339}\]

Hence show that the momenta \(p_{\theta}\) and \(p_{\phi}\) are related to the the magnitude and \(z\)-component of the angular-momentum vector \({\bf L}\) by

\[p_{\phi}=L_{z}\quad;\quad p_{\theta}^{2}=L^{2}-\frac{L_{z}^{2}}{\sin^{2} \theta}. \tag{3.340}\]

**3.21**: [3] Plot a \((y,\dot{y})\), \((x=0,\,\dot{x}>0)\) surface of section for motion in the potential \(\Phi_{L}\) of equation (3.103) when \(q=0.9\) and \(E=-0.337\). Qualitatively relate the structure of this surface of section to the structure of the \((x,\dot{x})\) surface of section shown in Figure 3.9.

**3.22**: [3] Sketch the structure of the \((x,\dot{x})\), \((y=0,\,\dot{y}>0)\) surface of section for motion at energy \(E\) in a Kepler potential when (a) the \((x,y)\) coordinates are inertial, and (b) the coordinates rotate at \(0.75\) times the circular frequency \(\Omega\) at the energy \(E\). Hint: see Binney, Gerhard, & Hut (1985).

**3.23**: [3] The Earth is flattened at the poles by its spin. Consequently orbits in its potential do not conserve total angular momentum. Many satellites are launched in inclined, nearly circular orbits only a few hundred kilometers above the Earth's surface, and their orbits must remain nearly circular, or they will enter the atmosphere and be destroyed. Why do the orbits remain nearly circular?

**3.24**: [2] Let \(\hat{\bf e}_{1}\) and \(\hat{\bf e}_{2}\) be unit vectors in an inertial coordinate system centered on the Sun, with \(\hat{\bf e}_{1}\) pointing away from the Galactic center (towards \(\ell=180^{\circ}\), \(b=0\)) and \(\hat{\bf e}_{2}\) pointing towards \(\ell=270^{\circ}\), \(b=90^{\circ}\). The mean velocity field \({\bf v}({\bf x})\) relative to the Local Standard of Rest can be expanded in a Taylor series,

\[v_{i}=\sum_{j=1}^{2}H_{ij}x_{j}+{\rm O}(x^{2}). \tag{3.341}\](a) Assuming that the Galaxy is stationary and axisymmetric, evaluate the matrix \({\bf H}\) in terms of the Oort constants \(A\) and \(B\).

(b) What is the matrix \({\bf H}\) in a rotating frame, that is, if \(\hat{\bf e}_{1}\) continues to point to the center of the Galaxy as the Sun orbits around it?

(c) In a homogeneous, isotropic universe, there is an analogous \(3\times 3\) matrix \({\bf H}\) that describes the relative velocity \({\bf v}\) between two fundamental observers separated by \({\bf x}\). Evaluate this matrix in terms of the Hubble constant.

**3.25**: [3] Consider two point masses \(m_{1}\) and \(m_{2}>m_{1}\) that travel in a circular orbit about their center of mass under their mutual attraction. (a) Show that the Lagrange point \(L_{4}\) of this system forms an equilateral triangle with the two masses. (b) Show that motion near \(L_{4}\) is stable if \(m_{1}/(m_{1}+m_{2})<0.03852\). (c) Are the Lagrange points \(L_{1}\), \(L_{2}\), \(L_{3}\) stable? See Valtonen & Karttunen (2006).

**3.26**: [2] Show that the leapfrog integrator (3.166a) is second-order accurate, in the sense that the errors in \({\bf q}\) and \({\bf p}\) after a timestep \(h\) are O(\(h^{3}\)).

**3.27**: [2] Forest & Ruth (1990) have devised a symplectic, time-reversible, fourth-order integrator of timestep \(h\) by taking three successive drift-kick-drift leapfrog steps of length \(ah\), \(bh\), and \(ah\) where \(2a+b=1\). Find \(a\) and \(b\). Hint: \(a\) and \(b\) need not both be positive.

**3.28**: [2] Confirm the formulae for the Adams-Bashforth, Adams-Moulton, and Hermite integrators in equations (3.169), (3.170), and (3.171), and derive the next higher order integrator of each type. You may find it helpful to use computer algebra.

**3.29**: [1] Prove that the fictitious time \(\tau\) in Burdet-Heggie regularization is related to the eccentric anomaly \(\eta\) by \(\tau=(T_{r}/2\pi a)\eta+\mbox{\it constant}\), if the motion is bound (\(E_{2}<0\)) and the external field \({\bf g}=0\).

**3.30**: [1] We wish to integrate numerically the motions of \(N\) particles with positions \({\bf x}_{i}\), velocities \({\bf v}_{i}\), and masses \(m_{i}\). The particles interact only by gravitational forces (the gravitational N-body problem). We are considering using several possible integrators: modified Euler, leapfrog, or fourth-order Runge-Kutta. Which of these will conserve the total momentum \(\sum_{i=1}^{N}m_{i}{\bf v}_{i}\)? Which will conserve the total angular momentum \(\sum_{i=1}^{N}m_{i}{\bf x}_{i}\times{\bf v}_{i}\)? Assume that all particles are advanced with the same timestep, and that forces are calculated exactly. You may solve the problem either analytically or numerically.

**3.31**: [2] Show that the generating function of the canonical transformation from angle-action variables \((\theta_{i},J_{i})\) to the variables \((q_{i},p_{i})\) discussed in Box 3.4 is

\[S(q,J)=\mp{{1\over 2}}q\sqrt{2J-q^{2}}\pm J\cos^{-1}\left({q\over\sqrt{2J}} \right). \tag{3.342}\]

**3.32**: [1] Let \(\epsilon(R)\) and \(\ell(R)\) be the specific energy and angular momentum of a circular orbit of radius \(R\) in the equatorial plane of an axisymmetric potential.

(a) Prove that

\[{{\rm d}\ell\over{\rm d}R}={R\kappa^{2}\over 2\Omega}\quad;\quad{{\rm d} \epsilon\over{\rm d}R}={{1\over 2}}R\kappa^{2}, \tag{3.343}\]

where \(\Omega\) and \(\kappa\) are the circular and epicycle frequencies.

(b) The energy of a circular orbit as a function of angular momentum is \(\epsilon(\ell)\). Show that \({\rm d}\epsilon/{\rm d}\ell=\Omega\) in two ways, first from the results of part (a) and then using angle-action variables.

**3.33**: [2] The angle variables \(\theta_{i}\) conjugate to the actions \(J_{i}\) can be implicitly defined by the coupled differential equations \({\rm d}w_{\alpha}/{\rm d}\theta_{i}=[w_{\alpha},J_{i}]\), where \(w_{\alpha}\) is any ordinary phase-spacecoordinate. Using this result, show that the angle variable for the harmonic oscillator, \(H=\frac{1}{2}(p^{2}+\omega^{2}q^{2})\), may be written

\[\theta(x,p)=-\tan^{-1}\left(\frac{p}{\omega q}\right).\]

Hint: the action is \(J=H/\omega\).

**3.34**: [2] Consider motion for \(L_{z}=0\) in the Stackel potential (3.247).

(a) Express \(I_{3}\) as a function of \(u\), \(v\), \(p_{u}\), and \(p_{v}\).

(b) Show that \(H\cos^{2}v+I_{3}=\frac{1}{2}(p_{v}^{2}/\Delta^{2})-V\).

(c) Show that \([H,I_{3}]=0\).

(d) Hence show that \(J_{u}\) and \(J_{v}\) are in involution, that is \([J_{u},J_{v}]=0\). Hint: if \(f(a,b)\) is any differentiable function of two variables, and \(A\) is any differentiable function of the phase-space variables, then \([A,f]=[A,a](\partial f/\partial a)+[A,b](\partial f/\partial b)\).

**3.35**: [2] A particle moves in a one-dimensional potential well \(\Phi(x)\). In angle-action variables, the Hamiltonian has the form \(H(J)=cJ^{4/3}\) where \(c\) is a constant. Find \(\Phi(x)\).

**3.36**: [2] Obtain the Hamiltonian and fundamental frequencies as functions of the actions for the three-dimensional harmonic oscillator by examining the limit \(b\to\infty\) of equations (3.226).

**3.37**: [2] For motion in a potential of the form (3.247), obtain

\[\dot{p}_{u}=\frac{2E\sinh u\cosh u-\mathrm{d}U/\mathrm{d}u}{\sinh^{2}u+\sin^{ 2}v}+\frac{L_{z}^{2}\cosh u}{\Delta^{2}\sinh^{3}u(\sinh^{2}u+\sin^{2}v)},\]

where \((u,v)\) are the prolate spheroidal coordinates defined by equations (3.242), by (a) differentiating equation (3.249a) with respect to \(t\) and then using \(\dot{u}=\partial H/\partial p_{u}\), and (b) from \(\dot{p}_{u}=-\partial H/\partial u\).

**3.38**: [2] For the coordinates defined by equation (3.267), show that the integral defined by equations (3.268) can be written

\[I_{2}=\frac{\sinh^{2}u[\frac{1}{2}(p_{v}^{2}/\Delta^{2})-V]-\sin^{2}v[\frac{1} {2}(p_{u}^{2}/\Delta^{2})+U]}{\sinh^{2}u+\sin^{2}v}.\]

Show that in the limit \(\Delta\to 0\), \(u\to\infty\) we have \(\Delta\sinh u\to\Delta\cosh u\to R\) and \(v\to\pi/2-\phi\), where \(R\) and \(\phi\) are the usual polar coordinates. Hence show that in this limit \(2\Delta^{2}I_{2}\to L_{z}^{2}\).

**3.39**: [2] Show that the third integral of an axisymmetric Stackel potential can be taken to be

\[\begin{split}& I_{3}(u,v,p_{u},p_{v},p_{\phi})=\frac{1}{\sinh^{ 2}u+\sin^{2}v}\times\\ &\left[\sinh^{2}u\left(\frac{p_{v}^{2}}{2\Delta^{2}}-V\right)- \sin^{2}v\left(\frac{p_{u}^{2}}{2\Delta^{2}}+U\right)\right]+\frac{p_{\phi}^{2 }}{2\Delta^{2}}\left(\frac{1}{\sin^{2}v}-\frac{1}{\sinh^{2}u}\right).\end{split}\]

Hint: generalize the work of Problem 3.38.

**3.40**: [1] Show that when orbital frequencies are incommensurable, adiabatic invariance of actions implies that closed orbits remain closed when the potential is adiabatically deformed. An initially circular orbit in a spherical potential \(\Phi\) does not remain closed when \(\Phi\) is squashed along any line that is not parallel to the orbit's original angular-momentum vector. Why does this statement remain true no matter how slowly \(\Phi\) is squashed?

**3.41**: [2] From equations (3.39b) and (3.190), show that the radial action \(J_{r}\) of an orbit in the isochrone potential (2.47) is related to the energy \(E\) and angular momentum \(L\) of this orbit by

\[J_{r}=\sqrt{GMb}\left[x^{-\frac{1}{2}}-f(L)\right], \tag{3.348}\]

where \(x\equiv-2Eb/(GM)\) and \(f\) is some function. Use equation (3.327) to show that \(f(L)=(\sqrt{l^{2}+1}-l)^{-1}=\sqrt{l^{2}+1}+l\), where \(l\equiv|L|/(2\sqrt{GMb})\), and hence show that the isochrone Hamiltonian can be written in the form (3.226a).

**3.42**: [2] Angle-action variables are also useful in general relativity. For example, the relativistic analog to the Hamilton-Jacobi equation (3.218) for motion in the point-mass potential \(\Phi(r)=-GM/r\) is

\[E^{2}\left(\frac{1+\frac{1}{4}r_{\rm S}/r}{1-\frac{1}{4}r_{\rm S}/r}\right)^{ 2}=c^{4}+\frac{c^{2}}{(1+\frac{1}{4}r_{\rm S}/r)^{4}}\left[\left(\frac{\partial S }{\partial r}\right)^{2}+\left(\frac{1}{r}\frac{\partial S}{\partial\vartheta }\right)^{2}+\left(\frac{1}{r\sin\vartheta}\frac{\partial S}{\partial\phi} \right)^{2}\right], \tag{3.349}\]

where \(r_{\rm S}\equiv 2GM/c^{2}\) is the **Schwarzschild radius**, the energy per unit mass \(E\) includes the rest-mass energy \(c^{2}\), and the equations are written in the isotropic metric, i.e., \({\rm d}s^{2}\) at any point is proportional to its Euclidean form (Landau & Lifshitz 1999).

(a) Show that the Hamiltonian can be written in the form

\[H(p_{r},p_{\vartheta},p_{\phi})=\frac{1-\frac{1}{4}r_{\rm S}/r}{1+\frac{1}{4} r_{\rm S}/r}\sqrt{c^{4}+\frac{c^{2}p^{2}}{(1+\frac{1}{4}r_{\rm S}/r)^{4}}}, \tag{3.350}\]

where \(p^{2}=p_{r}^{2}+p_{\vartheta}^{2}/r^{2}+p_{\phi}^{2}/(r\sin\vartheta)^{2}\).

(b) For systems in which relativistic effects are weak, show that the Hamiltonian can be written in the form

\[H=c^{2}+H_{\rm Kep}+H_{\rm gr}+{\rm O}(c^{-4}), \tag{3.351}\]

where \(H_{\rm Kep}=\frac{1}{2}p^{2}-GM/r\) is the usual Kepler Hamiltonian and

\[H_{\rm gr}=\frac{1}{c^{2}}\left(\frac{G^{2}M^{2}}{2r^{2}}-\frac{p^{4}}{8}- \frac{3GMp^{2}}{2r}\right). \tag{3.352}\]

(c) To investigate the long-term effects of relativistic corrections on a Kepler orbit, we may average \(H_{\rm gr}\) over an unperturbed Kepler orbit. Show that this average may be written

\[\langle H_{\rm gr}\rangle=\frac{G^{2}M^{2}}{c^{2}a^{2}}\left(\frac{15}{8}- \frac{3}{\sqrt{1-e^{2}}}\right), \tag{3.353}\]

where \(a\) and \(e\) are the semi-major axis and eccentricity. Hint: use the results of Problem 3.9.

(d) Show that relativistic corrections cause the argument of pericenter \(\omega\) to precess by an amount

\[\Delta\omega=\frac{6\pi GM}{c^{2}a(1-e^{2})} \tag{3.354}\]

per orbit. Hint: convert \(\langle H_{\rm gr}\rangle\) to angle-action variables using Table E.1 and use Hamilton's equations.

**3.43**: [2] The Hamiltonian \(H({\bf x},{\bf p};\lambda)\), where \(\lambda\) is a parameter, supports a family of resonant orbits. In the \((x_{1},p_{1})\) surface of section, the family's chain of islands is bounded by orbits with actions \(J_{1}\equiv(2\pi)^{-1}\oint{\rm d}x_{1}\,p_{1}=J_{\pm}(\lambda)\), where \(J_{+}>J_{-}\). Let \(\lambda\) increase sufficiently slowly for the actions of non-resonant orbits to be conserved, and assume that \(J_{+}^{\prime}>J_{-}^{\prime}>0\), where a prime denotes differentiation with respect to \(\lambda\). Show that, as \(\lambda\) grows, an orbit of unknown phase and action slightly larger than \(J_{+}\) will be captured by the resonance with probability \(P_{c}=1-J_{-}^{\prime}/J_{+}^{\prime}\). Hint: exploit conservation of phase-space volume as expressed by equation (4.10).