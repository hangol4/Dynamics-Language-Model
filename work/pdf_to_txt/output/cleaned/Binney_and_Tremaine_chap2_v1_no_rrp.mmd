## 2 Potential Theory

Much of the mass of a galaxy resides in stars. To compute the gravitational potential of a large collection of stars, we should in principle simply add the point-mass potentials of all the stars together. Of course, this is not practicable for the \(\approx 10^{11}\) stars in a typical galaxy, and for most purposes it is sufficient to model the potential by smoothing the mass density in stars on a scale that is small compared to the size of the galaxy, but large compared to the mean distance between stars. In particular, in SS1.2.1 we saw that we obtain an excellent approximation to the orbit of a single star in a galaxy by treating the star as a test particle that moves in a smooth potential of this kind. In this chapter we show how the force field of such an idealized galaxy can be calculated. The chapter is divided into eight sections. We start by reviewing some general results on potential theory, and then in SS2.2 we specialize to discuss the simplest potentials, those of spherical bodies. In SS2.3 we describe flattened density distributions that also have simple potentials. These special systems give us insight into the potentials of real galaxies and provide useful prototypes, but they are not adequate for accurate modeling. Therefore in SS2.4 and SS2.5 we describe a variety of general techniques for computing the potentials of aspherical bodies. The potentials of razor-thin disks form an important limiting case, which we discuss in SS2.6. In SS2.7 we use these results to examine the potential of the Milky Way. In SS2.8 and SS2.9 we describe how gravitational potentials are found in computer simulations of stellar systems. The discussion in SSSS2.4 to 2.6 is rather mathematical, and readers who are willing to take a few results on trust may prefer to move straight from SS2.3 to SS2.7. ### 2.1 General results

Our goal is to calculate the force \({\bf F}({\bf x})\) on a particle of mass \(m_{\rm s}\) at position \({\bf x}\) that is generated by the gravitational attraction of a distribution of mass \(\rho({\bf x}^{\prime})\). According to Newton's inverse-square law of gravitation, the force \({\bf F}({\bf x})\) may be obtained by summing the small contributions

\[\delta{\bf F}({\bf x})=Gm_{\rm s}\frac{{\bf x}^{\prime}-{\bf x}}{|{\bf x}^{ \prime}-{\bf x}|^{3}}\delta m({\bf x}^{\prime})=Gm_{\rm s}\frac{{\bf x}^{ \prime}-{\bf x}}{|{\bf x}^{\prime}-{\bf x}|^{3}}\rho({\bf x}^{\prime})\,{\rm d} ^{3}{\bf x}^{\prime} \tag{2.1}\]

to the overall force from each small element of volume \({\rm d}^{3}{\bf x}^{\prime}\) located at \({\bf x}^{\prime}\). Thus

\[{\bf F}({\bf x})=m_{\rm s}{\bf g}({\bf x})\quad\mbox{where}\quad{\bf g}({\bf x })\equiv G\int{\rm d}^{3}{\bf x}^{\prime}\frac{{\bf x}^{\prime}-{\bf x}}{|{\bf x }^{\prime}-{\bf x}|^{3}}\rho({\bf x}^{\prime}) \tag{2.2}\]

is the **gravitational field**, the force per unit mass. If we define the **gravitational potential**\(\Phi({\bf x})\) by

\[\Phi({\bf x})\equiv-G\int{\rm d}^{3}{\bf x}^{\prime}\frac{\rho({\bf x}^{ \prime})}{|{\bf x}^{\prime}-{\bf x}|}, \tag{2.3}\]

and notice that

\[\mathbf{\nabla}_{\bf x}\biggl{(}\frac{1}{|{\bf x}^{\prime}-{\bf x}|} \biggr{)}=\frac{{\bf x}^{\prime}-{\bf x}}{|{\bf x}^{\prime}-{\bf x}|^{3}}, \tag{2.4}\]

we find that we may write \({\bf g}\) as

\[\eqalign{{\bf g}({\bf x})&=\mathbf{\nabla}_{\bf x}\int{\rm d}^{3}{ \bf x}^{\prime}\frac{G\rho({\bf x}^{\prime})}{|{\bf x}^{\prime}-{\bf x}|}\cr& =-\mathbf{\nabla}\Phi,\cr} \tag{2.5}\]

where for brevity we have dropped the subscript \({\bf x}\) on the gradient operator \(\nabla\). The potential is useful because it is a scalar field that is easier to visualize than the vector gravitational field but contains the same information. Also, in many situations the easiest way to obtain \({\bf g}\) is first to calculate the potential and then to take its gradient. If we take the divergence of equation (2.2), we find

\[\mathbf{\nabla}\cdot{\bf g}({\bf x})=G\int{\rm d}^{3}{\bf x}^{\prime }\,\mathbf{\nabla}_{\bf x}\cdot\left(\frac{{\bf x}^{\prime}-{\bf x}}{ |{\bf x}^{\prime}-{\bf x}|^{3}}\right)\rho({\bf x}^{\prime}). \tag{2.6}\]Now

\[\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left(\frac{\mathbf{x}^{\prime}-\mathbf{x}}{| \mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right)=-\frac{3}{|\mathbf{x}^{\prime}- \mathbf{x}|^{3}}+\frac{3(\mathbf{x}^{\prime}-\mathbf{x})\cdot(\mathbf{x}^{ \prime}-\mathbf{x})}{|\mathbf{x}^{\prime}-\mathbf{x}|^{5}}. \tag{2.7}\]

When \(\mathbf{x}^{\prime}-\mathbf{x}\neq 0\) we may cancel the factor \(|\mathbf{x}^{\prime}-\mathbf{x}|^{2}\) from top and bottom of the last term in this equation to conclude that

\[\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left(\frac{\mathbf{x}^{\prime}-\mathbf{ x}}{|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right)=0\qquad(\mathbf{x}^{\prime}\neq \mathbf{x}). \tag{2.8}\]

Therefore, any contribution to the integral of equation (2.6) must come from the point \(\mathbf{x}^{\prime}=\mathbf{x}\), and we may restrict the volume of integration to a small sphere of radius \(h\) centered on this point. Since, for sufficiently small \(h\), the density will be almost constant through this volume, we can take \(\rho(\mathbf{x}^{\prime})\) out of the integral. The remaining terms of the integrand may then be arranged as follows:

\[\boldsymbol{\nabla}\cdot\mathbf{g}(\mathbf{x}) =G\rho(\mathbf{x})\int_{|\mathbf{x}^{\prime}-\mathbf{x}|\leq h} \mathrm{d}^{3}\mathbf{x}^{\prime}\,\boldsymbol{\nabla}_{\mathbf{x}}\cdot\left( \frac{\mathbf{x}^{\prime}-\mathbf{x}}{|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}\right) \tag{2.9a}\] \[=-G\rho(\mathbf{x})\int_{|\mathbf{x}^{\prime}-\mathbf{x}|\leq h }\mathrm{d}^{2}\mathbf{S}^{\prime}\cdot\frac{(\mathbf{x}^{\prime}-\mathbf{x}) }{|\mathbf{x}^{\prime}-\mathbf{x}|^{3}}.\]

The last step in this sequence uses the divergence theorem to convert the volume integral into a surface integral (eq. B.43). Now on the sphere \(|\mathbf{x}^{\prime}-\mathbf{x}|=h\) we have \(\mathrm{d}^{2}\mathbf{S}^{\prime}=(\mathbf{x}^{\prime}-\mathbf{x})h\,\mathrm{ d}^{2}\Omega\), where \(\mathrm{d}^{2}\Omega\) is a small element of solid angle. Hence equation (2.9a) becomes

\[\boldsymbol{\nabla}\cdot\mathbf{g}(\mathbf{x})=-G\rho(\mathbf{x})\int\mathrm{d }^{2}\Omega=-4\pi G\rho(\mathbf{x}). \tag{2.9b}\]

If we substitute from equation (2.5) for \(\boldsymbol{\nabla}\cdot\mathbf{g}\), we obtain **Poisson's equation** relating the potential \(\Phi\) to the density \(\rho\);

\[\nabla^{2}\Phi=4\pi G\rho. \tag{2.10}\]

This is a differential equation that can be solved for \(\Phi(\mathbf{x})\) given \(\rho(\mathbf{x})\) and an appropriate boundary condition.1 For an isolated system the boundary condition is \(\Phi\to 0\) as \(|\mathbf{x}|\to\infty\). The potential given by equation (2.3) automatically satisfies this boundary condition. Poisson's equation providesa route to \(\Phi\) and then to \({\bf g}\) that is often more convenient than equations (2.2) or (2.3). In the special case \(\rho=0\) Poisson's equation becomes **Laplace's equation**,

\[\nabla^{2}\Phi=0. \tag{2.11}\]

If we integrate both sides of equation (2.10) over an arbitrary volume containing total mass \(M\), and then apply the divergence theorem (eq. B.43), we obtain

\[4\pi GM=4\pi G\int{\rm d}^{3}{\bf x}\,\rho=\int{\rm d}^{3}{\bf x}\,\nabla^{2} \Phi=\int{\rm d}^{2}{\bf S}\cdot\mathbf{\nabla}\Phi. \tag{2.12}\]

This result is **Gauss's theorem**, which states that _the integral of the normal component of \(\mathbf{\nabla}\Phi\) over any closed surface equals \(4\pi G\) times the mass contained within that surface_. Since \({\bf g}\) is determined by the gradient of a potential, the gravitational field is conservative, that is, the work done against gravitational forces in moving two stars from infinity to a given configuration is independent of the path along which they are moved, and is defined to be the potential energy of the configuration (Appendix D.1). Similarly, the work done against gravitational forces in assembling an arbitrary continuous distribution of mass \(\rho({\bf x})\) is independent of the details of how the mass distribution was assembled, and is defined to be equal to the **potential energy** of the mass distribution. An expression for the potential energy can be obtained by the following argument. Suppose that some of the mass is already in place so that the density and potential are \(\rho({\bf x})\) and \(\Phi({\bf x})\). If we now bring in a additional small mass \(\delta m\) from infinity to position \({\bf x}\), the work done is \(\delta m\,\Phi({\bf x})\). Thus, if we add a small increment of density \(\delta\rho({\bf x})\), the change in potential energy is

\[\delta W=\int{\rm d}^{3}{\bf x}\,\delta\rho({\bf x})\Phi({\bf x}). \tag{2.13}\]

According to Poisson's equation the resulting change in potential \(\delta\Phi({\bf x})\) satisfies \(\nabla^{2}(\delta\Phi)=4\pi G(\delta\rho)\), so

\[\delta W=\frac{1}{4\pi G}\int{\rm d}^{3}{\bf x}\,\Phi\nabla^{2}(\delta\Phi)\,. \tag{2.14}\]

Using the divergence theorem in the form (B.45), we may write this as

\[\delta W=\frac{1}{4\pi G}\int\Phi\mathbf{\nabla}(\delta\Phi)\cdot{\rm d }^{2}{\bf S}-\frac{1}{4\pi G}\int{\rm d}^{3}{\bf x}\,\mathbf{\nabla} \Phi\cdot\mathbf{\nabla}(\delta\Phi), \tag{2.15}\]

where the surface integral vanishes because \(\Phi\propto r^{-1}\), \(|\mathbf{\nabla}\delta\Phi|\propto r^{-2}\) as \(r\to\infty\), so the integrand \(\propto r^{-3}\) while the total surface area \(\propto r^{2}\). But \(\mathbf{\nabla}\Phi\cdot\mathbf{\nabla}(\delta\Phi)=\frac{1} {2}\delta(\mathbf{\nabla}\Phi\cdot\mathbf{\nabla}\Phi)= \frac{1}{2}\delta|(\mathbf{\nabla}\Phi)|^{2}\). Hence

\[\delta W=-\frac{1}{8\pi G}\delta\bigg{(}\int{\rm d}^{3}{\bf x}\,|\mathbf{\nabla}\Phi|^{2}\bigg{)}. \tag{2.16}\]If we now sum up all of the contributions \(\delta W\), we have a simple expression for the potential energy,

\[W=-\frac{1}{8\pi G}\int{\rm d}^{3}{\bf x}\,|\mathbf{\nabla}\Phi|^{2}. \tag{2.17}\]

To obtain an alternative expression for \(W\), we again apply the divergence theorem and replace \(\nabla^{2}\Phi\) by \(4\pi G\rho\) to obtain

\[W={{1\over 2}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\Phi({\bf x}). \tag{2.18}\]

**The potential-energy tensor** In SS4.8.3 we shall encounter the tensor \({\bf W}\) that is defined by

\[W_{jk}\equiv-\int{\rm d}^{3}{\bf x}\,\rho({\bf x})x_{j}\frac{\partial\Phi}{ \partial x_{k}}, \tag{2.19}\]

where \(\rho\) and \(\Phi\) are the density and potential of some body, and the integral is to be taken over all space. We now deduce some useful properties of \({\bf W}\), which is known as the **Chandrasekhar potential-energy tensor**.2

Footnote 2: Subramanyan Chandrasekhar (1910–1995) was educated in India and England and spent most of his career at the University of Chicago. He discovered the Chandrasekhar limit, the maximum mass of a white dwarf star, and elucidated the concept of dynamical friction in astrophysics (§8.1). He shared the 1983 Nobel Prize in Physics with W. A. Fowler. If we substitute for \(\Phi\) from equation (2.3), \({\bf W}\) becomes

\[W_{jk}=G\int{\rm d}^{3}{\bf x}\,\rho({\bf x})x_{j}\frac{\partial}{\partial x_{ k}}\int{\rm d}^{3}{\bf x^{\prime}}\,\frac{\rho({\bf x^{\prime}})}{|{\bf x^{ \prime}}-{\bf x}|}. \tag{2.20}\]

Since the range of the integration over \({\bf x^{\prime}}\) does not depend on \({\bf x}\), we may carry the differentiation inside the integral to find

\[W_{jk}=G\int{\rm d}^{3}{\bf x}\int{\rm d}^{3}{\bf x^{\prime}}\,\rho({\bf x}) \rho({\bf x^{\prime}})\frac{x_{j}(x_{k}^{\prime}-x_{k})}{|{\bf x^{\prime}}-{ \bf x}|^{3}}.\] (2.21a) Furthermore, since \[{\bf x}\] and \[{\bf x^{\prime}}\] are dummy variables of integration, we may relabel them and write \[W_{jk}=G\int{\rm d}^{3}{\bf x^{\prime}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x^{ \prime}})\rho({\bf x})\frac{x_{j}^{\prime}(x_{k}-x_{k}^{\prime})}{|{\bf x}-{ \bf x^{\prime}}|^{3}} \tag{2.21b}\]

Finally, on interchanging the order of integration in equation (2.21b) and adding the result to equation (2.21a), we obtain

\[W_{jk}=-{{1\over 2}}G\int{\rm d}^{3}{\bf x}\int{\rm d}^{3}{\bf x^{ \prime}}\,\rho({\bf x})\rho({\bf x^{\prime}})\frac{(x_{j}^{\prime}-x_{j})(x_{ k}^{\prime}-x_{k})}{|{\bf x^{\prime}}-{\bf x}|^{3}}. \tag{2.22}\]

**Figure 2.1** Proof of Newton's first theorem. From this expression we draw the important inference that the tensor \({\bf W}\) is **symmetric**, that is, that \(W_{jk}=W_{kj}\). If the body is flattened along some axis, say the \(x_{3}\) axis, \(W_{33}\) will be smaller than the other components because for most pairs of matter elements, \(|x_{3}-x_{3}^{\prime}|<|x_{1}-x_{1}^{\prime}|\) or \(|x_{2}-x_{2}^{\prime}|\). When we take the **trace** of both sides of equation (2.22), we find

\[\begin{split}{\rm trace}({\bf W})&\equiv\sum_{j=1 }^{3}W_{jj}=-{{1\over 2}}G\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\int{\rm d}^{3}{ \bf x}^{\prime}\,{\rho({\bf x}^{\prime})\over|{\bf x}^{\prime}-{\bf x}|}\\ &={{1\over 2}}\int{\rm d}^{3}{\bf x}\,\rho({\bf x})\Phi({\bf x }).\end{split} \tag{2.23}\]

Comparing this with equation (2.18) we see that \({\rm trace}({\bf W})\) is simply the total gravitational potential energy \(W\). Taking the trace of (2.19) we have

\[W=-\int{\rm d}^{3}{\bf x}\,\rho{\bf x}\cdot\mathbf{\nabla}\Phi, \tag{2.24}\]

which provides another useful expression for the potential energy of a body. **2.2 Spherical systems**

**2.2.1 Newton's theorems**

Newton proved two results that enable us to calculate the gravitational potential of any spherically symmetric distribution of matter easily:

**Newton's first theorem**_A body that is inside a spherical shell of matter experiences no net gravitational force from that shell._

**Newton's second theorem**_The gravitational force on a body that lies outside a spherical shell of matter is the same as it would be if all the shell's matter were concentrated into a point at its center._Figure 2.1 illustrates the proof of Newton's first theorem. Consider the cone associated with a small solid angle \(\delta{\bf\Omega}\) centered on the point \({\bf r}\). This cone intersects the spherical shell of matter at two points, at distances \(r_{1}\) and \(r_{2}\) from \({\bf r}\). Elementary geometrical considerations assure us that the angles \(\theta_{1}\) and \(\theta_{2}\) are equal, and therefore that the masses \(\delta m_{1}\) and \(\delta m_{2}\) contained within \(\delta{\bf\Omega}\) where it intersects the shell are in the ratio \(\delta m_{1}/\delta m_{2}=(r_{1}/r_{2})^{2}\). Hence \(\delta m_{2}/r_{2}^{2}=\delta m_{1}/r_{1}^{2}\) and a particle placed at \({\bf r}\) is attracted equally in opposite directions. Summing over all cones centered on \({\bf r}\), one concludes that the body at \({\bf r}\) experiences no net force from the shell.\(\triangleleft\)

An important corollary of Newton's first theorem is that the gravitational potential inside an empty spherical shell is constant because \({\bf\nabla}\Phi=-{\bf g}=0\). Thus we may evaluate the potential \(\Phi({\bf r})\) inside the shell by calculating the integral expression (2.3) for \({\bf r}\) located at any interior point. The most convenient place for \({\bf r}\) is the center of the shell, for then all points on the shell are at the same distance \(R\), and one immediately has

\[\Phi=-{GM\over R}.\]

The proof of his second theorem eluded Newton for more than ten years. Yet with hindsight it is easy. The trick (Figure 2.2) is to compare the potential \(\Phi\) at a point \({\bf p}\) located a distance \(r\) from the center of a spherical inner shell of mass \(M\) and radius \(a\) (\(r>a\)), with the potential \(\Phi^{\prime}\) at a point \({\bf p}^{\prime}\) located a distance \(a\) from the center of an outer shell of mass \(M\) and radius \(r\). Consider the contribution \(\delta\Phi\) to the potential at \({\bf p}\) from the portion of the inner shell with solid angle \(\delta{\bf\Omega}\) located at \({\bf q}^{\prime}\). Evidently

\[\delta\Phi=-{GM\over|{\bf p}-{\bf q}^{\prime}|}{\delta{\bf\Omega}\over 4\pi}.\]

But the contribution \(\delta\Phi^{\prime}\) of the matter in the outer shell near \({\bf q}\) to the potential at \({\bf p}^{\prime}\) is

\[\delta\Phi^{\prime}=-{GM\over|{\bf p}^{\prime}-{\bf q}|}{\delta{\bf\Omega} \over 4\pi}.\]Finally, as \(|{\bf p}-{\bf q}^{\prime}|=|{\bf p}^{\prime}-{\bf q}|\) by symmetry, it follows that \(\delta\Phi=\delta\Phi^{\prime}\), and then by summation over all points \({\bf q}\) and \({\bf q}^{\prime}\) that \(\Phi=\Phi^{\prime}\). But we already know that \(\Phi^{\prime}=-GM/r\), therefore \(\Phi=-GM/r\), which is exactly the potential that would be generated by concentrating the entire mass of the inner shell at its center.\(\triangleleft\)

Alternative proofs of Newton's theorems, using the machinery of spherical harmonics, are given in SS2.4. From Newton's first and second theorems, it follows that the gravitational attraction of a spherical density distribution \(\rho(r^{\prime})\) on a unit mass at radius \(r\) is entirely determined by the mass interior to \(r\):

\[{\bf F}(r)=-\frac{GM(r)}{r^{2}}\hat{\bf e}_{r},\] (2.27a) where \[M(r)=4\pi\int_{0}^{r}{\rm d}r^{\prime}\,r^{\prime 2}\rho(r^{\prime}). \tag{2.27b}\]

The total gravitational potential may be considered to be the sum of the potentials of spherical shells of mass \({\rm d}M(r)=4\pi\rho(r)r^{2}{\rm d}r\), so we may calculate the gravitational potential at \({\bf r}\) generated by an arbitrary spherically symmetric density distribution \(\rho({\bf r}^{\prime})\) by adding the contributions to the potential produced by shells (i) with \(r^{\prime}<r\), and (ii) with \(r^{\prime}>r\). In this way we obtain

\[\eqalign{\Phi(r)&=-\frac{G}{r}\int_{0}^{r}{\rm d}M(r^{\prime})-G\int_{r}^{ \infty}\frac{{\rm d}M(r^{\prime})}{r^{\prime}}\cr&=-4\pi G\left[\frac{1}{r}\int _{0}^{r}{\rm d}r^{\prime}\,r^{\prime 2}\rho(r^{\prime})+\int_{r}^{\infty}{\rm d}r^{ \prime}\,r^{\prime}\rho(r^{\prime})\right].} \tag{2.28}\]

It is worthwhile to check that the force \({\bf F}=-\mathbf{\nabla}\Phi\) obtained from (2.28) recovers the simple expression (2.27a). An important property of a spherical matter distribution is its **circular speed**\(v_{\rm c}(r)\), defined to be the speed of a particle of negligible mass (a **test particle**) in a circular orbit at radius \(r\). We may readily evaluate \(v_{\rm c}\) by equating the gravitational attraction \(|{\bf F}|\) from equation (2.27a) to the centripetal acceleration \(v_{\rm c}^{2}/r\):

\[v_{\rm c}^{2}=r|{\bf F}|=r\frac{{\rm d}\Phi}{{\rm d}r}=\frac{GM(r)}{r}. \tag{2.29}\]

The associated angular frequency is called the **circular frequency**

\[\Omega\equiv\frac{v_{\rm c}}{r}=\sqrt{\frac{GM(r)}{r^{3}}}. \tag{2.30}\]The circular speed and frequency measure the mass interior to \(r\). Another important quantity is the **escape speed**\(v_{\rm e}\) defined by3

Footnote 3: This result is correct only if the potential \(\Phi(r)\to 0\) as \(r\to\infty\)—we have assumed this so far but for systems with very extended mass distributions other zero points may be necessary (cf. eq. 2.62). \[v_{\rm e}(r)\equiv\sqrt{2|\Phi(r)|}. \tag{2.31}\]

A star at \(r\) can escape from the gravitational field represented by \(\Phi\) only if it has a speed at least as great as \(v_{\rm e}(r)\), for only then does its (positive) kinetic energy \(\frac{1}{2}v^{2}\) exceed the absolute value of its (negative) potential energy \(\Phi\). The escape speed at \(r\) depends on the mass both inside and outside \(r\). **Potential energy of spherical systems** The simplest expression for the potential energy of a spherical body is obtained from equation (2.24). Substituting equation (2.27a) and integrating over all directions of \({\bf r}\), we obtain

\[W=-4\pi G\int_{0}^{\infty}{\rm d}r\,r\rho(r)M(r). \tag{2.32}\]

It is straightforward to show (see Problem 2.2) that the potential-energy tensor of a spherical body is **diagonal**, that is, \(W_{jk}=0\) for \(j\neq k\), and has the form

\[W_{jk}={{1\over 3}}W\delta_{jk}, \tag{2.33}\]

where \(\delta_{ij}\) is unity if \(i=j\) and zero otherwise. Such tensors are said to be **isotropic**. #### 2.2.2 Potentials of some simple systems

It is instructive to discuss the potentials generated by several simple density distributions:

**(a) Point mass** In this case

\[\Phi(r)=-{GM\over r}\quad;\quad v_{\rm c}(r)=\sqrt{GM\over r}\quad;\quad v_{\rm e }(r)=\sqrt{2GM\over r}. \tag{2.34}\]

Potentials of this form, and orbits within them, are frequently referred to as **Keplerian** because Kepler first understood that \(v_{\rm c}\propto r^{-1/2}\) in the solar system. **(b) Homogeneous sphere** If the density is some constant \(\rho\), we have \(M(r)={4\over 3}\pi r^{3}\rho\) and

\[v_{\rm c}=\sqrt{4\pi G\rho\over 3}r. \tag{2.35}\]Thus in this case the circular speed rises linearly with radius, and the orbital period of a mass on a circular orbit is

\[T=\frac{2\pi r}{v_{\rm c}}=\sqrt{\frac{3\pi}{G\rho}}, \tag{2.36}\]

independent of the radius of its orbit. The inverse of the angular frequency of a circular orbit is

\[\frac{r}{v_{\rm c}}=\sqrt{\frac{3}{4\pi G\rho}}=0.4886(G\rho)^{-1/2}. \tag{2.37}\]

If a small mass is released from rest at radius \(r\) in the gravitational field of a homogeneous sphere, its equation of motion is

\[\frac{{\rm d}^{2}r}{{\rm d}t^{2}}=-\frac{GM(r)}{r^{2}}=-\frac{4\pi G\rho}{3}r, \tag{2.38}\]

which is the equation of motion of a harmonic oscillator of angular frequency \(2\pi/T\). Therefore no matter what is the initial value of \(r\), the test mass will reach \(r=0\) in a quarter of a period, or in a time

\[\sqrt{\frac{3\pi}{16G\rho}}=0.767(G\rho)^{-1/2}. \tag{2.39}\]

The times in equations (2.37) and (2.39) are rather similar, and this suggests that the time taken for a particle to complete a significant fraction of its orbit is \(\sim(G\rho)^{-1/2}\), independent of the size and shape of the orbit. This result also holds for inhomogeneous systems, so long as \(\rho\) is replaced by the mean density \(\overline{\rho}\) interior to the particle's current radius. Thus we estimate the crossing time (sometimes also called the **dynamical time**) to be

\[t_{\rm cross}\simeq t_{\rm dyn}\simeq(G\,\overline{\rho})^{-1/2} \tag{2.40}\]

and shall use this as a measure of the characteristic time associated with the orbital motion of a star. Note that a complete orbital period is larger than \(t_{\rm cross}\) by a factor \(\simeq 2\pi\simeq 6\). The potential energy of a homogeneous sphere of radius \(a\) and density \(\rho\) is conveniently obtained from equation (2.32). We have \(M(r)=\frac{4}{3}\pi\rho r^{3}\), and therefore

\[W=-\frac{16\pi^{2}}{3}G\rho^{2}\int_{0}^{a}{\rm d}r\,r^{4}=-\frac{16}{15}\pi^{ 2}G\rho^{2}a^{5}=-\frac{3}{5}\frac{GM^{2}}{a}. \tag{2.41}\]

Sometimes it is useful to characterize the size of a system that lacks a sharp boundary by quoting the **gravitational radius**, which is defined as

\[r_{\rm g}\equiv\frac{GM^{2}}{|W|}. \tag{2.42}\]For a homogeneous sphere of radius \(a\), \(r_{\rm g}=\frac{5}{3}a\). From equation (2.28) the gravitational potential of a homogeneous sphere of radius \(a\) is

\[\Phi(r)=\cases{-2\pi G\rho(a^{2}-\frac{1}{3}r^{2})&($r<a$),\cr-\frac{4\pi G\rho a ^{3}}{3r}&($r>a$).\cr} \tag{2.43}\]

**(c) Plummer model** We might expect that in many spherical systems the density is roughly constant near the center, and falls to zero at large radii. The potential of a system of this type would be proportional to \(r^{2}+\mbox{\it constant}\) at small radii and to \(r^{-1}\) at large radii. A simple potential with these properties is the **Plummer model**

\[\Phi=-\frac{GM}{\sqrt{r^{2}+b^{2}}}. \tag{2.44a}\]

The linear scale of the system that generates this potential is set by the **Plummer scale length**\(b\), while \(M\) is the system's total mass. From equation (B.53) for \(\nabla^{2}\) in spherical polar coordinates we have

\[\nabla^{2}\Phi=\frac{1}{r^{2}}\frac{{\rm d}}{{\rm d}r}\left(r^{2}\frac{{\rm d }\Phi}{{\rm d}r}\right)=\frac{3GMb^{2}}{(r^{2}+b^{2})^{5/2}}. \tag{2.45}\]

Thus from Poisson's equation (2.10) we have that the density corresponding to the potential (2.44a) is

\[\rho(r)=\frac{3M}{4\pi b^{3}}\left(1+\frac{r^{2}}{b^{2}}\right)^{-5/2}. \tag{2.44b}\]

The potential energy of a Plummer model is

\[W=-\frac{3\pi GM^{2}}{32b}. \tag{2.46}\]

Plummer (1911) used the potential-density pair that is described by equations (2.44) to fit observations of globular clusters. We shall encounter it again in SS4.3.3a as a member of the family of stellar systems known as polytropes. **(d) Isochrone potential** The position of a star orbiting in a Plummer potential cannot be given in terms of elementary functions. However, in Chapter 3 we shall see that all orbits are analytic in the **isochrone potential**

\[\Phi(r)=-\frac{GM}{b+\sqrt{b^{2}+r^{2}}}\,, \tag{2.47}\]which owes its name to a property of its orbits that we shall derive in SS3.1c. By equation (2.29) we have for the circular speed at radius \(r\)

\[v_{\rm c}^{2}(r)=\frac{GMr^{2}}{(b+a)^{2}a},\] (2.48a) where \[a\equiv\sqrt{b^{2}+r^{2}}. \tag{2.48b}\]

When \(r\) is large \(v_{\rm c}\simeq\sqrt{GM/r}\), as required for a system of finite mass and extent. By Poisson's equation the density associated with the isochrone potential is

\[\rho(r)=\frac{1}{4\pi G}\frac{1}{r^{2}}\frac{\rm d}{\rm d r}\left(r^{2}\frac{ \rm d\Phi}{\rm d r}\right)=M\left[\frac{3(b+a)a^{2}-r^{2}(b+3a)}{4\pi(b+a)^{3} a^{3}}\right]. \tag{2.49}\]

Thus the central density is

\[\rho(0)=\frac{3M}{16\pi b^{3}}, \tag{2.50}\]

and at large radii the density tends to

\[\rho(r)\simeq\frac{bM}{2\pi r^{4}}\ \ \ \ (r\gg b). \tag{2.51}\]

**(e) Modified Hubble model** The surface brightnesses of many elliptical galaxies may be approximated over a large range of radii by the **Hubble**-**Reynolds law

\[I_{\rm H}(R)=\frac{I_{0}}{(1+R/R_{\rm H})^{2}}, \tag{2.52}\]

or the \(R^{1/4}\) law (eq. 1.17 with \(m=4\)). It is possible to solve for the spherical luminosity density \(j(r)\) that generates a given axisymmetric brightness

Figure 2.3: Projection of a spherical body along the line of sight. ### Box 2.1: Definitions of surface brightness

Two definitions of surface brightness are used in the astronomical literature. Consider the radiative power that enters a telescope of aperture \(\mathrm{d}A\) at normal incidence from directions in the element of solid angle \(\mathrm{d}^{2}\Omega\) due to the distribution of luminosity density \(j(\mathbf{r})\). We take the coordinate origin to lie at the center of the telescope aperture. Then in the distance range \((r,r+\mathrm{d}r)\) the volume that lies within the given solid-angle element is \(r^{2}\mathrm{d}r\,\mathrm{d}^{2}\Omega\), and the associated luminosity is \(\mathrm{d}L=j(\mathbf{r})r^{2}\mathrm{d}r\,\mathrm{d}^{2}\Omega\). A fraction \(\mathrm{d}A/(4\pi r^{2})\) of this luminosity enters the telescope, so the power received in the given solid-angle element from the given distance range is \((4\pi)^{-1}j(\mathbf{r})\mathrm{d}r\,\mathrm{d}^{2}\Omega\,\mathrm{d}A\). Summing over all distances and dividing by \(\mathrm{d}^{2}\Omega\,\mathrm{d}A\) we find that the flux per unit solid angle is

\[\widehat{I}=\frac{1}{4\pi}\int\mathrm{d}r\,j(\mathbf{r}).\]

The surface brightness \(\widehat{I}\) might be reported in units of \(\,\mathrm{W}\,\mathrm{m}^{-2}\,\mathrm{sr}^{-1}\). The second definition of surface brightness is the integral

\[I=\int\mathrm{d}r\,j(\mathbf{r}).\]

\(I\) is the galaxy's luminosity per unit area when viewed from the given direction, and is conveniently given in units of solar luminosities per square parsec. Surface brightnesses are often reported by observers as so many magnitudes per square arcsecond, for example \(20\,\mathrm{mag}\,\mathrm{arcsec}^{-2}\), meaning that in one square arcsecond of the image as much radiation is received as from a 20th magnitude star. In this book we follow the second convention and call \(I\) the "surface brightness. "Using the substitution \(y\equiv z/\sqrt{a^{2}+R^{2}}\), we obtain the **modified Hubble model**

\[I_{\rm h}(R)=\frac{2j_{0}a}{1+R^{2}/a^{2}}\int_{0}^{\infty}\frac{{\rm d}y}{(1+y^ {2})^{3/2}}=\frac{2j_{0}a}{1+R^{2}/a^{2}}. \tag{2.55}\]

Thus \(I_{\rm h}(a)=\frac{1}{2}I_{\rm h}(0)\), so \(a\) is the core radius as defined on page 30. At large \(R\), \(I_{\rm h}(R)\propto R^{-2}\), just as in the Hubble-Reynolds law (2.52). However, the Hubble-Reynolds law and the modified Hubble model behave quite differently near the center: while the luminosity density \(j_{\rm h}\) is well behaved at the origin, in the Hubble-Reynolds law, \({\rm d}I_{\rm H}/{\rm d}R\neq 0\) at \(R=0\), which implies that the luminosity density \(j_{\rm H}(r)\) diverges as \(r\to 0\) (Hubble 1930). Using equation (2.28) we can calculate the potential that would be generated by the modified Hubble model if its mass were distributed in the same way as its light. If \(\rho(r)=\Upsilon j(r)\), where \(\Upsilon\) is the constant mass-to-light ratio in the galaxy, one has

\[M_{\rm h}(r)=4\pi a^{3}\Upsilon j_{0}\bigg{[}\ln\left(\frac{r}{a}+\sqrt{1+ \frac{r^{2}}{a^{2}}}\right)-\frac{r}{a}\bigg{(}1+\frac{r^{2}}{a^{2}}\bigg{)}^ {-1/2}\bigg{]}, \tag{2.56}\]

\[\Phi_{\rm h}=-\frac{GM_{\rm h}(r)}{r}-\frac{4\pi G\Upsilon j_{0}a^{2}}{\sqrt{1 +(r/a)^{2}}}. \tag{2.57}\]

One feature of both the Hubble-Reynolds law and the modified Hubble model is that the mass diverges logarithmically at large \(r\); from equation (2.56) \(M_{\rm h}\simeq 4\pi a^{3}\Upsilon j_{0}\left[\ln(2r/a)-1\right]\) for \(r\gg a\). In practice, a galaxy must have a finite mass, so \(j(r)\) must fall below \(j_{\rm h}(r)\) at sufficiently large \(r\). Nevertheless, the potential \(\Phi_{\rm h}\) is finite, and in fact rather nearly equal to \(-GM_{\rm h}(r)/r\) whenever \(r\gg a\). This behavior indicates that from the gravitational point of view the density distribution of equation (2.53) behaves much like a point mass at large radii. The circular speed is shown in Figure 2.4. It peaks at \(r=2.9a\) and then falls nearly as steeply as in the Keplerian case. **(f) Power-law density model**  Many galaxies have luminosity profiles that approximate a power law over a large range in radius. Consider the

Figure 2.4: Circular speed versus radius for a body whose projected density follows the modified Hubble model (2.55). The circular speed \(v_{\rm c}\) is plotted in units of \(\sqrt{Gj_{0}\Upsilon a^{2}}\). structure of a system in which the mass density drops off as some power of the radius:

\[\rho(r)=\rho_{0}\left(\frac{r_{0}}{r}\right)^{\alpha}. \tag{2.58}\]

The surface density of this system is

\[\Sigma(R)=\frac{\rho_{0}r_{0}^{\alpha}}{R^{\alpha-1}}\frac{(-\frac{1}{2})! ( \frac{\alpha-3}{2})!}{(\frac{\alpha-2}{2})!}. \tag{2.59}\]

We assume that \(\alpha<3\), since only in this case is the mass interior to \(r\) finite, namely

\[M(r)=\frac{4\pi\rho_{0}r_{0}^{\alpha}}{3-\alpha}r^{3-\alpha}. \tag{2.60}\]

From equations (2.60) and (2.29) the circular speed is given by

\[v_{\rm c}^{2}(r)=\frac{4\pi G\rho_{0}r_{0}^{\alpha}}{3-\alpha}r^{2-\alpha}. \tag{2.61}\]

In Chapter 1 we saw that the circular-speed curves of many galaxies are remarkably flat. Equation (2.61) suggests that the mass density in these galaxies is proportional to \(r^{-2}\), corresponding to \(\alpha=2\). In SS4.3.3(b) we shall find that this is the density profile characteristic of a stellar-dynamical model called the "singular isothermal sphere." The potential difference between radius \(r\) and the reference radius \(r_{0}\) is

\[\begin{split}\Phi(r)-\Phi(r_{0})&=G\int_{r_{0}}^{r }{\rm d}r^{\prime}\,\frac{M(r^{\prime})}{r^{\prime 2}}=\frac{4\pi G\rho_{0}r_{0}^{ \alpha}}{3-\alpha}\int_{r_{0}}^{r}{\rm d}r^{\prime}\,r^{\prime(1-\alpha)}\\ &=\left\{\begin{array}{ll}\frac{v_{\rm c}^{2}(r_{0})-v_{\rm c}^ {2}(r)}{\alpha-2}&\mbox{for $\alpha\neq 2$}\\ v_{\rm c}^{2}\ln(r/r_{0})&\mbox{for $\alpha=2$}\end{array}\right.\end{split} \tag{2.62}\]

Equation (2.60) shows that \(M(r)\) diverges at large \(r\) for all \(\alpha<3\). However, such models are still useful because by Newton's first theorem, the mass exterior to any radius \(r\) does not affect the dynamics interior to \(r\). For \(3>\alpha>2\), \(v_{\rm c}^{2}(r)\) decreases with increasing \(r\) (eq. 2.61), so by (2.62) there is only a finite potential difference between radius \(r\) and infinity. In fact, the escape speed \(v_{\rm e}(r)\) from radius \(r\) is given by

\[v_{\rm e}^{2}(r)=2[\Phi(\infty)-\Phi(r)]=2\frac{v_{\rm c}^{2}(r)}{\alpha-2} \ \ \ \ (\alpha>2). \tag{2.63}\]

For \(\alpha<2\), \(\Phi(r)\) grows without limit as \(r\to\infty\), so the interpretation of \(\Phi\) as the energy per unit mass required to remove a particle to infinity is no longer valid. The potential is nevertheless a useful concept because the gravitational field is given by \({\bf g}=-{\bf\nabla}\Phi\). Since the light distributions of elliptical galaxies suggest \(\alpha\simeq 3\) at large \(r\) (see eq. 2.53), while the flatness of the circular-speed curves in spiral galaxies suggest \(\alpha\simeq 2\), it is clear that the escape speeds of galaxies are very uncertain. **(g) Two-power density models** The luminosity density of many elliptical galaxies can be approximated as a power law in radius at both the largest and smallest observable radii, with a smooth transition between these power laws at intermediate radii (BM SS4.3.1). Numerical simulations of the clustering of dark-matter particles suggest that the mass density within a dark halo has a similar structure (SS9.3). For these reasons much attention has been devoted to models in which the density is given by

\[\rho(r)={\rho_{0}\over(r/a)^{\alpha}(1+r/a)^{\beta-\alpha}}. \tag{2.64}\]

With \(\beta=4\) these models have particularly simple analytic properties, and are known as **Dehnen models** (BM eq. 4.15; Dehnen 1993; Tremaine et al. 1994). BM Table 4.5 gives formulae for the projected surface density of Dehnen models for the cases \(\alpha=0\), \(1\), \(3\over 2\), and \(2\). The model with \(\alpha=1\) and \(\beta=4\) is called a **Hernquist model** (Hernquist 1990), while that with \(\alpha=2\) and \(\beta=4\) is called a **Jaffe model** (Jaffe 1983). Dehnen models with \(\alpha\) in the range \((0.6,2)\) provide reasonable models of the centers of elliptical galaxies (BM SS4.3.1). Dark halos can be modeled by equation (2.64) with \(\beta\simeq 3\) and \(\alpha\) in the range \((1,1.5)\). The model with \((\alpha,\beta)=(1,3)\) is called the **NFW model** after Navarro, Frenk, & White (1995). The NFW formula contains two free parameters: \(\rho_{0}\) and \(a\). Navarro, Frenk, & White (1996) showed that the values taken by these parameters for the halos that formed in their simulations were strongly correlated, so the halos were essentially members of a one-parameter family. The conventional choice of parameter is the distance \(r_{200}\) from the center of the halo at which the mean density is 200 times the cosmological critical density, \(\rho_{\rm c}\) (eq. 1.52).4 A more physical choice of parameter is the mass interior to \(r_{200}\), which is \(M=200\rho_{\rm c}{4\over 3}\pi r_{200}^{3}\). The **concentration** of the halo is \(c\equiv r_{200}/a\). The central result of Navarro, Frenk, & White (1996) is that at a given value of \(M\) (and therefore \(r_{200}\)), halos show a relatively small scatter in \(c\). The mean value of \(c\) falls from \(\simeq 16\) to \(\simeq 6\) as the halo mass increases from \(\sim 3\times 10^{11}\,{\cal M}_{\odot}\) to \(\sim 3\times 10^{15}\,{\cal M}_{\odot}\). Footnote 4: In §9.2.1 we shall show that \(r_{200}\) approximately divides the interior region in which material has crossed the halo at least once from the exterior one in which matter is still falling in to the halo for the first time. According to (2.64) the mass interior to radius \(r\) is

\[M(r)=4\pi\rho_{0}a^{3}\int_{0}^{r/a}{\rm d}s\,{s^{2-\alpha}\over(1+s)^{\beta- \alpha}}. \tag{2.65}\]\[M(r)=4\pi\rho_{0}a^{3}\times\left\{\begin{array}{ll}\frac{r/a}{1+ r/a}&\mbox{for a Jaffe model}\\ \frac{(r/a)^{2}}{2(1+r/a)^{2}}&\mbox{for a Hernquist model}\\ \ln(1+r/a)-\frac{r/a}{1+r/a}&\mbox{for a NFW model.}\end{array}\right. \tag{2.66}\]

In the Jaffe and Hernquist models the mass asymptotes to a finite value as \(r\to\infty\), while in the NFW model the mass diverges logarithmically with \(r\). The circular speed in each model, which follows immediately from (2.66) and (2.29), is plotted in Figure 2.5. From equation (2.29) the potentials of the three models are

\[\Phi =-G\int_{r}^{\infty}\mathrm{d}r\,\frac{M(r)}{r^{2}}\] \[=-4\pi G\rho_{0}a^{2}\times\left\{\begin{array}{ll}\frac{ \ln\left(1+a/r\right)}{2(1+r/a)}&\mbox{for a Hernquist model}\\ \frac{\ln(1+r/a)}{r/a}&\mbox{for a NFW model.}\end{array}\right. \tag{2.67}\]

From these formulae and equations (2.32) and (2.42) it is straightforward to show that the Jaffe and Hernquist models have gravitational radii \(r_{\rm g}=2a\) and \(6a\), respectively, while for the NFW model \(r_{\rm g}\) is undefined. Figure 2.5: Circular speed versus radius for the Jaffe, Hernquist, and NFW models. ### 2.3 Potential-density pairs for flattened systems

Later in this chapter we will show how to obtain the gravitational potentials of systems of arbitrary shape. However, we shall find that the calculation of the gravitational potential and field generated by a given distribution of matter is often an arduous task that leads to cumbersome formulae involving special functions, or numerical calculations. Fortunately, for many purposes it suffices to represent a galaxy by a simple model that has the same gross structure as the galaxy. In this section we describe families of potentials that are generated by fairly simple and realistic axisymmetric density distributions. These potentials help us to understand how the gravitational potential of an initially spherical body is affected by flattening, and in later chapters we shall use several of these potentials to illustrate features of dynamics in axisymmetric galaxies. #### 2.3.1 Kuzmin models and generalizations

Consider the axisymmetric potential

\[\Phi_{\rm K}(R,z)=-\frac{GM}{\sqrt{R^{2}+(a+|z|)^{2}}}\quad(a\geq 0). \tag{2.68a}\]

As Figure 2.6 indicates, at points with \(z<0\), \(\Phi_{\rm K}\) is identical with the potential of a point mass \(M\) located at the point \((R,z)=(0,a)\); and when \(z>0\), \(\Phi_{\rm K}\) coincides with the potential generated by a point mass at \((0,-a)\). Hence \(\nabla^{2}\Phi_{\rm K}\) must vanish everywhere except on the plane \(z=0\). By applying Gauss's theorem (2.12) to a flat volume that contains a small portion of the plane \(z=0\), we conclude that \(\Phi_{\rm K}\) is generated by the surface density

\[\Sigma_{\rm K}(R)=\frac{aM}{2\pi(R^{2}+a^{2})^{3/2}}. \tag{2.68b}\]

The potential-density pair of equations (2.68) was introduced by Kuzmin (1956), but it is often referred to as "Toomre's model 1" because it became widely known in the West only after Toomre (1963) unknowingly re-derived it. Consider next the potential

\[\Phi_{\rm M}(R,z)=-\frac{GM}{\sqrt{R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{2}}}.\] (2.69a) When \[a=0\], \[\Phi_{\rm M}\] reduces to Plummer's spherical potential ( 2.44a ), and when \[b=0\], \[\Phi_{\rm M}\] reduces to Kuzmin's potential of a razor-thin disk ( 2.68a ). Thus, depending on the choice of the two parameters \[a\] and \[b\], \[\Phi_{\rm M}\] can represent the potential of anything from an infinitesimally thin disk to a spherical system. If we calculate \[\nabla^{2}\Phi_{\rm M}\], we find that the mass distribution with which it is associated is (Miyamoto & Nagai 1975 ) \[\rho_{\rm M}(R,z)=\left(\frac{b^{2}M}{4\pi}\right)\frac{aR^{2}+(a+3\sqrt{z^{2} +b^{2}}\,)(a+\sqrt{z^{2}+b^{2}}\,)^{2}}{\left[R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{2 }\right]^{5/2}}(z^{2}+b^{2})^{3/2}.\] (2.69b) In Figure 2.7 we show contour plots of \[\rho_{\rm M}(R,z)\] for various values of \[b/a\]. When \[b/a\simeq 0.2\], these are qualitatively similar to the light distributions of disk galaxies, although there are quantitative differences. For example, from equation ( 2.69b ) we have that \[\rho(R,0)\propto R^{-3}\] when \[R\] is large, whereas the brightness profiles of disks fall off at least as fast as \[\exp(-R/R_{\rm d})\] (eq. 1.7 ). Since Poisson's equation is linear in \(\Phi\) and \(\rho\), the difference between any two potential-density pairs is itself a potential-density pair. Therefore, if we differentiate a potential-density pair with respect to one of its parameters, we obtain a new potential-density pair. For example, Toomre (1963) derived a family of potential-density pairs by differentiating \(\Phi_{\rm K}(R,z)/a\)\(n\) times with respect to \(a^{2}\). Similarly, Satoh (1980) obtained a series of spherical potential-density pairs by differentiating \(b^{-2}\) times the Plummer potential and density (eq. 2.44 ) \(n\) times with respect to \(b^{2}\). He flattened these potentials by replacing \(r^{2}+b^{2}\) with \(R^{2}+(a+\sqrt{z^{2}+b^{2}}\,)^{2}\), and in the limit \(n\to\infty\) obtained

\[\Phi_{\rm S}(R,z)=-\frac{GM}{S},\] (2.70a) where \[S^{2}\equiv R^{2}+z^{2}+a\left(a+2\sqrt{z^{2}+b^{2}}\,\right).\] (2.70c) The corresponding density distribution follows from Poisson's equation: \[\rho_{\rm S}(R,z)=\frac{ab^{2}M}{4\pi S^{3}(z^{2}+b^{2})}\left[\frac{1}{\sqrt {z^{2}+b^{2}}}+\frac{3}{a}\left(1-\frac{R^{2}+z^{2}}{S^{2}}\right)\right].\] (2.70b) Figure 2.8 shows that at large \[b/a\] the isodensity surfaces \[\Phi_{\rm S}\] are more nearly elliptical than those of \[\Phi_{\rm M}\]. #### 2.3.2 Logarithmic potentials

Since the Kuzmin and other models in the previous subsection all have finite mass, the circular speed associated with these potentials falls off in Keplerian fashion, \(v_{\rm c}\propto R^{-1/2}\), at large \(R\). However, in Chapter 1 it was shown that the circular-speed curves of spiral galaxies tend to be flat at large radii. If at large \(R\), \(v_{\rm c}=v_{0}\), a constant, then \({\rm d}\Phi/{\rm d}R=v_{0}^{2}/R\), and hence \(\Phi\propto v_{0}^{2}/R\). Figure 2.7: Contours of equal density in the \((R,z)\) plane for the Miyamoto–Nagai density distribution (2.69b) when: \(b/a=0.2\) (top); \(b/a=1\) (middle); \(b/a=5\) (bottom). There are two contours per decade, and the highest contour levels are \(0.3M/a^{3}\) (top), \(0.03M/a^{3}\) (middle), and \(0.001M/a^{3}\) (bottom). \(v_{0}^{2}\ln R+\mbox{\it constant}\) in this region. Therefore, consider the potential

\[\Phi_{\rm L}={{1\over 2}}v_{0}^{2}\ln\left(R_{\rm c}^{2}+R^{2}+{z^{2} \over q_{\Phi}^{2}}\right)+\mbox{constant},\] (2.71a) where \[R_{\rm c}\] and \[v_{0}\] are constants, and \[q_{\Phi}\] is the axis ratio of the equipotential surfaces. The circular speed at radius \[R\] in the equatorial plane of \[\Phi_{\rm L}\] is \[v_{\rm c}={v_{0}R\over\sqrt{R_{\rm c}^{2}+R^{2}}}. \tag{2.71b}\]

The density distribution to which \(\Phi_{\rm L}\) corresponds is

\[\rho_{\rm L}(R,z)={v_{0}^{2}\over 4\pi Gq_{\Phi}^{2}}\ {(2q_{\Phi}^{2}+1)R_{ \rm c}^{2}+R^{2}+(2-q_{\Phi}^{-2})z^{2}\over(R_{\rm c}^{2}+R^{2}+z^{2}q_{\Phi} ^{-2})^{2}}. \tag{2.71c}\]

Figure 2.8: Contours of equal density in the \((R,z)\) plane for Satoh’s density distribution (2.70c) when: \(b/a=1\) (top); \(b/a=10\) (bottom). There are two contours per decade, and the highest contour levels are \(0.1M/a^{3}\) (top), and \(0.001M/a^{3}\) (bottom). At small \(R\) and \(z\), \(\rho_{\rm L}\) tends to a constant value, and when \(R\) or \(|z|\) is large, \(\rho_{\rm L}\) falls off as \(R^{-2}\) or \(z^{-2}\). The equipotential surfaces of \(\Phi_{\rm L}\) are spheroids5 of axial ratio \(q_{\Phi}\), but Figure 2.9 shows that the equidensity surfaces are rather flatter and can deviate strongly from spheroids. In fact, if we define the axial ratio \(q_{\rho}\) of the isodensity surfaces by the ratio \(z_{m}/R_{m}\) of the distances down the \(z\) and \(R\) axes at which a given isodensity surface cuts the \(z\) axis and the \(x\) or \(y\) axis, we find

Footnote 5: A **spheroid** is the surface generated by rotating an ellipse about one of its principal axes. An **oblate**, or flattened, spheroid is generated if the axis of rotation is the minor axis, and a **prolate**, or elongated, spheroid is generated if this axis is the major axis. \[q_{\rho}^{2}\simeq\frac{1+4q_{\Phi}^{2}}{2+3/q_{\Phi}^{2}}\quad(r\ll R_{\rm c}) \tag{2.72a}\]or

\[q_{\rho}^{2}\simeq q_{\Phi}^{4}\left(2-\frac{1}{q_{\Phi}^{2}}\right)\quad(r\gg R_ {c}). \tag{2.72b}\]

Outside the core, the flattening \(1-q_{\Phi}\) of the potential is only about a third that of the density distribution: \(1-q_{\Phi}\simeq\frac{1}{3}(1-q_{\rho})\). The density \(\rho_{\rm L}\) becomes negative on the \(z\) axis when \(q_{\Phi}<1/\surd 2=0.707\). #### 2.3.3 Poisson's equation in very flattened systems

In any axisymmetric system with density \(\rho(R,z)\), Poisson's equation can be written (eq. B.52)

\[\frac{\partial^{2}\Phi}{\partial z^{2}}=4\pi G\rho(R,z)+\frac{1}{R}\frac{ \partial}{\partial R}\left(RF_{R}\right), \tag{2.73}\]

where \(F_{R}=-\partial\Phi/\partial R\) is the radial force. Now consider, for example, the Miyamoto-Nagai potential-density pair given by equations (2.69). As the parameter \(b\to 0\), the density distribution becomes more and more flattened, and at fixed \(R\) the density in the plane \(z=0\) becomes larger and larger as \(b^{-1}\). However, the radial force \(F_{R}\) remains well behaved as \(b\to 0\); indeed, in the limit \(b=0\), \(F_{R}=-\partial\Phi_{\rm K}/\partial R\), where \(\Phi_{\rm K}(R,z)\) is simply the Kuzmin potential (2.68a). Thus, near \(z=0\) the first term on the right side of equation (2.73) becomes very large compared to the second, and Poisson's equation simplifies to the form

\[\frac{\partial^{2}\Phi(R,z)}{\partial z^{2}}=4\pi G\rho(R,z). \tag{2.74}\]

This result applies to almost any thin disk system. It implies that the vertical variation of the potential at a given radius \(R\) depends only on the density distribution at that radius. Effectively, this means that the solution of Poisson's equation in a thin disk can be decomposed into two steps: (i) Approximate the thin disk as a surface density layer of zero thickness and determine the potential in the plane of the disk \(\Phi(R,0)\) using the models of this section or the more general techniques of SS2.6. (ii) At each radius \(R\) solve equation (2.74) to find the vertical variation of \(\Phi(R,z)\). Thus we have

\[\Phi(R,z)=\Phi(R,0)+\Phi_{z}(R,z)\] (2.75a) where \[\Phi_{z}(R,z)\equiv 4\pi G\int_{0}^{z}{\rm d}z^{\prime}\int_{0}^{z^{\prime}}{ \rm d}z^{\prime\prime}\rho(R,z^{\prime\prime})+a(R)z. \tag{2.75b}\]

The constant of integration, \(a\), is zero if the disk is symmetric around the equatorial plane. ### 2.4 Multipole expansion

In the last section we encountered a number of axisymmetric density distributions that give rise to potentials of known form. By adding a few of these distributions together one can obtain quite a wide range of model galaxies that have readily available potentials. However, for many purposes one requires a systematic procedure for calculating the potential of an arbitrary density distribution to whatever accuracy one pleases. The next few sections are devoted to this task. The first such technique, based on spherical harmonics, works best for systems that are neither very flattened nor very elongated. Hence it is a good method for calculating the potentials of bulges and dark-matter halos (SSSS1.1.2 and 1.1.3). Our first step is to obtain the potential of a thin spherical shell of variable surface density. Since the shell has negligible thickness, the task of solving Poisson's equation \(\nabla^{2}\Phi=4\pi G\rho\) reduces to that of solving Laplace's equation \(\nabla^{2}\Phi=0\) inside and outside the shell, subject to suitable boundary conditions at infinity, at the origin, and on the shell. Now in spherical coordinates Laplace's equation is (eq. B.53)

\[\frac{1}{r^{2}}\frac{\partial}{\partial r}\left(r^{2}\frac{\partial\Phi}{ \partial r}\right)+\frac{1}{r^{2}\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta\frac{\partial\Phi}{\partial\theta}\right)+\frac{1}{r^{2}\sin ^{2}\theta}\frac{\partial^{2}\Phi}{\partial\phi^{2}}=0. \tag{2.76}\]

This may be solved by the method of **separation of variables**. We seek special solutions that are the product of functions of one variable only:

\[\Phi(r,\theta,\phi)=R(r)P(\theta)Q(\phi). \tag{2.77a}\]

Substituting equation (2.77a) into (2.76) and rearranging, we obtain

\[\frac{\sin^{2}\theta}{R}\frac{\mathrm{d}}{\mathrm{d}r}\left(r^{2}\frac{ \mathrm{d}R}{\mathrm{d}r}\right)+\frac{\sin\theta}{P}\frac{\mathrm{d}}{ \mathrm{d}\theta}\left(\sin\theta\frac{\mathrm{d}P}{\mathrm{d}\theta}\right)= -\frac{1}{Q}\frac{\mathrm{d}^{2}Q}{\mathrm{d}\phi^{2}}. \tag{2.77b}\]

The left side of this equation does not depend on \(\phi\), and the right side does not depend on \(r\) or \(\theta\). It follows that both sides are equal to some constant, say \(m^{2}\). Hence

\[-\frac{1}{Q}\frac{\mathrm{d}^{2}Q}{\mathrm{d}\phi^{2}}=m^{2}, \tag{2.78a}\] \[\frac{\sin^{2}\theta}{R}\frac{\mathrm{d}}{\mathrm{d}r}\left(r^{2}\frac{ \mathrm{d}R}{\mathrm{d}r}\right)+\frac{\sin\theta}{P}\frac{\mathrm{d}}{ \mathrm{d}\theta}\left(\sin\theta\frac{\mathrm{d}P}{\mathrm{d}\theta}\right)=m ^{2}. \tag{2.78b}\]

Equation (2.78a) may be immediately integrated to

\[Q(\phi)=Q_{m}^{+}\mathrm{e}^{\mathrm{i}m\phi}+Q_{m}^{-}\mathrm{e}^{-\mathrm{i }m\phi}. \tag{2.79a}\]We require \(\Phi\) to be a periodic function of \(\phi\) with period \(2\pi\), so \(m\) can take only integer values. Since equations (2.78) depend only on \(m^{2}\), we could restrict our attention to non-negative values of \(m\) without loss of generality. However, a simpler convention is to allow \(m\) to take both positive and negative values, so the second exponential in equation (2.79a) becomes redundant, and we may write simply

\[Q=Q_{m}{\rm e}^{{\rm i}m\phi}\quad\,(m=\ldots,-1,0,1,\ldots). \tag{2.79b}\]

Equation (2.78b) can be written

\[\frac{1}{R}\frac{{\rm d}}{{\rm d}r}\left(r^{2}\frac{{\rm d}R}{{\rm d}r}\right) =\frac{m^{2}}{\sin^{2}\theta}-\frac{1}{P\sin\theta}\frac{{\rm d}}{{\rm d} \theta}\left(\sin\theta\frac{{\rm d}P}{{\rm d}\theta}\right). \tag{2.80}\]

Since the left side of this equation does not depend on \(\theta\) and the right side does not depend on \(r\), both sides must equal some constant, which we write as \(l(l+1)\). Thus equation (2.80) implies

\[\frac{{\rm d}}{{\rm d}r}\left(r^{2}\frac{{\rm d}R}{{\rm d}r}\right)-l(l+1)R=0,\] (2.81a) and in terms of \[x\equiv\cos\theta\], \[\frac{{\rm d}}{{\rm d}x}\left[(1-x^{2})\frac{{\rm d}P}{{\rm d}x}\right]-\frac {m^{2}}{1-x^{2}}P+l(l+1)P=0. \tag{2.81b}\]

Two linearly independent solutions of equation (2.81a) are

\[R(r)=Ar^{l}\quad\text{and}\quad R(r)=Br^{-(l+1)}. \tag{2.82}\]

The solutions of equation (2.81b) are associated Legendre functions \(P_{l}^{m}(x)\) (see Appendix C.5). Physically acceptable solutions exist only when \(l\) is an integer. Without loss of generality we can take \(l\) to be non-negative, and then physically acceptable solutions exist only for \(|m|\leq l\). When \(m=0\) the solutions are simply polynomials in \(x\), called Legendre polynomials \(P_{l}(x)\). Rather than write out the product \(P_{l}^{m}(\cos\theta){\rm e}^{{\rm i}m\phi}\) again and again, it is helpful to define the spherical harmonic \({\rm Y}_{l}^{m}(\theta,\phi)\), which is equal to \(P_{l}^{m}(\cos\theta){\rm e}^{{\rm i}m\phi}\) times a constant chosen so the \({\rm Y}_{l}^{m}\) satisfy the orthogonality relation (see eq. C.44)

\[\begin{split}\int{\rm d}^{2}\Omega\,{\rm Y}_{l}^{m\,*}(\mathbf{\Omega }){\rm Y}_{l^{\prime}}^{m^{\prime}}(\mathbf{\Omega})&\equiv\int_{0} ^{\pi}{\rm d}\theta\,\sin\theta\int_{0}^{2\pi}{\rm d}\phi\,{\rm Y}_{l}^{m\,*}( \theta,\phi){\rm Y}_{l^{\prime}}^{m^{\prime}}(\theta,\phi)\\ &=\delta_{ll^{\prime}}\delta_{mm^{\prime}},\end{split} \tag{2.83}\]

where we have used \(\mathbf{\Omega}\) as a shorthand for \((\theta,\phi)\) and \({\rm d}^{2}\Omega\) for \(\sin\theta\,{\rm d}\theta\,{\rm d}\phi\). The spherical harmonics with \(l\leq 2\) are listed in equation (C.50). Putting all these results together, we have from equations (2.77a), (2.79b), and (2.82) that

\[\Phi_{lm}(r,{\bf\Omega})=\left(A_{lm}r^{l}+B_{lm}r^{-(l+1)}\right){\rm Y}_{l}^{m }({\bf\Omega}) \tag{2.84}\]

is a solution of \(\nabla^{2}\Phi=0\) for all non-negative integers \(l\) and integer \(m\) in the range \(-l\leq m\leq l\). Now let us apply these results to the problem of determining the potential of a thin shell of radius \(a\) and surface density \(\sigma({\bf\Omega})\). We write the potential internal and external to the shell as

\[\Phi_{\rm int}(r,{\bf\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\left(A_{lm}r ^{l}+B_{lm}r^{-(l+1)}\right){\rm Y}_{l}^{m}({\bf\Omega})\quad(r\leq a),\] (2.85a) and \[\Phi_{\rm ext}(r,{\bf\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\left(C_{lm}r ^{l}+D_{lm}r^{-(l+1)}\right){\rm Y}_{l}^{m}({\bf\Omega})\quad(r\geq a). \tag{2.85b}\]

The potential at the center must be non-singular, so \(B_{lm}=0\) for all \(l,m\). Similarly, the potential at infinity must be zero, so \(C_{lm}=0\) for all \(l,m\). Furthermore, \(\Phi_{\rm ext}(a,{\bf\Omega})\) must equal \(\Phi_{\rm int}(a,{\bf\Omega})\) because no work can be done in passing through an infinitesimally thin shell. Hence from equations (2.85) we have

\[\sum_{l=0}^{\infty}\sum_{m=-l}^{l}A_{lm}a^{l}{\rm Y}_{l}^{m}({\bf\Omega})=\sum _{l=0}^{\infty}\sum_{m=-l}^{l}D_{lm}a^{-(l+1)}{\rm Y}_{l}^{m}({\bf\Omega}). \tag{2.86}\]

The coefficients \(A_{lm}a^{l}\) etc. of each spherical harmonic \({\rm Y}_{l}^{m}\) on the two sides of equation (2.86) must be equal, as can be shown by multiplying both sides of the equation by \({\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}({\bf\Omega})\), integrating over \({\bf\Omega}\), and using the orthogonality relation (2.83). Therefore, from equation (2.86) we have

\[D_{lm}=A_{lm}a^{2l+1}. \tag{2.87}\]

Now let us expand the surface density of the thin shell as

\[\sigma({\bf\Omega})=\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\sigma_{lm}{\rm Y}_{l}^{ m}({\bf\Omega}), \tag{2.88}\]

where the \(\sigma_{lm}\) are numbers yet to be determined. To obtain the coefficient \(\sigma_{l^{\prime}m^{\prime}}\), we multiply both sides of equation (2.88) by \({\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}({\bf\Omega})\) and integrate over \({\bf\Omega}\). With equation (2.83) we find

\[\int{\rm d}^{2}\Omega\,{\rm Y}_{l^{\prime}}^{m^{\prime}}{}^{*}({\bf\Omega})\, \sigma({\bf\Omega})=\sigma_{l^{\prime}m^{\prime}}. \tag{2.89}\]Since \({\rm Y}_{0}^{0}=1/\sqrt{4\pi}\), \(\sigma_{00}=M/(2a^{2}\sqrt{\pi})\), where \(M\) is the mass of the shell. Gauss's theorem (2.12) applied to a small piece of the shell tells us that

\[\left(\frac{\partial\Phi_{\rm ext}}{\partial r}\right)_{r=a}-\left(\frac{ \partial\Phi_{\rm int}}{\partial r}\right)_{r=a}=4\pi G\sigma({\bf\Omega}), \tag{2.90}\]

so inserting equations (2.85) and (2.88) into equation (2.90), we obtain

\[\begin{split}-\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\bigg{(}(l+1)D_{ lm}a^{-(l+2)}+& IA_{lm}a^{l-1}\bigg{)}{\rm Y}_{l}^{m}({\bf\Omega})=\\ & 4\pi G\sum_{l=0}^{\infty}\sum_{m=-l}^{l}\sigma_{lm}{\rm Y}_{l}^{ m}({\bf\Omega}).\end{split} \tag{2.91}\]

Once again the coefficients of \({\rm Y}_{l}^{m}\) on each side of the equation must be identical, so with (2.87) we have

\[A_{lm}=-4\pi Ga^{-(l-1)}\frac{\sigma_{lm}}{2l+1}\quad;\quad D_{lm}=-4\pi Ga^{ l+2}\frac{\sigma_{lm}}{2l+1}. \tag{2.92}\]

Collecting these results together, we have from equations (2.85) that

\[\begin{split}\Phi_{\rm int}(r,{\bf\Omega})&=-4\pi Ga \sum_{l=0}^{\infty}\bigg{(}\frac{r}{a}\bigg{)}^{l}\sum_{m=-l}^{l}\frac{\sigma _{lm}}{2l+1}{\rm Y}_{l}^{m}({\bf\Omega}),\\ \Phi_{\rm ext}(r,{\bf\Omega})&=-4\pi Ga\sum_{l=0}^{ \infty}\bigg{(}\frac{a}{r}\bigg{)}^{l+1}\sum_{m=-l}^{l}\frac{\sigma_{lm}}{2l+ 1}{\rm Y}_{l}^{m}({\bf\Omega}),\end{split} \tag{2.93}\]

where the \(\sigma_{lm}\) are given by equation (2.89). Finally we evaluate the potential of a solid body by breaking it down into a series of spherical shells. We let \(\delta\sigma_{lm}(a)\) be the \(\sigma\)-coefficient of the shell lying between \(a\) and \(a+\delta a\), and \(\delta\Phi(r,{\bf\Omega};a)\) be the corresponding potential at \(r\). Then we have by equation (2.89)

\[\delta\sigma_{lm}(a)=\int_{0}^{\pi}{\rm d}\theta\,\sin\theta\int_{0}^{2\pi}{ \rm d}\phi\,{\rm Y_{l}^{m}}^{*}({\bf\Omega})\rho(a,{\bf\Omega})\delta a\equiv \rho_{lm}(a)\delta a. \tag{2.94}\]

Substituting these values of \(\sigma_{lm}\) into equations (2.93) and integrating over all \(a\), we obtain the potential at \(r\) generated by the entire collection of shells:

\[\begin{split}\Phi(r,{\bf\Omega})&=\sum_{a=0}^{r} \delta\Phi_{\rm ext}+\sum_{a=r}^{\infty}\delta\Phi_{\rm int}\\ &=-4\pi G\sum_{l,m}\frac{{\rm Y}_{l}^{m}({\bf\Omega})}{2l+1} \bigg{(}\frac{1}{r^{l+1}}\int_{0}^{r}\!\! {\rm d}a\,a^{l+2}\rho_{lm}(a)+r^{l} \!\int_{r}^{\infty}\!\frac{{\rm d}a}{a^{l-1}}\rho_{lm}(a)\bigg{)}.\end{split} \tag{2.95}\]This equation gives the potential generated by the body as an expansion in **multipoles**: the terms associated with \(l=m=0\) are the **monopole** terms, those associated with \(l=1\) are **dipole** terms, those with \(l=2\) are **quadrupole** terms, and those with larger \(l\) are \(2^{l}\)-poles. Similar expansions occur in electrostatics (e.g., Jackson 1999). The monopole terms are the same as in equation (2.28) for the potential of a spherical system.6 Since there is no gravitational analog of negative charge, pure dipole or quadrupole gravitational potentials cannot arise, in contrast to the electrostatic case. In fact, if one places the origin of coordinates at the center of mass of the system, the dipole term vanishes identically outside any matter distribution. While the monopole terms generate a circular-speed curve \(v_{\rm c}(r)=\sqrt{GM(r)/r}\) that never declines with increasing \(r\) more steeply than in the Keplerian case (\(v_{\rm c}\propto r^{-1/2}\)), over a limited range in \(r\) the higher-order multipoles may cause the circular speed to fall more steeply with increasing radius. Footnote 6: Thus the spherical-harmonic expansion provides an alternative proof of Newton’s first and second theorems. As an illustration of the effectiveness of the multipole expansion, we show in Figure 2.10 the contours of Satoh's potential \(\Phi_{\rm S}(R,z)\) (eq. 2.70a), together with the approximations to this potential that one obtains from equation (2.95) if one includes only terms with \(l\leq\,2\) or \(8\). The flexibility

Figure 2.10: Equipotentials of Satoh’s density distribution (2.70c) with \(b/a=1\). Full curves show the exact equipotentials computed from equation (2.70a), and dashed curves show the estimate provided by equation (2.95) with the sum over \(l\) extending to \(l=2\). Contours based on the sum to \(l=8\) are also plotted (dotted contours) but almost overlie the full curves. of the multipole expansion makes it a powerful tool for numerical work, and it plays a central role in some of the Poisson solvers for N-body codes that will be described in SS2.9. However, multipole expansions are poorly suited for modeling the potentials of disks. ### 2.5 The potentials of spheroidal and ellipsoidal systems

Many galaxies have nearly spheroidal or ellipsoidal equidensity surfaces (BM SS4.3.3). Moreover, Newton's theorems for spherical bodies can be generalized to include spheroidal and ellipsoidal bodies, so models with isodensity surfaces of this shape are relatively easy to construct. Finally, as the axis ratio shrinks to zero a spheroid becomes a disk, and thus we can obtain the potentials of razor-thin disks as a limiting case of spheroids. In this section we develop efficient techniques for calculating the potentials of such objects. In SSSS2.5.1 and 2.5.2 we derive formulae for oblate (i.e., flattened) spheroidal systems, and in SS2.5.3 we briefly discuss ellipsoidal systems. Results for prolate spheroidal systems can be obtained either by adapting our derivations for oblate systems, or by specializing the results for ellipsoidal systems. The principal formulae for all three geometries are given in Tables 2.1 and 2.2. Figure 2.11: Curves of constant \(u\) and \(v\) in the \((R,z)\) plane. Semi-ellipses are curves of constant \(u\), and hyperbolae are curves of constant \(v\). The common focus of all curves is marked by a dot. In order to ensure that each point has a unique \(v\)-coordinate, we exclude the disk (\(z=0,\ R\leq\Delta\)) from the space to be considered. #### 2.5.1 Potentials of spheroidal shells

Consider a system in which the isodensity surfaces are similar concentric spheroids. We align our coordinate system such that the \(z\) axis is the minor axis of the spheroids, and designate the principal-axis lengths of the spheroids by \(a\) and \(c\), with \(a\geq c\). Spheroidal bodies call for spheroidal dominates, so we consider the form of Laplace's equation, \(\nabla^{2}\Phi=0\), in **oblate spheroidal coordinates**. These coordinates employ the usual azimuthal angle \(\phi\) of cylindrical coordinates, but replace the coordinates \((R,z)\) with new coordinates \((u,v)\) that are defined by

\[R=\Delta\cosh u\sin v\quad;\quad z=\Delta\sinh u\cos v\quad(u\geq 0,0\leq v\leq \pi), \tag{2.96}\]

where \(\Delta\) is a constant. Figure 2.11 shows the curves of constant \(u\) and \(v\) in the \((R,z)\) plane. The curves \(u=\)_constant_ are confocal half-ellipses with foci at \((R,z)=(\Delta,0)\), namely

\[\frac{R^{2}}{\cosh^{2}u}+\frac{z^{2}}{\sinh^{2}u}=\Delta^{2}. \tag{2.97}\]

Similarly, the curves \(v=\)_constant_ coincide with the hyperbolae

\[\frac{R^{2}}{\sin^{2}v}-\frac{z^{2}}{\cos^{2}v}=\Delta^{2} \tag{2.98}\]

formed by the normals to these ellipses. From equations (2.96) we see that if we increase one of \(u\), \(v\), and \(\phi\) by a small amount while holding the other two coordinates constant, the point \((u,v,\phi)\) moves parallel to the three orthogonal unit vectors \(\hat{\mathbf{e}}_{u}\), \(\hat{\mathbf{e}}_{v}\), \(\hat{\mathbf{e}}_{\phi}\) by the distances \(h_{u}\delta u\), \(h_{v}\delta v\) and \(h_{\phi}\delta\phi\), where the scale factors are

\[h_{u}=h_{v}=\Delta\sqrt{\sinh^{2}u+\cos^{2}v}\quad;\quad h_{\phi}=\Delta\cosh u \sin v. \tag{2.99}\]

Hence the gradient of a potential \(\Phi\) may be expressed in these coordinates as (eq. B.39)

\[\boldsymbol{\nabla}\Phi=\frac{1}{\Delta\sqrt{\sinh^{2}u+\cos^{2}v}}\left[ \frac{\partial\Phi}{\partial u}\hat{\mathbf{e}}_{u}+\frac{\partial\Phi}{ \partial v}\hat{\mathbf{e}}_{v}\right]+\frac{1}{\Delta\cosh u\sin v}\frac{ \partial\Phi}{\partial\phi}\hat{\mathbf{e}}_{\phi}. \tag{2.100}\]

We further have (eq. B.54)

\[\begin{split}\nabla^{2}\Phi&=\frac{1}{\Delta^{2}( \sinh^{2}u+\cos^{2}v)}\bigg{[}\frac{1}{\cosh u}\frac{\partial}{\partial u} \bigg{(}\cosh u\frac{\partial\Phi}{\partial u}\bigg{)}\\ &\qquad\qquad+\frac{1}{\sin v}\frac{\partial}{\partial v}\bigg{(} \sin v\frac{\partial\Phi}{\partial v}\bigg{)}\bigg{]}+\frac{1}{\Delta^{2} \cosh^{2}u\sin^{2}v}\frac{\partial^{2}\Phi}{\partial\phi^{2}}.\end{split} \tag{2.101}\]We concentrate on potentials that are functions \(\Phi(u)\) of only the "radial" coordinate \(u\). For potentials of this class, \(\nabla^{2}\Phi=0\) reduces to

\[{{\rm d}\over{\rm d}u}\left(\cosh u{{\rm d}\Phi\over{\rm d}u}\right)=0.\]

Hence either

\[\Phi=\Phi_{0}\qquad\hbox{(a constant)},\]

or \({\rm d}\Phi/{\rm d}u=A\,{\rm sech}\,u\), where \(A\) is a constant. Integrating this last equation we find

\[\Phi=-A\sin^{-1}({\rm sech}\,u)+B,\]

where \(B\) is a constant. For \(u\) large, \({\rm sech}\,u\to\Delta/r\to 0\), where \(r\) is the usual spherical radius. So a potential of the form (2.103b) varies as

\[\Phi\simeq-A\,{\rm sech}\,u+B\to-{A\Delta\over r}+B,\]

Hence, if we set \(B=0\) and \(A=G\delta M/\Delta\), the potential given by equation (2.103b) tends to zero at infinity like the gravitational potential of a shell of mass \(\delta M\). Thus we are led to consider the potential defined by

\[\Phi=-{G\delta M\over\Delta}\times\cases{\sin^{-1}({\rm sech}\,u_{0})&$(u<u_{0 })$,\cr\sin^{-1}({\rm sech}\,u)&$(u\geq u_{0})$.\cr}\]

This potential is everywhere continuous and solves \(\nabla^{2}\Phi=0\) everywhere except on the spheroid \(u=u_{0}\) (see eqs. 2.103). Hence it is the gravitational potential of a shell of material on the surface \(u=u_{0}\). This shell has principal semi-axes of lengths \(a\equiv\Delta\cosh u_{0}\) and \(c\equiv\Delta\sinh u_{0}\). Hence the shell's **eccentricity**

\[e\equiv\sqrt{1-{c^{2}\over a^{2}}}={\rm sech}\,u_{0},\]

and we may rewrite equations (2.105) as

\[\Phi=-{G\delta M\over ae}\times\cases{\sin^{-1}(e)&$(u<u_{0})$,\cr\sin^{-1}({ \rm sech}\,u)&$(u\geq u_{0})$.\cr}\]We can find the surface density of the shell \(u=u_{0}\) by applying Gauss's theorem (2.12) to the potential (2.107). Since \(\boldsymbol{\nabla}\Phi=0\) inside the shell, by equation (2.100) the surface density of the shell is

\[\begin{split}\Sigma(v)=\frac{\hat{\bf e}_{u}\cdot\boldsymbol{ \nabla}\Phi}{4\pi G}&=\frac{1}{4\pi G\Delta\sqrt{\sinh^{2}u_{0}+ \cos^{2}v}}\biggl{(}\frac{{\rm d}\Phi}{{\rm d}u}\biggr{)}_{u=u_{0}+}\\ &=\frac{\delta M}{4\pi a^{2}\sqrt{1-e^{2}\sin^{2}v}},\end{split} \tag{2.108}\]

where evaluation at \(u_{0}+\) denotes the limiting value as \(u\to u_{0}\) from above. Equation (2.108) has a simple physical interpretation: \(\Sigma(v)\) is the surface density of the thin shell of uniform density \(\rho\) that is bounded by the two surfaces \(\beta\) and \(\beta+\delta\beta\) of the set of similar spheroids,

\[\frac{R^{2}}{a^{2}}+\frac{z^{2}}{c^{2}}=\beta^{2}, \tag{2.109}\]

where \(\delta\beta\) and \(\delta M\) are related by (2.113) below. _Proof:_ The small perpendicular \({\bf s}\) in Figure 2.12 runs between the shell's inner and outer skins. Thus \({\bf s}=s\boldsymbol{\nabla}\beta/|\boldsymbol{\nabla}\beta|\), and at any point on the surface we have \(\delta\beta=({\bf s}\cdot\boldsymbol{\nabla}\beta)=s|\boldsymbol{\nabla}\beta|\). Hence \(s=\delta\beta/|\boldsymbol{\nabla}\beta|\) and the surface density of the shell is

\[\widetilde{\Sigma}=\rho s=\frac{\rho\delta\beta}{|\boldsymbol{\nabla}\beta|}= \biggl{(}\frac{R^{2}}{a^{4}}+\frac{z^{2}}{c^{4}}\biggr{)}^{-1/2}\rho\beta\, \delta\beta. \tag{2.110}\]

Finally, writing \(R=\beta a\sin v\), \(z=\beta c\cos v\), and \(e=\sqrt{1-c^{2}/a^{2}}\), we find

\[\widetilde{\Sigma}=\frac{a\sqrt{1-e^{2}}\,\rho\,\delta\beta}{\sqrt{1-e^{2}\sin ^{2}v}}. \tag{2.111}\]

The volume inside an oblate spheroidal shell with semi-axis lengths \(a\beta\) and \(c\beta\) is

\[V={{4\over 3}}\pi a^{2}c\beta^{3}={{4\over 3}}\pi a^{3}\beta^{3} \sqrt{1-e^{2}}, \tag{2.112}\]

so the mass that is bounded by the surfaces \(\beta\) and \(\beta+\delta\beta\) is

\[\delta M=4\pi\rho a^{3}\sqrt{1-e^{2}}\,\beta^{2}\delta\beta. \tag{2.113}\]

We can now set \(\beta=1\) and substitute (2.113) into equation (2.111) to find that \(\widetilde{\Sigma}=\Sigma\), where \(\Sigma\) is given by equation (2.108).\(\triangleleft\)

We have shown that the potential (2.107) is generated by a thin shell of uniform density that is bounded by similar spheroids of eccentricity \(e\). We call such a shell a **thin homoeoid** and have:

**Homoeoid theorem**_The exterior isopotential surfaces of a thin homoeoid are the spheroids that are confocal with the shell itself. Inside the shell the potential is constant._

The homoeoid theorem applies only to a _thin_ homoeoid. But it immediately yields a remarkable property of any homoeoid--that is, of any shell of constant density, no matter how thick, whose inner and outer surfaces are similar (_not_ confocal) spheroids:

**Newton's third theorem**_A mass that is inside a homoeoid experiences no net gravitational force from the homoeoid._

_Proof:_ Break the given homoeoid into a series of thin homoeoids. The interior of the thick homoeoid lies in the interior of each of its component thin homoeoids, and the interior potential of each thin homoeoid is constant. Hence the aggregate interior potential is constant and generates no gravitational force.\(\triangleleft\)

Newton's first theorem, for spherical systems, thus emerges as a special case of Newton's third theorem for spheroidal systems. Newton's second theorem, for spherical systems, has no analog for spheroidal systems because the potential outside a spheroidal body _does_ depend on the distribution of matter within it. These theorems help us to understand qualitatively the potential of an inhomogeneous spheroidal body. Each shell of the body makes a contribution to the potential that is constant interior to the shell and on the shell, and gradually becomes rounder as one moves outward from the shell. This tendency of isopotentials to become spherical at large radii manifested itself already in SS2.4 in the rapid radial decay of the higher multipole components of the gravitational potential. The shape of the isopotential surface at a distance \(r\) from the center of an inhomogeneous spheroidal body represents a compromise between the rather round contributions of the central shells, and the more aspherical contributions of the shells just interior to \(r\). Thus, if the body is very centrally concentrated, the isopotentials near its edge will be nearly round, while a more homogeneous spheroidal body will have more flattened isopotentials. **2.5.2 Potentials of spheroidal systems**

We now use equation (2.107) to calculate the gravitational potential of a body whose isodensity surfaces are the similar spheroids

\[{\rm constant}=m^{2}\equiv R^{2}+\frac{z^{2}}{1-e^{2}}, \tag{2.114}\]

i.e., a body in which \(\rho=\rho(m^{2})\). Comparing equations (2.109) and (2.114), we see that \(m=\beta a\), so the mass of the shell between \(m\) and \(m+\delta m\) is given by equation (2.113) as

\[\delta M=4\pi\rho(m^{2})\sqrt{1-e^{2}}\,m^{2}\delta m. \tag{2.115}\]For a spherical system (\(e=0\)) this reduces to the familiar formula \(\delta M=4\pi\rho r^{2}\delta r\). There is a unique family of confocal spheroids such that one member of the family coincides with the homoeoid labeled by \(m\). Let \(u_{m}(R_{0},z_{0})\) be the label of the member of this family that passes through the point \((R_{0},z_{0})\) at which the potential is required (see eq. 2.122 below for an explicit formula). Then if \((R_{0},z_{0})\) lies inside the homoeoid \(m\), we have on setting \(a=m\) in equation (2.107) and substituting for \(\delta M\) from equation (2.115) that the contribution of \(m\) to the potential at \((R_{0},z_{0})\) is

\[\delta\Phi_{\rm int}\equiv\delta\Phi(R_{0},z_{0})=-4\pi G\rho(m^{2})m\,\delta m \frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(e).\] (2.116a) Similarly, if \[(R_{0},z_{0})\] lies outside the homoeoid, \[\delta\Phi_{\rm ext}\equiv\delta\Phi(R_{0},z_{0})=-4\pi G\rho(m^{2})m\,\delta m \frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(\operatorname{sech}u_{m}). \tag{2.116b}\]

The potential of the entire body is the sum of contributions (2.116) from all the homoeoids that make up the body. If we define

\[\psi(m)\equiv\int_{0}^{m^{2}}{\rm d}m^{2}\,\rho(m^{2}), \tag{2.117}\]

the sum of the \(\delta\Phi_{\rm int}\) is

\[\sum_{m>m_{0}}\delta\Phi_{\rm int}=-2\pi G\frac{\sqrt{1-e^{2}}}{e}\sin^{-1}(e) \left[\psi(\infty)-\psi(m_{0})\right], \tag{2.118}\]

where \(m_{0}\) is the label of the homoeoid that passes through \((R_{0},z_{0})\):

\[m_{0}^{2}\equiv R_{0}^{2}+\frac{z_{0}^{2}}{1-e^{2}}. \tag{2.119}\]

Similarly,

\[\sum_{m<m_{0}}\delta\Phi_{\rm ext}=-2\pi G\frac{\sqrt{1-e^{2}}}{e}\int_{0}^{m _{0}^{2}}{\rm d}m^{2}\,\rho(m^{2})\sin^{-1}(\operatorname{sech}u_{m}). \tag{2.120}\]

Integrating equation (2.120) by parts,

\[\begin{split}\sum_{m<m_{0}}&\delta\Phi_{\rm ext}=- 2\pi G\frac{\sqrt{1-e^{2}}}{e}\\ &\times\left\{\left[\psi(m)\sin^{-1}(\operatorname{sech}u_{m}) \right]^{m_{0}}_{m=0}-\int_{m=0}^{m_{0}}\frac{\psi(m){\rm d}\operatorname{sech }u_{m}}{\sqrt{1-\operatorname{sech}^{2}u_{m}}}\right\}.\end{split} \tag{2.121}\]The quantity \(u_{m}\) appearing in equation (2.121) is a function \(u_{m}(R_{0},z_{0})\) by virtue of the condition that \(u_{m}\) label the spheroid through \((R_{0},z_{0})\) that is confocal with the homoeoid \(m=\mathit{constant}\). Let the \(\Delta\) parameter of the confocal family of spheroids containing \(m\) be \(\Delta_{m}\), and let \(u_{\star}\) be the label of the homoeoid \(m\) within this family. Then \(m=\Delta_{m}\cosh u_{\star}\) and \(\sqrt{1-e^{2}}\,m=\Delta_{m}\sinh u_{\star}\), so \(\Delta_{m}=me\), and we have from equation (2.97) that

\[\begin{split}\frac{R_{0}^{2}}{\Delta_{m}^{2}\cosh^{2}u_{m}}+ \frac{z_{0}^{2}}{\Delta_{m}^{2}\sinh^{2}u_{m}}&=1,\\ \text{which implies}\qquad\frac{R_{0}^{2}}{1+\sinh^{2}u_{m}}+ \frac{z_{0}^{2}}{\sinh^{2}u_{m}}&=m^{2}e^{2}.\end{split} \tag{2.122}\]

This is the required equation for \(u_{m}\). Thus, in particular, \(m=0\) implies \(\sinh u_{m}=\infty\), and \(m=m_{0}\) implies \(\sinh u_{m}=\sqrt{1-e^{2}}\,/e\). Inserting these limits into equation (2.121), and adding the result to equation (2.116), we find

\[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\frac{ \sqrt{1-e^{2}}}{e}\\ &\quad\times\biggl{(}\psi(\infty)\sin^{-1}e-\int_{\sinh u_{m}= \sqrt{1-e^{2}}\,/e}^{\infty}\psi(m)\frac{\mathrm{d}\sinh u_{m}}{1+\sinh^{2}u_ {m}}\biggr{)}.\end{split} \tag{2.123}\]

We can simplify this equation by defining a new variable of integration

\[\tau\equiv a_{0}^{2}e^{2}\biggl{[}\sinh^{2}u_{m}-\biggl{(}\frac{1}{e^{2}}-1 \biggr{)}\biggr{]}, \tag{2.124}\]

where \(a_{0}\) is any constant. Then equation (2.122) becomes

\[\frac{R_{0}^{2}}{\tau+a_{0}^{2}}+\frac{z_{0}^{2}}{\tau+c_{0}^{2}}=\frac{m^{2} }{a_{0}^{2}}\quad\ (c_{0}\equiv\sqrt{1-e^{2}}a_{0}),\] (2.125a) and equation ( 2.123 ) becomes \[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\frac{ \sqrt{1-e^{2}}}{e}\\ &\quad\times\biggl{(}\psi(\infty)\sin^{-1}e-\frac{a_{0}e}{2}\int_ {0}^{\infty}\mathrm{d}\tau\,\frac{\psi(m)}{(\tau+a_{0}^{2})\sqrt{\tau+c_{0}^{ 2}}}\biggr{)}.\end{split} \tag{2.125b}\]

The integral in this equation gives the contributions to \(\Phi\) from homoeoids for which \((R_{0},z_{0})\) is an exterior point, with \(\tau=0\) corresponding to the homoeoid that touches \((R_{0},z_{0})\), and large \(\tau\) corresponding to small homoeoids. It is instructive to apply equations (2.125) to the determination of the interior potential of a homogeneous spheroid of density \(\rho_{0}\) and eccentricity 

\begin{table}
\begin{tabular}{c c c} Thin shell & \(\Phi({\bf x}_{\rm int})=\frac{Ga_{1}}{2a_{2}a_{3}}I({\bf a})M_{\rm shell}\) & \(\Phi({\bf x}_{\rm ext})=\frac{Ga_{1}^{\prime}}{2a_{2}^{\prime}a_{3}^{\prime}}I({ \bf a})M_{\rm shell}\) \\ Homogeneous & \(\Phi({\bf x}_{\rm int})=-\pi G\rho\{I({\bf a})a_{1}^{2}-\sum_{i=1}^{3}A_{i}({ \bf a})x_{i}^{2}\}\) & \(W_{\bar{u}j}=-\frac{8}{15}\pi^{2}G\rho^{2}a_{1}a_{2}a_{3}A_{i}a_{i}^{2}\delta_ {ij}\) \\  & \(\Phi({\bf x}_{\rm ext})=-\pi G\rho\frac{a_{1}a_{2}a_{3}}{a_{1}^{\prime}a_{2}^{ \prime}a_{3}^{\prime}}I({\bf a}){d_{1}^{\prime}}^{2}-\sum_{i=1}^{3}A_{i}({\bf a })x_{i}^{2}\}\) & \(W=-\frac{8}{15}\pi^{2}G\rho^{2}a_{1}^{3}a_{2}a_{3}I\) \\ Inhomogeneous & \(\Phi({\bf x})=-\pi G\frac{a_{2}a_{3}}{a_{1}}\int_{0}^{\infty}\frac{{\rm d}\tau} {\Delta}\left\{\psi(\infty)-\psi[m(\tau,{\bf x})]\right\}\) & \(W_{\bar{u}j}=-2\pi^{2}G\frac{a_{2}a_{3}}{a_{1}^{\prime}}SA_{i}a_{i}^{2}\delta_ {ij}\) & \(W=-2\pi^{2}G\frac{a_{2}a_{3}}{a_{1}^{\prime}}SI\delta_{ij}\) \\ \end{tabular}
\end{table}
Table 2: Potentials and potential-energy tensors of ellipsoidal bodiesthat has semi-axes of lengths \(a_{1}\) and \(a_{3}=\sqrt{1-e^{2}}\,a_{1}\). For this case, equation (2.117) yields

\[\psi(m)=\rho_{0}\times\cases{m^{2}&$(m^{2}<a_{1}^{2})$,\cr a_{1}^{2}&$(m^{2}\geq a _{1}^{2})$.\cr} \tag{2.126}\]

Equation (2.125b) takes on a particularly simple form if we set the arbitrary constant \(a_{0}\) equal to \(a_{1}\). If \((R_{0},z_{0})\) lies inside the spheroid, \(m(\tau)\) is always smaller than \(a_{0}\). Hence, we may substitute from equation (2.125a) and (2.126) into (2.125b), to obtain

\[\begin{split}\Phi(R_{0},z_{0})&=-2\pi G\rho_{0}a_{1 }^{2}\frac{\sqrt{1-e^{2}}}{e}\biggl{[}\sin^{-1}e\\ &\quad-\frac{a_{1}e}{2}\int_{0}^{\infty}\frac{d\tau}{(\tau+a_{1}^ {2})\sqrt{\tau+a_{3}^{2}}}\biggl{(}\frac{R_{0}^{2}}{\tau+a_{1}^{2}}+\frac{z_{ 0}^{2}}{\tau+a_{3}^{2}}\biggr{)}\biggr{]}.\end{split} \tag{2.127}\]

This potential is quadratic in the coordinates and may be written

\[\Phi({\bf x})=-\pi G\rho_{0}(Ia_{1}^{2}-A_{1}R^{2}-A_{3}z^{2}), \tag{2.128}\]

where the dimensionless coefficients \(I\) and \(A_{i}\) are given in Table 2.1. An expression for the exterior potential of the homogeneous spheroid is given in Table 2.2. With the help of equations (2.117) and (2.125) we obtain the gravitational field generated by a spheroidal system as

\[{\bf g}=-\boldsymbol{\nabla}\Phi=-\pi G\sqrt{1-e^{2}}\,a_{0}\int_{0}^{\infty} \mathrm{d}\tau\,\frac{\rho(m^{2})\boldsymbol{\nabla}m^{2}}{(\tau+a_{0}^{2}) \sqrt{\tau+c_{0}^{2}}},\] (2.129a) where \[\boldsymbol{\nabla}m^{2}=2a_{0}^{2}\left(\frac{R}{\tau+a_{0}^{2}}\hat{\bf e}_ {R}+\frac{z}{\tau+c_{0}^{2}}\hat{\bf e}_{z}\right). \tag{2.129b}\]

We may use equation (2.129) to find the circular speed \(v_{\mathrm{c}}(R)\) in the equatorial plane of an oblate spheroidal galaxy. The radial component of the field (2.129) is

\[g_{R}(R,z)=-2\pi G\sqrt{1-e^{2}}\,a_{0}^{3}R\int_{0}^{\infty}\mathrm{d}\tau\, \frac{\rho(m^{2})}{(\tau+a_{0}^{2})^{2}\sqrt{\tau+c_{0}^{2}}}. \tag{2.130}\]

In the equatorial plane \(z=0\), equation (2.125a) yields

\[m=\frac{a_{0}R}{\sqrt{\tau+a_{0}^{2}}}.\] (2.131a) Hence \[\frac{\mathrm{d}\tau}{(\tau+a_{0}^{2})^{2}}=-\frac{2m}{R^{2}a_{0}^{2}}\mathrm{ d}m, \tag{2.131b}\]and equation (2.130) yields

\[v_{\rm c}^{2}(R)=-Rg_{R}(R,0)=4\pi G\sqrt{1-e^{2}}\int_{0}^{R}{\rm d}m\,\frac{m^{2 }\rho(m^{2})}{\sqrt{R^{2}-m^{2}e^{2}}}. \tag{2.132}\]

Let us see how these formulae work out in a specific case. Consider the oblate spheroidal density distribution

\[\rho(m^{2})=\rho_{0}\biggl{[}1+\biggl{(}\frac{m}{a_{0}}\biggr{)}^{2}\biggr{]}^ {-3/2}, \tag{2.133}\]

where \(a_{0}\) is the core radius and the parameter \(e\) that appears in the definition (2.114) of \(m\) is the eccentricity of the system. In the limit \(e\to 0\) this reduces to the modified Hubble model (2.53). We substitute for \(\rho\) in equation (2.132) to obtain

\[v_{\rm c}^{2}(R)=4\pi G\rho_{0}a_{0}^{3}\frac{\sqrt{1-e^{2}}}{e}\int_{0}^{R} \frac{m^{2}{\rm d}m}{(a_{0}^{2}+m^{2})^{3/2}\sqrt{R^{2}/e^{2}-m^{2}}}. \tag{2.134}\]

By making the substitution

\[m=\frac{R\sin\theta}{e\sqrt{1+\left(R/ea_{0}\right)^{2}\cos^{2}\theta}} \tag{2.135}\]

Figure 2.13: Circular speed versus radius for three bodies with the same face-on projected density profile (the modified Hubble model, eq. 2.133) but different axis ratios \(q=c/a\). Though all three bodies have the same mass inside a spheroid of given semi-major axis, \(v_{\rm c}\) increases with flattening \(1-q\). one may show that the integral of equation (2.134) equals

\[\frac{ek}{R}\left[F(\theta_{m},k)-E(\theta_{m},k)\right], \tag{2.136}\]

where \(F\) and \(E\) are incomplete elliptic integrals (see Appendix C.4),

\[k\equiv\frac{R}{\sqrt{e^{2}a_{0}^{2}+R^{2}}},\quad\mbox{and}\quad\theta_{m} \equiv\sin^{-1}\sqrt{\frac{e^{2}a_{0}^{2}+R^{2}}{a_{0}^{2}+R^{2}}}.\] (2.137a) Hence \[v_{\rm c}^{2}(R)=4\pi G\rho_{0}a_{0}^{3}\frac{\sqrt{1-e^{2}}}{R}k\left[F(\theta _{m},k)-E(\theta_{m},k)\right]. \tag{2.137b}\]

We may use this result to investigate how strongly a galaxy's circular speed is affected by its shape. In Figure 2.13 we plot the circular-speed curves of three galaxies whose density profiles are given by equation (2.133) for axis ratio \(q=\sqrt{1-e^{2}}=1\) (spherical system), \(q=0.5\) (E5 galaxy), and \(q=0.1\) (the flatness characteristic of disk galaxies). The central density has in each case been adjusted so as to hold constant the mass \(M(a)\) interior to the spheroid of semi-major axis \(a\). The peak circular speed of the \(q=0.1\) model is about 20% higher than that of the spherical system because flattening the system increases the radial component of the force between a given mass element and a test mass in the equatorial plane. Figure 2.14: The ellipticity \(\epsilon_{\Phi}\) of an equipotential surface versus the surface’s semi-major axis length \(r\). Each curve is labeled by the ellipticity \(\epsilon_{\rho}=1-q\) of the body with density (2.133) that generates the corresponding potential. Notice the rapidity with which the equipotential surfaces become spherical at large \(r/a_{0}\). For the density distribution defined by equation (2.133), Figure 2.14 shows the ellipticity \(\epsilon_{\Phi}\) of the isopotential surfaces for several values of the ellipticity \(\epsilon_{\rho}\equiv 1-q\) of the density distribution. One sees that in the core \(r<a_{0}\), \(\epsilon_{\Phi}\mathrel{\hbox to 0.0pt{\raise 2.1973pt\hbox{$>$}}{\lower 2.1973pt \hbox{$\sim$}}}{1\over 2}\epsilon_{\rho}\), while at a few core radii \(\epsilon_{\Phi}\approx{1\over 3}\epsilon_{\rho}\), and at \(r\gg a\), \(\epsilon_{\Phi}\) rapidly approaches zero. Thus, in the region containing the bulk of the mass, the potential is generally flattened only about a third as much as the density, just as we found for logarithmic potentials in SS2.3.2. #### Potentials of ellipsoidal systems

The problem of calculating the gravitational potential of a body whose isodensity surfaces are similar, coaxial ellipsoids challenged some of the best minds of the eighteenth and nineteenth centuries--see Chandrasekhar (1969) for details. The general problem was solved by George Green (1793-1841), a Nottingham millwright, in 1835 using rather specialized geometrical methods that we shall not present here. Green's results are natural generalizations of the ones we deduced above by a more accessible technique for axisymmetric systems. We now summarize the results for triaxial systems and refer readers to Kellogg (1953) or Chandrasekhar (1969) for proofs. On surfaces of constant density, the variable

\[m^{2}\equiv a_{1}^{2}\sum_{i=1}^{3}{x_{i}^{2}\over a_{i}^{2}}\]

is constant, where \((x_{1},x_{2},x_{3})\) are Cartesian coordinates and \(a_{1}\), \(a_{2}\), \(a_{3}\) are the semi-axes of the ellipsoid. A thin shell of uniform density, whose inner and outer skins are the surfaces \(m\) and \(m+\delta m\), generates an exterior potential that is constant on the ellipsoidal surfaces

\[m^{2}=a_{1}^{2}\sum_{i=1}^{3}{x_{i}^{2}\over a_{i}^{2}+\tau},\]

where \(\tau\geq 0\) labels the surfaces. (This is a straightforward extension of the homoeoid theorem proved in SS2.5.1.) There is no gravitational field inside such a shell. We may find the gravitational potential of any body in which \(\rho=\rho(m^{2})\) by breaking the body down into thin triaxial homoeoids: the triaxial analog of equation (2.125b) is

\[\Phi({\bf x})=-\pi G{a_{2}a_{3}\over a_{1}}\int_{0}^{\infty}{\rm d}\tau\,{ \psi(\infty)-\psi(m)\over\sqrt{(\tau+a_{1}^{2})(\tau+a_{2}^{2})(\tau+a_{3}^{2} )}},\]

where \(\psi(m)\) is again defined by (2.117) and \(m=m({\bf x},\tau)\) through equation (2.139). Merritt & Fridman (1996) give expressions derived from (2.140)for the gravitational potentials and fields of triaxial generalizations of the Dehnen models of SS2.2.2g. **(a) Ferrers potentials** A particularly simple application of equation (2.140) is to the case in which

\[\rho(m^{2})=\cases{\rho_{0}\left(1-m^{2}/a_{1}^{2}\right)^{n}&for $m\leq a_{1}$\cr 0&for $m>a_{1}$,\cr}\]

where \(m=m({\bf x})\) through equation (2.138). By (2.117) we now have

\[\psi(\infty)-\psi(m)={\rho_{0}a_{1}^{2}\over n+1}\left(1-{m^{2}\over a_{1}^{2} }\right)^{n+1}\quad(m\leq a_{1}).\]

Hence the internal potential of a body whose density is of the form (2.141) is

\[\eqalign{\Phi({\bf x})=-{\pi G\rho_{0}a_{1}a_{2}a_{3}\over n+1}&\int_{0}^{ \infty}{{\rm d}\tau\over\sqrt{(\tau+a_{1}^{2})(\tau+a_{2}^{2})(\tau+a_{3}^{2}) }}\cr&\qquad\qquad\qquad\qquad\times\left(1-\sum_{i=1}^{3}{x_{i}^{2}\over\tau +a_{i}^{2}}\right)^{n+1}.\cr}\]

If \(n\) is an integer, the bracket involving \({\bf x}\) in equation (2.143) can be multiplied out, and the potential at any point obtained as a sum of terms of the form \(A_{pqr}x_{1}^{p}x_{2}^{q}x_{3}^{r}\), where the coefficients \(A_{pqr}\) are independent of \({\bf x}\). Potentials of this simple form are ideally suited to numerical studies of orbits in triaxial galaxies, such as we shall describe in SS3.3. We shall refer to these as **Ferrers potentials**. The \(n=0\) Ferrers potential arises from a homogeneous ellipsoid with semi-axes \(a_{1}\), \(a_{2}\), \(a_{3}\). Expressions for the interior and exterior potentials of such bodies can be derived from equations (2.140) and (2.143) and are given in Tables 2.1 and 2.2. **(b) Potential-energy tensors of ellipsoidal systems** Roberts (1962) showed that for ellipsoidal bodies equation (2.22) has a remarkably simple form:

\[W_{jk}=-\pi^{2}G{a_{2}a_{3}\over a_{1}^{2}}\left({a_{j}\over a_{1}}\right)^{2} A_{j}\delta_{jk}\int_{0}^{\infty}{\rm d}m\,\left[\psi(\infty)-\psi(m)\right]^{2},\]

where the \(A_{j}\) are given in Table 2.1. Notice that the right side of equation (2.144) comprises a constant times the product of two factors: (i) a factor \((a_{j}/a_{1})^{2}A_{j}\delta_{jk}\) that depends only on the axial ratios \((a_{2}/a_{1})\) etc. ; and (ii) a factor \(\int{\rm d}m\,\left[\psi(\infty)-\psi(m)\right]^{2}\) that is independent of the body's ellipticity and the same for all components of the tensor; this integral can be evaluated from a knowledge of the radial density structure alone. In particular, ratiosof potential-energy terms, for example \(W_{11}/W_{33}\), depend only on the body's ellipticity, and _are entirely independent of the radial density structure_ so long as the density is stratified on similar ellipsoids. We shall exploit this useful result in SS4.8.3. In Table 2.2 we give expressions for the potential-energy tensors of homogeneous ellipsoids. ### 2.6 The potentials of disks

Most of the light emitted by a typical spiral galaxy comes from a thin disk. Thus we anticipate that a substantial fraction of the galaxy's mass is concentrated in the disk, and it is therefore important to be able to calculate efficiently the gravitational field of a thin disk. We begin by investigating the potential of an idealized axisymmetric disk of zero thickness. #### Disk potentials from homoeoids

We may consider any axisymmetric disk to be a very flat spheroid and use the formulae of SS2.5.1 to obtain the potential. A homogeneous spheroid of density \(\rho\), semi-axes \(a\) and \(c\), and axial ratio \(q=c/a\) has mass \(M(a)=\frac{4}{3}\pi\rho qa^{3}\) (eq. 112) and surface density (see Figure 2.15)

\[\Sigma(a,R)=2\rho q\sqrt{a^{2}-R^{2}}, \tag{2.145}\]

where \(R\) is the usual cylindrical radius. Differentiating these expressions with respect to \(a\), we obtain the mass \(\delta M(a)\) and the surface density \(\delta\Sigma(a,R)\) of

Figure 2.15: A spheroid of axis ratio \(q\) and semi-major axis \(a\) is viewed along a line of sight that cuts the spheroid’s equatorial plane perpendicularly at radius \(R\). This line of sight cuts through the spheroid for a distance \(2q\sqrt{a^{2}-R^{2}}\). the thin homoeoid of density \(\rho\), semi-major axis \(a\), thickness \(\delta a\), and axial ratio \(q\):

\[\delta M(a)=4\pi\rho qa^{2}\delta a\quad;\quad\delta\Sigma(a,R)=\frac{2\rho qa}{ \sqrt{a^{2}-R^{2}}}\delta a. \tag{2.146}\]

If we now let \(q\) tend to zero while holding \(2\rho qa\equiv\Sigma_{0}\) constant, we obtain the mass and surface density of an infinitely flattened homoeoid:

\[\delta M(a)=2\pi\Sigma_{0}a\,\delta a\quad;\quad\delta\Sigma(a,R)=\frac{\Sigma _{0}\,\delta a}{\sqrt{a^{2}-R^{2}}}. \tag{2.147}\]

We may construct a razor-thin disk of known surface density \(\Sigma(R)\) by finding the family of homoeoids whose combined surface density equals \(\Sigma(R)\) at all \(R\). In mathematical language, we have to find the function \(\Sigma_{0}(a)\) that satisfies the integral equation

\[\Sigma(R)=\sum_{a\geq R}\delta\Sigma(a,R)=\int_{R}^{\infty}\mathrm{d}a\,\frac{ \Sigma_{0}(a)}{\sqrt{a^{2}-R^{2}}}.\] (2.148a) This is an Abel integral equation. Its solution is (eq. B.72) \[\Sigma_{0}(a)=-\frac{2}{\pi}\frac{\mathrm{d}}{\mathrm{d}a}\int_{a}^{\infty} \mathrm{d}R\,\frac{R\Sigma(R)}{\sqrt{R^{2}-a^{2}}}. \tag{2.148b}\]

Note that \(\Sigma_{0}(a)\) is _not_ the same function as \(\Sigma(R)\). In particular, some of the mass that lies interior to radius \(R\) comes from homoeoids having \(a>R\). By Newton's third theorem, this portion of matter does not contribute to the gravitational force at \(R\), because a point in the equatorial plane at radius \(R\) is an interior point of all homoeoids with \(a>R\). Thus two disks can have identical surface-density distributions for \(R^{\prime}<R\) and yet have very different force fields at \(R\). In this respect disks differ from spherical distributions of mass, for which the force at \(r_{0}\) depends only on the density at \(r<r_{0}\). In fact, the surface density of a disk at \(R^{\prime}>R\) affects the attraction at \(R\) because the annulus of material exterior to \(R\) actually pulls a star placed at radius \(R\) outward, thus partially compensating the inward attraction of the interior matter. For example on the perimeter of a sharp-edged disk, the circular speed can be much higher than at the edge of a spherical body, or a more extended disk, with the same mass interior to this point. We now calculate the potential of a thin disk by adding the potentials of the thin homoeoids into which we have decomposed it. By Gauss's theorem, the gravitational field is discontinuous across a sheet of finite surface density, but the potential is continuous. Consequently, the potential in the equatorial plane differs infinitesimally from the potential just above or below the disk. Therefore we need only calculate the potential at points that are external to all homoeoids, and take the limit \(z\to 0\) to find the potential in the plane. Equation (2.107) gives the potential outside a homoeoid of mass \(M\). For a completely flattened homoeoid, we have \(e=1\) and the mass is given in terms of \(\Sigma_{0}\) by the first of equations (2.147). Hence, at location \((R,z)\) the potential of this homoeoid is

\[\delta\Phi(R,z)=-2\pi G\Sigma_{0}\delta a\sin^{-1}(\operatorname{sech}u), \tag{2.149}\]

where \(u\) is determined by the equations \(R=a\cosh u\sin v\), \(z=a\sinh u\cos v\) (eq. 2.96). Eliminating \(v\) from these equations by using \(1=\cos^{2}v+\sin^{2}v\), we obtain a quadratic equation for \(\cosh^{2}u\):

\[a^{2}\cosh^{4}u-(R^{2}+z^{2}+a^{2})\cosh^{2}u+R^{2}=0. \tag{2.150}\]

The root that we require is the one with \(\cosh^{2}u\geq 1\), which is

\[\begin{split}\cosh^{2}u&=\frac{1}{2a^{2}}\left[R^{2 }+z^{2}+a^{2}+\sqrt{(R^{2}+z^{2}+a^{2})^{2}-4a^{2}R^{2}}\,\right]\\ &=\frac{1}{4a^{2}}\left[\sqrt{z^{2}+(a+R)^{2}}+\sqrt{z^{2}+(a-R) ^{2}}\,\right]^{2}.\end{split} \tag{2.151}\]

Taking the square root of both sides and substituting the result into equation (2.149), we obtain

\[\delta\Phi=-2\pi G\Sigma_{0}\,\delta a\sin^{-1}\bigg{(}\frac{2a}{\sqrt{z^{2}+( a+R)^{2}}+\sqrt{z^{2}+(a-R)^{2}}}\bigg{)}. \tag{2.152}\]

Finally, the potential of an axisymmetric disk of arbitrary surface-density profile is obtained by combining this result with equations (2.148), which decompose a disk into homoeoids. We have (Cuddeford 1993)

\[\Phi(R,z)=4G\int_{0}^{\infty}\mathrm{d}a\,\sin^{-1}\!\bigg{(}\frac{2a}{\sqrt{ +}+\sqrt{-}}\bigg{)}\frac{\mathrm{d}}{\mathrm{d}a}\int_{a}^{\infty}\mathrm{d }R^{\prime}\frac{R^{\prime}\Sigma(R^{\prime})}{\sqrt{R^{\prime 2}-a^{2}}}.\] (2.153a) where \[\sqrt{\pm}\equiv\sqrt{z^{2}+(a\pm R)^{2}}. \tag{2.153b}\]

An alternative form is obtained by integrating by parts:

\[\begin{split}\Phi(R,z)=-2\sqrt{2}G\int_{0}^{\infty}\mathrm{d}a& \,\frac{[(a+R)/\sqrt{+}]-[(a-R)/\sqrt{-}]}{\sqrt{R^{2}-z^{2}-a^{2} +\sqrt{+}\sqrt{-}}}\\ &\times\int_{a}^{\infty}\mathrm{d}R^{\prime}\frac{R^{\prime} \Sigma(R^{\prime})}{\sqrt{R^{\prime 2}-a^{2}}}.\end{split} \tag{2.154}\]This form does not require differentiation of the term that depends on the surface density. Equations (2.153a) and (2.154) are numerically convenient because the inner integrals depend only on \(a\), and thus can be tabulated on a grid of values of \(a\) at the outset. Then only a single integral is required to evaluate \(\Phi\) at each fresh point \((R,z)\). Moreover, the integrands do not oscillate in sign, so numerical integrations converge rapidly. We are particularly interested in the value of the potential in the equatorial plane. Consider first the case \(a>R\). For small \(z\), it is easy to see that \(\sqrt{\pm}\to(a\pm R)+{\rm O}(z^{2})\), with the consequence that the numerator of the fraction in the first line in equation (2.154) vanishes like \(z^{2}\) as \(z\to 0\). In the same limit the denominator vanishes too, but more slowly, like \(z\). Hence, for \(a>R\) the integrand tends to zero with \(z\) and we readily find that

\[\Phi(R,0)=-4G\int_{0}^{R}{{\rm d}a\over\sqrt{R^{2}-a^{2}}}\int_{a}^{\infty}{ \rm d}R^{\prime}{R^{\prime}\Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.155}\]

To obtain the circular speed at radius \(R\) in the equatorial plane, the natural procedure is to differentiate this expression with respect to \(R\), which is the upper limit of the outer integral. The usual formula for differentiating such an integral requires us to evaluate the integrand at \(a=R\), when it diverges. Instead of resolving this problem we return to equation (2.153a), in which we may put \(z\) to zero without any awkwardness, to obtain

\[\Phi(R,0)=4G\int_{0}^{\infty}{\rm d}a\,\sin^{-1}\bigg{(}{2a\over(a+R)+|a-R|} \bigg{)}{{\rm d}\over{\rm d}a}\int_{a}^{\infty}{\rm d}R^{\prime}{R^{\prime} \Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.156}\]

The argument of \(\sin^{-1}\) is unity for \(R<a\) and \(a/R\) otherwise. Consequently, when we differentiate with respect to \(R\) we obtain

\[v_{\rm c}^{2}(R)=R{\partial\Phi\over\partial R}=-4G\int_{0}^{R}{\rm d}a\,{a \over\sqrt{R^{2}-a^{2}}}{{\rm d}\over{\rm d}a}\int_{a}^{\infty}{\rm d}R^{ \prime}{R^{\prime}\Sigma(R^{\prime})\over\sqrt{R^{\prime 2}-a^{2}}}. \tag{2.157}\]

**(a) The Mestel disk**  As a simple application of equation (2.157) consider a disk in which the surface density is given by

\[\Sigma(R)=\cases{{v_{0}^{2}\over 2\pi GR}&for $R<R_{\rm max}$\cr 0&otherwise,} \tag{2.158}\]

where \(v_{0}\) and \(R_{\rm max}\) are constants with dimensions of velocity and length, respectively. For this surface density the inner integral in equation (2.157) is proportional to \(\cosh^{-1}(R_{\rm max}/a)\), so its derivative with respect to \(a\) follows from

\[{{\rm d}\over{\rm d}a}\cosh^{-1}(R_{\rm max}/a)=-{R_{\rm max}\over a\sqrt{R_{ \rm max}^{2}-a^{2}}}. \tag{2.159}\]We let the outer radius of the disk, \(R_{\rm max}\), tend to infinity. In this limit the disk becomes the **Mestel disk** (Mestel 1963) and the derivative (2.159) becomes \(-1/a\). Substituting this value into equation (2.157), we find that the circular speed in the Mestel disk is

\[v_{\rm c}^{2}=\frac{2v_{0}^{2}}{\pi}\int_{0}^{R}\frac{{\rm d}a}{\sqrt{R^{2}-a^ {2}}}=v_{0}^{2}. \tag{2.160}\]

Hence, the circular speed of a disk in which the surface density is inversely proportional to radius is independent of radius. Moreover, for this surface-density law, \(v_{\rm c}(R)\) is given by the simple formula

\[v_{\rm c}^{2}(R)=\frac{GM(R)}{R},\] (2.161a) where \[M(R)=2\pi\int_{0}^{R}{\rm d}R^{\prime}\,R^{\prime}\Sigma(R^{\prime})=\frac{v_ {0}^{2}R}{G} \tag{2.161b}\]

is the mass interior to \(R\). This is precisely analogous to equation (2.29) for a spherical system. Although we have argued that for general disks the circular speed is affected by the mass exterior to \(R\), for the particular case of the Mestel disk the simple formula (2.161a) happens to give the correct answer--we are aware of no other disks with this property. **(b) The exponential disk** The surface-brightness profiles of many galactic disks are approximately exponential in form (eq. 1.7). Let us use the results just derived to calculate the potential that such a disk would generate if its surface mass density were also exponential. Setting

\[\Sigma(R)=\Sigma_{0}{\rm e}^{-R/R_{\rm d}}, \tag{2.162}\]

we use equation (C.69) to show that the inner integral in equations (2.153a) to (2.157) is

\[\int_{a}^{\infty}{\rm d}R^{\prime}\frac{R^{\prime}\Sigma_{0}{\rm e}^{-R^{ \prime}/R_{\rm d}}}{\sqrt{R^{\prime 2}-a^{2}}}=\Sigma_{0}aK_{1}(a/R_{\rm d}), \tag{2.163}\]

where \(K_{1}\) is a modified Bessel function (Appendix C.7). Figure 2.16 shows contours of the potential that one obtains by substituting this formula into equation (2.154). The potential in the equatorial plane is given by substituting (2.163) into equation (2.155):

\[\begin{split}\Phi(R,0)&=-4G\Sigma_{0}\int_{0}^{R}{ \rm d}a\,\frac{aK_{1}(a/R_{\rm d})}{\sqrt{R^{2}-a^{2}}}\\ &=-\pi G\Sigma_{0}R\big{[}I_{0}(y)K_{1}(y)-I_{1}(y)K_{0}(y)\big{]},\end{split} \tag{2.164a}\]where

\[y\equiv{R\over 2R_{\rm d}},\]

we have used equation (C.70), and the \(I_{n}\) are modified Bessel functions (Appendix C.7). If we differentiate equation (2.164a) with respect to \(R\), we obtain the circular speed of the exponential disk (Freeman 1970):

\[v_{\rm c}^{2}(R)=R{\partial\Phi\over\partial R}=4\pi G\Sigma_{0}R_{\rm d}y^{2} \left[I_{0}(y)K_{0}(y)-I_{1}(y)K_{1}(y)\right].\]

In Figure 2.17 we show this circular speed together with the circular speed of the spherical body that has as much mass \(M_{\rm s}(r)\) interior to \(r=R\) as the exponential disk, that is,

\[\eqalign{M_{\rm s}(R)=M_{\rm d}(R)&=2\pi\int_{0}^{R}{\rm d}R^{\prime}\,R^{ \prime}\Sigma_{0}{\rm e}^{-R^{\prime}/R_{\rm d}}\cr&=2\pi\Sigma_{0}R_{\rm d}^{2 }\biggl{[}1-{\rm e}^{-R/R_{\rm d}}\Bigl{(}1+{R\over R_{\rm d}}\Bigr{)}\biggr{]}. }\]

The exponential disk achieves a peak circular speed that is about 15% higher than that of the equivalent spherical distribution. The dotted line in Figure 2.17 gives the Keplerian circular speed for a system in which the entire mass of the disk is concentrated at the center. Notice that the disk's circular speed approaches the Keplerian speed only slowly and from above, whereas the circular speed of the equivalent spherical distribution tends rapidly to the Keplerian speed from below. **(c) Thick disks** Although galactic disks are thin in the sense that the density falls off much faster perpendicular to the equatorial plane than in the radial direction within the plane, it is frequently essential to take into account the non-zero thickness of the disk in the perpendicular direction. For example, the dynamics of the solar neighborhood, and of the Sun itself, would be very different if the Galactic disk were razor-thin rather than some hundreds of parsecs thick. The techniques for deriving the potential of a spheroidal system that are described in SS2.5.1 are not directly applicable to this problem because the density of a galactic disk is generally not constant on spheroids. The multipole expansion described in SS2.4 is also not suitable, because it converges slowly for flat systems. Here we describe how to calculate the potential of a disk when the density is of the form

\[\rho(R,z)=\Sigma(R)\zeta(z). \tag{167}\]

Physically, this formula implies that a cross-section through the disk always has the same shape, no matter at what radius it is taken. In particular, the characteristic scale height of the disk is independent of \(R\), an assumption that is in reasonable agreement with observations of edge-on disk galaxies (BM SS4.4.3). It is convenient to normalize the function \(\zeta(z)\) in equation (167) such that \(\int{\rm d}z\,\zeta(z)=1\). With this normalization, \(\Sigma(R)\) is the total surface density

Figure 17: The circular-speed curves of: an exponential disk (full curve); a point with the same total mass (dotted curve); the spherical body for which \(M(r)\) is given by equation (166) (dashed curve). and \(\Sigma(R)\zeta(z)\,{\rm d}z\) is the surface density of the layer of material of thickness \({\rm d}z\) that lies a distance \(z\) above the equatorial plane. Let \(\Phi_{0}(R,z)\) be the potential that would be generated by a razor-thin disk with surface density \(\Sigma(R)\) that lay in the plane \(z=0\). Then the potential generated at \((R,z)\) by the layer at distance \(z^{\prime}\) from the plane is

\[{\rm d}\Phi(R,z)={\rm d}z^{\prime}\,\Phi_{0}(R,z-z^{\prime})\zeta(z^{\prime}). \tag{2.168}\]

Adding the contributions to the disk's potential from every layer, we obtain for the overall potential

\[\Phi(R,z)=\int_{-\infty}^{\infty}{\rm d}z^{\prime}\,\zeta(z^{\prime})\Phi_{0}( R,z-z^{\prime}), \tag{2.169}\]

where \(\Phi_{0}\) can be obtained from either (2.153a) or (2.154). Consider, for example, the exponential disk (2.162). Then inserting into equation (2.153a) the derivative \(-\Sigma_{0}(a/R_{\rm d})K_{0}(a/R_{\rm d})\) with respect to \(a\) of equation (2.163), and then substituting the resulting value of \(\Phi_{0}\) into equation (2.169), we find

\[\Phi(R,z)=-\frac{4G\Sigma_{0}}{R_{\rm d}}\int_{-\infty}^{\infty}{\rm d}z^{ \prime}\,\zeta(z^{\prime})\int_{0}^{\infty}{\rm d}a\,\sin^{-1}\bigg{(}\frac{2a }{\sqrt{+}+\sqrt{-}}\bigg{)}aK_{0}(a/R_{\rm d}), \tag{2.170}\]

where \(\sqrt{\pm}\) is defined by equation (2.153b) with \(z\) replaced by \(z-z^{\prime}\). We shall use this formula in SS2.7 below. #### 2.6.2 Disk potentials from Bessel functions

Disk galaxies generally contain non-axisymmetric features such as a bar or spiral arms. Hence it is essential to know how to calculate the potential of a flattened, non-axisymmetric system. Several methods may be employed and none is ideal for every problem. Evans & de Zeeuw (1992) show how the results of SS2.5.3 may be used to obtain the potential of razor-thin, elliptical disks in analogy with the work of SS2.6.1. However, the technique they present is not easy to apply, so in the rest of this section we present three alternatives, each with its own strengths when applied to particular problems. All these methods can also be applied to axisymmetric disks, and all yield alternatives to the formulae of SS2.5. Above and below an isolated razor-thin disk the gravitational potential satisfies Laplace's equation, \(\nabla^{2}\Phi=0\), with appropriate boundary conditions on the disk and at infinity. In cylindrical coordinates Laplace's equation is (eq. B.52)

\[\frac{1}{R}\frac{\partial}{\partial R}\left(R\frac{\partial\Phi}{\partial R} \right)+\frac{1}{R^{2}}\frac{\partial^{2}\Phi}{\partial\phi^{2}}+\frac{ \partial^{2}\Phi}{\partial z^{2}}=0. \tag{2.171}\]Writing

\[\Phi(R,z)=J(R)F(\phi)Z(z), \tag{2.172}\]

we obtain by the method of separation of variables (see SS2.4)

\[\frac{1}{J(R)R}\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{\mathrm{d}J}{\mathrm{d }R}\right)+\frac{1}{F(\phi)R^{2}}\frac{\mathrm{d}^{2}F}{\mathrm{d}\phi^{2}}=- \frac{1}{Z(z)}\frac{\mathrm{d}^{2}Z}{\mathrm{d}z^{2}}=-k^{2}, \tag{2.173}\]

where \(k\) is an arbitrary real or complex number. Thus

\[0 =\frac{\mathrm{d}^{2}Z}{\mathrm{d}z^{2}}-k^{2}Z, \tag{2.174}\] \[0 =\frac{1}{J(R)R}\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{ \mathrm{d}J}{\mathrm{d}R}\right)+\frac{1}{F(\phi)R^{2}}\frac{\mathrm{d}^{2}F} {\mathrm{d}\phi^{2}}+k^{2}.\]

The first of equations (2.174) may be immediately integrated to

\[Z(z)=\mathrm{e}^{\pm kz}. \tag{2.175}\]

When multiplied by \(R^{2}\), the second of equations (2.174) separates into equations for \(J\) and \(F\):

\[0 =\frac{\mathrm{d}^{2}F}{\mathrm{d}\phi^{2}}+m^{2}F \tag{2.176}\] \[0 =R\frac{\mathrm{d}}{\mathrm{d}R}\left(R\frac{\mathrm{d}J}{ \mathrm{d}R}\right)+k^{2}R^{2}J(R)-m^{2}J.\]

The first of these equations trivially yields \(F\propto\mathrm{e}^{\mathrm{i}m\phi}\), where \(m\) is an integer. If we make the substitution \(u\equiv kR\), the second equation simplifies to

\[u\frac{\mathrm{d}}{\mathrm{d}u}\left(u\frac{\mathrm{d}J}{\mathrm{d}u}\right)+( u^{2}-m^{2})J(u)=0. \tag{2.177}\]

We require the solution of this equation to be finite at \(u=0\) (\(R=0\)). This solution is conventionally written \(J_{m}(u)=J_{m}(kR)\) and is called the Bessel function of order \(m\) (Appendix C.7). Summarizing these results, we have that the functions

\[\Phi_{\pm}(R,z)=\mathrm{e}^{\mathrm{i}(m\phi\pm kz)}J_{m}(kR) \tag{2.178}\]

are solutions of \(\nabla^{2}\Phi=0\). Figure 2.18: The disk mass within the box shown in cross-section equals \(-(4\pi G)^{-1}\) times the integral of the normal component of \(\boldsymbol{\nabla}\Phi_{km}\) over the surface of the box. The horizontal component of \(\boldsymbol{\nabla}\Phi_{km}\) is due to the gravitational attraction from the rest of the galaxy. Now consider the function

\[\Phi_{km}(R,z)={\rm e}^{{\rm i}m\phi-k|z|}J_{m}(kR),\]

where \(k\) is real and positive. \(\Phi_{km}\) satisfies all the conditions required for it to be the potential generated by an isolated density distribution: it is non-singular at \(R=0\), periodic in \(\phi\) and vanishes at large distances from the origin. Furthermore, for \(z>0\), \(\Phi_{km}\) coincides with \(\Phi_{-}\), and for \(z<0\), \(\Phi_{km}\) coincides with \(\Phi_{+}\). Therefore, \(\Phi_{km}\) solves \(\nabla^{2}\Phi=0\) everywhere except in the plane \(z=0\). At \(z=0\), \(\Phi_{km}\) does not satisfy Laplace's equation because its gradient suffers a discontinuity. Figure 2.18 illustrates how we may use Gauss's theorem (eq. 2.12) to evaluate the surface density \(\Sigma_{km}(R,\phi)\) of the sheet that generates this discontinuity. We have that

\[\lim_{z\to 0+}{\partial\Phi_{km}\over\partial z}=-k{\rm e}^{{\rm i}m\phi}J_{m}( kR)\quad\hbox{and}\quad\lim_{z\to 0-}{\partial\Phi_{km}\over\partial z}=+k{\rm e}^{{ \rm i}m\phi}J_{m}(kR).\]

The integral of \(\hbox{\boldmath$\nabla$}\Phi_{km}\) over the closed unit surface that is shown in the figure must equal \(4\pi G\Sigma_{km}\) from which it follows that

\[\Sigma_{km}(R,\phi)=-{k\over 2\pi G}\,{\rm e}^{{\rm i}m\phi}J_{m}(kR).\]

We now use equations (2.179) to find the potential generated by a disk of arbitrary surface density \(\Sigma(R,\phi)\). If we can find functions \(S_{m}(k)\) such that

\[\eqalign{\Sigma(R,\phi)&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)\Sigma_{km}(R,\phi)\cr&=-{1\over 2\pi G}\sum_{m=-\infty}^{\infty}\int_{0}^{ \infty}{\rm d}k\,kS_{m}(k){\rm e}^{{\rm i}m\phi}J_{m}(kR),}\]

then we will have

\[\eqalign{\Phi(R,\phi,z)&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)\Phi_{km}(R,\phi,z)\cr&=\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}{\rm d}k\, S_{m}(k)J_{m}(kR){\rm e}^{{\rm i}m\phi-k|z|}. }\]

Multiplying (2.181) through by \({\rm e}^{-{\rm i}m^{\prime}\phi}\) and averaging over \(\phi\), we obtain

\[\Sigma_{m^{\prime}}(R)\equiv{1\over 2\pi}\int_{0}^{2\pi}{\rm d}\phi\,{\rm e}^{-{ \rm i}m^{\prime}\phi}\Sigma(R,\phi)=-{1\over 2\pi G}\int_{0}^{\infty}{\rm d}k\, kS_{m^{\prime}}(k)J_{m^{\prime}}(kR).\]Equation (2.183) states that \(S_{m}(k)\) is the \(m\)th-order Hankel transform of \(-2\pi G\Sigma_{m}\) (eq. C.60b). Hankel transforms have properties that are similar to those of the familiar Fourier transforms (Appendix B.4). In particular, they may be inverted by use of equation (C.60a). We find

\[S_{m}(k)=-2\pi G\int_{0}^{\infty}{\rm d}R\,RJ_{m}(kR)\Sigma_{m}(R). \tag{2.184}\]

When we eliminate \(S_{m}(k)\) between this equation and (2.182), we obtain finally

\[\Phi(R,\phi,z)=-2\pi G\!\!\sum_{m=-\infty}^{\infty}\int_{0}^{\infty}\!\! {\rm d }k\,{\rm e}^{{\rm i}m\phi-k|z|}J_{m}(kR)\!\int_{0}^{\infty}\!\! {\rm d}R^{\prime }\,R^{\prime}J_{m}(kR^{\prime})\Sigma_{m}(R^{\prime}). \tag{2.185}\]

Application to axisymmetric disks Potential-density pairs for axisymmetric disks are obtained by setting \(z=0\) in equation (2.182) and restricting the sum to the case \(m=0\). We have (Toomre 1963)

\[\Phi(R,0)=\int_{0}^{\infty}{\rm d}k\,S_{0}(k)J_{0}(kR). \tag{2.186}\]

Differentiating with respect to \(R\) and using the identity \({\rm d}J_{0}(x)/{\rm d}x=-J_{1}(x)\) (eq. C.58), we obtain

\[v_{\rm c}^{2}(R)=R\frac{\partial\Phi}{\partial R}=-R\int_{0}^{\infty}{\rm d}k \,kS_{0}(k)J_{1}(kR). \tag{2.187}\]

Substituting for \(S_{0}(k)\) from equation (2.184) this can be rewritten

\[v_{\rm c}^{2}(R)=2\pi GR\int_{0}^{\infty}{\rm d}k\,kJ_{1}(kR)\int_{0}^{\infty} {\rm d}R^{\prime}\,R^{\prime}\Sigma(R^{\prime})J_{0}(kR^{\prime}). \tag{2.188}\]

Applying to equation (2.187) the inversion formula for Hankel transforms (eqs. C.60) we find

\[S_{0}(k)=-\int_{0}^{\infty}{\rm d}R^{\prime}\,v_{\rm c}^{2}(R^{\prime})J_{1}( kR^{\prime}). \tag{2.189}\]

Substituting this expression for \(S_{0}\) into equation (2.181), we have

\[\Sigma(R)=\frac{1}{2\pi G}\int_{0}^{\infty}{\rm d}k\,kJ_{0}(kR)\int_{0}^{ \infty}{\rm d}R^{\prime}\,v_{\rm c}^{2}(R^{\prime})J_{1}(kR^{\prime}). \tag{2.190}\]

Comparison of this formula with our expression (2.188) for the reverse relation reveals complete symmetry between the quantities \(v_{\rm c}(R)\) and \(2\pi GR\Sigma(R)\)(Kalnajs 1999). Hence our mathematics seems to be saying that it is as easy to determine a disk's surface density from measurements of its circular speed, as to obtain the circular speed from the surface density. Unfortunately, observational constraints destroy this symmetry. The key point is that the left side of either equation (2.188) or (2.190) can be determined at any given value of \(R\) only if the variable on the right side can be measured out to radii at which its value becomes negligible. The surface density declines rapidly with radius, so equation (2.188) can be used to derive accurate values of \(v_{\rm c}\). Circular speeds, by contrast, decline little if at all out to the largest observable radii. Consequently, in practice we cannot obtain the data needed to determine \(\Sigma\) accurately from equation (2.190). # 2.6.3 Disk potentials from logarithmic spirals

An alternative technique for finding non-axisymmetric potential-density pairs was introduced by Kalnajs (1971). The potential \(\Phi(R,\phi)\) at any point in the plane of a disk is

\[\Phi(R,\phi) =-G\int{\rm d}R^{\prime}\,R^{\prime}\int{\rm d}\phi^{\prime}\, \frac{\Sigma(R^{\prime},\phi^{\prime})}{|{\bf x}-{\bf x}^{\prime}|} \tag{2.191}\] \[=-G\int_{0}^{\infty}{\rm d}R^{\prime}\,R^{\prime}\int_{0}^{2\pi} {\rm d}\phi^{\prime}\,\frac{\Sigma(R^{\prime},\phi^{\prime})}{\sqrt{R^{ \prime 2}+R^{2}-2RR^{\prime}\cos(\phi^{\prime}-\phi)}}.\]

The integral in this expression can be simplified if we define a new radial coordinate,

\[u\equiv\ln R, \tag{2.192}\]

and introduce the **reduced potential**\(V\) and the **reduced surface density**\(S\) by

\[R^{1/2}\Phi\equiv V(u,\phi)={\rm e}^{u/2}\Phi\left[R(u),\phi\right] \tag{2.193}\] \[R^{3/2}\Sigma\equiv S(u,\phi)={\rm e}^{3u/2}\Sigma\left[R(u),\phi \right].\]

With these substitutions (2.191) becomes

\[V(u,\phi)=-G\int_{-\infty}^{\infty}{\rm d}u^{\prime}\int_{0}^{2\pi}{\rm d} \phi^{\prime}\,K(u-u^{\prime},\phi-\phi^{\prime})S(u^{\prime},\phi^{\prime}),\] (2.194a) where \[K(u-u^{\prime},\phi-\phi^{\prime})\equiv\frac{1}{\sqrt{2}\sqrt{\cosh(u-u^{ \prime})-\cos(\phi-\phi^{\prime})}}. \tag{2.194b}\]

Now consider the reduced potential \(V_{\alpha m}(u,\phi)\) that is generated by the particular reduced surface density

\[S_{\alpha m}(u,\phi)={\rm e}^{{\rm i}(\alpha u+m\phi)}, \tag{2.195}\]where \(\alpha\) is a real number and \(m\) is an integer. We have

\[V_{\alpha m}(u,\phi)=-G\int_{-\infty}^{\infty}\mathrm{d}u^{\prime }\int_{0}^{2\pi}\mathrm{d}\phi^{\prime}\,K(u-u^{\prime},\phi-\phi^{\prime}) \mathrm{e}^{\mathrm{i}(\alpha u^{\prime}+m\phi^{\prime})} \tag{2.196}\] \[=-G\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}\int_{-\infty}^{\infty} \mathrm{d}u^{\prime}\int_{0}^{2\pi}\mathrm{d}\phi^{\prime}\,K(u-u^{\prime}, \phi-\phi^{\prime})\mathrm{e}^{\mathrm{i}[\alpha(u^{\prime}-u)+m(\phi^{\prime }-\phi)]}.\]

If we change to new variables of integration \(u^{\prime\prime}\equiv u-u^{\prime}\) and \(\phi^{\prime\prime}\equiv\phi-\phi^{\prime}\), equation (2.196) becomes

\[V_{\alpha m}=-GN(\alpha,m)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}, \tag{2.197}\]

where

\[\begin{split} N(\alpha,m)&\equiv\int_{-\infty}^{ \infty}\mathrm{d}u^{\prime\prime}\int_{0}^{2\pi}\mathrm{d}\phi^{\prime\prime} \,K(u^{\prime\prime},\phi^{\prime\prime})\mathrm{e}^{-\mathrm{i}(\alpha u^{ \prime\prime}+m\phi^{\prime\prime})}\\ &=\pi\frac{(\frac{1}{2}m-\frac{3}{4}+\frac{1}{2}\mathrm{i}\alpha)!(\frac{1}{2}m-\frac{3}{4}-\frac{1}{2}\mathrm{i}\alpha)! }{(\frac{1}{2}m-\frac {1}{4}+\frac{1}{2}\mathrm{i}\alpha)! (\frac{1}{2}m-\frac{1}{4}-\frac{1}{2} \mathrm{i}\alpha)! }.\end{split} \tag{2.198}\]

The kernel \(N(\alpha,m)\) is real and even in both \(\alpha\) and \(m\).7 The reduced potential generated by an arbitrary linear combination

Footnote 7: These statements can be proved using equations (C.12) and (C.14). \[S(u,\phi)\equiv\sum_{m=-\infty}^{\infty}\int_{-\infty}^{\infty}\frac{\mathrm{ d}\alpha}{2\pi}\,A_{m}(\alpha)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}\] (2.199a) of surface densities of the form ( 2.195 ) is \[V(u,\phi)=-G\sum_{m=-\infty}^{\infty}\int_{-\infty}^{\infty}\frac{\mathrm{d} \alpha}{2\pi}\,N(\alpha,m)A_{m}(\alpha)\mathrm{e}^{\mathrm{i}(\alpha u+m\phi)}. \tag{2.199b}\]

Furthermore, equation (2.199a) states that \(A_{m}(\alpha)\) is nothing but the Fourier transform of the reduced surface density \(S(u,\phi)\) (eqs. B.64 and B.67). Consequently,

\[A_{m}(\alpha)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathrm{d}u\int_{0}^{2\pi} \mathrm{d}\phi\,S(u,\phi)\mathrm{e}^{-\mathrm{i}(\alpha u+m\phi)}. \tag{2.199c}\]

So we may use equations (2.199) to obtain the potential in the plane \(z=0\) that is generated by any distribution of surface density. Since \(\alpha u+m\phi=\alpha\ln R+m\phi\) is constant on **logarithmic spirals**, equations (2.199) determine the potential of a disk by decomposing the density into spirals. Note that this derivation does not produce an expression for the value of the potential away from the plane \(z=0\) (Problem 2.19 remedies this defect). #### 2.6.4 Disk potentials from oblate spheroidal coordinates

In some situations we require the potential of a disk with a sharp outer edge. If the outer edge is circular, this problem can be efficiently solved using the oblate spheroidal coordinates of SS2.5.1.8 We substitute \(\Phi=U(u)V(v){\rm e}^{{\rm i}m\phi}\) into Laplace's equation using (2.101), and separate variables in the usual way. Then we find that \(U\) and \(V\) satisfy

Footnote 8: In the more general case in which the outer edge is an ellipse, one uses ellipsoidal coordinates (Morse & Feshbach 1953; Tremaine 1976b; Evans & de Zeeuw 1992). \[\frac{m^{2}}{\sin^{2}v}-\frac{1}{V\sin v}\frac{{\rm d}}{{\rm d}v} \left(\sin v\frac{{\rm d}V}{{\rm d}v}\right) =l(l+1), \tag{2.200a}\] \[\frac{m^{2}}{\cosh^{2}u}+\frac{1}{U\cosh u}\frac{{\rm d}}{{\rm d}u }\left(\cosh u\frac{{\rm d}U}{{\rm d}u}\right) =l(l+1), \tag{2.200b}\]

where \(l(l+1)\) is the separation constant. The left side of equation (2.200a) is the same as the right side of equation (2.80) with \(V(v)\) substituted for \(P(\theta)\). Furthermore, the boundary conditions at \(v=0\) or \(\pi\) (i.e., along the \(z\) axis) that must be satisfied by a physically acceptable function \(V(v)\) are the same as the conditions we imposed on \(P(\theta)\). Hence

\[V(v,\phi)=V_{lm}{\rm Y}_{l}^{m}(v,\phi), \tag{2.201}\]

where \(V_{lm}\) is a constant and \({\rm Y}_{l}^{m}\) is the spherical harmonic defined by equation (C.42). Since the potential must be symmetrical about the plane of the disk \(v=\pi/2\), we must restrict ourselves to values of \(l\) and \(m\) for which \({\rm Y}_{l}^{m}(v,\phi)\) is an even function of \(\cos v\). Hence we require \(l-m\) to be even. If we change the independent variable in equation (2.200b) to \(x={\rm i}\sinh u\), the equation becomes the associated Legendre equation (2.81b) with \(x\) now pure imaginary. If the potential is to vanish at infinity (large \(u\)), it must be proportional to the solution of equation (2.81b) that vanishes at large \(x\). This is written \(Q_{l}^{m}(x)\) (see C.5). Hence the functions

\[\Phi_{lm}(u,v,\phi)\equiv\frac{V_{lm}}{Q_{l}^{m}(0)}Q_{l}^{m}({\rm i}\sinh u){ \rm Y}_{l}^{m}(v,\phi)\ \ \ \ \ (l-m\ {\rm even}) \tag{2.202}\]

satisfy Laplace's equation everywhere outside the excluded disk \(u=0\) (\(z=0\), \(R\leq\Delta\)) and vanish at infinity. However, there is a discontinuity in the gradient of \(\Phi_{lm}\) on the excluded disk. By Gauss's theorem, this discontinuity is generated by a surface density \(\Sigma_{lm}(v,\phi)\); thus from equation (2.100) we have

\[\begin{split} 4\pi G\Sigma_{lm}(v,\phi)&=2\left(\hat{\bf e }_{u}\!\cdot\!\!\nabla\Phi_{lm}\right)_{u\to 0+}=\frac{2}{\Delta|\cos v|} \lim_{u\to 0+}\left(\frac{\partial\Phi_{lm}}{\partial u}\right)\\ &=2V_{lm}{\rm i}\lim_{x\to 0}\left[\frac{{\rm d}\ln Q_{l}^{m}(x)}{{ \rm d}x}\right]\frac{{\rm Y}_{l}^{m}(v,\phi)}{\Delta|\cos v|},\end{split} \tag{2.203}\]where \(x\) approaches zero along the positive imaginary axis. Using equations (C.31) and (C.13) to evaluate the limit in equation (2.203), we then find (Hunter 1963)

\[\Sigma_{lm}=-\frac{2V_{lm}}{\pi^{2}G\Delta g_{lm}}\,\frac{{\rm Y}_{l}^{m}(v, \phi)}{|\cos v|},\] (2.204a) where \[g_{lm}\equiv\frac{(l+m)!(l-m)! }{2^{2l-1}\left[\left(\frac{l+m}{2}\right)!\left( \frac{l-m}{2}\right)!\right]^{2}}. \tag{2.204b}\]

A general disk potential, which is a sum over \(l\) and \(m\) of potentials of the form (2.202), is generated by the surface density \(\Sigma(v,\phi)\) that is the sum of surface densities \(\Sigma_{lm}(v,\phi)\). According to equation (2.204a), \(-2V_{lm}/(\pi^{2}G\Delta g_{lm})\) is the coefficient of \({\rm Y}_{l}^{m}(v,\phi)\) when \(|\cos v|\Sigma(v,\phi)\) is expanded in spherical harmonics. Thus with the orthogonality relation (C.44) we have

\[\frac{2V_{lm}}{\pi^{2}G\Delta g_{lm}}=-\int_{0}^{2\pi}{\rm d}\phi\int_{0}^{ \pi}{\rm d}v\,\sin v|\cos v|\Sigma(v,\phi){\rm Y}_{l}^{m\,*}(v,\phi). \tag{2.205}\]

The integrand in equation (2.205) is symmetrical about \(v=\pi/2\) when \(l-m\) is even, so we may restrict the \(v\) integration to the range \((0,\pi/2)\) and double the result. Hence

\[V_{lm}=-\frac{\pi^{2}Gg_{lm}}{\Delta}\int_{0}^{2\pi}{\rm d}\phi\int_{0}^{ \Delta}{\rm d}R\,R\Sigma(R,\phi){\rm Y}_{l}^{m\,*}\Big{(}\sin^{-1}(R/\Delta), \phi\Big{)}. \tag{2.206}\]

All the techniques in this section are special cases of a general method for finding disk potential-density pairs that is described by Qian (1992). ### 2.7 The potential of our Galaxy

In this section we investigate the gravitational field of our own galaxy, the Milky Way. The Galaxy is made of several components, the disk, the bulge, the stellar halo, and the dark halo. The mix of stars, gas and dark matter that makes up a galaxy such as our own varies from component to component and is even likely to depend on location within each component. Ideally, we should rely solely on dynamical tracers, such as the velocity fields of gas and stars and observations of gravitational lensing, to map out the distribution of mass in the Galaxy. Sadly, at the present time such a project is unfeasible. Since we are not yet in a position to model the Galactic density and gravitational field in a purely dynamical way, we flesh out the available dynamical constraints with photometric information. In particular, we simply assume_ that each component has a mass-to-light ratio \(\Upsilon\) that is independent of position. For the reason given above, this procedure is arbitrary and unsatisfactory, but it yields concrete Galactic potentials, which make testable predictions regarding the kinematics of stars and gas. Proceeding in this spirit, we now investigate models of our Galaxy, following Dehnen & Binney (1998a) and BM SS10.6. The brightness distribution of each component is assumed to be similar to those of external galaxies (BM SSSS4.3 and 4.4), while the size and total luminosity of each component is determined from photometry and star counts, or by fitting to the available dynamical constraints. We do not model the stellar halo here since its contribution to the potential is negligible. The models are constrained by fitting to the following data (cf. Table 1.2):

(i) The circular-speed curve \(v_{\rm c}(R)\) for an assumed value of the solar circular speed, \(v_{0}\equiv v_{\rm c}(R_{0})\). Since this curve is determined from the line-of-sight velocities of tracers such as HI clouds and Cepheid stars, the circular-speed curve depends on \(v_{0}\), which must be determined by other methods. (ii) The values of the Oort constants (Table 1.2, eq. 3.83, and BM SS10.3.3). (iii) The total surface density within \(1.1\,{\rm kpc}\) of the Galactic plane near the Sun, \(\Sigma_{1.1}(R_{0})\), and the contribution of the disk to this density (Table 1.1). (iv) The velocity dispersion of bulge stars in Baade's window, a line of sight that passes \(\sim 500\,{\rm pc}\) from the Galactic center in which absorption by intervening dust is unusually low. We take this dispersion to be \(117\pm 15\,{\rm km\,s^{-1}}\). (v) The total mass within \(100\,{\rm kpc}\) of the Galactic center (eq. 1.12). (vi) The solar radius \(R_{0}=8\,{\rm kpc}\). The functional forms assumed for each of the Galaxy's components are as follows. **(a) The bulge** The density of this component is assumed to be

\[\rho_{\rm b}(R,z)=\rho_{\rm b0}\Bigl{(}{m\over a_{\rm b}}\Bigr{)}^{-\alpha_{ \rm b}}{\rm e}^{-m^{2}/r_{\rm b}^{2}},\] (2.207a) where \[m=\sqrt{R^{2}+z^{2}/q_{\rm b}^{2}}. \tag{2.207b}\]

For \(q_{\rm b}<1\) this is an oblate, spheroidal power-law model that is truncated at an outer radius \(r_{\rm b}\). Its potential is conveniently calculated from equations (2.125) with

\[e=\sqrt{1-q_{\rm b}^{2}}\quad;\quad\psi(m)=\rho_{\rm b0}\int_{0}^{m}{\rm d}m^ {2}\,\Bigl{(}{m\over a_{\rm b}}\Bigr{)}^{-\alpha_{\rm b}}{\rm e}^{-m^{2}/r_{ \rm b}^{2}}. \tag{2.208}\]

Near-infrared photometry (BM SS10.2.1) suggests values for three of the parameters, \(\alpha_{\rm b}=1.8\), \(q_{\rm b}=0.6\), \(r_{\rm b}=1.9\,{\rm kpc}\), and without loss of generality,we can set \(a_{\rm b}=1\,{\rm kpc}\). The parameter \(\rho_{\rm b0}\), and hence the mass of the bulge, are determined by fitting the dynamical constraints. **(b) The dark halo** By extending the spherical two-power-law models of SS2.2.2f to oblate models, the density of this component is taken to have the form

\[\rho_{\rm h}(R,z)=\rho_{\rm h0}\Bigl{(}\frac{m}{a_{\rm h}}\Bigr{)}^{-\alpha_{ \rm h}}\Bigl{(}1+\frac{m}{a_{\rm h}}\Bigr{)}^{\alpha_{\rm h}-\beta_{\rm h}}, \tag{2.209}\]

where \(m\) is again given by equation (2.207b) with \(q_{\rm b}\) replaced by \(q_{\rm h}\). The potential of this component, in which the density varies as \(r^{-\alpha_{\rm h}}\) for \(r\ll a_{\rm h}\) and \(r^{-\beta_{\rm h}}\) at large \(r\), can also be obtained from equation (2.125). Clearly, photometry provides no guidance as to the values of any of the parameters in equation (2.209); all five parameters \(\rho_{\rm h0}\), \(a_{\rm h}\), \(\alpha_{\rm h}\), \(\beta_{\rm h}\), and \(q_{\rm h}\) can only be determined by fitting the dynamical constraints. The data we use have little sensitivity to \(q_{\rm h}\), and we arbitrarily set it to 0.8. **(c) The stellar disk** The density of the stellar disk is assumed to fall off exponentially with radius \(R\), as in equation (1.7), and to depend on distance from the midplane \(z\) through the sum of two exponentials, representing the thin and thick disks described on page 13--this dependence on \(z\) is motivated by observations such as those of Gilmore & Reid (1983), shown in BM Figure 10.25. Mathematically,

\[\rho_{\rm d}(R,z)=\Sigma_{\rm d}{\rm e}^{-R/R_{\rm d}}\biggl{(}\frac{\alpha_{ 0}}{2z_{0}}{\rm e}^{-|z|/z_{0}}+\frac{\alpha_{1}}{2z_{1}}{\rm e}^{-|z|/z_{1}} \biggr{)}, \tag{2.210}\]

where \(\alpha_{0}+\alpha_{1}=1\), \(\Sigma_{\rm d}\) is the central surface density, \(R_{\rm d}\) is the disk scale length, and \(z_{0}=0.3\,{\rm kpc}\) and \(z_{1}=1\,{\rm kpc}\) are scale heights for the thin and thick components. The potential generated by this density distribution is given by equation (2.170) with \(\zeta(z)\) replaced by the expression in large brackets in equation (2.210). **(d) The interstellar medium** The disk formed by a galaxy's interstellar medium (ism) is thinner and more extended radially than the galaxy's stellar disk (see, for example, BM Figures 8.25 and 9.19). In the case of the Milky Way there is a hole of radius \(\sim 4\,{\rm kpc}\) at the center of the disk of the ism (BM Figure 9.19). These observations are crudely represented by taking the density of the ism to be

\[\rho_{\rm g}(R,z)=\frac{\Sigma_{\rm g}}{2z_{\rm g}}\exp\Big{(}-\frac{R}{R_{ \rm g}}-\frac{R_{\rm m}}{R}-\frac{|z|}{z_{\rm g}}\Bigr{)}, \tag{2.211}\]

with \(R_{\rm m}=4\,{\rm kpc}\) and \(z_{\rm g}=80\,{\rm pc}\). The parameters \(\Sigma_{\rm g}\) and \(R_{\rm g}\) are related to the parameters \(\Sigma_{\rm d}\) and \(R_{\rm d}\) of equation (2.210) by the assumption that \(R_{\rm g}=2R_{\rm d}\) and that the ism contributes 25% of the total disk surface density at the solar radius, \(R_{0}\). The potential implied by equation (2.211) is best found from equation (2.154). Dehnen & Binney (1998a) found that fits to the constraints described above could be obtained for a wide range of models made up of the components (a) to (d). The most important single parameter for determining the properties of a model is the scale length of the stellar disk, \(R_{\rm d}\). In SS1.1.2 we estimated that \(R_{\rm d}\) lies between 2 and 3 kpc. When \(R_{\rm d}\) is at the lower end of this range, the disk dominates the gravitational field out to beyond the solar radius, whereas when \(R_{\rm d}=3\) kpc, the halo dominates at all radii. It is useful to examine the properties of two extreme models, namely the most and the least halo-dominated models; we designate them Models I and II and list their parameters in Table 2.3. Model I has a small scale length, \(R_{\rm d}=2\) kpc, and gives rise to the isopotential surfaces and circular-speed curves shown in Figures 2.19 and 2.20. At small radii the halo density is \(\rho_{\rm h}\propto r^{-\alpha_{\rm h}}=r^{2}\), which is the smallest value of \(\alpha_{\rm h}\) allowed by the fitting program--with this disk scale length, the best fit has the smallest possible halo contribution near the center. Figure 2.20 illus

\begin{table}
\begin{tabular}{l|c c} \hline \hline Parameter & Model I & Model II \\ \hline \(R_{\rm d}/{\rm kpc}\) & 2 & 3.2 \\ \((\Sigma_{\rm d}+\Sigma_{\rm g})/{\cal M}_{\odot}\) pc\({}^{-2}\) & 1905 & 536 \\ \(\rho_{\rm b0}/{\cal M}_{\odot}\) pc\({}^{-3}\) & 0.427 & 0.3 \\ \(\rho_{\rm h0}/{\cal M}_{\odot}\) pc\({}^{-3}\) & 0.711 & 0.266 \\ \(\alpha_{\rm h}\) & \(-2\) & 1.63 \\ \(\beta_{\rm h}\) & 2.96 & 2.17 \\ \(a_{\rm h}/{\rm kpc}\) & 3.83 & 1.90 \\ \(M_{\rm d}/10^{10}\,{\cal M}_{\odot}\) & 5.13 & 4.16 \\ \(M_{\rm b}/10^{10}\,{\cal M}_{\odot}\) & 0.518 & 0.364 \\ \(M_{\rm h,<10\,kpc}/10^{10}\,{\cal M}_{\odot}\) & 2.81 & 5.23 \\ \(M_{\rm h,<100\,kpc}/10^{10}\,{\cal M}_{\odot}\) & 60.0 & 55.9 \\ \(v_{\rm e}(R_{0})/{\rm km\,s}^{-1}\) & 520 & 494 \\ \(f_{\rm b}\) & 0.05 & 0.04 \\ \(f_{\rm d}\) & 0.60 & 0.33 \\ \(f_{\rm h}\) & 0.35 & 0.63 \\ \hline \end{tabular}

Notes: In both models \(0.75\Sigma(R_{0})\) is contributed by stars, of which \(0.05\Sigma(R_{0})\) is in the thick disk. Interstellar gas accounts for the remaining \(0.25\Sigma(R_{0})\). The thin and thick disks have the same scale length \(R_{\rm d}\), while the gas disk has scale length \(2R_{\rm d}\) and a central hole of radius \(R_{\rm m}=4\) kpc. The thicknesses of the disks are \(z_{0}=300\) pc, \(z_{1}=1\) kpc, \(z_{\rm g}=80\) pc. In both models the bulge parameters are \(a_{\rm b}=1\) kpc, \(\alpha_{\rm b}=1.8\), \(r_{\rm b}=1.9\) kpc, \(q_{\rm b}=0.6\), while the halo axis ratio \(q_{\rm h}=0.8\). The quantity \(v_{\rm e}(R_{0})\) is the escape speed from the solar neighborhood; \(f_{\rm b}\), \(f_{\rm d}\) and \(f_{\rm h}\) are the fractions of the radial force supplied by bulge, disk and halo at \(R_{0}=8\) kpc. These are slightly modified forms of Models 1 and 4 of Dehnen & Binney (1998a). \end{table}
Table 2.3Parameters of Galaxy modelstates the dynamical importance of the disk and bulge interior to the solar radius, showing that at such radii the halo makes only a small contribution to the overall circular speed--since \(v_{\rm c}^{2}\propto g\), the contribution to the gravitational force is even smaller. This dominance is reflected in the contour plots of Figure 2.19 by the much closer packing of the equipotential contours of the bulge (top left panel) and disk (lower left panel) than those of the halo (top right panel). The equipotential surfaces of the disk are naturally more

Figure 2.19: The lower right panel shows equipotential contours of a model of the Galaxy with \(R_{\rm d}=2\,{\rm kpc}\) (Model I). Contour levels are \((-0.5,-1,\,-1.5\ldots)\times(100\,{\rm km\,s^{-1}})^{2}\). The top left panel shows the potential of the bulge, while the potentials of halo and disk are shown at top right and lower left, respectively. From top left to lower right the potentials at \((R,z)=(8\,{\rm kpc},0)\) are \(-0.28,\,-10.2,\,-2.98,\,-13.46\times(100\,{\rm km\,s^{-1}})^{2}\). Figure 2.20: The full curve shows the circular-speed curve of Model I, whose potential is contoured in Figure 2.19. The contributions from the bulge, halo and disk are shown by the long-dashed, dotted and short-dashed curves, respectively. Notice that the total circular speed is given by the sum in quadrature of the circular speeds of the components. highly flattened than those of either the bulge or the halo, so the equipotential surfaces of the total potential are most flattened at radii \(r\sim 5\,{\rm kpc}\), where the disk's potential dominates. Although in Model I the disk dominates the gravitational field (potential gradient) at \(R_{0}\), the halo makes by far the largest contribution to the total potential at all radii. For example, at the Sun's location the halo contributes \(-10.2\times(100\,{\rm km\,s^{-1}})^{2}\) to the overall potential, while the disk and bulge together contribute only \(-3.26\times(100\,{\rm km\,s^{-1}})^{2}\). The large contribution from the halo reflects the its enormous mass, most of it beyond \(R_{0}\). Just how much mass the halo contains is ill-determined because the Galaxy's circular speed \(v_{\rm c}(R)\) is uncertain beyond \(\approx 2R_{0}\). Figures 2.21 and 2.22 analyze the potential of Model II, a model that has a larger disk scale length, \(R_{\rm d}=3.2\,{\rm kpc}\). As Figure 2.22 shows, in this model the halo dominates the circular speed at all radii. It does so because it is much more centrally concentrated than the halo of Model I: at small \(r\) its density rises towards the center as \(r^{-1.63}\) rather than falling as in Model I. At the solar position the escape speed in this model is \(v_{\rm e}(R_{0})=494\,{\rm km\,s^{-1}}\), which is observationally indistinguishable from \(v_{\rm e}(R_{0})=520\,{\rm km\,s^{-1}}\) in Model I; both are consistent with the observational estimate \(v_{\rm e}(R_{0})=(550\pm 50)\,{\rm km\,s^{-1}}\) in Table 1.2. Figure 2.21: Equipotential contours of the halo-dominated Galaxy model, Model II, which has \(R_{\rm d}=3.2\,{\rm kpc}\). The top left panel shows the potential of the bulge, while the potentials of halo and disk are shown at top right and lower left, respectively. The lower right panel shows the overall potential with contour levels \((-0.5,-1,\,-1.5\ldots)\times(100\,{\rm km\,s^{-1}})^{2}\). From top left to lower right the potentials at \((R,z)=(8\,{\rm kpc},0)\) are \(-0.20\), \(-9.83\), \(-2.19\), \(-12.21\times(100\,{\rm km\,s^{-1}})^{2}\). One of the striking conclusions from these models is that the relative contributions of the disk and the halo to the interior mass and the circular speed at \(R_{0}\) are very uncertain. As \(R_{\rm d}\) varies from \(3.2\,{\rm kpc}\) to \(2\,{\rm kpc}\), the mass of the dark halo inside \(10\,{\rm kpc}\) decreases by nearly a factor 2 and the fraction of the gravitational force at \(R_{0}\) contributed by the halo falls9 from 0.63 to 0.35. Similar uncertainties are encountered in models of external disk galaxies (van Albada et al. 1985; Sellwood 1999). This degeneracy between the disk and halo parameters has to be resolved by bringing other observational constraints or dynamical arguments to bear, such as those obtained from measurements of the dynamics of galactic bars (SS6.5.2e), and

Figure 2.23: In each panel the full curve shows as a function of \(z\) in a Galactic model the force towards the galactic plane, \(K_{z}=\partial\Phi/\partial z\) at \(R_{0}=8\,{\rm kpc}\). The contributions from the bulge plus halo and disk are shown by the dotted and dashed curves, respectively. The left panel is for disk-dominated model, Model I (Figures 2.19 and 2.20), while the right panel is for Model II (Figures 2.21 and 2.22). Figure 2.22: The full curve shows the circular-speed curve of Model II. The contributions from the bulge, halo and disk are shown by the long-dashed, dotted and short-dashed curves, respectively. the optical depth to gravitational microlensing towards the Galactic center (Bissantz & Gerhard 2002; Famaey & Binney 2005). Even though the halo of Model II dominates the circular speed at \(R_{0}\), Figure 2.23 shows that the vertical force towards the disk, \(K_{z}=\partial\Phi/\partial z\), is dominated by the disk within \(\sim 2\,{\rm kpc}\) of the plane. Even a relatively low-mass disk can dominate \(K_{z}\) in this way because a disk's contribution to \(K_{z}\) rises extremely quickly near the plane, where the density of disk material is high. Above one scale height, \(\sim 200\,{\rm pc}\), the disk's contribution to \(K_{z}\) flattens off to the nearly constant value \(2\pi G\Sigma(R)\) (cf. Problem 2.3). By contrast, in both panels of Figure 2.23 the halo's contribution to \(K_{z}\) (dotted curves) rises nearly linearly with \(z\) out to several kiloparsecs above the Sun. Notice how similar the full curves in Figure 2.23 are: despite the very different contributions to \(v_{\rm c}\) from disk and halo in the two models, the shape of the observationally measurable quantity \(K_{z}\) (SS4.9.3) is almost the same in the two cases. **(e) The bulge as a bar** There is both kinematic and photometric evidence that the Milky Way's bulge is in fact a bar, that is, a highly elongated, rapidly rotating stellar system (SS6.5 and BM SSS9.4 and 10.1). From the vantage point of the Sun, it is hard to determine the precise shape of the bar, but, as sketched in Figure 2.24, the bar is believed to extend to a Galactocentric radius \(\sim 3\,{\rm kpc}\), with its longest axis inclined by about \(20^{\circ}\) to the line from the Sun to the Galactic center (Bissantz & Gerhard 2002). The lengths of the bar's semi-axes are roughly in the ratios \(1\,{:}\,0.3\,{:}\,0.3\). Both photometric studies of the bar itself and comparisons with bars in other galaxies suggest that the isodensity surfaces deviate significantly from ellipsoids (Lopez-Corredoira et al. 2005). Nonetheless, when considering the impact that the bar has on the Galaxy's gravitational potential, it is useful to start by approximating the isodensity surfaces by ellipsoids for in this case we can obtain the potential from equation (2.140)--if a more exact result were required, one could expand the difference \(\rho({\bf x})-\rho_{\rm e}({\bf x})\) between the actual density distribution \(\rho\) and the elliptical model \(\rho_{\rm e}\) in spherical harmonics, and obtain the small correction to the potential from equation (2.95). In this spirit, we estimate the effect of the bar on the Galaxy's potential by fashioning a bar out of the axisymmetric bulge of Model I as follows. In equations (2.207) we increase the scale radius \(r_{\rm b}\) from \(1.9\,{\rm kpc}\) to \(3\,{\rm kpc}\), and redefine \(m\) by \(m^{2}=x^{2}+(y^{2}+z^{2})/q^{2}\), where \(x\) runs along the bar's long axis. We adopt \(q=0.35\) and increase \(\rho_{0}\) so that the bar has roughly the same mass as the original bulge. In Figure 2.25 the full curves show the

Figure 2.24: Schematic diagram of the Galactic bar. intersection with the Galactic plane of the bar's isopotential surfaces, while the dotted curves show the corresponding curves for the bulge of Model I. As expected, the bar's isopotential surfaces are elongated. The effect is very small near the solar circle but appreciable at \(R\lesssim 5\,{\rm kpc}\). On account of this elongation, the potential now generates tangential forces: Along a radius that makes an angle of \(45^{\circ}\) with the bar's long axis, the ratio \(F_{\phi}/F_{r}\) of the tangential and radial forces from the bar falls from 0.4 at the center to 0.27 at 2 kpc and 0.125 at 4 kpc. From Figure 2.20 we see that the bulge dominates \(F_{r}\) at \(R\lesssim 1\,{\rm kpc}\), so in this crude model tangential forces are very important at small radii. Conversely, at \(R\simeq 4\,{\rm kpc}\) the bulge contributes only 11% of \(F_{r}\), so at that radius \(F_{\phi}\) is only \(\sim 1\%\) of \(F_{r}\). Nonetheless, the tangential forces that the bar induces can be dynamically significant for resonant orbits as far out as the solar circle because along such orbits the effect of \(F_{\phi}\) can accumulate over several periods (SS3.7.2 and Dehnen 2000a). We conclude that accurate models of the triaxial bar are needed to understand the dynamics of the Milky Way at \(R\lesssim 2\)-3 kpc, and possibly beyond. ### 2.8 Potentials from functional expansions

A common theme of many of the methods we have described is the expansion of the gravitational potential and density in a set of functions that are potential-density pairs. We shall encounter such methods again in SS2.9.4 as efficient tools for N-body simulation, and in SS5.3.2, where we study linear response theory for stellar systems. In this section we re-examine these techniques from a general standpoint. The basic idea of SS2.3 was to approximate a real galactic density distribution by a density for which the potential is known analytically. Only a

Figure 2.25: Full curves show the intersection with the Galactic plane of the isopotential surfaces of a model of the galactic bar. For comparison the dotted curves show the same curves for the axisymmetric bulge of Model I.

small number of different functional forms for the density were presented, so with them the potential of a given galaxy could not be calculated to arbitrary accuracy. In SSSS2.6.2 to 2.6.4 we described a second approach: representing the system's density as an infinite sum of density distributions of known potential--for example the Bessel-function distributions \(\Sigma_{km}(R,\phi)\) that are defined by equations (2.179). This second approach has the advantage that the potential and density can be approximated to arbitrarily high accuracy. However, a good approximation will require that a large number of terms are taken in the sum for the potential, because none of the density distributions of individual terms resembles real galaxies. Here we show how to combine the best aspects of these two approaches. In mathematical language, we find pairs of (possibly complex) **basis functions**\(\Phi_{\beta}({\bf x})\) and \(\rho_{\beta}({\bf x})\) for \(\beta=1,2,\ldots\), that satisfy

\[\nabla^{2}\Phi_{\beta}=4\pi G\rho_{\beta}, \tag{2.212}\]

and determine coefficients \(a_{\beta}\) such that the density of the system under study can be written as the sum

\[\rho({\bf x})=\sum_{\beta}a_{\beta}\rho_{\beta}({\bf x});\] (2.213a) then the system's potential \[\Phi({\bf x})\] is given by \[\Phi({\bf x})=\sum_{\beta}a_{\beta}\Phi_{\beta}({\bf x}). \tag{2.213b}\]

We determine the coefficients \(a_{\beta}\) as follows. We multiply equation (2.213a) by \(-\Phi_{\alpha}^{*}\) and integrate over all space to obtain

\[s_{\alpha}=\sum_{\beta}M_{\alpha\beta}a_{\beta},\] (2.214a) where \[s_{\alpha}=-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x})\rho({\bf x}) \quad;\quad M_{\alpha\beta}=-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x })\rho_{\beta}({\bf x}). \tag{2.214b}\]

The elements of the matrix \({\bf M}\) have a simple physical interpretation: \(M_{\alpha\beta}\) is minus the potential energy of the density distribution \(\rho_{\beta}\) in the gravitational potential \(\Phi_{\alpha}^{*}\). Using Poisson's equation (2.212) and applying the divergence theorem (B.45), we can show that \({\bf M}\) is a Hermitian matrix:10

Footnote 10: In the language of linear operators, the natural inner product on the space spanned by \(\{\Phi_{\alpha}\}\) is \((f,g)=-(4\pi G)^{-1}\int{\rm d}^{3}{\bf x}\,f^{*}\nabla^{2}g\). Then \((f,g)=(g,f)^{*}\) is minus the interaction energy of the density distributions associated with the potentials \(f^{*}\) and \(g\). \[\eqalign{M_{\alpha\beta}&=-{1\over 4\pi G}\int{\rm d}^{3}{\bf x}\,\Phi_{ \alpha}^{*}\nabla^{2}\Phi_{\beta}\cr&=-{1\over 4\pi G}\oint\Phi_{\alpha}^{*} \boldsymbol{\nabla}\Phi_{\beta}\cdot{\rm d}^{2}{\bf S}+{1\over 4\pi G}\int{\rm d}^{3}{ \bf x}\,\boldsymbol{\nabla}\Phi_{\alpha}^{*}\cdot\boldsymbol{\nabla}\Phi_{ \beta}. }\]The surface term vanishes when the integral is taken over all space, because \(\Phi_{\alpha}\) falls off at least as fast as \(r^{-1}\). This result shows that \(M_{\alpha\beta}=M^{*}_{\beta\alpha}\) so \({\bf M}\) is Hermitian. Note that \({\bf M}\) does not depend on the galactic mass distribution, so it can be computed once and for all after the basis potentials \(\Phi_{\alpha}\) have been chosen, and subsequently used time and again to follow the evolution of the potentials of many different galaxies, or of a single dynamically evolving galaxy. The coefficients \(a_{\beta}\) can now be found by solving the linear equation (2.214a). We can choose the basis functions to facilitate this process. There are two strategies for exploiting this freedom. **(a) Bi-orthonormal basis functions** We choose the basis functions such that \({\bf M}\) is the unit matrix, so equation (2.214a) has the trivial solution \(a_{\alpha}=s_{\alpha}\). From equation (2.214b) we see that this requires that the basis functions are **bi-orthonormal**:

\[-\int{\rm d}^{3}{\bf x}\,\Phi_{\alpha}^{*}({\bf x})\rho_{\beta}({\bf x})= \delta_{\alpha\beta}. \tag{2.216}\]

A straightforward way of ensuring bi-orthonormality is to require that the \(\Phi_{\alpha}\) are eigenfunctions of the Hermitian operator \(\nabla^{2}\)--in this case \(\rho_{\alpha}\propto\Phi_{\alpha}\), and the orthogonality of \(\Phi_{\alpha}\) and \(\rho_{\beta}\) is assured by the usual theorem that the eigenfunctions of a Hermitian operator are mutually orthogonal. Examples include the three functional expansions for disk potentials described in SSSS2.6.2 to 2.6.4. In SS5.3.2 we shall use bi-orthonormal functional expansions to investigate the stability of stellar systems. **(b) Designer basis functions** In principle \({\bf a}\) and \({\bf s}\) are vectors of infinite dimension. In practice it is necessary to truncate them and work with finite-dimensional vectors and matrices. The philosophy of **designer basis functions** is to choose the basis functions so that the galaxy can be accurately represented by the smallest possible number of them; the computational savings of having smaller vectors and matrices can more than offset the disadvantage that \({\bf M}\) no longer has a simple form. The approach is most easily described by a concrete example. We examine the important special case in which each basis function is the product of a function of radius \(r\) and a spherical harmonic:

\[\Phi_{\bf n}({\bf x})=F_{\bf n}(r){\rm Y}_{l}^{m}({\bf\Omega}), \tag{2.217}\]

where the potentials are enumerated by the vector \({\bf n}=(n,l,m)\), which has integer components, rather than the index \(\alpha\) used above; here \(n\) indexes an infinite number of radial functions for each spherical harmonic. Since the spherical harmonics (eq. C.44) are orthogonal, \({\bf M}\) is now block diagonal, that is, \(M_{{\bf n}^{\prime}{\bf n}}=0\) for \(l^{\prime}\neq l\) or \(m^{\prime}\neq m\). Thus the equations (2.214a) can be solved separately for each spherical-harmonic index pair \((l,m)\). Applying the Laplacian operator (C.49) to equation (2.217), we find with Poisson's equation (2.212) that \(\rho_{\bf n}\) is given by

\[4\pi G\rho_{\bf n}({\bf x})=\nabla^{2}\Phi_{\bf n}={\rm Y}_{l}^{m}({\bf\Omega} )\biggl{[}{1\over r^{2}}{{\rm d}\over{\rm d}r}\Bigl{(}r^{2}{{\rm d}F_{\bf n} \over{\rm d}r}\Bigr{)}-{l(l+1)\over r^{2}}F_{\bf n}\biggr{]}. \tag{2.218}\]For _any_ choice of the radial function \(F_{\bf n}\), equations (2.217) and (2.218) yield a potential-density pair. We now exploit this freedom to arrange for the first few functions \(\Phi_{\bf n}\) in the set to provide a good approximation to the potentials of real galaxies. One way of doing this is to set \(F_{000}(r)\) equal to the potential of one of the two-power-law models described in SS2.2.2g. For guidance in choosing \(F_{0lm}\) for \(l>0\) we turn to the solution of Poisson's equation that we obtained in terms of spherical harmonics in SS2.4. Considering the coefficient of \({\rm Y}_{l}^{m}\) in equation (2.95), we see that the terms proportional to \(r^{l}\) will be dominant at small \(r\) and the terms proportional to \(r^{-(l+1)}\) will be dominant at large \(r\). These observations imply that a promising choice for \(F_{0lm}\) is

\[F_{0lm}(r)=F_{l}(r)\equiv{r^{l}\over(1+r/r_{0})^{2l+1}}\quad(l>0),\]

where \(r_{0}\) is a suitable scale radius. If we also apply this equation for \(l=0\), then \(F_{0}(r)\) is proportional to the potential of a Hernquist model (eq. 2.67), consistent with our earlier argument that \(F_{000}\) should be the potential of a two-power-law galaxy model. We must still expand our basis to include functions \(F_{\bf n}(r)\) for each given \((l,m)\) and \(n>0\) to describe accurately the radial dependence. To this end we write

\[F_{nl}(r)\equiv F_{\bf n}(r)=U_{n}(r)F_{l}(r),\]

where \(U_{0}(r)=1\) and the set of \(U_{n}\) is complete. A possible choice would be

\[U_{n}(r)=u^{n}\quad\hbox{where}\quad u\equiv{r/r_{0}-1\over r/r_{0}+1}\quad(- 1\leq u<1).\]

When our choice of basis functions is inserted in equation (2.214b), we find with equation (2.218) that the matrix \({\bf M}\) and the vector \({\bf s}\) take the forms

\[\eqalign{M_{{\bf n}^{\prime}{\bf n}}&=-(4\pi G)^{-1}\delta_{l^{\prime}l} \delta_{m^{\prime}m}\int{\rm d}r\,F_{n^{\prime}l}^{*}(r)\biggl{[}{{\rm d} \over{\rm d}r}\Bigl{(}r^{2}{{\rm d}\over{\rm d}r}\Bigr{)}-l(l+1)\biggr{]}F_{ nl}(r)\cr s_{{\bf n}^{\prime}}&=-\int{\rm d}^{3}{\bf x}\,{\rm Y}_{l}^{m*}({\bf\Omega})F_{n^ {\prime}l}^{*}(r)\rho({\bf x}). }\]

It is possible to combine the best features of bi-orthonormal and designer basis functions. For example, if we choose \(F_{nl}(r)=U_{nl}(r)F_{l}(r)\), where \(F_{l}(r)\) is given by (2.219) and \(U_{nl}(r)\) is an appropriate polynomial in the variable \(u\) defined by equation (2.221), the designer basis functions are bi-orthonormal (Hernquist & Ostriker 1992). ## Chapter 2 Potential Theory

### 2.1 Introduction

The study of the dynamics of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the dynamics of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the dynamics of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the \(N\)-body system is a very important topic in the study of the \(N\)-body system. The study of the \(N\)-body system is a very important topic in the study of the dynamics of the \(N\)-body system. The study of the \(N\)-body system is a very important topic in the study of the \(N\)-body system. Poisson solvers for collisional problems can be designed to be essentially perfect: in SS7.4.6d we shall see that the conceptually difficult part of a collisional simulation is integrating the orbits of particles. By contrast, Poisson solvers for collisionless simulations are fundamentally limited by particle noise: since we do not really know \(\rho({\bf r})\) but only the locations of a finite number of particles that sample \(\rho({\bf r})\), we cannot recover \(\Phi({\bf r})\) accurately no matter how much potential theory we know. On account of this fundamental limitation, Poisson solvers for collisionless simulations inevitably involve a compromise between inadequate resolution and excessive statistical noise. Some solvers are undoubtedly better than others, but the solver that is best suited to a given simulation depends on the scientific problem that is to be addressed. In this section we describe the most important types of Poisson solver, and discuss their strengths and weaknesses. #### Direct summation

Consider evaluating the force on particle \(\alpha\) by simply summing the contributions from all the other particles in the simulation,

\[{\bf F}_{\alpha}=\sum_{\beta\neq\alpha}Gm_{\beta}\frac{{\bf r}_{\beta}-{\bf r }_{\alpha}}{|{\bf r}_{\beta}-{\bf r}_{\alpha}|^{3}}. \tag{223}\]

Each such force evaluation involves the calculation of \(N-1\) distances \(|{\bf r}_{\beta}-{\bf r}_{\alpha}|\). Each distance can be used twice, once for the contribution of particle \(\beta\) to the force on particle \(\alpha\) and once for the force from particle \(\alpha\) on particle \(\beta\). So, if forces are evaluated by direct summation a minimum of \(\frac{1}{2}N(N-1)\) distances have to be evaluated, where \(N\gg 1\) is the number of particles in the simulation. Thus, the work per timestep increases with \(N\) as \(N^{2}\). Below we shall see that there are vastly more efficient ways of evaluating forces, which scale as \(N\ln N\). The first N-body calculations were restricted to small values of \(N\), for which the difference between \(N^{2}\) and \(N\ln N\) is not large, so direct summation was a viable option. For the values of \(N>10\,000\) now current, \(N^{2}/(N\ln N)>10^{3}\), so direct summation is in principle not an attractive strategy. Notwithstanding this fact it is still in use because its simple formulae can be encoded in hardware, so special-purpose processors can calculate forces between tens of thousands of particles at acceptable speeds (Makino et al. 2003). **Softening** If two particles, say \(\alpha\) and \(\beta\), approach each other closely, the term in equation (223) that describes the force \({\bf F}_{\alpha\beta}\) between them becomes large. This phenomenon is problematic for both collisional and collisionless calculations, for different reasons. In the collisional case the divergence of \({\bf F}_{\alpha\beta}\) as \({\bf r}_{\alpha}\to{\bf r}_{\beta}\) is a real physical effect, but one that is computationally awkward because it implies that the equations of motion of particles \(\alpha\) and \(\beta\) have to be integrated with very small timesteps. Unless sophisticated workarounds such as "regularization" (SS3.4.7) are employed to handle this situation, close encounters can bring the integration virtually to a halt. "Softening" of the force-law as described below is an expedient that keeps the integration moving along at an acceptable pace at the price of a loss of realism. In the collisionless case the divergence of \({\bf F}_{\alpha\beta}\) predicted by equation (2.223) is entirely unphysical, for the mass distribution we are trying to model is inherently smooth. The divergence is an artifact of the Monte-Carlo sampling of the density distribution. In this case softening can enhance rather than detract from the realism of the simulation. Softening involves replacing equation (2.223) with

\[{\bf F}_{\alpha}=\sum_{\beta\neq\alpha}Gm_{\beta}S_{\rm F}(|{\bf r}_{\beta}-{ \bf r}_{\alpha}|)\,{{\bf r}_{\beta}-{\bf r}_{\alpha}\over|{\bf r}_{\beta}-{\bf r }_{\alpha}|}. \tag{2.224}\]

This equation differs from (2.223) only in the replacement of \(r^{-2}\) by \(S_{\rm F}(r)\), where \({\bf r}={\bf r}_{\beta}-{\bf r}_{\alpha}\). \(S_{\rm F}(r)\), the **force softening kernel**, is some function that tends to \(r^{-2}\) for values of its argument bigger than the **softening length**\(\epsilon\), and tends smoothly to zero for small values of its argument. Equation (2.224) has the desirable features that: (i) the force exerted by particle \(\beta\) on particle \(\alpha\), \(Gm_{\alpha}m_{\beta}S_{F}(r){\bf r}/r\), is equal and opposite to the force exerted by \(\alpha\) on \(\beta\), so Newton's third law is satisfied; (ii) the force between any two particles acts along the line that joins them; (iii) the force approaches the usual gravitational force at large separations; (iv) the force between two particles at the same location is zero. \(S_{\rm F}(r)\) is the derivative of another function \(S(r)\), the **softening kernel**, which appears in the equation for the potential at the location of particle \(\alpha\):

\[\Phi_{\alpha}\equiv\Phi({\bf r}_{\alpha})=\sum_{\beta\neq\alpha}Gm_{\beta}S(|{ \bf r}_{\beta}-{\bf r}_{\alpha}|). \tag{2.225}\]

A widely used form of \(S\) is

\[S({\bf r})=-{1\over\sqrt{r^{2}+\epsilon^{2}}}. \tag{2.226}\]

In this case, the gravitational potential of each particle is just that of a Plummer sphere of scale length \(\epsilon\) (eq. 2.44a). In a collisionless simulation this makes physical sense: the mass that is represented by a particle is in reality distributed through a non-zero volume.11 The density law of a Plummer sphere (eq. 2.44b) places most of the sphere's mass inside \(r=\epsilon\), so the natural choice is to make \(\epsilon\) of order the inter-particle separation. In collisionless simulations the choice of softening kernel and softening length is a compromise between maximizing the smoothness of the force-field and minimizing the degradation of the spatial resolution caused by the softening. Despite its popularity, the choice (2.226) of \(S\) is not optimal in this sense, because the density of a Plummer sphere falls off too slowly with radius. A better choice is

\[S({\bf r})=-\frac{r^{2}+\frac{3}{2}\epsilon^{2}}{(r^{2}+\epsilon^{2})^{3/2}}, \tag{2.227}\]

which amounts to replacing the potential of each particle with that of a sphere of radius \(\epsilon\) in which the density is proportional to \((r^{2}+\epsilon^{2})^{-7/2}\). See Dehnen (2001) for a discussion of the merits of various softening kernels. An ideal Poisson solver would allow \(\epsilon\) to vary as a particle moves from a high-density to a low-density region. In practice most contemporary Poisson solvers use fixed softening due to technical difficulties associated with energy conservation. We now consider algorithms that enable one to evaluate the sum (2.225) to high accuracy in a number of arithmetic operations that scales as \(N\ln N\), rather as \(N^{2}\). #### Tree codes

Our discussion is based on Dehnen (2000b). The particles are first organized into a structure that was introduced by Barnes & Hut (1986): we place an imaginary cube around the simulation and divide it into eight equal sub-cubes. If any sub-cube contains more than one particle, we divide it in turn into eight equal cubes, and so on until every cube contains at most one particle. This hierarchy of cubes forms an **oct-tree**, and the original cube is called the **root** of the tree. Each cube after the root has a parent cube, and seven sibling cubes. Any cube that contains more than one particle has eight child cubes. There is a clear analogy with a real tree, whose trunk divides into great boughs, which divide into branches, which divide into twigs, which ultimately carry leaves. Particles are the leaves of our oct-tree. Suppose now that we locate the center of mass of the particles in each cube and evaluate the sums

\[M_{0}\equiv\sum_{\alpha}m_{\alpha}\quad;\quad M_{ij}=\sum_{\alpha}m_{\alpha}x _{i}^{\alpha}x_{j}^{\alpha}\quad;\quad M_{ijk}=\sum_{\alpha}m_{\alpha}x_{i}^{ \alpha}x_{j}^{\alpha}x_{k}^{\alpha} \tag{2.228}\]

and so forth, where the sums run over the particles in the cube and \({\bf x}^{\alpha}\) is the position vector of particle \(\alpha\) relative to the cube's center of mass. This hierarchy of sums is closely related to the multipole expansion of SS2.4, and these quantities are called the **Cartesian multipole moments**. The three in equation (2.228) are the monopole, quadrupole, and octopole moments. ## Chapter 2 Potential Theory

### 2.1 Introduction

The study of the properties of the potential in the presence of a single particle is a very important topic. The study of the properties of the potential in the presence of a single particle is a very important topic. The study of the properties of the potential in the presence of a single particle is very important topic. The study of the properties of the potential in the presence of a single particle is a very important topic. The study of the properties of the potential in the presence of a single particle is very important topic. The study of the properties of the potential in the presence of a single particle is a very important topic. subtend angles at \({\bf x}\) smaller than \(\theta_{\rm o}\). Some of these final cubes will be leaves, which are deemed to subtend zero angle, because they contain only a single particle. The key point is that as the number of particles in the simulation is increased, the number of cubes over which we sum to get the force at \({\bf x}\) increases much more slowly--see Box 2.2. **Cartesian multipole expansion** To derive explicit formulae for the potential in terms of the multipoles of cubes, we now develop some of the theory of Cartesian multipoles. We consider the contribution to the gravitational potential \(\Phi\) at position \({\bf X}\) in cube A that is generated by the matter in cube B. We have

\[\Phi({\bf X})=G\int_{\rm cube\ B}{\rm d}^{3}{\bf Y}\,S({\bf X}-{\bf Y})\rho({ \bf Y}), \tag{2.229}\]

where \(\rho\) is the matter density and \(S\) is the softening kernel (eq. 2.225). We specialize to the case of well-separated cubes and write \({\bf X}=\hat{\bf X}+{\bf x}\) and \({\bf Y}=\hat{\bf Y}+{\bf y}\), where \(\hat{\bf X}\) and \(\hat{\bf Y}\) are the centers of mass of cubes A and B, respectively. Then we Taylor expand \(S({\bf X}-{\bf Y})\) in powers of \({\bf x}-{\bf y}\) around \(\hat{\bf X}-\hat{\bf Y}\):

\[\eqalign{S({\bf X}-{\bf Y})&=S(\hat{\bf X}-\hat{\bf Y})+\sum_{i=1}^{3}({\bf x }-{\bf y})_{i}{\partial S({\bf R})\over\partial R_{i}}\bigg{|}_{{\bf R}=\hat{ \bf X}-\hat{\bf Y}}\cr&\qquad+{1\over 2! }\sum_{i,j=1}^{3}({\bf x}-{\bf y})_{i}({\bf x }-{\bf y})_{j}{\partial^{2}S({\bf R})\over\partial R_{i}\partial R_{j}}\bigg{|} _{{\bf R}=\hat{\bf X}-\hat{\bf Y}}+\cdots\cr&=\sum_{n}{1\over n! }({\bf x}-{ \bf y})^{(n)}\cdot\big{[}\partial_{(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X}- \hat{\bf Y}}. }\]

Here the last line employs a notation in which \({\bf r}^{(n)}\equiv r_{i_{1}}r_{i_{2}}\cdots r_{i_{n}}\) is a product of \(n\) components of the vector \({\bf r}\) and \(\partial_{(n)}\) is the corresponding product of partial derivatives with respect to these components, while the centered dot implies summation over all the \(n\) indices \(i_{k}\) (a total of \(3^{n}\) terms). Substituting (2.230) into (2.229), we obtain

\[\Phi(\hat{\bf X}+{\bf x})=G\sum_{n}{1\over n! }\bigg{[}\int{\rm d}^{3}{\bf y} \,\rho(\hat{\bf Y}+{\bf y})({\bf x}-{\bf y})^{(n)}\bigg{]}\cdot\big{[} \partial_{(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X}-\hat{\bf Y}}.\]

Using the expansion

\[({\bf x}-{\bf y})^{(n)}=\sum_{k=0}^{n}{n!\over k!(n-k)! }{\bf x}^{(k)}{\bf y}^{ (n-k)},\]

we have

\[\Phi(\hat{\bf X}+{\bf x})=G\sum_{n}\sum_{k=0}^{n}{1\over k!(n-k)! }{\bf x}^{(k) }{\bf M}^{(n-k)}\cdot\big{[}\partial_{(n)}S({\bf R})\big{]}_{{\bf R}=\hat{\bf X }-\hat{\bf Y}},\]

**Box 2.3: Derivatives of a spherically symmetric softening kernel**

Consider the case of a spherically symmetric softening kernel \(S({\bf R})\), i.e., one of the form \(S(|{\bf R}|)\). In this case the evaluation of the first few tensors \(\partial_{(n)}S\) is straightforward:

\[\eqalign{\partial_{(1)}S(R)&={S^{\prime}}{R_{i}\over R}\cr\partial_{(2)}S(R)&= \Bigl{(}{S^{\prime\prime}}-{S^{\prime}\over R}\Bigr{)}{R_{i}R_{j}\over R^{2}}+ {S^{\prime}\over R}\delta_{ij}\cr\partial_{(3)}S(R)&=\Bigl{(}{S^{\prime\prime \prime}}-3{S^{\prime\prime}\over R}+3{S^{\prime}\over R^{2}}\Bigr{)}{R_{i}R_{ j}R_{k}\over R^{3}}\cr&\qquad+\Bigl{(}{S^{\prime\prime}}-{S^{\prime}\over R}\Bigr{)}{ \delta_{ij}R_{k}+\delta_{jk}R_{i}+\delta_{ki}R_{j}\over R^{2}}\cr\partial_{(4 )}S(R)&=\Bigl{(}{S^{iv}}-6{S^{\prime\prime\prime}\over R}+9{S^{\prime\prime} \over R^{2}}-9{S^{\prime}\over R^{3}}\Bigr{)}{R_{i}R_{j}R_{k}R_{l}\over R^{4}} \cr&\qquad+\Bigl{(}{S^{\prime\prime\prime}}-3{S^{\prime\prime}\over R}+3{S^{ \prime}\over R^{2}}\Bigr{)}\bigl{(}\delta_{ij}R_{k}R_{l}+\delta_{jk}R_{i}R_{l} +\delta_{ki}R_{j}R_{l}\cr&\qquad+\delta_{il}R_{j}R_{k}+\delta_{lj}R_{i}R_{k}+ \delta_{lk}R_{i}R_{j}\Bigr{)}/R^{3}\cr&\qquad+\Bigl{(}{S^{\prime\prime}}-{S^{ \prime}\over R}\Bigr{)}{\delta_{ij}\delta_{kl}+\delta_{ik}\delta_{jl}+\delta_ {il}\delta_{jk}\over R^{2}}\cr}\]

where

\[{\bf M}^{(k)}\equiv\int_{\rm cube\ B}\!\! {\rm d}^{3}{\bf y}\,\rho({\bf\hat{Y} }+{\bf y}){\bf y}^{(k)}.\]

When the density distribution is simulated with particles, \(\rho({\bf r})=\sum_{\alpha}m_{\alpha}\delta({\bf r}-{\bf r}^{\alpha})\) is a sum of delta functions centered on the locations of the particles. In this case the integral in (2.234) can be immediately evaluated and yields the objects defined by equations (2.228). Equation (2.233) expresses the potential generated by cube B at an arbitrary point in cube A as a power series in the components of \({\bf x}\), the separation between the point of observation and A's center of mass. The coefficients in this power series are made up of (a) the multipole moments of B, which were evaluated during tree construction, and (b) the derivatives \(\partial_{(n)}S\) of the softening kernel evaluated on the vector \({\bf R}\) that joins the centers of mass of the two cubes, which can be evaluated once and for all at the start of the integration. Once these quantities are all to hand, we can quickly evaluate the force on every particle in cube A by summing the series with the appropriate value of \({\bf x}\). The derivatives \(\partial_{(n)}S\) are explicitly evaluated for a spherically symmetric kernel in Box 2.3. An important simplification arises because the same derivatives occur in the analogous series for the potential that cube A generates at a point within cube B. Dehnen (2000b) explains how one can exploit this fact, both to accelerate the computation and to achieve exact momentum conservation. Unlike some of the codes that we are about to present, a tree code employs no grid. This feature enables tree codes to handle problems such as galaxy mergers, in which dense stellar systems move through a large volume of nearly empty space--most grid-based codes cannot handle such problems efficiently because they would waste most of their computing resources covering low-density regions with the same high-resolution grid that they require to handle the dense stellar systems. Another merit of tree codes is that they are readily parallelized by, for example, delegating to a different processor construction of each of the trees that emerge from the root's eight child cubes. #### Particle-mesh codes

A wide variety of N-body codes solve Poisson's equation using estimates of the density at a set of regularly spaced points, the nodes of a mesh or grid. The simplest mesh is a Cartesian grid and we concentrate on this case, although most of the principles we describe carry over to other meshes, such as ones based on spherical polar coordinates. More detail can be found in Hockney & Eastwood (1988). The process of estimating the density on a grid from the positions of a large number of particles that trace the density is called **mass assignment** because it involves assigning the mass of each particle to one or more nearby nodes. The simplest algorithm is to assign all of the mass of each particle to the nearest node. This procedure, which is known as the **nearest grid point** (**NGP**) scheme, is rarely used for two reasons. First, the NGP scheme only samples the density distribution crudely. Second, as explained on page 134 below, for technical reasons associated with momentum conservation the NGP scheme leads to solutions of Poisson's equation in which forces change discontinuously midway between nodes. Better mass-assignment schemes spread the mass of each particle over several nearby nodes. Box 2.4 describes a hierarchy of widely used schemes that spread the mass over 1, \(2^{D}\), \(3^{D},\ldots\) nodes of a \(D\)-dimensional grid. If we decide on one node, we have the NGP scheme. If we want to split a particle's mass over \(2^{D}\) nodes, the resulting scheme is called the **cloud in cell** (**CIC**) mass-assignment scheme because it may be visualized by expanding every mass point into a homogeneous cube with side length equal to the grid spacing, and assigning every mass element in this cube to the nearest node (Figure 2.26). If we split a particle's mass over \(3^{D}\) nodes, we have the **triangular shaped cloud** (**TSC**) mass-assignment scheme, so called because the scheme may be derived by regarding the particle to be a cloud 

### 2.4 Mass assignment schemes

A mass-assignment scheme is a function \(W_{\mathbf{p}}(\mathbf{r})\) that gives the fraction of the mass of a particle at \(\mathbf{r}\) that is assigned to node \(\mathbf{p}\). Here \(\mathbf{p}\) is a triple of integers and the node's location is \(\mathbf{x_{p}}=(p_{1},p_{2},p_{3})\Delta\), with \(\Delta\) the grid spacing. The simplest schemes for a three-dimensional Cartesian grid are the product of three functions, each evaluated on one component of \(\mathbf{r}\)

\[W_{\mathbf{p}}(\mathbf{r})=w(x-p_{1}\Delta)w(y-p_{2}\Delta)w(z-p_{3}\Delta).\]

The condition that all the mass is assigned somewhere is \(\sum_{\mathbf{p}}W_{\mathbf{p}}(\mathbf{r})=1\), which is assured if \(M_{0}\equiv\sum_{i}w(x-i\Delta)=1\). Additional constraints arise from demanding that the grid-scale fluctuations are as small as possible at large distances. Suppose that we are modeling a one-dimensional potential with softening kernel \(S(x)\). Then the potential due to a mass \(m\) at \(x\) is \(\Phi(x^{\prime})=mS(x^{\prime}-x)\). The potential computed from a grid is

\[\Phi_{\mathrm{g}}(x^{\prime})=m\sum_{i}w(x-i\Delta)S(x^{\prime}-i\Delta).\]

If \(|x^{\prime}-x|\gg\Delta\), we can Taylor expand \(S(x^{\prime}-i\Delta)\) in powers of \(x-i\Delta\):

\[\Phi_{\mathrm{g}}(x^{\prime})=m\sum_{i}\sum_{n=0}^{\infty}\frac{1}{n! }w(x-i \Delta)S^{(n)}(x^{\prime}-x)(x-i\Delta)^{n},\]

where \(S^{(n)}\) is the \(n\)th derivative of \(S\). If condition \(M_{0}=1\) is satisfied, the \(n=0\) term equals the exact potential, so grid-scale fluctuations are minimized if

\[M_{n}\equiv\sum_{i}(x-i\Delta)^{n}w(x-i\Delta)=\mathrm{constant}\quad\mathrm{ for}\quad n=1,2,\ldots\]

If the mass is distributed between two nodes,

\[w(x)=\cases{1-|x|/\Delta&for $|x|<\Delta$,\cr 0&otherwise,\cr} \tag{1}\]

satisfies \(M_{0}=1\), \(M_{1}=0\). This is the cloud in cell (CIC) mass-assignment scheme. If the mass is distributed between three nodes,

\[w(x)=\cases{\frac{3}{4}-|x|^{2}/\Delta^{2}&for $|x|<\frac{1}{2}\Delta$\cr\frac{1}{2}( \frac{3}{2}-|x|/\Delta)^{2}&for $\frac{1}{2}\Delta<|x|<\frac{3}{2}\Delta$\cr 0& otherwise.\cr} \tag{2}\]

satisfies \(M_{0}=1\), \(M_{1}=0\), \(M_{2}=\frac{1}{4}\Delta^{2}\). This is the triangular shaped cloud (TSC) mass-assignment scheme. There is an alternative three-node scheme in which \(M_{2}=0\), but in this scheme \(w(x)\) is discontinuous at \(|x|/\Delta=\frac{1}{2}\), \(\frac{3}{2}\), whereas in the TSC scheme \(w(x)\) is continuous and differentiable. in which the mass density falls linearly with coordinate differences from the location of the particle (Figure 2.26). In the NGP scheme, the mass assigned to a node changes discontinuously as a particle moves through the grid. In the CIC scheme, the mass changes continuously but with discontinuous first derivative. In the TSC scheme, both the mass and its derivative change continuously. In view of the role a mass-assignment scheme plays in force interpolation--see page 134 below--the progressive increase in smoothness as one proceeds up this hierarchy of mass-assignment schemes is valuable. This advantage must be set against two disadvantages of proceeding up the hierarchy: (i) in three dimensions the computational cost increases rapidly as the number of nodes to which mass is assigned increases from 1 for NGP, to 8 for CIC, 27 for CIC, etc. ; (ii) spreading mass over many nodes involves a loss of spatial resolution. In practice the most widely used schemes are CIC and TSC. Given the density on the mesh, we are ready to solve Poisson's equation for the potential. To do this we must specify boundary conditions, which in practice are one of two types: **periodic** and **vacuum**. Periodic boundary conditions are used when the grid is imagined to be one cell of an infinite lattice; these are natural for cosmological simulations. With vacuum boundary conditions we require that at large distances \(\Phi\to-GM/r\), where \(M\) is the total mass on the grid. These are appropriate for simulations of isolated stellar systems. **(a) Periodic boundary conditions** We solve Poisson's equation by representing \(\nabla^{2}\) as a finite-difference operator. For example, we can make the approximation

\[\eqalign{\left(\nabla^{2}\Phi\right)_{lmn}\simeq&\big{(}\Phi_{l+1,m,n}+\Phi_{ l-1,m,n}+\Phi_{l,m+1,n}+\Phi_{l,m-1,n}\cr&\qquad+\Phi_{l,m,n+1}+\Phi_{l,m,n-1}-6 \Phi_{l,m,n}\big{)}/\Delta^{2},}\]

where \(\Delta\) is the mesh spacing. This substitution converts the Poisson equation into a large system of linear equations for the \(\Phi_{lmn}\) in terms of the known \(\rho_{lmn}\). The system obtained by equating (2.235) to \(4\pi G\rho_{lmn}\) is most

Figure 2.26: The CIC (left) and TSC (right) mass-assignment schemes in one dimension. The dotted lines mark the boundaries between cells of the grid, and the rectangle (CIC) and triangle (TSC) represent the mass of the particle. Mass is assigned to cells in proportion to the fraction of the area of the rectangle or triangle that lies in each cell—for example, the shaded portions are assigned to cell 1.

efficiently solved using discrete Fourier transforms (DFTs; see Appendix G and Problem 2.23). **(b) Vacuum boundary conditions** Consider now how to solve Poisson's equation with vacuum boundary conditions. We use the integral form of Poisson's equation (2.3), or its smoothed form (2.229), in which the softening kernel \(S\) already contains our choice of boundary conditions. We write

\[\Phi({\bf r})=G\sum_{\bf p}S({\bf r}-{\bf r_{p}})m_{\bf p}, \tag{2.236}\]

where \(m_{\bf p}\) is the mass assigned to node \({\bf p}\). The labor required to evaluate \(\Phi\) at the location of every particle is proportional to the number of particles times the number of nodes. A much more efficient approach is to evaluate \(\Phi\) only at the nodes, and then to interpolate to the locations of particles. At the nodes, equation (2.236) reads

\[\Phi_{\bf q}=G\sum_{\bf p}S_{{\bf q}-{\bf p}}m_{\bf p}, \tag{2.237}\]

where \({\bf p}\) and \({\bf q}\) are three-vectors with integer components in the range \((0,K-1)\), with \(K\) the number of nodes along a side of the computational box. In equation (2.237), each component of \(S\)'s subscript ranges from \(-(K-1)\) (when \(q_{1}=0\) and \(p_{1}=K-1\)) to \(K-1\) (when \(q_{1}=K-1\) and \(p_{1}=0\)). Thus \(S\)'s subscript has components that take on \(2K-1\) values, while the subscript of \(m\) has components that range over only \(K\) possible values. Discrete Fourier transforms provide an extremely efficient way of solving equations of this form, but before we can apply them, we have to make the problem symmetrical in the subscripts, and arrange for them to take \(2^{n}\) values, for some integer \(n\). We do this by taking \(K=2^{n-1}\) and padding \(m\) out to a matrix of size \((2K)^{3}\), whose subscripts cover the range \((-K,K-1)\) with \(m_{\bf p}\) set to zero when any component of the subscript lies outside the physically significant range, \((0,K-1)\). Finally we eliminate negative indices by making \(S\) and \(m\) periodic functions of each index with period \(2K\). Thus extended, equation (2.237) takes the form of a discrete convolution. So we take the DFT of both sides of this equation, and, with the aid of the discrete Fourier convolution theorem (eq. G.5), we obtain

\[\hat{\Phi}_{\bf k}=G\hat{S}_{\bf k}\hat{m}_{\bf k}. \tag{2.238}\]

According to this equation, the DFT of \(\Phi\) can be obtained from that of \(m\) simply by multiplying by the DFT of \(S\). With \(\hat{\Phi}_{\bf k}\) in hand, \(\Phi\) is easily obtained by doing an inverse DFT. Moreover, the DFT of \(S\) can be calculated once and for all at the start of the simulation and stored for use at each timestep. ### 2.5: James's Fourier Poisson solver

We describe the method of James (1977) for imposing vacuum boundary conditions on the system (2.235) without doubling the range of all the indices. This method is both fast and economical with computer memory. We start from the density values on a cubical grid and imagine the values to represent electric charge density rather than mass density. Next, we find the potential that would be generated by the charges attached to the interior of the grid if the boundary of the grid were grounded--that is, if the potential \(\Phi\) vanished on the boundary. This potential is the solution of Poisson's equation for the given charge density at interior points of the grid, subject to the boundary condition \(\Phi=0\) on the grid boundary. We obtain the required solution by writing \(\Phi\) in terms of its sine transform (eq. G.7a)

\[\Phi_{lmn}=\sum_{\alpha\beta\gamma=1}^{K-1}\Phi^{\alpha\beta\gamma}(\mbox{SSS} )\sin\left(\frac{\pi l\alpha}{K}\right)\sin\left(\frac{\pi m\beta}{K}\right) \sin\left(\frac{\pi n\gamma}{K}\right)\!, \tag{1}\]

where \(0\leq l,m,n\leq K\). The sine transform automatically ensures that \(\Phi_{lmn}\) vanishes on the boundary. Substituting this expression for \(\Phi_{lmn}\) into the numerical approximation (2.235) for the Laplacian, and then equating this to \(4\pi G\rho_{lmn}\) with \(\rho_{lmn}\) expressed in terms of its sine transform, we discover that each amplitude \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\) is simply a multiple of the corresponding amplitude \(\rho^{\alpha\beta\gamma}(\mbox{SSS})\). Since the sine transform is its own inverse (eq. G.7b), it is a simple matter to recover the \(\Phi_{lmn}\) from the \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\). The potential we obtain in this way differs from the one we require because the walls bear charges that differ from those specified in the original problem. (When the walls of the grid are grounded, charges flow along the grounding cables until \(\Phi\) vanishes on the boundary.) We use Gauss's theorem to determine the actual surface density of wall charges \(\Sigma\)--since the potential vanishes outside the box, \(\Sigma=-g_{\perp}/(4\pi G)\), where \(g_{\perp}=|{\bf n}\cdot\nabla\Phi|\) is the magnitude of the force field just inside the walls of the grounded box. Finally, we convolve the resulting charge distribution on the walls with a softening kernel to obtain the potential that it generates when vacuum boundary conditions are applied, and subtract this potential from the potential generated by the mass in the grounded box, to get the potential that the originally specified density distribution generates with vacuum boundary conditions. The softening kernel should be the inverse of the discrete Laplacian used in the calculation of \(\Phi^{\alpha\beta\gamma}(\mbox{SSS})\)--see James (1977) for details. The key to the success of this procedure is that the convolution of the wall charge density with the softening kernel is simple because the charge density is hollow--see Appendix G or Magorrian (2007) for details. This approach to imposing vacuum boundary conditions is very wasteful of computer memory. Box 2.5 describes a clever and much more economical alternative. Once the potential has been obtained at every node, we use numerical differentiation to obtain the gravitational field \(\mathbf{g_{n}}\) at the nodes: for example, the component parallel to the first axis might be

\[\hat{\mathbf{e}}_{1}\cdot\mathbf{g_{n}}=-\frac{1}{2\Delta}(\Phi_{(n_{1}+1,n_{2},n_{3})}-\Phi_{(n_{1}-1,n_{2},n_{3})}). \tag{2.239}\]

More generally

\[\mathbf{g_{j}}=\sum_{\mathbf{n}}\mathbf{A_{n}}\Phi_{\mathbf{j+n}}, \tag{2.240}\]

where \(\mathbf{A_{n}}=-\mathbf{A_{-n}}\) defines some numerical differentiation scheme. Values of the forces on individual particles are then obtained by interpolation from these values. In any such scheme, it is desirable that the sum of the forces on all the particles is zero to machine precision, because this is a prerequisite for conservation of the simulation's total momentum; if momentum is not conserved the system is liable to rocket off the grid. Consider therefore the sum of all forces. We let \(W_{\mathbf{p}}(\mathbf{r})\) denote the fraction of the mass of a particle that lies at \(\mathbf{r}\) that is assigned to node \(\mathbf{p}\), so

\[m_{\mathbf{p}}=\sum_{\text{particles }\beta}m_{\beta}W_{\mathbf{p}}(\mathbf{r} _{\beta}). \tag{2.241}\]

We introduce similar functions \(Q_{\mathbf{j}}(\mathbf{r})\) to describe the interpolation scheme used to calculate forces on particles given the field on the mesh: let the gravitational field at \(\mathbf{r}\) be

\[\mathbf{g}(\mathbf{r})=\sum_{\text{nodes }\mathbf{j}}Q_{\mathbf{j}}(\mathbf{r} )\mathbf{g_{j}}. \tag{2.242}\]

Then with equation (2.237), (2.240) and (2.241), the sum of all particle forces is

\[\begin{split}\mathbf{F}_{\text{tot}}&=\sum_{\text{ particles }\alpha}m_{\alpha}\mathbf{g}(\mathbf{r}_{\alpha})=\sum_{\alpha}m_{\alpha}\sum_{ \text{nodes }\mathbf{j}}Q_{\mathbf{j}}(\mathbf{r}_{\alpha})\sum_{\mathbf{n}}\mathbf{A_{n} }\Phi_{\mathbf{j+n}}\\ &=G\sum_{\mathbf{j}\mathbf{p}}\sum_{\alpha\beta}m_{\alpha}m_{ \beta}Q_{\mathbf{j}}(\mathbf{r}_{\alpha})W_{\mathbf{p}}(\mathbf{r}_{\beta}) \sum_{\mathbf{n}}\mathbf{A_{n}}S_{\mathbf{j+n-p}}.\end{split} \tag{2.243}\]

The sum over \(\mathbf{n}\), which is the numerical derivative of the softening kernel, is antisymmetric in \(\mathbf{j}\) and \(\mathbf{p}\), as can seen by replacing the dummy variable \(\mathbf{n}\) by \(-\mathbf{n}\) and exploiting the antisymmetry of \(\mathbf{A_{n}}\) and the symmetry of \(S_{\mathbf{q}}\). In view of this antisymmetry, \(\mathbf{F}_{\text{tot}}\) vanishes if \(Q_{\mathbf{p}}=W_{\mathbf{p}}\), and in fact only this choice of \(Q_{\bf p}\) guarantees symmetry of the sum over \(\alpha\beta\) for all possible particle locations. Therefore, we conclude that net momentum can be conserved if and only if we use the same scheme to interpolate forces from the grid as we use to assign mass to the grid. In particular, if we use the NGP scheme, forces change discontinuously midway between nodes. **(c) Mesh refinement** Stellar systems, whether galaxies, galactic nuclei, star clusters or clusters of galaxies, tend to develop small, tightly bound condensations. These objects are often of considerable astronomical interest. For example, the visible stars of the Milky Way are a dense condensation in a much larger dark-matter halo. The ideal Poisson solver would determine the gravitational field of a structure no matter how small the structure becomes. In the CIC and TSC mass-assignment schemes, the force between two particles that are separated by no more than the mesh spacing is significantly smaller than the value predicted by Newton's inverse-square law, regardless of the value of \(\epsilon\) that is used in the softening kernel. Hence the dynamics of structures smaller than a few mesh spacings cannot be faithfully followed. Stellar systems usually have large volumes in which the density is low, and small volumes in which it is high. Hence achieving higher spatial resolution by subdividing the grid (**mesh refinement**) throughout the volume occupied by a system is undesirable: in low-density regions a fine mesh is both computationally expensive and pointless. If higher resolution is to be attained by mesh refinement, we must refine locally and adaptively--at each timestep, high-density regions must be located and equipped with a finer mesh. Handling an adaptive mesh requires intricate code, and if the mesh has a complex geometry, it will not be possible to use DFTs to evaluate the sum (2.237) efficiently. For a discussion of adaptive-mesh codes see Knebe, Green, & Binney (2001). **(d) P\({}^{3}\)M codes** The **Particle-particle-particle-mesh** or **P\({}^{3}\)M** technique provides a simpler way of enhancing the spatial resolution of a PM code. The idea behind a P\({}^{3}\)M code is to use the standard PM algorithm to calculate the contribution from distant particles to the force \({\bf F}\) on a particle, while using the direct sum (2.224) to get the contribution to \({\bf F}\) from particles that lie in the same or adjacent cells. The softening kernel \(S_{\rm F}\) used for the direct sum must be carefully chosen to provide only the difference between the Newtonian force and the force already obtained from the grid. The efficiency of a P\({}^{3}\)M code depends sensitively on the number of particles, \(N_{\rm max}\), in the most densely populated cell, since the cost of evaluating the direct sum scales as \(N_{\rm max}^{2}\) rather than as \(N_{\rm max}\ln(N_{\rm max})\). P\({}^{3}\)M codes have been extensively used for cosmological simulations (Efstathiou et al. 1985). In these simulations, galaxy formation leads gradually to higher and higher densities, so \(N_{\rm max}\) eventually becomes very large and the simulations grind to a halt. This problem can be resolved by using either a tree algorithm (Bode & Ostriker 2003) or a separate P\({}^{3}\)M implementation (Couchman 1991) to handle sums within populous cells. #### 2.9.4 Spherical-harmonic codes

We saw in SS2.4 and Figure 2.10 that good approximations to the potentials of stellar systems that are not too far from spherical can be obtained from the first few terms of the spherical-harmonic expansion (2.95). Two rather different approaches to the numerical implementation of equation (2.95) have been widely used. In the first (McGlynn 1984; Bonteko 1988), we cover the computational volume with a spherical mesh centered on the estimated location of the center of the system. We identify the particles that lie within each spherical shell around this center, say between radii \(a_{i}-\Delta/2\) and \(a_{i}+\Delta/2\), and then evaluate the integrals (2.94) up to \(l=l_{\rm max}\), using the formula

\[m_{lm}(a_{i})\simeq\sum_{a_{i}-\Delta/2<r_{\alpha}\leq a_{i}+\Delta/2}\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\! \!\! #### 2.9.5 Simulations of planar systems

Studies of the dynamics of thin disks often confine the particles to a plane. In this case the softening length \(\epsilon\) can be interpreted as the characteristic thickness of the disk: if two particles pass at a fixed vertical separation \(\Delta z\) from one another, their mutual interaction potential is given by equation (2.225) with \({\bf r}_{\alpha}\) and \({\bf r}_{\beta}\) two-dimensional vectors, and \(\epsilon\) set equal to \(\Delta z\) in equation (2.226). A two-dimensional mesh that is \(K\) cells on a side consumes less computer memory and CPU time than the corresponding three-dimensional mesh by a factor \(K\), so PM codes are much more attractive in two dimensions than in three. Both rectangular (Hohl & Hockney 1969) and polar (Sellwood 1983) meshes have been widely used. On going from three dimensions to two, the functional expansion technique yields a similar efficiency gain because the number of subscripts \(n,l\) etc., that need be summed over decreases from three to two (Earn & Sellwood 1995). **Problems**

**2.1** [1] Show that the gravitational potential energy of a spherical system of finite mass in which the density satisfies \(\lim_{r\to 0}\rho r^{5/2}=0\) can be written

\[W=-{G\over 2}\int_{0}^{\infty}{\rm d}r\,{M^{2}(r)\over r^{2}},\]

where \(M(r)\) is the mass interior to radius \(r\). **2.2** [1] Prove that the Chandrasekhar potential-energy tensor for any spherical body has the form \(W_{jk}={1\over 3}W\delta_{jk}\), where \(W\) is the potential energy. Hint: start from equation (2.19). **2.3** [1] Show that the potential of an infinite razor-thin sheet of surface density \(\Sigma\) in the plane \(z=0\) is \(\Phi=2\pi G\Sigma|z|+\it constant\), (a) using Gauss's theorem, and (b) from Poisson's equation. **2.4** [1] (Suggested by A. Toomre) Show that \(\Phi=\ln[r(1+|\cos(\theta)|)]\) solves Laplace's equation everywhere except when \(r=0\) or \(\theta=\pi/2\). By applying Gauss's theorem near \(\theta=\pi/2\), find the potential of the Mestel disk (2.158) in the limit \(R_{\rm max}\to\infty\). **2.5** [2] The **finite Mestel disk** is a razor-thin disk with surface density \(\Sigma(R)\) such that (i) \(\Sigma(R)=0\) for all \(R>R_{0}\); (ii) the circular speed is \(v_{\rm c}(R)=v_{0}=\it constant\) for all \(R<R_{0}\). The surface density of the finite Mestel disk was first derived by Mestel (1963) but here we describe a short, elegant derivation due to Brada & Milgrom (1995). (a) Consider a spherical mass distribution with density \(\rho(r)={1\over 2}Ar^{-2}\) for \(r<R_{0}\) and zero for \(r>R_{0}\), where \(A\) is a constant. Argue that the circular speed is independent of radius and independent of \(R_{0}\) so long as \(r<R_{0}\). (b) Now squash the sphere along one direction, so that its isodensity surfaces are spheroids with axis ratio \(q\). Argue that the circular speed in the equatorial plane of the squashed system is still independent of radius and independent of \(R_{0}\) so long as the equatorial radius \(R<R_{0}\). Hint: use Newton's third theorem. (c) By considering the limit \(q\to 0\), show that a disk with surface density

\[\Sigma(R)=\cases{(A/R)\cos^{-1}(R/R_{0})&($R<R_{0}$)\cr 0&($R>R_{0}$)\cr}\]

has a flat circular-speed curve for \(R<R_{0}\). (d) Show that \(v_{0}^{2}=\pi^{2}GA\). Hint: let \(R_{0}\to\infty\) and compare to the infinite Mestel disk. **2.6**[1] Defining **prolate spheroidal coordinates**\((u,v)\) by \(R=a\sinh u\sin v\), \(z=a\cosh u\cos v\), where \(a>0\) is a constant, show that \(R^{2}+(a+|z|)^{2}=a^{2}(\cosh u+|\cos v|)^{2}\). Hence show that the potential (2.68a) of the Kuzmin disk can be written

\[\Phi_{\rm K}(u,v)=-\frac{GM}{a}\,\frac{\cosh u-|\cos v|}{\sinh^{2}u+\sin^{2}v}. \tag{2.251}\]

In SS3.5.3 we show that this potential is an example of a Stackel potential, in which orbits admit an extra isolating integral. **2.7**[2] Astronauts orbiting an unexplored planet find that (i) the surface of the planet is precisely spherical and centered on \(r=0\); and (ii) the potential exterior to the planetary surface is \(\Phi=-GM/r\) exactly, that is, there are no non-zero multipole moments other than the monopole. Can they conclude from these observations that the mass distribution in the interior of the planet is spherically symmetric? If not, give a simple example of a non-spherical mass distribution that would reproduce the observations. **2.8**[1] (Suggested by L. Ciotti) If a transparent, spherical stellar system has constant mass-to-light ratio \(\Upsilon\), prove that the potential at radius \(r\) is

\[\Phi(r)=-\frac{2G\Upsilon}{r}\int_{0}^{r}{\rm d}x\,S(x), \tag{2.252}\]

where \(S(x)\) is the strip brightness defined in Problem 1.3. **2.9**[1] If a transparent, spherical stellar system has constant mass-to-light ratio \(\Upsilon\), prove that the central potential is (Ciotti 1991)

\[\Phi(0)=-4G\Upsilon\int_{0}^{\infty}{\rm d}R\,I(R), \tag{2.253}\]

where \(I(R)\) is the surface brightness at projected radius \(R\). **2.10**[2] Consider an axisymmetric body whose density distribution is \(\rho(R,z)\) and total mass is \(M=\int{\rm d}^{3}{\bf r}\,\rho(R,z)\). Assume that the body has finite extent, \(\rho(R,z)=0\) for \(r^{2}=R^{2}+z^{2}>r_{\rm max}^{2}\), and is symmetric about its equator, that is, \(\rho(R,-z)=\rho(R,z)\). (a) Show that at distances large compared to \(r_{\rm max}\), the potential arising from this body can be written in the form

\[\Phi(R,z)\simeq-\frac{GM}{r}-\frac{G}{4}\frac{(R^{2}-2z^{2})}{r^{5}}\int{\rm d }^{3}{\bf r^{\prime}}\,\rho(R^{\prime},z^{\prime})({R^{\prime}}^{2}-2{z^{ \prime}}^{2}), \tag{2.254}\]

where the error is of order \((r_{\rm max}/r)^{2}\) smaller than the second term. (b) Show that at large distances from an exponential disk with surface density \(\Sigma(R)=\Sigma_{0}\exp(-R/R_{\rm d})\), the potential has the form

\[\Phi(R,z)\simeq-\frac{GM}{r}\left[1+\frac{3R_{\rm d}^{2}(R^{2}-2z^{2})}{2r^{4} }+{\rm O}(R_{\rm d}^{4}/r^{4})\right], \tag{2.255}\]

where \(M\) is the mass of the disk. **2.11**[2] Show that the potential energy of an exponential disk is \(W\simeq-11.627\,G\Sigma_{0}^{2}R_{\rm d}^{3}\). Show further that if all stars move on circular orbits, the disk's angular momentum is \(J\simeq 17.462\,G^{1/2}\Sigma_{0}^{3/2}R_{\rm d}^{7/2}\) and its kinetic energy is \(K\simeq 5.813\,G\Sigma_{0}^{2}R_{\rm d}^{3}\). Hence show that for this disk the dimensionless spin parameter \(\lambda\equiv J|E|^{1/2}/GM^{5/2}\simeq 0.4255\), where \(E=K+W\) is the total energy. **2.12**[1] The \(r^{-1}\) dependence of the gravitational potential on distance arises because the graviton, which carries the gravitational field, is massless. If the graviton had a mass \(m_{\rm g}\), the gravitational potential due to a body of mass \(M\) would be \(\Phi(r)=-GM{\rm e}^{-\alpha r}/r\), where \(\alpha=m_{\rm g}c/\hbar\) (the **Yukawa potential**), which reduces to the Newtonian potential in the limit \(\alpha\to 0\). What is the analog of Poisson's equation (2.10) for the Yukawa potential? **2.13**: [2] Prove that the external potentials and gravitational fields of any two confocal spheroids of uniform density and equal mass are everywhere the same. **2.14**: [2] Use equation (2.140) to show that a prolate body with density \(\rho=\rho_{0}(1+R^{2}/a_{1}^{2}+z^{2}/a_{3}^{2})^{-2}\), where \(a_{3}>a_{1}\), generates the potential

\[\Phi(u,v)=-\pi G\rho_{0}a_{1}^{2}a_{3}\int_{0}^{\infty}\!\mathrm{d}\tau\frac{ \sqrt{a_{3}^{2}+\tau}}{(\tau+a_{3}^{2}+\lambda)(\tau+a_{3}^{2}+\mu)}, \tag{2.256}\]

where \((u,v)\) are oblate spheroidal coordinates defined by equation (2.96) with \(\Delta^{2}=a_{3}^{2}-a_{1}^{2}\), and we have written \(\lambda\equiv\Delta^{2}\sinh^{2}u\), \(\mu\equiv-\Delta^{2}\cos^{2}v\). Decompose the integral in (2.256) into partial fractions to show (without evaluating the integrals) that \(\Phi\) is a Stackel potential

\[\Phi(\lambda,\mu)=\frac{H(\lambda)-H(\mu)}{\lambda-\mu}, \tag{2.257}\]

where \(H\) is a continuous function (de Zeeuw 1985 and SS3.5.3). Finally, show that

\[\Phi(u,v)=-\frac{2\pi Ga_{1}^{2}a_{3}\rho_{0}}{\Delta^{2}}\,\frac{f(\Delta \sinh u)-f(\lambda\cos v)}{\sinh^{2}u+\cos^{2}v},\] (2.258a) where \[f(z)\equiv z\tan^{-1}(z/a_{3}). \tag{2.258b}\]

Hint: to ensure convergence of the integrals, you may wish to add \((\tau+a_{3}^{2})^{-\frac{1}{2}}\) to one of the integrands and subtract it from the other. The body with this potential is called the **perfect prolate spheroid**, because it is the only prolate axisymmetric density distribution of constant ellipticity that has a Stackel potential. **2.15**: [1] Show that the central potential of a thin axisymmetric disk is

\[\Phi(0,0)=-2\pi G\int_{0}^{\infty}\mathrm{d}R\,\Sigma(R). \tag{2.259}\]

Hint: use equation (C.68). **2.16**: [1] Prove that the potential \(\Phi(r)\) is a non-decreasing function of \(r\) in any spherical system. Does the same conclusion hold in an axisymmetric razor-thin disk? If so, prove it; if not, find a counter-example. **2.17**: [2] (Suggested by M. Merrifield) An axisymmetric disk is seen edge-on and has projected mass per unit length \(\mu(X)\). Show that its surface density is

\[\Sigma(R)=-\frac{1}{\pi}\int_{R}^{\infty}\,\frac{\mathrm{d}X}{\sqrt{X^{2}-R^{ 2}}}\frac{\mathrm{d}\mu}{\mathrm{d}X}, \tag{2.260}\]

and that its potential is

\[\Phi(R,z)=2G\int_{0}^{\infty}\mathrm{d}X\,\frac{\mathrm{d}\mu}{\mathrm{d}X}\sin ^{-1}\left(\frac{2X}{\sqrt{z^{2}+(R+X)^{2}}+\sqrt{z^{2}+(R-X)^{2}}}\right). \tag{2.261}\]

Hint: use (2.153a). **2.18**: [1] Use equation (2.190) to show that the razor-thin disk for which the circular speed is given by

\[v_{\mathrm{c}}^{2}=\frac{v_{0}^{2}}{\sqrt{1+R^{2}/a^{2}}}\] (2.262a) has surface density (Toomre 1963) \[\Sigma(R)=\frac{v_{0}^{2}}{2\pi GR}\left(1-\frac{1}{\sqrt{1+a^{2}/R^{2}}}\right). \tag{2.262b}\]

Show that these formulae correspond to the Mestel disk in an appropriate limit. Show that the surface density (2.68b) of the Kuzmin disk is obtained when \(\Sigma(R)\) is differentiated with respect to \(a^{2}\), and hence recover the circular speed of this model. **2.19**[3] We have derived relations between the potential and surface density of non-axisymmetric disks by solving Laplace's equation in cylindrical coordinates (SS2.6.2) and oblate spheroidal coordinates (SS2.6.4). Derive a relation of this kind by solving Laplace's equation in spherical coordinates, and show that the result is identical with the formula derived using logarithmic spirals (eq. 2.199). Hint: you may need associated Legendre functions \(P_{\lambda}^{m}(x)\), where \(\lambda\) is a real number. See also equations (C.12) and (C.31). **2.20**[2] Show that the circular speed \(v_{c}(R)\) in a thin axisymmetric disk of surface density \(\Sigma(R)\) may be written in the form (Mestel 1963)

\[\begin{split} v_{\rm c}^{2}(R)=\frac{GM(R)}{R}+2G\sum_{k=1}^{ \infty}\alpha_{k}\biggl{[}&\frac{2k+1}{R^{2k+1}}\int_{0}^{R}{ \rm d}R^{\prime}\,\Sigma(R^{\prime}){R^{\prime}}^{2k+1}\\ &-2kR^{2k}\int_{R}^{\infty}{\rm d}R^{\prime}\,\frac{\Sigma(R^{ \prime})}{{R^{\prime}}^{2k}}\biggr{]},\end{split} \tag{2.263}\]

where

\[\alpha_{k}\equiv\int_{0}^{\pi}{\rm d}\theta P_{2k}(\cos\theta)=\pi\left[ \frac{(2k)!}{2^{2k}(k!)^{2}}\right]^{2}. \tag{2.264}\]

Hint: start with equation (2.3) and expand \(|{\bf x}-{\bf x}^{\prime}|^{-1}\) in Legendre polynomials using equation (C.35). **2.21**[2] Show that the potential of an axisymmetric disk with surface density \(\Sigma(R)\) is

\[\Phi(R,z)=-\frac{2G}{\sqrt{R}}\int_{0}^{\infty}{\rm d}R^{\prime}\,\Sigma(R^{ \prime})kK(k)\sqrt{R^{\prime}}, \tag{2.265}\]

where \(K(k)\) is a complete elliptic integral (Appendix C.4) and

\[k^{2}\equiv\frac{4RR^{\prime}}{(R+R^{\prime})^{2}+z^{2}}. \tag{2.266}\]

Hint: start with equation (2.3) and show that \(|{\bf x}-{\bf x}^{\prime}|^{2}=4RR^{\prime}k^{-2}\{1-k^{2}\cos^{2}[\frac{1}{ 2}(\phi-\phi^{\prime})]\}\). Note that the integral (2.265) has a logarithmic singularity when \(z=0\) and \(R^{\prime}\to R\), which requires some care when the integral is being evaluated numerically. **2.22**[3] (Suggested by H. Dejonghe) Prove that the surface density \(\Sigma(x,y)\) and potential \(\Phi(x,y)\) in a disk occupying the plane \(z=0\) are related by

\[\Sigma(x^{\prime},y^{\prime})=\frac{1}{4\pi^{2}G}\iint\frac{{\rm d}x\,{\rm d} y}{|{\bf x}-{\bf x}^{\prime}|}\left(\frac{\partial^{2}\Phi}{\partial x^{2}}+ \frac{\partial^{2}\Phi}{\partial y^{2}}\right). \tag{2.267}\]

**2.23**[1] Consider the discrete form of Poisson's equation with periodic boundary conditions that is obtained by using the approximation (2.235) for the value of the Laplacian on a grid with \(K\) mesh cells on a side. Write \(\Phi_{lmn}\) and \(\rho_{lmn}\) in terms of their DFTs,

\[\Phi_{\bf r}=\sum_{\bf k}\hat{\Phi}_{\bf k}{\rm e}^{2\pi{\rm i}{\bf k}\cdot{ \bf r}/K}\quad;\quad\rho_{\bf r}=\sum_{\bf k}\hat{\rho}_{\bf k}{\rm e}^{2\pi{ \rm i}{\bf k}\cdot{\bf r}/K}, \tag{2.268}\]

where \({\bf r}\) and \({\bf k}\) are vectors with integer components in the range \((0,K-1)\). Show that

\[\Phi_{\bf k}=\frac{2\pi G\rho_{\bf k}\Delta^{2}}{\cos(2\pi k_{x}/K)+\cos(2\pi k _{y}/K)+\cos(2\pi k_{z}/K)-3}. \tag{2.269}\]

**2.24**[2] In some numerical simulations of spherical stellar systems, spherical symmetry is enforced by treating each of the \(N\) stars as a "superstar," that is, a spherical shell containing a large number of stars with randomly oriented orbits but the same radius, radial velocity, and scalar angular momentum. Let \(m_{n}\) and \(r_{n}\) be the mass and radius of the \(n^{\rm th}\) superstar. Assume that the superstars are sorted in order of increasing radius, that is, \(r_{1}\leq r_{2}<\cdots<r_{N}\). (a) Show that the force on superstar \(n\) is

\[{\bf F}_{n}=-\hat{\bf e}_{r}\,\frac{GM_{n}}{r_{n}^{2}}\quad\mbox{where}\quad M_{n }\equiv\sum_{j=1}^{n-1}m_{j}. \tag{2.270}\]

Thus show that the force on every star can be computed in O\((N)\) steps once the stars are sorted in radius, in contrast to direct summation (SS2.9.1), which requires O\((N^{2})\) steps. (b) A set of \(N\) superstars can be sorted into increasing order in O\((N\ln N)\) steps (e.g., Press et al. 1986). Thus, the initial calculation of the forces for an unsorted system requires O\((N\ln N)\) steps. Show that force calculations at subsequent timesteps require only O\((N)\) steps.